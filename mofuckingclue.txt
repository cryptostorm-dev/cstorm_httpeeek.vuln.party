/*! Agility
*/
var tryParseDate,TimeSpan,TimePeriod;typeof window.Agility=="undefined"&&(window.Agility={}),function(Agility){var _sessionLevelCacheKey,_unique,_uniqueIndex;Agility.isCtrl=!1,Agility.isAlt=!1,Agility.isShift=!1,$(document).keyup(function(e){switch(e.which){case 16:Agility.isShift=!1;break;case 17:Agility.isCtrl=!1;break;case 18:Agility.isAlt=!1}}).keydown(function(e){switch(e.which){case 16:Agility.isShift=!0;break;case 17:Agility.isCtrl=!0;break;case 18:Agility.isAlt=!0}}),Agility.RegisterNamespace=function(space){for(var spaces=space.split("."),root=window,i=0;i<spaces.length;i++)root=typeof root[spaces[i]]=="undefined"?root[spaces[i]]={}:root[spaces[i]];return root},_sessionLevelCacheKey=null,Agility.SessionLevelCacheKey=function(){return _sessionLevelCacheKey==null&&(_sessionLevelCacheKey=(new Date).toString("yyyyMMddHHmmss")),_sessionLevelCacheKey},Agility.ResolveUrl=function(url){var baseUrl=window.Agility_BaseUrl||"/";return url.replace(/^~\//,baseUrl)},_unique={},_uniqueIndex=0,Agility.UniqueID=function(prePend){return prePend==undefined||prePend==null||prePend==""?_uniqueIndex++:(_unique[prePend]==undefined&&(_unique[prePend]=0),prePend+_unique[prePend]++)},Agility.CloneObject=function(what,serializationType){serializationType!=undefined&&serializationType!=null&&serializationType!=""&&(this.__type=serializationType);for(i in what)if(what[i]==null)this[i]=null;else if(typeof what[i]=="object")this[i]=new Agility.CloneObject(what[i]);else{var val=what[i];this[i]=val}},Agility.QueryString=function(name,url){var index;if((url==undefined||url==null||url=="")&&(url=location.href),index=url.indexOf("?"),index<1&&index==url.length-2)return null;url.indexOf("#")!=-1&&(url=url.substring(0,url.indexOf("#")));var qstr=url.substring(index+1,url.length),ary1=qstr.split("&"),retValue=null;return jQuery.each(ary1,function(index,q){var ary2=q.split("=");if(ary2.length==2&&unescape(ary2[0]).toLowerCase()==name.toLowerCase())return retValue=ary2[1],retValue=retValue.replace(/\+/g,"%20"),retValue=unescape(retValue),!1}),retValue},Agility.ToJSONDate=function(dateObj){dateObj.setMinutes(dateObj.getMinutes()+dateObj.getTimezoneOffset());var dtStr=dateObj.getFullYear()+"-"+Agility.PadLeft(dateObj.getMonth()+1,"0")+"-"+Agility.PadLeft(dateObj.getDate()+1,"0")+" "+Agility.PadLeft(dateObj.getHours(),"0")+":"+Agility.PadLeft(dateObj.getMinutes(),"0")+":"+Agility.PadLeft(dateObj.getSeconds(),dateObj.getMilliseconds(),"0");return"/Date("+dtStr+")/"},Agility.PadLeft=function(str,padChar){for(str=str+"";str.length<padChar;)str=padChar+str;return str},Agility.GetFlashVersion=function(){var flashVersion=0,control,version,flashPlugin,vstr,desc;if(window.ActiveXObject){control=null;try{control=new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),control&&(version=control.GetVariable("$version").substring(4),version=version.split(","),flashVersion=parseInt(version[0]))}catch(e){}}else navigator.plugins!=null&&navigator.plugins.length>0&&(flashPlugin=navigator.plugins["Shockwave Flash"],typeof flashPlugin=="object"&&(flashPlugin.version?(vstr=flashPlugin.version,vstr&&(flashVersion=parseInt(vstr.split(".")[0]))):(desc=flashPlugin.description,desc&&(flashVersion=parseInt(desc.replace("Shockwave Flash ","").split(".")[0])))));return flashVersion},Agility.SetCookie=function(name,value,expires,path,domain,secure){var expires_date=expires;document.cookie=name+"="+escape(value)+(expires?";expires="+expires_date.toGMTString():"")+(path?";path="+path:"")+(domain?";domain="+domain:"")+(secure?";secure":"")},Agility.GetCookie=function(cookieName){var a_all_cookies=document.cookie.split(";"),a_temp_cookie="",cookie_name="",cookie_value="",b_cookie_found=!1;for(i=0;i<a_all_cookies.length;i++){if(a_temp_cookie=a_all_cookies[i].split("="),cookie_name=a_temp_cookie[0].replace(/^\s+|\s+$/g,""),cookie_name==cookieName)return b_cookie_found=!0,a_temp_cookie.length>1&&(cookie_value=unescape(a_temp_cookie[1].replace(/^\s+|\s+$/g,""))),cookie_value;a_temp_cookie=null,cookie_name=""}if(!b_cookie_found)return null},Agility.DeleteCookie=function(name,path,domain,secure){Agility.GetCookie(name)&&(document.cookie=name+"="+(path?";path="+path:"")+(domain?";domain="+domain:"")+(secure?";secure":"")+";expires=Thu, 01-Jan-1970 00:00:01 GMT")},Agility.JSON=new function(){this.decode=function(){var filter,result,self,tmp;if($$("toString")){switch(arguments.length){case 2:self=arguments[0],filter=arguments[1];break;case 1:$[typeof arguments[0]](arguments[0])===Function?(self=this,filter=arguments[0]):self=arguments[0];break;default:self=this}if(rc.test(self))try{if(result=e("(".concat(self,")")),filter&&result!==null&&(tmp=$[typeof result](result))&&(tmp===Array||tmp===Object))for(self in result)result[self]=v(self,result)?filter(self,result[self]):result[self]}catch(z){}else throw new JSONError("bad data");}return result},this.encode=function(){var self=arguments.length?arguments[0]:this,result,tmp,i,key;if(self===null)result="null";else if(self!==undefined&&(tmp=$[typeof self](self)))switch(tmp){case Array:result=[];for(var i=0,j=0,k=self.length;j<k;j++)self[j]!==undefined&&(tmp=Agility.JSON.encode(self[j]))&&(result[i++]=tmp);result="[".concat(result.join(","),"]");break;case Boolean:result=String(self);break;case Date:result='"'.concat(self.getFullYear(),"-",d(self.getMonth()+1),"-",d(self.getDate()),"T",d(self.getHours()),":",d(self.getMinutes()),":",d(self.getSeconds()),'"');break;case Function:break;case Number:result=isFinite(self)?String(self):"null";break;case String:result='"'.concat(self.replace(rs,s).replace(ru,u),'"');break;default:i=0,result=[];for(key in self)self[key]!==undefined&&(tmp=Agility.JSON.encode(self[key]))&&(result[i++]='"'.concat(key.replace(rs,s).replace(ru,u),'":',tmp));result="{".concat(result.join(","),"}")}return result},this.toDate=function(){var self=arguments.length?arguments[0]:this,result;return rd.test(self)?(result=new Date,result.setHours(i(self,11,2)),result.setMinutes(i(self,14,2)),result.setSeconds(i(self,17,2)),result.setMonth(i(self,5,2)-1),result.setDate(i(self,8,2)),result.setFullYear(i(self,0,4))):rt.test(self)&&(result=new Date(self*1e3)),result};var c={"\b":"b","\t":"t","\n":"n","\f":"f","\r":"r",'"':'"',"\\":"\\","/":"/"},d=function(n){return n<10?"0".concat(n):n},e=function(c,f,e){return e=eval,delete eval,typeof eval=="undefined"&&(eval=e),f=eval(""+c),eval=e,f},i=function(e,p,l){return 1*e.substr(p,l)},p=["","000","00","0",""],rc=null,rd=/^[0-9]{4}\-[0-9]{2}\-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}$/,rs=/(\x5c|\x2F|\x22|[\x0c-\x0d]|[\x08-\x0a])/g,rt=/^([0-9]+|[0-9]+[,\.][0-9]{1,3})$/,ru=/([\x00-\x07]|\x0b|[\x0e-\x1f])/g,s=function(i,d){return"\\".concat(c[d])},u=function(i,d){var n=d.charCodeAt(0).toString(16);return"\\u".concat(p[n.length],n)},v=function(k,v){return $[typeof result](result)!==Function&&(v.hasOwnProperty?v.hasOwnProperty(k):v.constructor.prototype[k]!==v[k])},$={boolean:function(){return Boolean},"function":function(){return Function},number:function(){return Number},object:function(o){return o instanceof o.constructor?o.constructor:null},string:function(){return String},undefined:function(){return null}},$$=function(m){function $(c,t){t=c[m],delete c[m];try{e(c)}catch(z){return c[m]=t,1}}return $(Array)&&$(Object)};try{rc=new RegExp('^("(\\\\.|[^"\\\\\\n\\r])*?"|[,:{}\\[\\]0-9.\\-+Eaeflnr-u \\n\\r\\t])+?$')}catch(z){rc=/^(true|false|null|\[.*\]|\{.*\}|".*"|\d+|\d+\.\d+)$/}}}(Agility),tryParseDate=Date.parse,Date.CultureInfo={name:"en-US",englishName:"English (United States)",nativeName:"English (United States)",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],shortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],firstLetterDayNames:["S","M","T","W","T","F","S"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],abbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],amDesignator:"AM",pmDesignator:"PM",firstDayOfWeek:0,twoDigitYearMax:2029,dateElementOrder:"mdy",formatPatterns:{shortDate:"M/d/yyyy",longDate:"dddd, MMMM dd, yyyy",shortTime:"h:mm tt",longTime:"h:mm:ss tt",fullDateTime:"dddd, MMMM dd, yyyy h:mm:ss tt",sortableDateTime:"yyyy-MM-ddTHH:mm:ss",universalSortableDateTime:"yyyy-MM-dd HH:mm:ssZ",rfc1123:"ddd, dd MMM yyyy HH:mm:ss GMT",monthDay:"MMMM dd",yearMonth:"MMMM, yyyy"},regexPatterns:{jan:/^jan(uary)?/i,feb:/^feb(ruary)?/i,mar:/^mar(ch)?/i,apr:/^apr(il)?/i,may:/^may/i,jun:/^jun(e)?/i,jul:/^jul(y)?/i,aug:/^aug(ust)?/i,sep:/^sep(t(ember)?)?/i,oct:/^oct(ober)?/i,nov:/^nov(ember)?/i,dec:/^dec(ember)?/i,sun:/^su(n(day)?)?/i,mon:/^mo(n(day)?)?/i,tue:/^tu(e(s(day)?)?)?/i,wed:/^we(d(nesday)?)?/i,thu:/^th(u(r(s(day)?)?)?)?/i,fri:/^fr(i(day)?)?/i,sat:/^sa(t(urday)?)?/i,future:/^next/i,past:/^last|past|prev(ious)?/i,add:/^(\+|aft(er)?|from|hence)/i,subtract:/^(\-|bef(ore)?|ago)/i,yesterday:/^yes(terday)?/i,today:/^t(od(ay)?)?/i,tomorrow:/^tom(orrow)?/i,now:/^n(ow)?/i,millisecond:/^ms|milli(second)?s?/i,second:/^sec(ond)?s?/i,minute:/^mn|min(ute)?s?/i,hour:/^h(our)?s?/i,week:/^w(eek)?s?/i,month:/^m(onth)?s?/i,day:/^d(ay)?s?/i,year:/^y(ear)?s?/i,shortMeridian:/^(a|p)/i,longMeridian:/^(a\.?m?\.?|p\.?m?\.?)/i,timezone:/^((e(s|d)t|c(s|d)t|m(s|d)t|p(s|d)t)|((gmt)?\s*(\+|\-)\s*\d\d\d\d?)|gmt|utc)/i,ordinalSuffix:/^\s*(st|nd|rd|th)/i,timeContext:/^\s*(\:|a(?!u|p)|p)/i},timezones:[{name:"UTC",offset:"-000"},{name:"GMT",offset:"-000"},{name:"EST",offset:"-0500"},{name:"EDT",offset:"-0400"},{name:"CST",offset:"-0600"},{name:"CDT",offset:"-0500"},{name:"MST",offset:"-0700"},{name:"MDT",offset:"-0600"},{name:"PST",offset:"-0800"},{name:"PDT",offset:"-0700"}]},function(){var $D=Date,$P=$D.prototype,$C=$D.CultureInfo,p=function(s,l){return l||(l=2),("000"+s).slice(l*-1)},$y,$m,$d,validate;$P.clearTime=function(){return
 this.setHours(0),this.setMinutes(0),this.setSeconds(0),this.setMilliseconds(0),this},$P.setTimeToNow=function(){var n=new Date;return this.setHours(n.getHours()),this.setMinutes(n.getMinutes()),this.setSeconds(n.getSeconds()),this.setMilliseconds(n.getMilliseconds()),this},$D.today=function(){return(new Date).clearTime()},$D.compare=function(date1,date2){if(isNaN(date1)||isNaN(date2))throw new Error(date1+" - "+date2);else{if(date1 instanceof Date&&date2 instanceof Date)return date1<date2?-1:date1>date2?1:0;throw new TypeError(date1+" - "+date2);}},$D.equals=function(date1,date2){return date1.compareTo(date2)===0},$D.getDayNumberFromName=function(name){for(var n=$C.dayNames,m=$C.abbreviatedDayNames,o=$C.shortestDayNames,s=name.toLowerCase(),i=0;i<n.length;i++)if(n[i].toLowerCase()==s||m[i].toLowerCase()==s||o[i].toLowerCase()==s)return i;return-1},$D.getMonthNumberFromName=function(name){for(var n=$C.monthNames,m=$C.abbreviatedMonthNames,s=name.toLowerCase(),i=0;i<n.length;i++)if(n[i].toLowerCase()==s||m[i].toLowerCase()==s)return i;return-1},$D.isLeapYear=function(year){return year%4==0&&year%100!=0||year%400==0},$D.getDaysInMonth=function(year,month){return[31,$D.isLeapYear(year)?29:28,31,30,31,30,31,31,30,31,30,31][month]},$D.getTimezoneAbbreviation=function(offset){for(var z=$C.timezones,p,i=0;i<z.length;i++)if(z[i].offset===offset)return z[i].name;return null},$D.getTimezoneOffset=function(name){for(var z=$C.timezones,p,i=0;i<z.length;i++)if(z[i].name===name.toUpperCase())return z[i].offset;return null},$P.clone=function(){return new Date(this.getTime())},$P.compareTo=function(date){return Date.compare(this,date)},$P.equals=function(date){return Date.equals(this,date||new Date)},$P.between=function(start,end){return this.getTime()>=start.getTime()&&this.getTime()<=end.getTime()},$P.isAfter=function(date){return this.compareTo(date||new Date)===1},$P.isBefore=function(date){return this.compareTo(date||new Date)===-1},$P.isToday=$P.isSameDay=function(date){return this.clone().clearTime().equals((date||new Date).clone().clearTime())},$P.addMilliseconds=function(value){return this.setMilliseconds(this.getMilliseconds()+value*1),this},$P.addSeconds=function(value){return this.addMilliseconds(value*1e3)},$P.addMinutes=function(value){return this.addMilliseconds(value*6e4)},$P.addHours=function(value){return this.addMilliseconds(value*36e5)},$P.addDays=function(value){return this.setDate(this.getDate()+value*1),this},$P.addWeeks=function(value){return this.addDays(value*7)},$P.addMonths=function(value){var n=this.getDate();return this.setDate(1),this.setMonth(this.getMonth()+value*1),this.setDate(Math.min(n,$D.getDaysInMonth(this.getFullYear(),this.getMonth()))),this},$P.addYears=function(value){return this.addMonths(value*12)},$P.add=function(config){if(typeof config=="number")return this._orient=config,this;var x=config;return x.milliseconds&&this.addMilliseconds(x.milliseconds),x.seconds&&this.addSeconds(x.seconds),x.minutes&&this.addMinutes(x.minutes),x.hours&&this.addHours(x.hours),x.weeks&&this.addWeeks(x.weeks),x.months&&this.addMonths(x.months),x.years&&this.addYears(x.years),x.days&&this.addDays(x.days),this},$P.getWeek=function(){var a,b,c,d,e,f,g,n,s,w;return $y=$y?$y:this.getFullYear(),$m=$m?$m:this.getMonth()+1,$d=$d?$d:this.getDate(),$m<=2?(a=$y-1,b=(a/4|0)-(a/100|0)+(a/400|0),c=((a-1)/4|0)-((a-1)/100|0)+((a-1)/400|0),s=b-c,e=0,f=$d-1+31*($m-1)):(a=$y,b=(a/4|0)-(a/100|0)+(a/400|0),c=((a-1)/4|0)-((a-1)/100|0)+((a-1)/400|0),s=b-c,e=s+1,f=$d+(153*($m-3)+2)/5+58+s),g=(a+b)%7,d=(f+g-e)%7,n=f+3-d|0,w=n<0?53-((g-s)/5|0):n>364+s?1:(n/7|0)+1,$y=$m=$d=null,w},$P.getISOWeek=function(){return $y=this.getUTCFullYear(),$m=this.getUTCMonth()+1,$d=this.getUTCDate(),p(this.getWeek())},$P.setWeek=function(n){return this.moveToDayOfWeek(1).addWeeks(n-this.getWeek())},validate=function(n,min,max,name){if(typeof n=="undefined")return!1;if(typeof n!="number")throw new TypeError(n+" is not a Number.");else if(n<min||n>max)throw new RangeError(n+" is not a valid value for "+name+".");return!0},$D.validateMillisecond=function(value){return validate(value,0,999,"millisecond")},$D.validateSecond=function(value){return validate(value,0,59,"second")},$D.validateMinute=function(value){return validate(value,0,59,"minute")},$D.validateHour=function(value){return validate(value,0,23,"hour")},$D.validateDay=function(value,year,month){return validate(value,1,$D.getDaysInMonth(year,month),"day")},$D.validateMonth=function(value){return validate(value,0,11,"month")},$D.validateYear=function(value){return validate(value,0,9999,"year")},$P.set=function(config){return $D.validateMillisecond(config.millisecond)&&this.addMilliseconds(config.millisecond-this.getMilliseconds()),$D.validateSecond(config.second)&&this.addSeconds(config.second-this.getSeconds()),$D.validateMinute(config.minute)&&this.addMinutes(config.minute-this.getMinutes()),$D.validateHour(config.hour)&&this.addHours(config.hour-this.getHours()),$D.validateMonth(config.month)&&this.addMonths(config.month-this.getMonth()),$D.validateYear(config.year)&&this.addYears(config.year-this.getFullYear()),$D.validateDay(config.day,this.getFullYear(),this.getMonth())&&this.addDays(config.day-this.getDate()),config.timezone&&this.setTimezone(config.timezone),config.timezoneOffset&&this.setTimezoneOffset(config.timezoneOffset),config.week&&validate(config.week,0,53,"week")&&this.setWeek(config.week),this},$P.moveToFirstDayOfMonth=function(){return this.set({day:1})},$P.moveToLastDayOfMonth=function(){return this.set({day:$D.getDaysInMonth(this.getFullYear(),this.getMonth())})},$P.moveToNthOccurrence=function(dayOfWeek,occurrence){var shift=0;if(occurrence>0)shift=occurrence-1;else if(occurrence===-1)return this.moveToLastDayOfMonth(),this.getDay()!==dayOfWeek&&this.moveToDayOfWeek(dayOfWeek,-1),this;return this.moveToFirstDayOfMonth().addDays(-1).moveToDayOfWeek(dayOfWeek,1).addWeeks(shift)},$P.moveToDayOfWeek=function(dayOfWeek,orient){var diff=(dayOfWeek-this.getDay()+7*(orient||1))%7;return this.addDays(diff===0?diff+=7*(orient||1):diff)},$P.moveToMonth=function(month,orient){var diff=(month-this.getMonth()+12*(orient||1))%12;return this.addMonths(diff===0?diff+=12*(orient||1):diff)},$P.getOrdinalNumber=function(){return Math.ceil((this.clone().clearTime()-new Date(this.getFullYear(),0,1))/864e5)+1},$P.getTimezone=function(){return $D.getTimezoneAbbreviation(this.getUTCOffset())},$P.setTimezoneOffset=function(offset){var here=this.getTimezoneOffset(),there=Number(offset)*-6/10;return this.addMinutes(there-here)},$P.setTimezone=function(offset){return this.setTimezoneOffset($D.getTimezoneOffset(offset))},$P.hasDaylightSavingTime=function(){return Date.today().set({month:0,day:1}).getTimezoneOffset()!==Date.today().set({month:6,day:1}).getTimezoneOffset()},$P.isDaylightSavingTime=function(){return Date.today().set({month:0,day:1}).getTimezoneOffset()!=this.getTimezoneOffset()},$P.getUTCOffset=function(){var n=this.getTimezoneOffset()*-10/6,r;return n<0?(r=(n-1e4).toString(),r.charAt(0)+r.substr(2)):(r=(n+1e4).toString(),"+"+r.substr(1))},$P.getElapsed=function(date){return(date||new Date)-this},$P.toISOString||($P.toISOString=function(){function f(n){return n<10?"0"+n:n}return'"'+this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+'Z"'}),$P._toString=$P.toString,$P.toString=function(format){var x=this,c,ord;if(format&&format.length==1){c=$C.formatPatterns,x.t=x.toString;switch(format){case"d":return x.t(c.shortDate);case"D":return x.t(c.longDate);case"F":return x.t(c.fullDateTime);case"m":return x.t(c.monthDay);case"r":return x.t(c.rfc1123);case"s":return x.t(c.sortableDateTime);case"t":return x.t(c.shortTime);case"T":return x.t(c.longTime);case"u":return x.t(c.universalSortableDateTime);case"y":return x.t(c.yearMonth)}}return ord=function(n){switch(n*1){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}},format?format.replace(/(\\)?(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|S)/g,function(m){if(m.charAt(0)==="\\")return m.replace("\\","");x.h=x.getHours;switch(m){case"hh":return p(x.h()<13?x.h()===0?12:x.h():x.h()-12);case"h":return x.h()<13?x.h()===0?12:x.h():x.h()-12;case"HH":return p(x.h());case"H":return x.h();case"mm":return p(x.getMinutes());case"m":return x.getMinutes();case"ss":return p(x.getSeconds());case"s":return x.getSeconds();case"yyyy":return p(x.getFullYear(),4);case"yy":return p(x.getFullYear());case"dddd":return $C.dayNames[x.getDay()];case"ddd":return $C.abbreviatedDayNames[x.getDay()];case"dd":return p(x.getDate());case"d":return x.getDate();case"MMMM":return $C.monthNames[x.getMonth()];case"MMM":return $C.abbreviatedMonthNames[x.getMonth()];case"MM":return p(x.getMonth()+1);case"M":return x.getMonth()+1;case"t":return x.h()<12?$C.amDesignator.substring(0,1):$C.pmDesignator.substring(0,1);case"tt":return x.h()<12?$C.amDesignator:$C.pmDesignator;case"S":return ord(x.getDate());default:return m}}):this._toString()}}(),function(){var i,_vector,vx,j;Date.Parsing={Exception:function(s){this.message="Parse error at '"+s.substring(0,10)+" ...'"}};var $P=Date.Parsing,_=$P.Operators={rtoken:function(r){return function(s){var mx=s.match(r);if(mx)return[mx[0],s.substring(mx[0].length)];throw new $P.Exception(s);}},token:function(){return function(s){return _.rtoken(new RegExp("^s*"+s+"s*"))(s)}},stoken:function(s){return _.rtoken(new RegExp("^"+s))},until:function(p){return function(s){for(var qx=[],rx=null;s.length;){try{rx=p.call(this,s)}catch(e){qx.push(rx[0]),s=rx[1];continue}break}return[qx,s]}},many:function(p){return function(s){for(var rx=[],r=null;s.length;){try{r=p.call(this,s)}catch(e){return[rx,s]}rx.push(r[0]),s=r[1]}return[rx,s]}},optional:function(p){return function(s){var r=null;try{r=p.call(this,s)}catch(e){return[null,s]}return[r[0],r[1]]}},not:function(p){return
 function(s){try{p.call(this,s)}catch(e){return[null,s]}throw new $P.Exception(s);}},ignore:function(p){return p?function(s){var r=null;return r=p.call(this,s),[null,r[1]]}:null},product:function(){for(var px=arguments[0],qx=Array.prototype.slice.call(arguments,1),rx=[],i=0;i<px.length;i++)rx.push(_.each(px[i],qx));return rx},cache:function(rule){var cache={},r=null;return function(s){try{r=cache[s]=cache[s]||rule.call(this,s)}catch(e){r=cache[s]=e}if(r instanceof $P.Exception)throw r;else return r}},any:function(){var px=arguments;return function(s){for(var r=null,i=0;i<px.length;i++)if(px[i]!=null){try{r=px[i].call(this,s)}catch(e){r=null}if(r)return r}throw new $P.Exception(s);}},each:function(){var px=arguments;return function(s){for(var rx=[],r=null,i=0;i<px.length;i++)if(px[i]!=null){try{r=px[i].call(this,s)}catch(e){throw new $P.Exception(s);}rx.push(r[0]),s=r[1]}return[rx,s]}},all:function(){var px=arguments,_=_;return _.each(_.optional(px))},sequence:function(px,d,c){return(d=d||_.rtoken(/^\s*/),c=c||null,px.length==1)?px[0]:function(s){for(var r=null,q=null,rx=[],i=0;i<px.length;i++){try{r=px[i].call(this,s)}catch(e){break}rx.push(r[0]);try{q=d.call(this,r[1])}catch(ex){q=null;break}s=q[1]}if(!r)throw new $P.Exception(s);if(q)throw new $P.Exception(q[1]);if(c)try{r=c.call(this,r[1])}catch(ey){throw new $P.Exception(r[1]);}return[rx,r?r[1]:s]}},between:function(d1,p,d2){d2=d2||d1;var _fn=_.each(_.ignore(d1),p,_.ignore(d2));return function(s){var rx=_fn.call(this,s);return[[rx[0][0],r[0][2]],rx[1]]}},list:function(p,d,c){return d=d||_.rtoken(/^\s*/),c=c||null,p instanceof Array?_.each(_.product(p.slice(0,-1),_.ignore(d)),p.slice(-1),_.ignore(c)):_.each(_.many(_.each(p,_.ignore(d))),px,_.ignore(c))},set:function(px,d,c){return d=d||_.rtoken(/^\s*/),c=c||null,function(s){for(var r=null,p=null,q=null,rx=null,best=[[],s],last=!1,qx,j,i=0;i<px.length;i++){q=null,p=null,r=null,last=px.length==1;try{r=px[i].call(this,s)}catch(e){continue}if(rx=[[r[0]],r[1]],r[1].length>0&&!last)try{q=d.call(this,r[1])}catch(ex){last=!0}else last=!0;if(last||q[1].length!==0||(last=!0),!last){for(qx=[],j=0;j<px.length;j++)i!=j&&qx.push(px[j]);p=_.set(qx,d).call(this,q[1]),p[0].length>0&&(rx[0]=rx[0].concat(p[0]),rx[1]=p[1])}if(rx[1].length<best[1].length&&(best=rx),best[1].length===0)break}if(best[0].length===0)return best;if(c){try{q=c.call(this,best[1])}catch(ey){throw new $P.Exception(best[1]);}best[1]=q[1]}return best}},forward:function(gr,fname){return function(s){return gr[fname].call(this,s)}},replace:function(rule,repl){return function(s){var r=rule.call(this,s);return[repl,r[1]]}},process:function(rule,fn){return function(s){var r=rule.call(this,s);return[fn.call(this,r[0]),r[1]]}},min:function(min,rule){return function(s){var rx=rule.call(this,s);if(rx[0].length<min)throw new $P.Exception(s);return rx}}},_generator=function(op){return function(){var args=null,rx=[],i,px;if(arguments.length>1?args=Array.prototype.slice.call(arguments):arguments[0]instanceof Array&&(args=arguments[0]),args)for(i=0,px=args.shift();i<px.length;i++)return args.unshift(px[i]),rx.push(op.apply(null,args)),args.shift(),rx;else return op.apply(null,arguments)}},gx="optional not ignore cache".split(/\s/);for(i=0;i<gx.length;i++)_[gx[i]]=_generator(_[gx[i]]);for(_vector=function(op){return function(){return arguments[0]instanceof Array?op.apply(null,arguments[0]):op.apply(null,arguments)}},vx="each any all".split(/\s/),j=0;j<vx.length;j++)_[vx[j]]=_vector(_[vx[j]])}(),function(){var $D=Date,$P=$D.prototype,$C=$D.CultureInfo,flattenAndCompact=function(ax){for(var rx=[],i=0;i<ax.length;i++)ax[i]instanceof Array?rx=rx.concat(flattenAndCompact(ax[i])):ax[i]&&rx.push(ax[i]);return rx},_C,_F,_get;$D.Grammar={},$D.Translator={hour:function(s){return function(){this.hour=Number(s)}},minute:function(s){return function(){this.minute=Number(s)}},second:function(s){return function(){this.second=Number(s)}},meridian:function(s){return function(){this.meridian=s.slice(0,1).toLowerCase()}},timezone:function(s){return function(){var n=s.replace(/[^\d\+\-]/g,"");n.length?this.timezoneOffset=Number(n):this.timezone=s.toLowerCase()}},day:function(x){var s=x[0];return function(){this.day=Number(s.match(/\d+/)[0])}},month:function(s){return function(){this.month=s.length==3?"jan feb mar apr may jun jul aug sep oct nov dec".indexOf(s)/4:Number(s)-1}},year:function(s){return function(){var n=Number(s);this.year=s.length>2?n:n+(n+2e3<$C.twoDigitYearMax?2e3:1900)}},rday:function(s){return function(){switch(s){case"yesterday":this.days=-1;break;case"tomorrow":this.days=1;break;case"today":this.days=0;break;case"now":this.days=0,this.now=!0}}},finishExact:function(x){var i,now,r;for(x=x instanceof Array?x:[x],i=0;i<x.length;i++)x[i]&&x[i].call(this);if(now=new Date,!this.hour&&!this.minute||this.month||this.year||this.day||(this.day=now.getDate()),this.year||(this.year=now.getFullYear()),this.month||this.month===0||(this.month=now.getMonth()),this.day||(this.day=1),this.hour||(this.hour=0),this.minute||(this.minute=0),this.second||(this.second=0),this.meridian&&this.hour&&(this.meridian=="p"&&this.hour<12?this.hour=this.hour+12:this.meridian=="a"&&this.hour==12&&(this.hour=0)),this.day>$D.getDaysInMonth(this.year,this.month))throw new RangeError(this.day+" is not a valid value for days.");return r=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second),this.timezone?r.set({timezone:this.timezone}):this.timezoneOffset&&r.set({timezoneOffset:this.timezoneOffset}),r},finish:function(x){var i,today,expression,gap,mod,orient,temp;if(x=x instanceof Array?flattenAndCompact(x):[x],x.length===0)return null;for(i=0;i<x.length;i++)typeof x[i]=="function"&&x[i].call(this);if(today=$D.today(),!this.now||this.unit||this.operator)this.now&&(today=new Date);else return new Date;return(expression=!!(this.days&&this.days!==null||this.orient||this.operator),orient=this.orient=="past"||this.operator=="subtract"?-1:1,this.now||"hour minute second".indexOf(this.unit)==-1||today.setTimeToNow(),(this.month||this.month===0)&&"year day hour minute second".indexOf(this.unit)!=-1&&(this.value=this.month+1,this.month=null,expression=!0),expression||!this.weekday||this.day||this.days||(temp=Date[this.weekday](),this.day=temp.getDate(),this.month||(this.month=temp.getMonth()),this.year=temp.getFullYear()),expression&&this.weekday&&this.unit!="month"&&(this.unit="day",gap=$D.getDayNumberFromName(this.weekday)-today.getDay(),mod=7,this.days=gap?(gap+orient*mod)%mod:orient*mod),this.month&&this.unit=="day"&&this.operator&&(this.value=this.month+1,this.month=null),this.value!=null&&this.month!=null&&this.year!=null&&(this.day=this.value*1),this.month&&!this.day&&this.value&&(today.set({day:this.value*1}),expression||(this.day=this.value*1)),this.month||!this.value||this.unit!="month"||this.now||(this.month=this.value,expression=!0),expression&&(this.month||this.month===0)&&this.unit!="year"&&(this.unit="month",gap=this.month-today.getMonth(),mod=12,this.months=gap?(gap+orient*mod)%mod:orient*mod,this.month=null),this.unit||(this.unit="day"),!this.value&&this.operator&&this.operator!==null&&this[this.unit+"s"]&&this[this.unit+"s"]!==null?this[this.unit+"s"]=this[this.unit+"s"]+(this.operator=="add"?1:-1)+(this.value||0)*orient:(this[this.unit+"s"]==null||this.operator!=null)&&(this.value||(this.value=1),this[this.unit+"s"]=this.value*orient),this.meridian&&this.hour&&(this.meridian=="p"&&this.hour<12?this.hour=this.hour+12:this.meridian=="a"&&this.hour==12&&(this.hour=0)),!this.weekday||this.day||this.days||(temp=Date[this.weekday](),this.day=temp.getDate(),temp.getMonth()!==today.getMonth()&&(this.month=temp.getMonth())),(this.month||this.month===0)&&!this.day&&(this.day=1),!this.orient&&!this.operator&&this.unit=="week"&&this.value&&!this.day&&!this.month)?Date.today().setWeek(this.value):(expression&&this.timezone&&this.day&&this.days&&(this.day=this.days),expression?today.add(this):today.set(this))}};var _=$D.Parsing.Operators,g=$D.Grammar,t=$D.Translator,_fn;g.datePartDelimiter=_.rtoken(/^([\s\-\.\,\/\x27]+)/),g.timePartDelimiter=_.stoken(":"),g.whiteSpace=_.rtoken(/^\s*/),g.generalDelimiter=_.rtoken(/^(([\s\,]|at|@|on)+)/),_C={},g.ctoken=function(keys){var fn=_C[keys],i;if(!fn){var c=$C.regexPatterns,kx=keys.split(/\s+/),px=[];for(i=0;i<kx.length;i++)px.push(_.replace(_.rtoken(c[kx[i]]),kx[i]));fn=_C[keys]=_.any.apply(null,px)}return fn},g.ctoken2=function(key){return _.rtoken($C.regexPatterns[key])},g.h=_.cache(_.process(_.rtoken(/^(0[0-9]|1[0-2]|[1-9])/),t.hour)),g.hh=_.cache(_.process(_.rtoken(/^(0[0-9]|1[0-2])/),t.hour)),g.H=_.cache(_.process(_.rtoken(/^([0-1][0-9]|2[0-3]|[0-9])/),t.hour)),g.HH=_.cache(_.process(_.rtoken(/^([0-1][0-9]|2[0-3])/),t.hour)),g.m=_.cache(_.process(_.rtoken(/^([0-5][0-9]|[0-9])/),t.minute)),g.mm=_.cache(_.process(_.rtoken(/^[0-5][0-9]/),t.minute)),g.s=_.cache(_.process(_.rtoken(/^([0-5][0-9]|[0-9])/),t.second)),g.ss=_.cache(_.process(_.rtoken(/^[0-5][0-9]/),t.second)),g.hms=_.cache(_.sequence([g.H,g.m,g.s],g.timePartDelimiter)),g.t=_.cache(_.process(g.ctoken2("shortMeridian"),t.meridian)),g.tt=_.cache(_.process(g.ctoken2("longMeridian"),t.meridian)),g.z=_.cache(_.process(_.rtoken(/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/),t.timezone)),g.zz=_.cache(_.process(_.rtoken(/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/),t.timezone)),g.zzz=_.cache(_.process(g.ctoken2("timezone"),t.timezone)),g.timeSuffix=_.each(_.ignore(g.whiteSpace),_.set([g.tt,g.zzz])),g.time=_.each(_.optional(_.ignore(_.stoken("T"))),g.hms,g.timeSuffix),g.d=_.cache(_.process(_.each(_.rtoken(/^([0-2]\d|3[0-1]|\d)/),_.optional(g.ctoken2("ordinalSuffix"))),t.day)),g.dd=_.cache(_.process(_.each(_.rtoken(/^([0-2]\d|3[0-1])/),_.optional(g.ctoken2("ordinalSuffix"))),t.day)),g.ddd=g.dddd=_.cache(_.process(g.ctoken("sun mon tue wed thu fri sat"),function(s){return function(){this.weekday=s}})),g.M=_.cache(_.process(_.rtoken(/^(1[0-2]|0\d|\d)/),t.month)),g.MM=_.cache(_.process(_.rtoken(/^(1[0-2]|0\
d)/),t.month)),g.MMM=g.MMMM=_.cache(_.process(g.ctoken("jan feb mar apr may jun jul aug sep oct nov dec"),t.month)),g.y=_.cache(_.process(_.rtoken(/^(\d\d?)/),t.year)),g.yy=_.cache(_.process(_.rtoken(/^(\d\d)/),t.year)),g.yyy=_.cache(_.process(_.rtoken(/^(\d\d?\d?\d?)/),t.year)),g.yyyy=_.cache(_.process(_.rtoken(/^(\d\d\d\d)/),t.year)),_fn=function(){return _.each(_.any.apply(null,arguments),_.not(g.ctoken2("timeContext")))},g.day=_fn(g.d,g.dd),g.month=_fn(g.M,g.MMM),g.year=_fn(g.yyyy,g.yy),g.orientation=_.process(g.ctoken("past future"),function(s){return function(){this.orient=s}}),g.operator=_.process(g.ctoken("add subtract"),function(s){return function(){this.operator=s}}),g.rday=_.process(g.ctoken("yesterday tomorrow today now"),t.rday),g.unit=_.process(g.ctoken("second minute hour day week month year"),function(s){return function(){this.unit=s}}),g.value=_.process(_.rtoken(/^\d\d?(st|nd|rd|th)?/),function(s){return function(){this.value=s.replace(/\D/g,"")}}),g.expression=_.set([g.rday,g.operator,g.value,g.unit,g.orientation,g.ddd,g.MMM]),_fn=function(){return _.set(arguments,g.datePartDelimiter)},g.mdy=_fn(g.ddd,g.month,g.day,g.year),g.ymd=_fn(g.ddd,g.year,g.month,g.day),g.dmy=_fn(g.ddd,g.day,g.month,g.year),g.date=function(s){return(g[$C.dateElementOrder]||g.mdy).call(this,s)},g.format=_.process(_.many(_.any(_.process(_.rtoken(/^(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|zz?z?)/),function(fmt){if(g[fmt])return g[fmt];throw $D.Parsing.Exception(fmt);}),_.process(_.rtoken(/^[^dMyhHmstz]+/),function(s){return _.ignore(_.stoken(s))}))),function(rules){return _.process(_.each.apply(null,rules),t.finishExact)}),_F={},_get=function(f){return _F[f]=_F[f]||g.format(f)[0]},g.formats=function(fx){var rx,i;if(fx instanceof Array){for(rx=[],i=0;i<fx.length;i++)rx.push(_get(fx[i]));return _.any.apply(null,rx)}return _get(fx)},g._formats=g.formats(['"yyyy-MM-ddTHH:mm:ssZ"',"yyyy-MM-ddTHH:mm:ssZ","yyyy-MM-ddTHH:mm:ssz","yyyy-MM-ddTHH:mm:ss","yyyy-MM-ddTHH:mmZ","yyyy-MM-ddTHH:mmz","yyyy-MM-ddTHH:mm","ddd, MMM dd, yyyy H:mm:ss tt","ddd MMM d yyyy HH:mm:ss zzz","MMddyyyy","ddMMyyyy","Mddyyyy","ddMyyyy","Mdyyyy","dMyyyy","yyyy","Mdyy","dMyy","d"]),g._start=_.process(_.set([g.date,g.time,g.expression],g.generalDelimiter,g.whiteSpace),t.finish),g.start=function(s){try{var r=g._formats.call({},s);if(r[1].length===0)return r}catch(e){}return g._start.call({},s)},$D._parse=$D.parse,$D.parse=function(s){var r=null;if(!s)return null;if(s instanceof Date)return s;try{r=$D.Grammar.start.call({},s.replace(/^\s*(\S*(\s+\S+)*)\s*$/,"$1"))}catch(e){return null}try{return r[1].length===0?r[0]:Date._parse(s)}catch(er1){return tryParseDate(s)}},$D.getParseFunction=function(fx){var fn=$D.Grammar.formats(fx);return function(s){var r=null;try{r=fn.call({},s)}catch(e){return null}return r[1].length===0?r[0]:null}},$D.parseExact=function(s,fx){return $D.getParseFunction(fx)(s)}}(),function(){var $D=Date,$P=$D.prototype,$C=$D.CultureInfo,$N=Number.prototype,df,sdf,i,mf,smf,j,ef,nf,k,nthfn,l;$P._orient=1,$P._nth=null,$P._is=!1,$P._same=!1,$P._isSecond=!1,$N._dateElement="day",$P.next=function(){return this._orient=1,this},$D.next=function(){return $D.today().next()},$P.last=$P.prev=$P.previous=function(){return this._orient=-1,this},$D.last=$D.prev=$D.previous=function(){return $D.today().last()},$P.is=function(){return this._is=!0,this},$P.same=function(){return this._same=!0,this._isSecond=!1,this},$P.today=function(){return this.same().day()},$P.weekday=function(){return this._is?(this._is=!1,!this.is().sat()&&!this.is().sun()):!1},$P.at=function(time){return typeof time=="string"?$D.parse(this.toString("d")+" "+time):this.set(time)},$N.fromNow=$N.after=function(date){var c={};return c[this._dateElement]=this,(date?date.clone():new Date).add(c)},$N.ago=$N.before=function(date){var c={};return c[this._dateElement]=this*-1,(date?date.clone():new Date).add(c)};var dx="sunday monday tuesday wednesday thursday friday saturday".split(/\s/),mx="january february march april may june july august september october november december".split(/\s/),px="Millisecond Second Minute Hour Day Week Month Year".split(/\s/),pxf="Milliseconds Seconds Minutes Hours Date Week Month FullYear".split(/\s/),nth="final first second third fourth fifth".split(/\s/),de;for($P.toObject=function(){for(var o={},i=0;i<px.length;i++)o[px[i].toLowerCase()]=this["get"+pxf[i]]();return o},$D.fromObject=function(config){return config.week=null,Date.today().set(config)},df=function(n){return function(){var ntemp,temp;if(this._is)return this._is=!1,this.getDay()==n;if(this._nth!==null){if(this._isSecond&&this.addSeconds(this._orient*-1),this._isSecond=!1,ntemp=this._nth,this._nth=null,temp=this.clone().moveToLastDayOfMonth(),this.moveToNthOccurrence(n,ntemp),this>temp)throw new RangeError($D.getDayName(n)+" does not occur "+ntemp+" times in the month of "+$D.getMonthName(temp.getMonth())+" "+temp.getFullYear()+".");return this}return this.moveToDayOfWeek(n,this._orient)}},sdf=function(n){return function(){var t=$D.today(),shift=n-t.getDay();return n===0&&$C.firstDayOfWeek===1&&t.getDay()!==0&&(shift=shift+7),t.addDays(shift)}},i=0;i<dx.length;i++)$D[dx[i].toUpperCase()]=$D[dx[i].toUpperCase().substring(0,3)]=i,$D[dx[i]]=$D[dx[i].substring(0,3)]=sdf(i),$P[dx[i]]=$P[dx[i].substring(0,3)]=df(i);for(mf=function(n){return function(){return this._is?(this._is=!1,this.getMonth()===n):this.moveToMonth(n,this._orient)}},smf=function(n){return function(){return $D.today().set({month:n,day:1})}},j=0;j<mx.length;j++)$D[mx[j].toUpperCase()]=$D[mx[j].toUpperCase().substring(0,3)]=j,$D[mx[j]]=$D[mx[j].substring(0,3)]=smf(j),$P[mx[j]]=$P[mx[j].substring(0,3)]=mf(j);for(ef=function(j){return function(){var m;if(this._isSecond)return this._isSecond=!1,this;if(this._same){this._same=this._is=!1;var o1=this.toObject(),o2=(arguments[0]||new Date).toObject(),v="",k=j.toLowerCase();for(m=px.length-1;m>-1;m--){if(v=px[m].toLowerCase(),o1[v]!=o2[v])return!1;if(k==v)break}return!0}return j.substring(j.length-1)!="s"&&(j+="s"),this["add"+j](this._orient)}},nf=function(n){return function(){return this._dateElement=n,this}},k=0;k<px.length;k++)de=px[k].toLowerCase(),$P[de]=$P[de+"s"]=ef(px[k]),$N[de]=$N[de+"s"]=nf(de);for($P._ss=ef("Second"),nthfn=function(n){return function(dayOfWeek){return this._same?this._ss(arguments[0]):dayOfWeek||dayOfWeek===0?this.moveToNthOccurrence(dayOfWeek,n):(this._nth=n,n===2&&(dayOfWeek===undefined||dayOfWeek===null))?(this._isSecond=!0,this.addSeconds(this._orient)):this}},l=0;l<nth.length;l++)$P[nth[l]]=l===0?nthfn(-1):nthfn(l)}(),TimeSpan=function(days,hours,minutes,seconds,milliseconds){for(var attrs="days hours minutes seconds milliseconds".split(/\s+/),gFn=function(attr){return function(){return this[attr]}},sFn=function(attr){return function(val){return this[attr]=val,this}},$a,$b,orient,i=0;i<attrs.length;i++)$a=attrs[i],$b=$a.slice(0,1).toUpperCase()+$a.slice(1),TimeSpan.prototype[$a]=0,TimeSpan.prototype["get"+$b]=gFn($a),TimeSpan.prototype["set"+$b]=sFn($a);return arguments.length==4?(this.setDays(days),this.setHours(hours),this.setMinutes(minutes),this.setSeconds(seconds)):arguments.length==5?(this.setDays(days),this.setHours(hours),this.setMinutes(minutes),this.setSeconds(seconds),this.setMilliseconds(milliseconds)):arguments.length==1&&typeof days=="number"&&(orient=days<0?-1:1,this.setMilliseconds(Math.abs(days)),this.setDays(Math.floor(this.getMilliseconds()/864e5)*orient),this.setMilliseconds(this.getMilliseconds()%864e5),this.setHours(Math.floor(this.getMilliseconds()/36e5)*orient),this.setMilliseconds(this.getMilliseconds()%36e5),this.setMinutes(Math.floor(this.getMilliseconds()/6e4)*orient),this.setMilliseconds(this.getMilliseconds()%6e4),this.setSeconds(Math.floor(this.getMilliseconds()/1e3)*orient),this.setMilliseconds(this.getMilliseconds()%1e3),this.setMilliseconds(this.getMilliseconds()*orient)),this.getTotalMilliseconds=function(){return this.getDays()*864e5+this.getHours()*36e5+this.getMinutes()*6e4+this.getSeconds()*1e3},this.compareTo=function(time){var t1=new Date(1970,1,1,this.getHours(),this.getMinutes(),this.getSeconds()),t2;return t2=time===null?new Date(1970,1,1,0,0,0):new Date(1970,1,1,time.getHours(),time.getMinutes(),time.getSeconds()),t1<t2?-1:t1>t2?1:0},this.equals=function(time){return this.compareTo(time)===0},this.add=function(time){return time===null?this:this.addSeconds(time.getTotalMilliseconds()/1e3)},this.subtract=function(time){return time===null?this:this.addSeconds(-time.getTotalMilliseconds()/1e3)},this.addDays=function(n){return new TimeSpan(this.getTotalMilliseconds()+n*864e5)},this.addHours=function(n){return new TimeSpan(this.getTotalMilliseconds()+n*36e5)},this.addMinutes=function(n){return new TimeSpan(this.getTotalMilliseconds()+n*6e4)},this.addSeconds=function(n){return new TimeSpan(this.getTotalMilliseconds()+n*1e3)},this.addMilliseconds=function(n){return new TimeSpan(this.getTotalMilliseconds()+n)},this.get12HourHour=function(){return this.getHours()>12?this.getHours()-12:this.getHours()===0?12:this.getHours()},this.getDesignator=function(){return this.getHours()<12?Date.CultureInfo.amDesignator:Date.CultureInfo.pmDesignator},this.toString=function(format){this._toString=function(){return this.getDays()!==null&&this.getDays()>0?this.getDays()+"."+this.getHours()+":"+this.p(this.getMinutes())+":"+this.p(this.getSeconds()):this.getHours()+":"+this.p(this.getMinutes())+":"+this.p(this.getSeconds())},this.p=function(s){return s.toString().length<2?"0"+s:s};var me=this;return format?format.replace(/dd?|HH?|hh?|mm?|ss?|tt?/g,function(format){switch(format){case"d":return me.getDays();case"dd":return me.p(me.getDays());case"H":return me.getHours();case"HH":return me.p(me.getHours());case"h":return me.get12HourHour();case"hh":return me.p(me.get12HourHour());case"m":return me.getMinutes();case"mm":return me.p(me.getMinutes());case"s":return
 me.getSeconds();case"ss":return me.p(me.getSeconds());case"t":return(me.getHours()<12?Date.CultureInfo.amDesignator:Date.CultureInfo.pmDesignator).substring(0,1);case"tt":return me.getHours()<12?Date.CultureInfo.amDesignator:Date.CultureInfo.pmDesignator}}):this._toString()},this},Date.prototype.getTimeOfDay=function(){return new TimeSpan(0,this.getHours(),this.getMinutes(),this.getSeconds(),this.getMilliseconds())},TimePeriod=function(years,months,days,hours,minutes,seconds,milliseconds){for(var attrs="years months days hours minutes seconds milliseconds".split(/\s+/),gFn=function(attr){return function(){return this[attr]}},sFn=function(attr){return function(val){return this[attr]=val,this}},$a,$b,diff,ts,i=0;i<attrs.length;i++)$a=attrs[i],$b=$a.slice(0,1).toUpperCase()+$a.slice(1),TimePeriod.prototype[$a]=0,TimePeriod.prototype["get"+$b]=gFn($a),TimePeriod.prototype["set"+$b]=sFn($a);if(arguments.length==7)this.years=years,this.months=months,this.setDays(days),this.setHours(hours),this.setMinutes(minutes),this.setSeconds(seconds),this.setMilliseconds(milliseconds);else if(arguments.length==2&&arguments[0]instanceof Date&&arguments[1]instanceof Date){var d1=years.clone(),d2=months.clone(),temp=d1.clone(),orient=d1>d2?-1:1;if(this.years=d2.getFullYear()-d1.getFullYear(),temp.addYears(this.years),orient==1?temp>d2&&this.years!==0&&this.years--:temp<d2&&this.years!==0&&this.years++,d1.addYears(this.years),orient==1)while(d1<d2&&d1.clone().addDays(Date.getDaysInMonth(d1.getYear(),d1.getMonth()))<d2)d1.addMonths(1),this.months++;else while(d1>d2&&d1.clone().addDays(-d1.getDaysInMonth())>d2)d1.addMonths(-1),this.months--;diff=d2-d1,diff!==0&&(ts=new TimeSpan(diff),this.setDays(ts.getDays()),this.setHours(ts.getHours()),this.setMinutes(ts.getMinutes()),this.setSeconds(ts.getSeconds()),this.setMilliseconds(ts.getMilliseconds()))}return this};
Agility.RegisterNamespace("Agility.UGC.API"),function(API){function checkApiIntialized(callback){return API.APIUrl==null||API.APIUrl==""||API.APIAccessKey==undefined?(callback({ResponseType:API.ResponseType.Error,Message:"The Agility UGC API has not been initialized.",ResponseData:null}),!1):!0}function _enforceRegex(fieldType,fieldValue){if(fieldValue==undefined||fieldValue==null||fieldValue==""||typeof fieldValue!="string")return null;if(fieldType.ValidationRegEx!=null&&fieldType.ValidationRegEx!=""&&fieldType.ValidationRegEx!="Add comma separated file extensions. Eg: .pdf, .gif")try{var rEx=new RegExp(fieldType.ValidationRegEx);if(rEx.ignoreCase=!0,fieldValue.search(rEx)==-1)return fieldType.ValidationMessage!=null&&fieldType.ValidationMessage!=""&&fieldType.ValidationMessage!="Add the file type validation message."?{FieldType:fieldType,Message:fieldType.ValidationMessage}:{FieldType:fieldType,Message:"The value from field "+fieldType.Label+" did not match the validation expression requirements."}}catch(Error){}}function validateFileType(filepath,validExp){var ary,selectedExt,i,ext;if(validExp==null||validExp=="")return!0;for(validExp=validExp.replace(".*([\\",""),validExp=validExp.replace("])","");validExp.indexOf("]|[\\")!=-1;)validExp=validExp.replace("]|[\\",";");fileTypes=validExp.replace(/\./g,"*."),ary=fileTypes.split(";"),selectedExt=filepath.substring(filepath.lastIndexOf(".")).toLowerCase(),selectedExt.indexOf(".")!=-1&&(selectedExt=selectedExt.substring(selectedExt.lastIndexOf(".")).toLowerCase());for(i in ary)if((ext=$.trim(ary[i]),ext!=""&&!(ext.length<2)&&ext.indexOf("*")==0)&&(ext=ext.substring(1).toLowerCase(),ext==selectedExt))return!0;return!1}function _buildAPIUrl(methodName,args,query){var url=API.APIUrl;return url==""||url==null?null:(url.lastIndexOf("/")!=url.length-1&&(url+="/"),url+=methodName+"/"+API.APIAccessKey+"/"+API.APISeconds+"/"+API.APIRandomNumber+"/"+API.APIHash+"/"+API.APIProfileRecordID,args!=undefined&&$.isArray(args)&&args.length>0&&jQuery.each(args,function(index,arg){url+="/"+escape(arg)}),url+="?method=?",query!=undefined&&query!=""&&(url+="&"+query),url)}function _submitPostData(url,postData,callback){var uniqueID=Agility.UniqueID("postDataForm"),uniqueFormID=uniqueID+"_form",uniqueIFrameID=uniqueID+"_iframe",returnUrl=location.href,blankUrl,formHtml,thisBody;if(returnUrl=returnUrl.substring(0,returnUrl.indexOf("/",returnUrl.indexOf("//")+2)),returnUrl+=Agility.ResolveUrl("~/AgilityRedirector.htm"),blankUrl=Agility.ResolveUrl("~/AgilityRedirector.htm"),url=url.replace("?method=?","?method=post"),formHtml='<div id="'+uniqueID+"\" style='display:none'><form id=\""+uniqueFormID+'" method="post" action="'+url+'" target="'+uniqueIFrameID+'">',typeof postData=="string")formHtml+='<input type="text" name="postdata" />';else for(prop in postData)formHtml+='<input type="text" name="'+prop+'" />';formHtml+='<input type="text" name="url" />',formHtml+="</form>",formHtml+='<iframe id="'+uniqueIFrameID+'" name="'+uniqueIFrameID+'" src="'+blankUrl+'"></iframe>',formHtml+="</div>",thisBody=jQuery(document.body),jQuery(thisBody).append(formHtml);var div=jQuery("#"+uniqueID),form=jQuery("#"+uniqueFormID),iframe=jQuery("#"+uniqueIFrameID);if(typeof postData=="string")$("input[name=postdata]",form).val(postData);else for(prop in postData)$("input[name="+prop+"]",form).val(postData[prop]);$("input[name=url]",form).val(returnUrl),jQuery(iframe).load(function(){var frm=window.frames[uniqueIFrameID],responseType=responseType=API.ResponseType.Error,loc=frm.location,href,data;loc!=null&&(href=loc.href,responseType=parseInt(Agility.QueryString("ResponseType",href)),isNaN(responseType)&&(responseType=API.ResponseType.Error)),data={ResponseType:responseType,Message:Agility.QueryString("Message",href),ResponseData:Agility.QueryString("ResponseData",href)},setTimeout(function(){callback(data)},0),setTimeout(function(){div.empty()},0)}),form.submit()}function _getOdataUrl(){var url=API.APIUrl;return url=url.substring(0,url.toLowerCase().lastIndexOf("/"))+"/Agility-UGC-API-ODATA.svc"}function _processOdataError(data,callback){if(data!=undefined&&data!=null&&data.error!=undefined&&data.error!=null){var message="An error occurred.";return data.error.message!=undefined&&data.error.message.value!=undefined&&(message=data.error.message.value),callback({ResponseType:API.ResponseType.Error,Message:message,ResponseData:null}),!0}}var _settingsCache,_fileSizeCache,_authCookieName;API.DataType={String:0,TextBlob:1,Int:2,Double:3,DateTime:4,File:5,GUID:6,Encrypted:7,Hashed:8,Boolean:9,Dropdown:10,HTML:11,Email:12},API.RecordState={New:0,Published:1,Deleted:2,Processing:3,Declined:4,Error:5,Escalated:6,AwaitingReview:7,Draft:8,All:-1},API.Permission={Read:0,Create:1,Edit:2,Delete:3,Moderate:4,Administer:5},API.FileStorage={RelativeURL:0,BaseURL:1,EdgeURL:2},API.SortDirection={ASC:"ASC",DESC:"DESC"},API.ResponseType={OK:0,Error:1},API.FileService={AmazonS3:0,YouTube:1,Flickr:2,Image:3,Video:4,Ooyala:5,Brightcove:6},API.FileServiceState={New:0,Unprocessed:1,Processed:2,Error:3},API.RecordFlag={Spam:"Spam",Flagged:"Flagged",Illegal:"Illegal",Abuse:"Abuse"},API.AggregateTypes={Count:0,Sum:1,Average:2},API.FeedbackContentType={WCM:0,UGC:1,Custom:2},API.FeedbackSubmissionType={Like:0,Rating:1,Vote:2,ApproveDisapprove:3,Custom:4},API.SubmissionInterval={None:-1,Day:0,Hour:1,Week:2,Month:3,Minute:4,SingleSubmissionOnly:5},API.FileServiceMetaDataTypeName="JSONPFileServiceMetaData:#Agility.UGC.API.ServiceObjects",API.YouTubeMetaField={OriginalFilePath:"OriginalFilePath",VideoID:"VideoID",Description:"Description",Category:"Category",Title:"Title",Keywords:"Keywords",Private:"Private",YouTubeState:"YouTubeState",Duration:"Duration"},API.FlickrMetaField={OriginalFilePath:"OriginalFilePath",title:"title",description:"description",tags:"tags",is_public:"is_public",is_friend:"is_friend",is_family:"is_family",safety_level:"safety_level",hidden:"hidden",photo_id:"photo_id"},API.OoyalaMetaField={embedCode:"embedCode",title:"title",description:"description",status:"status"},API.SearchArg=function(){PageSize=20,RecordOffset=0,IncludeSpam=!1,IncludeFlagged=!1,IncludeIllegal=!1,State=API.RecordState.Published,SortedField="",SortDirection="",RecordTypeName=null,Search="",CacheKey=null,Columns=[],FileStorage=API.FileStorage.RelativeURL,IncludeStatistics=!1},API.CommentSearchArg=function(){RelatedContentID:-1;PageSize:20;RecordOffset:0;SortedField:"CreatedOn";SortDirection:"DESC";RecordTypeName:"";CacheKey=null,OtherStates=[],State=API.RecordState.Published,FileStorage=API.FileStorage.RelativeURL,Columns=[],IgnoreAbuse=!0,IncludeFlagged=!1,IncludeIllegal=!1},API.FeedbackSearchArg=function(){ReferenceName=null,ContentType=-1,SubmissionType=-1,RelatedContentIDs=[],StartDate=null,EndDate=null,IsPositive=null,Action=null},API.BooleanFeedback=function(){BooleanFeedbackID=-1,FeedbackTypeID=-1,RelatedContentID=-1,ProfileRecordID=-1,ExternalProfileID=null,CreatedOn=null,IsPositive=null,ReferenceName=null,ContentType=-1,SubmissionType=-1,RequiresAuthentication=!1,SubmissionIntervalUnit=API.SubmissionInterval.None,SubmissionIntervalValue=1},API.RatingFeedback=function(){RatingFeedbackID=-1,FeedbackTypeID=-1,RelatedContentID=-1,ProfileRecordID=-1,ExternalProfileID=null,CreatedOn=null,IsPositive=null,RatingValue=0,ReferenceName=null,ContentType=-1,SubmissionType=-1,RequiresAuthentication=!1,SubmissionIntervalUnit=API.SubmissionInterval.None,SubmissionIntervalValue=1},API.Record=function(){var ID=-1,RecordTypeName,CreatedOn,ModifiedOn},API.Initialized=!1,API.APIUrl="",API.OnInit=function(API_Url,API_AccessKey,API_Seconds,API_RandomNumber,API_ProfileRecordID,API_Hash){API_Url!=undefined&&API_Url!=null&&(API.APIUrl=API_Url),API.APIAccessKey=API_AccessKey,API.APISeconds=API_Seconds,API.APIRandomNumber=API_RandomNumber,API.APIProfileRecordID=API_ProfileRecordID,API.APIHash=API_Hash,API.Initialized=!0},API.GetAllRecordTypes=function(callback){if(checkApiIntialized(callback)){var url=_buildAPIUrl("GetAllRecordTypes",null);jQuery.getJSON(url,callback)}},API.GetRecordType=function(recordTypeID,callback){if(checkApiIntialized(callback)){var url=_buildAPIUrl("GetRecordType",[recordTypeID]);jQuery.getJSON(url,callback)}},API.GetRecordTypeByName=function(recordTypeName,callback){if(checkApiIntialized(callback)){var url=_buildAPIUrl("GetRecordTypeByName",[recordTypeName]);jQuery.getJSON(url,callback)}},API.SaveRecordType=function(recordType,callback){if(checkApiIntialized(callback)){var postData=Agility.JSON.encode(recordType),url=_buildAPIUrl("SaveRecordType",null);_submitPostData(url,postData,callback)}},API.DeleteRecordType=function(recordTypeID,callback){if(checkApiIntialized(callback)){var url=_buildAPIUrl("DeleteRecordType",[recordTypeID]);jQuery.getJSON(url,callback)}},API.GetRecord=function(recordID,fileStorage,callback){if($.isFunction(fileStorage)&&(callback=fileStorage,fileStorage=null),checkApiIntialized(callback)){var url=null;url=fileStorage==null?_buildAPIUrl("GetRecord",[recordID]):_buildAPIUrl("GetRecord",[recordID],"fileStorage="+escape(fileStorage)),jQuery.getJSON(url,callback)}},API.GetRecordHistory=function(recordID,callback){if(checkApiIntialized(callback)){var url=_buildAPIUrl("GetRecordHistory",[recordID]);jQuery.getJSON(url,callback)}},API.DeleteRecord=function(recordID,callback){if(checkApiIntialized(callback)){var url=_buildAPIUrl("DeleteRecord",[recordID]);jQuery.getJSON(url,callback)}},API.SetRecordFlag=function(recordID,flag,reason,callback){var query,url;checkApiIntialized(callback)&&(query=null,reason!=null&&reason!=""&&(query="reason="+escape(reason)),url=_buildAPIUrl("SetRecordFlag",[recordID,flag],query),jQuery.getJSON(url,callback))},API.InsertRecordHistory=function(recordID,comment,callback){if(checkApiIntialized(callback)){var postData=comment,url=_buildAPIUrl("InsertRecordHistory",[recordID]);_submitPostData(url,postData,callback)}},API.SetRecordState=function(recordID,recordState,reason,comment,callback){if($.isFuncti
on(comment)&&(callback=comment,comment=""),checkApiIntialized(callback)){(reason==undefined||reason==null)&&(reason=""),(comment==undefined||comment==null)&&(comment="");var postData={reason:reason,comment:comment},url=_buildAPIUrl("SetRecordStateEx",[recordID,recordState]);_submitPostData(url,postData,callback)}},API.SetRecordFileState=function(recordID,fieldName,fileServiceState,callback){if(checkApiIntialized(callback)){var url=_buildAPIUrl("SetRecordFileState",[recordID,fieldName,fileServiceState]);jQuery.getJSON(url,callback)}},API.UpdateRecordTypeAlert=function(recordTypeID,recordState,moderatorID,otherNotificationType,callback){var query,url;checkApiIntialized(callback)&&(callback==undefined&&jQuery.isFunction(otherNotificationType)&&(callback=otherNotificationType,otherNotificationType=null),query=null,otherNotificationType!=null&&otherNotificationType!=""&&(query="otherNotificationType="+escape(otherNotificationType)),url=_buildAPIUrl("UpdateRecordTypeAlert",[recordTypeID,recordState,moderatorID],query),jQuery.getJSON(url,callback))},API.DeleteRecordTypeAlert=function(recordTypeID,recordState,moderatorID,otherNotificationType,callback){var query,url;checkApiIntialized(callback)&&(callback==undefined&&jQuery.isFunction(otherNotificationType)&&(callback=otherNotificationType,otherNotificationType=null),query=null,otherNotificationType!=null&&otherNotificationType!=""&&(query="otherNotificationType="+escape(otherNotificationType)),url=_buildAPIUrl("DeleteRecordTypeAlert",[recordTypeID,recordState,moderatorID],query),jQuery.getJSON(url,callback))},API.GetRecordTypeAlerts=function(recordTypeID,callback){if(checkApiIntialized(callback)){var url=_buildAPIUrl("GetRecordTypeAlerts",[recordTypeID]);jQuery.getJSON(url,callback)}},API.ClearCache=function(cacheKey,callback){if(checkApiIntialized(callback)){var url=_buildAPIUrl("ClearCache",[cacheKey]);jQuery.getJSON(url,callback)}},API.SaveRecord=function(record,callback,cacheKey){if(checkApiIntialized(callback)){if(record==null&&callback(API.ResponseType.Error,"The record object cannot be null."),record.RecordTypeName==undefined||record.RecordTypeName==null||record.RecordTypeName==""){callback({ResponseType:API.ResponseType.Error,Message:"The RecordTypeName property cannot be null."});return}API.GetRecordTypeByName(record.RecordTypeName,function(response){var recordType,lstFieldErrors,i,fieldType,fieldValue,fieldLabel,dt,o1,o2,msg,x,postData,url;if(response.ResponseType==API.ResponseType.Error){callback(response);return}if(recordType=response.ResponseData,recordType==undefined||recordType==null){callback({ResponseType:API.ResponseType.Error,Message:"The Record Type "+record.RecordTypeName+" could not be found."});return}for(lstFieldErrors=[],i=0;i<recordType.FieldTypes.length;i++)if(fieldType=recordType.FieldTypes[i],fieldValue=record[fieldType.Name],fieldValue!=undefined&&fieldValue!=null&&fieldValue.OriginalFilePath!=undefined&&(fieldValue=fieldValue.OriginalFilePath),fieldLabel=recordType.FieldTypes[i].Label,fieldType.AllowNull==!1&&(fieldValue==undefined||fieldValue==null||new String(fieldValue).length==0)&&(lstFieldErrors[lstFieldErrors.length]={FieldType:fieldType,Message:"The "+fieldType.Label+" field is required."}),fieldValue!=undefined&&fieldValue!=null&&fieldValue!="")switch(fieldType.DataType){case API.DataType.Boolean:new String(fieldValue).toLowerCase()!="true"&&new String(fieldValue).toLowerCase()!="false"&&(lstFieldErrors[lstFieldErrors.length]={FieldType:fieldType,Message:"Could not convert value "+fieldValue+" from field "+fieldType.Label+" to a boolean."});break;case API.DataType.DateTime:dt=new Date(fieldValue),dt==null&&(lstFieldErrors[lstFieldErrors.length]={FieldType:fieldType,Message:"Could not convert value "+fieldValue+" from field "+fieldType.Label+" to a date/time."});break;case API.DataType.Double:isNaN(parseFloat(fieldValue))&&(lstFieldErrors[lstFieldErrors.length]={FieldType:fieldType,Message:"Could not convert value "+fieldValue+" from field "+fieldType.Label+" to a number."});break;case API.DataType.Int:isNaN(parseInt(fieldValue))&&(lstFieldErrors[lstFieldErrors.length]={FieldType:fieldType,Message:"Could not convert value "+fieldValue+" from field "+fieldType.Label+" to a number."});break;case API.DataType.String:fieldType.MaxLength==0&&fieldValue.Length>400?lstFieldErrors[lstFieldErrors.length]={FieldType:fieldType,Message:"The value from field "+fieldType.Label+" must be 400 characters or less."}:fieldType.MaxLength>0&&fieldValue.Length>fieldType.MaxLength&&(lstFieldErrors[lstFieldErrors.length]={FieldType:fieldType,Message:"The value from field "+fieldType.Label+" must be "+fieldType.MaxLength+" characters or less."}),o1=_enforceRegex(fieldType,fieldValue,fieldLabel),o1!=null&&(lstFieldErrors[lstFieldErrors.length]=o1);break;default:fieldType.MaxLength>0&&fieldValue.Length>fieldType.MaxLength&&(lstFieldErrors[lstFieldErrors.length]={FieldType:fieldType,Message:"The value from field "+fieldType.Label+" must be "+fieldType.MaxLength+" characters or less."}),o2=_enforceRegex(fieldType,fieldValue,fieldLabel),o2!=null&&(lstFieldErrors[lstFieldErrors.length]=o2)}if(lstFieldErrors.length>0){for(msg="",x=0;x<lstFieldErrors.length;x++)msg+=" - "+lstFieldErrors[x].Message+"\n";callback({ResponseType:API.ResponseType.Error,Message:msg,ValidationErrors:lstFieldErrors});return}postData=Agility.JSON.encode(record),(cacheKey==undefined||cacheKey==null)&&(cacheKey=""),url=_buildAPIUrl("SaveRecord",[],"cacheKey="+escape(cacheKey)),_submitPostData(url,postData,callback)})}},API.SearchRecords=function(searchArg,callback){if(checkApiIntialized(callback)){var argStr=Agility.JSON.encode(searchArg),url=_buildAPIUrl("SearchRecords");url+="&s="+escape(argStr),jQuery.getJSON(url,callback)}},API.SearchComments=function(commentSearchArg,callback){if(checkApiIntialized(callback)){var argStr=Agility.JSON.encode(commentSearchArg),url=_buildAPIUrl("SearchComments");url+="&s="+escape(argStr),jQuery.getJSON(url,callback)}},API.SearchCommentParentIDs=function(commentSearchArg,callback){if(checkApiIntialized(callback)){var argStr=Agility.JSON.encode(commentSearchArg),url=_buildAPIUrl("SearchCommentParentIDs");url+="&s="+escape(argStr),jQuery.getJSON(url,callback)}},API.GetFeedbackAggregate=function(searchArg,callback){if(checkApiIntialized(callback)){var argStr=Agility.JSON.encode(searchArg),url=_buildAPIUrl("GetFeedbackAggregate");url+="&s="+escape(argStr),jQuery.getJSON(url,callback)}},API.SaveRating=function(ratingFeedback,callback){var rating=ratingFeedback;rating.SubmissionType=API.FeedbackSubmissionType.Rating,API.SaveRatingFeedback(rating,callback)},API.SaveLike=function(booleanFeedback,callback){var like=booleanFeedback;like.SubmissionType=API.FeedbackSubmissionType.Like,like.IsPositive=!0,API.SaveBooleanFeedback(like,callback)},API.SaveVote=function(booleanFeedback,callback){var vote=booleanFeedback;vote.IsPositive=!0,vote.SubmissionType=API.FeedbackSubmissionType.Vote,API.SaveBooleanFeedback(vote,callback)},API.SaveApproveDisapprove=function(booleanFeedback,IsApproved,callback){var ap=booleanFeedback;ap.IsPositive=IsApproved,ap.SubmissionType=API.FeedbackSubmissionType.ApproveDisapprove,API.SaveBooleanFeedback(ap,callback)},API.SaveRatingFeedback=function(ratingFeedback,callback){if(checkApiIntialized(callback)){API.APIProfileRecordID>0&&(ratingFeedback.ProfileRecordID=API.APIProfileRecordID);var postData=Agility.JSON.encode(ratingFeedback),url=_buildAPIUrl("SaveRatingFeedback",null);_submitPostData(url,postData,callback)}},API.SaveBooleanFeedback=function(booleanFeedback,callback){if(checkApiIntialized(callback)){API.APIProfileRecordID>0&&(booleanFeedback.ProfileRecordID=API.APIProfileRecordID);var postData=Agility.JSON.encode(booleanFeedback),url=_buildAPIUrl("SaveBooleanFeedback",null);_submitPostData(url,postData,callback)}},_settingsCache=null,API.GetSettings=function(callback,ignoreCache){if(checkApiIntialized(callback))if(_settingsCache==null||ignoreCache==!1){var url=_buildAPIUrl("GetSettings",null);jQuery.getJSON(url,function(data){data.ResponseType!=API.ResponseType.OK?callback(data):(_settingsCache=data.ResponseData,callback(data))})}else callback({ResponseType:API.ResponseType.OK,ResponseData:_settingsCache})},API.SaveSettings=function(settings,callback){if(checkApiIntialized(callback)){_settingsCache=null;var postData=Agility.JSON.encode(settings),url=_buildAPIUrl("SaveSettings",null);_submitPostData(url,postData,callback)}},API.GetAllSyndicationServices=function(callback){if(checkApiIntialized(callback)){var url=_buildAPIUrl("GetAllSyndicationServices",null);jQuery.getJSON(url,callback)}},API.DeleteSyndicationService=function(syndicationServiceID,callback){if(checkApiIntialized(callback)){var url=_buildAPIUrl("DeleteSyndicationService",[syndicationServiceID]);jQuery.getJSON(url,callback)}},API.SaveSyndicationService=function(syndicationService,callback){if(checkApiIntialized(callback)){var postData=Agility.JSON.encode(syndicationService),url=_buildAPIUrl("SaveSyndicationService",null);_submitPostData(url,postData,callback)}},API.GetAllSystemAccess=function(callback){if(checkApiIntialized(callback)){var url=_buildAPIUrl("GetAllSystemAccess",null);jQuery.getJSON(url,callback)}},API.GetGUID=function(callback){if(checkApiIntialized(callback)){var url=_buildAPIUrl("GetGUID",null);jQuery.getJSON(url,callback)}},API.GetAmazonS3Signature=function(policy,callback){if(checkApiIntialized(callback)){var url=_buildAPIUrl("GetAmazonS3Signature",null,"policy="+escape(policy));jQuery.getJSON(url,callback)}},API.GetOoyalaSignature=function(queryString,callback){if(checkApiIntialized(callback)){var url=_buildAPIUrl("GetOoyalaSignature",null,"p="+escape(queryString));jQuery.getJSON(url,callback)}},API.DeleteFile=function(key,callback){if(checkApiIntialized(callback)){var url=_buildAPIUrl("DeleteFile",null,"key="+escape(key));jQuery.getJSON(url,callback)}},_fileSizeCache={},API.GetFileSize=function(key,callback){if(checkApiIntialized(callback)){var
 url=_buildAPIUrl("GetFileSize",null,"key="+escape(key));_fileSizeCache[key]==undefined?jQuery.getJSON(url,function(data){data.ResponseType==API.ResponseType.OK&&(_fileSizeCache[key]=new Number(data.ResponseData)),callback(data)}):callback({ResponseType:API.ResponseType.OK,ResponseData:new Number(_fileSizeCache[key])})}},API.TestBrightcoveAuthenticationSettings=function(readToken,writeToken,callback){var url=API.APIUrl.toLowerCase().replace("agility-ugc-api-jsonp.svc","TestBrightcoveAuth.ashx"),videoID;$.isFunction(writeToken)?(videoID=readToken,callback=writeToken,url+="?accessKey="+escape(API.APIAccessKey),url+="&seconds="+escape(API.APISeconds),url+="&randomNumber="+escape(API.APIRandomNumber),url+="&hash="+escape(API.APIHash),url+="&profileRecordID="+escape(API.APIProfileRecordID),url+="&videoID="+videoID,url+="&method=?"):(url=API.APIUrl.toLowerCase().replace("agility-ugc-api-jsonp.svc","TestBrightcoveAuth.ashx"),url+="?readToken="+escape(readToken),url+="&writeToken="+escape(writeToken),url+="&method=?"),jQuery.getJSON(url,function(retObj){var isDisabled=!1;retObj.videoIsDisabled!=undefined&&retObj.videoIsDisabled==!0&&(isDisabled=!0),callback(retObj.valid,retObj.videoExists,isDisabled)})},API.TestYouTubeAuthenticationSettings=function(applicationName,apiKey,username,password,callback){var url=API.APIUrl.toLowerCase().replace("agility-ugc-api-jsonp.svc","TestYouTubeAuth.ashx");url+="?applicationName="+escape(applicationName),url+="&apiKey="+escape(apiKey),url+="&username="+escape(username),url+="&password="+escape(password),url+="&method=?",jQuery.getJSON(url,callback)},API.TestAmazonS3AuthenticationSettings=function(bucket,apiKey,secretKey,callback){var url=API.APIUrl.toLowerCase().replace("agility-ugc-api-jsonp.svc","TestAmazonAuth.ashx");url+="?apiKey="+escape(apiKey),url+="&bucket="+escape(bucket),url+="&secretKey="+escape(secretKey),url+="&method=?",jQuery.getJSON(url,callback)},API.GenerateTwitterOauthRequestToken=function(key,secret,callback){var url=API.APIUrl.toLowerCase().replace("agility-ugc-api-jsonp.svc","GenerateTwitterOauthRequestToken.ashx");url+="?accessKey="+escape(API.APIAccessKey),url+="&seconds="+escape(API.APISeconds),url+="&randomNumber="+escape(API.APIRandomNumber),url+="&hash="+escape(API.APIHash),url+="&profileRecordID="+escape(API.APIProfileRecordID),url+="&appkey="+escape(key),url+="&appsecret="+escape(secret),url+="&method=?",jQuery.getJSON(url,callback)},API.GetAmazonS3Form=function(options){if(options==undefined||options==null||typeof options=="string")throw new Error("The Amazon S3 form parameters have not been set correctly.");var returnUrl=location.href,inputID=options.inputID,fieldPanel=options.fieldPanel,fieldName=options.fieldName,fieldType=null;options.fieldType!=undefined&&(fieldType=options.fieldType),API.GetSettings(function(data){var html=null,settings;if(data.ResponseType!=API.ResponseType.OK){html=jQuery("<span>There was an error building the "+options.fieldName+" input: "+data.Message+"</span>"),html.appendTo(fieldPanel);return}if(settings=data.ResponseData,settings.AmazonS3Bucket==null||settings.AmazonS3Bucket==""){API.GetUGCUploadForm(options);return}API.GetGUID(function(dataGUID){var blankUrl,amazonS3Url,exDate,policy,awsSecretKey,awskey;if(dataGUID.ResponseType!=API.ResponseType.OK){html=jQuery("<span>There was an error building the "+options.fieldName+" input: "+dataGUID.Message+"</span>"),html.appendTo(fieldPanel);return}var GUID=dataGUID.ResponseData,currentFileKey=$("#"+inputID).val(),uniqueID=Agility.UniqueID("post_AmazonFileForm"),uniqueFormID=uniqueID+"_form",uniqueFileUploadID=uniqueID+"_fileupload",uniqueSwfUploadID=uniqueID+"_swfupload";options.button_placeholder_id!=undefined&&(uniqueSwfUploadID=options.button_placeholder_id);var uniqueIFrameID=uniqueID+"_iframe",uniqueUploadProgressID=uniqueID+"_progress",flashVersion=Agility.GetFlashVersion();if(returnUrl=returnUrl.substring(0,returnUrl.indexOf("/",returnUrl.indexOf("//")+2)),returnUrl+=Agility.ResolveUrl("~/AgilityRedirector.htm"),blankUrl=Agility.ResolveUrl("~/AgilityRedirector.htm"),amazonS3Url=settings.AmazonS3BaseUrl,amazonS3Url==undefined||amazonS3Url==null||amazonS3Url==""){html=jQuery("The Amazon S3 Base Url settings value has not be provided."),html.appendTo(fieldPanel);return}amazonS3Url.lastIndexOf("/")!=amazonS3Url.length-1&&(amazonS3Url+="/"),exDate=new Date,exDate.setDate(exDate.getDate()+1);var expiration=exDate.getFullYear()+"-"+(exDate.getMonth()+1)+"-"+exDate.getDate()+"T"+exDate.getHours()+":"+exDate.getMinutes()+":"+exDate.getSeconds()+"."+exDate.getTimezoneOffset()+"Z",baseDirectory="AgilityUGC/"+GUID,contentLengthRangeMin=0,contentLengthRangeMax=0;fieldType!=null&&fieldType.MaxLength>0&&(contentLengthRangeMax=fieldType.MaxLength*1024),policy='{ "expiration": "'+expiration+'", ',policy+='"conditions": [  ',policy+='\t{"bucket": "'+settings.AmazonS3Bucket+'"}, ',policy+='\t["starts-with", "$key", "'+baseDirectory+'"], ',policy+='\t{"acl": "public-read"}, ',policy+=flashVersion<=8?'\t{"success_action_redirect": "'+returnUrl+'"}, ':'\t{"success_action_status": "201"}, ',policy+='\t ["starts-with", "$Content-Type", ""], [ "starts-with", "$filename", "" ], ',contentLengthRangeMax>0&&(policy+=' ["content-length-range", '+contentLengthRangeMin+", "+contentLengthRangeMax+"], "),policy+="] }",awsSecretKey=settings.AmazonS3SecretKey,awskey=settings.AmazonS3AccessKey,API.GetAmazonS3Signature(policy,function(data){var policySig=data.ResponseData,fileTypes=null,validExp,postParams,swfu,formHtml,uploadedFileName;if(fieldType!=null&&fieldType.ValidationRegEx!=undefined&&fieldType.ValidationRegEx!=""){for(validExp=fieldType.ValidationRegEx,validExp=validExp.replace(".*([\\",""),validExp=validExp.replace("])","");validExp.indexOf("]|[\\")!=-1;)validExp=validExp.replace("]|[\\",";");fileTypes=validExp.replace(/\./g,"*.")}Agility.GetFlashVersion()>8&&options.swfUploadUrl!=undefined&&options.swfUploadUrl!=null?(html=jQuery("<span id='"+uniqueSwfUploadID+"'></span>"),html.appendTo(fieldPanel),postParams={AWSAccessKeyId:awskey,policy:policySig.PolicyBase64,acl:"public-read",Signature:policySig.Signature,success_action_status:"201"},swfu=new SWFUpload({upload_url:amazonS3Url,file_post_name:"file",post_params:postParams,file_size_limit:contentLengthRangeMax/1024,file_types:fileTypes,file_types_description:"Valid File Types",file_upload_limit:"0",file_queue_error_handler:function(file,errorCode,message){jQuery("#"+options.inputID).data("uploading",!1),options.uploadError!=undefined&&jQuery.isFunction(options.uploadError)&&options.uploadError(file,errorCode,message)},file_dialog_complete_handler:function(numFilesSelected,numFilesQueued){var file,filename,mimetype,filenameStripped;if(numFilesQueued>0){if(file=this.getFile(),file==null)return;if(filename=file.name,mimetype=API.GetMIMEtype(filename),this.addPostParam("Content-Type",API.GetMIMEtype(filename)),filenameStripped=filename.replace(/[^a-zA-Z0-9-_\.]/g,""),filenameStripped==""||filenameStripped.lastIndexOf(".")==0,this.addPostParam("key",baseDirectory+"/"+filenameStripped),options.beforeUpload!=undefined&&jQuery.isFunction(options.beforeUpload)&&options.beforeUpload(filename,mimetype,file.size,this)==!1)return;jQuery("#"+options.inputID).data("uploading",!0),this.startUpload()}},upload_start_handler:function(file){var filenameStripped=file.name.replace(/[^a-zA-Z0-9-_\.]/g,"");if(filenameStripped==""||filenameStripped.lastIndexOf(".")==0)return!1},upload_progress_handler:function(file,bytesLoaded){options.uploadProgress!=undefined&&jQuery.isFunction(options.uploadProgress)&&options.uploadProgress(file,bytesLoaded)},upload_success_handler:function(file,serverData){var xmlDoc,uploadedKey,filenameStripped;jQuery.browser.msie&&(xmlDoc=new ActiveXObject("Microsoft.XMLDOM"),xmlDoc.loadXML(serverData),serverData=xmlDoc),uploadedKey=$(serverData).find("Key").text(),(uploadedKey==null||uploadedKey=="")&&(filenameStripped=file.name.replace(/[^a-zA-Z0-9-_\.]/g,""),uploadedKey=baseDirectory+"/"+filenameStripped),jQuery("#"+options.inputID).val(uploadedKey),jQuery("#"+options.inputID).data("uploading",!1),options.uploadComplete!=undefined&&jQuery.isFunction(options.uploadComplete)&&options.uploadComplete(uploadedKey,file.size)},upload_complete_handler:function(){jQuery("#"+options.inputID).data("uploading",!1)},upload_error_handler:function uploadError(file,errorCode,message){jQuery("#"+options.inputID).data("uploading",!1),options.uploadError!=undefined&&jQuery.isFunction(options.uploadError)&&options.uploadError(file,errorCode,message)},swfupload_loaded_handler:function(){},button_image_url:options.uploadButtonImageUrl,button_placeholder_id:uniqueSwfUploadID,button_width:options.uploadButtonImageWidth,button_height:options.uploadButtonImageHeight,button_window_mode:SWFUpload.WINDOW_MODE.TRANSPARENT,button_action:SWFUpload.BUTTON_ACTION.SELECT_FILE,button_cursor:SWFUpload.CURSOR.HAND,prevent_swf_caching:!1,flash_url:options.swfUploadUrl,debug:!1})):(formHtml='<form  enctype="multipart/form-data" id="'+uniqueFormID+'" method="post" action="'+amazonS3Url+'" target="'+uniqueIFrameID+'"  style="display:inline">',formHtml+='<input type="hidden" name="key" />',formHtml+='<input type="hidden" name="AWSAccessKeyId" />',formHtml+='<input type="hidden" name="Content-Type" value="">',formHtml+='<input type="hidden" name="success_action_redirect" value="'+returnUrl+'" />',formHtml+='<input type="hidden" name="acl" value="public-read" />',formHtml+='<input type="hidden" name="policy" value="" />',formHtml+='<input type="hidden" name="filename" value="" />',formHtml+='<input type="hidden" name="Signature" size="100" value="" />',formHtml+="<input id='"+uniqueFileUploadID+'\' type="file" name="file" />',formHtml+="</form>",formHtml+='<iframe id="'+uniqueIFrameID+'" name="'+uniqueIFrameID+'" src="'+blankUrl+"\" style='position:absolute; height:1px; width: 1px; top:-1px; left:
 -10000px; overflow:hidden'></iframe>",html=jQuery(formHtml),html.appendTo(fieldPanel),jQuery("input[name='AWSAccessKeyId']",html).val(awskey),jQuery("input[name='policy']",html).val(policySig.PolicyBase64),jQuery("input[name='Signature']",html).val(policySig.Signature),uploadedFileName=null,jQuery("#"+uniqueIFrameID).load(function(){var loc,href,key,url,errorMsg;jQuery("#"+uniqueFileUploadID).show(),loc=null;try{loc=$(this.contentDocument.location)}catch(error){}try{(loc==undefined||loc==null)&&(loc=$(this.contentWindow.location)),href=loc.attr("href"),key=Agility.QueryString("key",href),key!=null&&key!=""&&(url=amazonS3Url+key,jQuery("#"+inputID).val(key),$("#"+inputID).data("uploading",!1),options.uploadComplete!=undefined&&jQuery.isFunction(options.uploadComplete)&&options.uploadComplete(key,-1))}catch(Error){if($("#"+inputID).data("uploading",!1),errorMsg="An error occurred while uploading.",contentLengthRangeMax>0&&(errorMsg+=" Please ensure the file is less than "+contentLengthRangeMax/1024+"kb."),options.uploadError!=undefined&&jQuery.isFunction(options.uploadError)){options.uploadError("",-1,errorMsg);throw Error;}else{alert(errorMsg);throw Error;}}}),jQuery("input[name='file']",html).change(function(){var unstrippedName,uploadedFileName,mimeType,filesize,f;if(uploadedFileName=$(this).val(),uploadedFileName!=""){if(fieldType!=null)try{if(!validateFileType(uploadedFileName,fieldType.ValidationRegEx)){options.uploadError!=undefined&&jQuery.isFunction(options.uploadError)&&options.uploadError(uploadedFileName,SWFUpload.QUEUE_ERROR.INVALID_FILETYPE,fieldType.ValidationMessage),$(this).val("");return}}catch(ex3){return}if(unstrippedName=uploadedFileName,uploadedFileName=uploadedFileName.replace(/[^a-zA-Z0-9-_\.]/g,""),uploadedFileName==""||uploadedFileName.lastIndexOf(".")==0){options.uploadError!=undefined&&jQuery.isFunction(options.uploadError)&&options.uploadError(unstrippedName,SWFUpload.QUEUE_ERROR.INVALID_FILETYPE,fieldType.ValidationMessage),$(this).val("");return}jQuery("input[name='key']",html).val(baseDirectory+"/"+uploadedFileName),mimeType=API.GetMIMEtype(uploadedFileName),filesize=-1;try{this.files&&this.files.length>0&&(filesize=this.files[0].size)}catch(error){}if(options.beforeUpload!=undefined&&jQuery.isFunction(options.beforeUpload)&&options.beforeUpload(uploadedFileName,mimeType,filesize,null)==!1){try{$(this).val("")}catch(ex2){}return}$("#"+inputID).data("uploading",!0),$("#"+uniqueFormID+" input[name='Content-Type']").val(mimeType),f=jQuery("#"+uniqueFormID),$(this).hide(),f.submit();try{$(this).val("")}catch(ex1){}}}))})})}),API._liveAttachmentRemoveHandlerBound!=!0&&(API._liveAttachmentRemoveHandlerBound=!0,jQuery("form a.UploadedFileRemove").live("click",function(){var associatedFieldID,elem,key;confirm("Do you wish to delete this file?\n\nYou will not be able to recover this file, and any links to it will be broken")&&(associatedFieldID=jQuery(this).parents("form").data("associatedFieldID"),elem=jQuery(this).parent("span.UploadedFileContainer"),elem.html("Deleting file..."),key=jQuery("#"+associatedFieldID).val(),API.DeleteFile(key,function(data){data.ResponseType!=0?elem.html("An error occurred: "+data.Message):(elem.html(""),jQuery("#"+associatedFieldID).val(""))}))}))},API.GetUGCUploadForm=function(options){var blankUrl,uploadUrl,exDate,fileTypes,validExp,button_window_mode,postParams,swfu,formHtml,uploadedFileName;if(options==undefined||options==null||typeof options=="string")throw new Error("The upload form parameters have not been set correctly.");var returnUrl=location.href,inputID=options.inputID,fieldPanel=options.fieldPanel,fieldName=options.fieldName,fieldType=null;options.fieldType!=undefined&&(fieldType=options.fieldType);var currentFileKey=$("#"+inputID).val(),uniqueID=Agility.UniqueID("post_UGCFileForm"),uniqueFormID=uniqueID+"_form",uniqueFileUploadID=uniqueID+"_fileupload",uniqueSwfUploadID=uniqueID+"_swfupload";options.button_placeholder_id!=undefined&&(uniqueSwfUploadID=options.button_placeholder_id);var uniqueIFrameID=uniqueID+"_iframe",uniqueUploadProgressID=uniqueID+"_progress",flashVersion=Agility.GetFlashVersion();returnUrl=returnUrl.substring(0,returnUrl.indexOf("/",returnUrl.indexOf("//")+2)),returnUrl+=Agility.ResolveUrl("~/AgilityRedirector.htm"),blankUrl=Agility.ResolveUrl("~/AgilityRedirector.htm"),uploadUrl=API.APIUrl,uploadUrl=uploadUrl.substring(0,uploadUrl.toLowerCase().lastIndexOf("/"))+"/UploadFile.ashx",exDate=new Date,exDate.setDate(exDate.getDate()+1);var expiration=exDate.getFullYear()+"-"+(exDate.getMonth()+1)+"-"+exDate.getDate()+"T"+exDate.getHours()+":"+exDate.getMinutes()+":"+exDate.getSeconds()+"."+exDate.getTimezoneOffset()+"Z",contentLengthRangeMin=0,contentLengthRangeMax=0;if(fieldType!=null&&fieldType.MaxLength>0&&(contentLengthRangeMax=fieldType.MaxLength*1024),fileTypes=null,fieldType!=null&&fieldType.ValidationRegEx!=undefined&&fieldType.ValidationRegEx!=""){for(validExp=fieldType.ValidationRegEx,validExp=validExp.replace(".*([\\",""),validExp=validExp.replace("])","");validExp.indexOf("]|[\\")!=-1;)validExp=validExp.replace("]|[\\",";");fileTypes=validExp.replace(/\./g,"*.")}Agility.GetFlashVersion()>8&&options.swfUploadUrl!=undefined&&options.swfUploadUrl!=null?(options.button_placeholder_id==undefined&&(html=jQuery("<span id='"+uniqueSwfUploadID+"'></span>"),html.appendTo(fieldPanel)),button_window_mode=SWFUpload.WINDOW_MODE.TRANSPARENT,options.button_window_mode!=undefined&&(button_window_mode=options.button_window_mode),postParams={accessKey:API.APIAccessKey,seconds:API.APISeconds,randomNumber:API.APIRandomNumber,hash:API.APIHash,profileRecordID:API.APIProfileRecordID},swfu=new SWFUpload({upload_url:uploadUrl,file_post_name:"file",post_params:postParams,file_size_limit:contentLengthRangeMax/1024,file_types:fileTypes,file_types_description:"Valid File Types",file_upload_limit:"0",file_queue_error_handler:function(file,errorCode,message){jQuery("#"+options.inputID).data("uploading",!1),options.uploadError!=undefined&&jQuery.isFunction(options.uploadError)&&options.uploadError(file,errorCode,message)},file_dialog_complete_handler:function(numFilesSelected,numFilesQueued){var file,filename,mimetype,filenameStripped;if(numFilesQueued>0){if(file=this.getFile(),file==null)return;if(filename=file.name,mimetype=API.GetMIMEtype(filename),this.addPostParam("Content-Type",API.GetMIMEtype(filename)),filenameStripped=filename.replace(/[^a-zA-Z0-9-_\.]/g,""),filenameStripped==""||filenameStripped.lastIndexOf(".")==0,options.beforeUpload!=undefined&&jQuery.isFunction(options.beforeUpload)&&options.beforeUpload(filename,mimetype,file.size,this)==!1)return;jQuery("#"+options.inputID).data("uploading",!0),this.startUpload()}},upload_start_handler:function(file){var filenameStripped=file.name.replace(/[^a-zA-Z0-9-_\.]/g,"");if(filenameStripped==""||filenameStripped.lastIndexOf(".")==0)return!1},upload_progress_handler:function(file,bytesLoaded){options.uploadProgress!=undefined&&jQuery.isFunction(options.uploadProgress)&&options.uploadProgress(file,bytesLoaded)},upload_success_handler:function(file,serverData){var responseObj,uploadedFileName;jQuery("#"+options.inputID).data("uploading",!1),responseObj=Agility.JSON.decode(serverData),responseObj.ResponseType!=API.ResponseType.OK?options.uploadError!=undefined&&jQuery.isFunction(options.uploadError)&&options.uploadError("",-1,responseObj.Message):(uploadedFileName=responseObj.ResponseData,jQuery("#"+inputID).val(uploadedFileName),options.uploadComplete!=undefined&&jQuery.isFunction(options.uploadComplete)&&options.uploadComplete(uploadedFileName,-1))},upload_complete_handler:function(){jQuery("#"+options.inputID).data("uploading",!1)},upload_error_handler:function uploadError(file,errorCode,message){jQuery("#"+options.inputID).data("uploading",!1),options.uploadError!=undefined&&jQuery.isFunction(options.uploadError)&&options.uploadError(file,errorCode,message)},swfupload_loaded_handler:function(){},button_image_url:options.uploadButtonImageUrl,button_placeholder_id:uniqueSwfUploadID,button_width:options.uploadButtonImageWidth,button_height:options.uploadButtonImageHeight,button_window_mode:button_window_mode,button_action:SWFUpload.BUTTON_ACTION.SELECT_FILE,button_cursor:SWFUpload.CURSOR.HAND,prevent_swf_caching:!1,flash_url:options.swfUploadUrl,debug:!1})):(formHtml='<form  enctype="multipart/form-data" id="'+uniqueFormID+'" method="post" action="'+uploadUrl+'" target="'+uniqueIFrameID+'"  style="display:inline">',formHtml+='<input type="hidden" name="accessKey" />',formHtml+='<input type="hidden" name="seconds" />',formHtml+='<input type="hidden" name="randomNumber" />',formHtml+='<input type="hidden" name="hash" />',formHtml+='<input type="hidden" name="profileRecordID" />',formHtml+='<input type="hidden" name="returnUrl" />',formHtml+="<input id='"+uniqueFileUploadID+'\' type="file" name="file" />',formHtml+="</form>",formHtml+='<iframe id="'+uniqueIFrameID+'" name="'+uniqueIFrameID+'" src="'+blankUrl+"\" style='position:absolute; height:1px; width: 1px; top:-1px; left: -10000px; overflow:hidden'></iframe>",html=jQuery(formHtml),html.appendTo(fieldPanel),jQuery("input[name='accessKey']",html).val(API.APIAccessKey),jQuery("input[name='seconds']",html).val(API.APISeconds),jQuery("input[name='randomNumber']",html).val(API.APIRandomNumber),jQuery("input[name='hash']",html).val(API.APIHash),jQuery("input[name='profileRecordID']",html).val(API.APIProfileRecordID),jQuery("input[name='returnUrl']",html).val(returnUrl),uploadedFileName=null,jQuery("#"+uniqueIFrameID).load(function(){var loc,href,responseType,uploadedFileName,errorMsg;jQuery("#"+uniqueFileUploadID).show(),loc=null;try{loc=$(this.contentDocument.location)}catch(error){}try{if((loc==undefined||loc==null)&&(loc=$(this.contentWindow.location)),href=loc.attr("href"),responseType=Agility.QueryString("ResponseType",href),responseType==null)return;responseType!=API.ResponseType.OK?(errorMsg=Agility.QueryString("Message",href),options.uplo
adError!=undefined&&jQuery.isFunction(options.uploadError)&&options.uploadError("",-1,errorMsg)):(uploadedFileName=Agility.QueryString("ResponseData",href),jQuery("#"+inputID).val(uploadedFileName),$("#"+inputID).data("uploading",!1),options.uploadComplete!=undefined&&jQuery.isFunction(options.uploadComplete)&&options.uploadComplete(uploadedFileName,-1))}catch(Error){if($("#"+inputID).data("uploading",!1),errorMsg="An error occurred while uploading.",contentLengthRangeMax>0&&(errorMsg+=" Please ensure the file is less than "+contentLengthRangeMax/1024+"kb."),options.uploadError!=undefined&&jQuery.isFunction(options.uploadError)){options.uploadError("",-1,errorMsg);throw Error;}else{alert(errorMsg);throw Error;}}}),jQuery("input[name='file']",html).change(function(){var fileElem=$(this),fileDom=this,unstrippedName,uploadedFileName,f;if(uploadedFileName=fileElem.val(),uploadedFileName!=""){if(fieldType!=null)try{if(!validateFileType(uploadedFileName,fieldType.ValidationRegEx)){options.uploadError!=undefined&&jQuery.isFunction(options.uploadError)&&options.uploadError(uploadedFileName,SWFUpload.QUEUE_ERROR.INVALID_FILETYPE,fieldType.ValidationMessage),fileElem.val("");return}}catch(ex3){return}if(unstrippedName=uploadedFileName,uploadedFileName=uploadedFileName.replace(/[^a-zA-Z0-9-_\.]/g,""),uploadedFileName==""||uploadedFileName.lastIndexOf(".")==0){options.uploadError!=undefined&&jQuery.isFunction(options.uploadError)&&options.uploadError(unstrippedName,SWFUpload.QUEUE_ERROR.INVALID_FILETYPE,fieldType.ValidationMessage),fileElem.val("");return}var mimeType=API.GetMIMEtype(uploadedFileName),uploaderObj=null,filesize=-1;try{fileDom.files&&fileDom.files.length>0&&(filesize=fileDom.files[0].size)}catch(error){}if(options.beforeUpload!=undefined&&jQuery.isFunction(options.beforeUpload)&&options.beforeUpload(uploadedFileName,mimeType,filesize,uploaderObj)==!1){try{fileElem.val("")}catch(ex2){}return}$("#"+inputID).data("uploading",!0),$("#"+uniqueFormID+" input[name='Content-Type']").val(mimeType),f=jQuery("#"+uniqueFormID),fileElem.hide(),f.submit();try{fileElem.val("")}catch(ex1){}}})),API._liveAttachmentRemoveHandlerBound!=!0&&(API._liveAttachmentRemoveHandlerBound=!0,jQuery("form a.UploadedFileRemove").live("click",function(){var associatedFieldID,elem,key;confirm("Do you wish to delete this file?\n\nYou will not be able to recover this file, and any links to it will be broken")&&(associatedFieldID=jQuery(this).parents("form").data("associatedFieldID"),elem=jQuery(this).parent("span.UploadedFileContainer"),elem.html("Deleting file..."),key=jQuery("#"+associatedFieldID).val(),API.DeleteFile(key,function(data){data.ResponseType!=0?elem.html("An error occurred: "+data.Message):(elem.html(""),jQuery("#"+associatedFieldID).val(""))}))}))},API._liveAttachmentRemoveHandlerBound=!1,_authCookieName=null,API.GetAuthCookieName=function(){return _authCookieName==null&&(_authCookieName="UGC_AUTH_"+API.APIAccessKey),_authCookieName},API.SetAuthCookieName=function(cookieName){return _authCookieName=cookieName},API.Logout=function(websiteUserTypeName){var cookieName=API.GetAuthCookieName(),cookieDate,cookieValue;websiteUserTypeName!=null&&(cookieName+=websiteUserTypeName),cookieDate=Date.today().addMonths(-1),cookieValue=null,Agility.SetCookie(cookieName,cookieValue,cookieDate,"/",null,!0)},API.Authenticate=function(websiteUserTypeName,login,password,persistCookie,loginFieldName,callback){var args,argStr,url;(callback==undefined&&loginFieldName!=undefined&&$.isFunction(loginFieldName)&&(callback=loginFieldName,loginFieldName=""),callback==undefined&&persistCookie!=undefined&&$.isFunction(persistCookie)&&(callback=persistCookie,persistCookie=!1),loginFieldName==undefined&&(loginFieldName=""),checkApiIntialized(callback))&&(args=[],args.push(websiteUserTypeName),argStr=Agility.JSON.encode(websiteUserTypeName),url=_buildAPIUrl("Authenticate",args),url+="&l="+escape(login)+"&p="+escape(password)+"&fn="+escape(loginFieldName),$.getJSON(url,function(data){var token,cookieName,cookieValue,cookieDate;_processOdataError(data,callback)||data!=undefined&&(token=data.ResponseData,token!=undefined&&token!=null&&token!=""&&(cookieName=API.GetAuthCookieName(),websiteUserTypeName!=null&&(cookieName+=websiteUserTypeName),cookieValue=new String(token),cookieDate=null,persistCookie&&(cookieDate=Date.today().addMonths(1)),Agility.SetCookie(cookieName,cookieValue,cookieDate,"/",null,!1)),callback({ResponseType:API.ResponseType.OK,ResponseData:token,Message:null}))}))},API.IsAuthenticated=function(websiteUserTypeName,callback){var cookieName=API.GetAuthCookieName(),token,args,url;if(websiteUserTypeName!=null&&(cookieName+=websiteUserTypeName),token=Agility.GetCookie(cookieName),token==null||token==""){callback({ResponseType:API.ResponseType.OK,ResponseData:!1,Message:null});return}checkApiIntialized(callback)&&(args=[],args.push(websiteUserTypeName),url=_buildAPIUrl("IsAuthenticated",args),url+="&s="+escape(token),$.getJSON(url,function(data){if(data!=undefined&&data.ResponseData!=undefined&&data.ResponseData!=null){var profileRecordID=data.ResponseData.ProfileRecordID,seconds=data.ResponseData.Seconds,randomNumber=data.ResponseData.RandomNumber,hash=data.ResponseData.AccessHash,accessKey=data.ResponseData.AccessKey;API.APIAccessKey=accessKey,API.APISeconds=seconds,API.APIRandomNumber=randomNumber,API.APIProfileRecordID=profileRecordID,API.APIHash=hash,callback({ResponseType:API.ResponseType.OK,ResponseData:profileRecordID,Message:null})}}))},API.ChangePassword=function(currentPassword,newPassword,callback){if(API.APIProfileRecordID<1){callback({ResponseType:API.ResponseType.Error,ResponseData:!1,Message:"The user is not currently logged in."});return}if(checkApiIntialized(callback)){var args=[],url=_buildAPIUrl("ChangePassword",args);url+="&c="+escape(currentPassword),url+="&n="+escape(newPassword),$.getJSON(url,function(data){callback(data)})}},API.RetrievePassword=function(websiteUserTypeName,login,callback){var args,url;checkApiIntialized(callback)&&(args=[],args.push(websiteUserTypeName),url=_buildAPIUrl("RetrievePassword",args),url+="&l="+escape(login),$.getJSON(url,function(data){data!=undefined&&data.ResponseData!=undefined&&data.ResponseData!=null&&callback({ResponseType:API.ResponseType.OK,ResponseData:data.ResponseData,Message:null})}))},API.GetODataMetaData=function(callback){var url=_getOdataUrl();url+="/?$format=json&$callback=?",$.getJSON(url,function(data){if(data!=undefined&&data.d!=undefined&&data.d!=null){if(_processOdataError(data,callback))return;data.d!=undefined&&data.d!=null&&callback({ResponseType:API.ResponseType.OK,Message:null,ResponseData:data.d})}})},API.GetODataFeed=function(recordTypeName,options,callback){var url=_getOdataUrl();url+="/"+recordTypeName+"/",url+="?$format=json",options!=undefined&&options!=null&&options.filter!=undefined&&options.filter!=null&&options.filter!=""&&(url+="&$filter="+escape(options.filter)),url+="&$callback=?",$.getJSON(url,function(data){_processOdataError(data,callback)||data!=undefined&&data!=null&&data.d!=undefined&&data.d!=null&&data.d.results!=undefined&&data.d.results!=null&&callback({ResponseType:API.ResponseType.OK,Message:null,ResponseData:data.d.results})})},API.GetODataRecord=function(recordTypeName,recordID,callback){var url=_getOdataUrl();url+="/"+recordTypeName+"("+recordID+")/",url+="?$format=json&$callback=?",$.getJSON(url,function(data){_processOdataError(data,callback)||data!=undefined&&data!=null&&data.d!=undefined&&data.d!=null&&callback({ResponseType:API.ResponseType.OK,Message:null,ResponseData:data.d})})},API.ExecCustomProcedure=function(proc,paramArgs,callback){var url=Agility.UGC.API.APIUrl,propertyName,val;if(url=url.toLowerCase().replace("agility-ugc-api-jsonp.svc","ExecCustomProcedure.ashx"),url+="?proc="+escape(proc),paramArgs!=undefined&&paramArgs!=null)for(propertyName in paramArgs)(val=paramArgs[propertyName],val!=undefined&&val!=null)&&(url+="&@"+escape(propertyName)+"="+escape(paramArgs[propertyName]));url+="&method=?",url+="&format=json",url+="&accessKey="+escape(API.APIAccessKey),url+="&seconds="+escape(API.APISeconds),url+="&randomNumber="+escape(API.APIRandomNumber),url+="&hash="+escape(API.APIHash),url+="&profileRecordID="+escape(API.APIProfileRecordID),$.getJSON(url,function(data){if(data!=undefined){var obj={ResponseType:API.ResponseType.OK,Message:null};obj.ResponseData=data.ResonseData!=undefined?data.ResonseData:data.ResponseData,callback(obj)}})},API.GetMIMEtype=function(filename){var fn=new String(filename),fn1=new String;return(fn1=fn.match(/[\/\\][^\/\\]*$/),fn1!=null&&fn1.length>0&&(fn=fn1+""),fn=fn.toLowerCase(),fn.search(/^.*\.ai$/)>=0)?"application/illustrator":fn.search(/^.*\.bin$/)>=0?"application/octet-stream":fn.search(/^.*\.pdf$/)>=0?"application/pdf":fn.search(/^.*\.ps$/)>=0?"application/postscript":fn.search(/^.*\.rtf$/)>=0?"application/rtf":fn.search(/^.*\.sit$/)>=0?"application/stuffit":fn.search(/^.*\.flv$/)>=0?"video/x-flv":fn.search(/^.*\.mdb$/)>=0?"application/vnd.ms-access":fn.search(/^.*\.xls$/)>=0?"application/vnd.ms-excel":fn.search(/^.*\.ppt$/)>=0?"application/vnd.ms-powerpoint":fn.search(/^.*\.pps$/)>=0?"application/vnd.ms-powerpoint":fn.search(/^.*\.pot$/)>=0?"application/vnd.ms-powerpoint":fn.search(/^.*\.xps$/)>=0?"application/vnd.ms-xpsdocument":fn.search(/^.*\.doc$/)>=0?"application/msword":fn.search(/^.*\.7z$/)>=0?"application/x-7z-compressed":fn.search(/^.*\.torrent$/)>=0?"application/x-bittorrent":fn.search(/^.*\.tar\.gz$/)>=0?"application/x-compressed-tar":fn.search(/^.*\.tgz$/)>=0?"application/x-compressed-tar":fn.search(/^.*\.ttf$/)>=0?"application/x-font-ttf":fn.search(/^.*\.gz$/)>=0?"application/x-gzip":fn.search(/^.*\.pdf\.gz$/)>=0?"application/x-gzpdf":fn.search(/^.*\.ps\.gz$/)>=0?"application/x-gzpostscript":fn.search(/^.*\.jar$/)>=0?"application/x-java-archive":fn.search(/^.*\.js$/)>=0?"application/javascript":fn.search(/^.*\.lzh$/)>=0?"application/x-lha":fn.search(/^.*\.mkv$/)>=0?"video/x-matroska"
:fn.search(/^.*\.exe$/)>=0?"application/x-ms-dos-executable":fn.search(/^.*\.ogg$/)>=0?"application/ogg":fn.search(/^.*\.ogx$/)>=0?"application/ogg":fn.search(/^.*\.oga$/)>=0?"audio/ogg":fn.search(/^.*\.ogv$/)>=0?"video/ogg":fn.search(/^.*\.ogg$/)>=0?"audio/x-vorbis+ogg":fn.search(/^.*\.ogg$/)>=0?"audio/x-flac+ogg":fn.search(/^.*\.ogg$/)>=0?"audio/x-speex+ogg":fn.search(/^.*\.spx$/)>=0?"audio/x-speex":fn.search(/^.*\.ogg$/)>=0?"video/x-theora+ogg":fn.search(/^.*\.ogm$/)>=0?"video/x-ogm+ogg":fn.search(/^.*\.qtl$/)>=0?"application/x-quicktime-media-link":fn.search(/^.*\.tar$/)>=0?"application/x-tar":fn.search(/^.*\.theme$/)>=0?"application/x-theme":fn.search(/^.*\.der$/)>=0?"application/x-x509-ca-cert":fn.search(/^.*\.cer$/)>=0?"application/x-x509-ca-cert":fn.search(/^.*\.crt$/)>=0?"application/x-x509-ca-cert":fn.search(/^.*\.cert$/)>=0?"application/x-x509-ca-cert":fn.search(/^.*\.pem$/)>=0?"application/x-x509-ca-cert":fn.search(/^.*\.xhtml$/)>=0?"application/xhtml+xml":fn.search(/^.*\.zip$/)>=0?"application/zip":fn.search(/^.*\.ac3$/)>=0?"audio/ac3":fn.search(/^.*\.aiff$/)>=0?"audio/x-aiff":fn.search(/^.*\.aif$/)>=0?"audio/x-aiff":fn.search(/^.*\.aifc$/)>=0?"audio/x-aiff":fn.search(/^.*\.flac$/)>=0?"audio/x-flac":fn.search(/^.*\.mid$/)>=0?"audio/midi":fn.search(/^.*\.midi$/)>=0?"audio/midi":fn.search(/^.*\.kar$/)>=0?"audio/midi":fn.search(/^.*\.m4a$/)>=0?"audio/mp4":fn.search(/^.*\.aac$/)>=0?"audio/mp4":fn.search(/^.*\.mp4$/)>=0?"video/mp4":fn.search(/^.*\.m4v$/)>=0?"video/mp4":fn.search(/^.*\.m4b$/)>=0?"audio/x-m4b":fn.search(/^.*\.3gp$/)>=0?"video/3gpp":fn.search(/^.*\.3gpp$/)>=0?"video/3gpp":fn.search(/^.*\.amr$/)>=0?"video/3gpp":fn.search(/^.*\.mp2$/)>=0?"audio/mp2":fn.search(/^.*\.mp3$/)>=0?"audio/mpeg":fn.search(/^.*\.mpga$/)>=0?"audio/mpeg":fn.search(/^.*\.m3u$/)>=0?"audio/x-mpegurl":fn.search(/^.*\.vlc$/)>=0?"audio/x-mpegurl":fn.search(/^.*\.asx$/)>=0?"audio/x-ms-asx":fn.search(/^.*\.wax$/)>=0?"audio/x-ms-asx":fn.search(/^.*\.wvx$/)>=0?"audio/x-ms-asx":fn.search(/^.*\.wmx$/)>=0?"audio/x-ms-asx":fn.search(/^.*\.psf$/)>=0?"audio/x-psf":fn.search(/^.*\.wma$/)>=0?"audio/x-ms-wma":fn.search(/^.*\.ra$/)>=0?"audio/vnd.rn-realaudio":fn.search(/^.*\.rax$/)>=0?"audio/vnd.rn-realaudio":fn.search(/^.*\.ram$/)>=0?"application/ram":fn.search(/^.*\.rv$/)>=0?"video/vnd.rn-realvideo":fn.search(/^.*\.rvx$/)>=0?"video/vnd.rn-realvideo":fn.search(/^.*\.wav$/)>=0?"audio/x-wav":fn.search(/^.*\.bmp$/)>=0?"image/bmp":fn.search(/^.*\.wbmp$/)>=0?"image/vnd.wap.wbmp":fn.search(/^.*\.gif$/)>=0?"image/gif":fn.search(/^.*\.jpeg$/)>=0?"image/jpeg":fn.search(/^.*\.jpg$/)>=0?"image/jpeg":fn.search(/^.*\.jpe$/)>=0?"image/jpeg":fn.search(/^.*\.png$/)>=0?"image/png":fn.search(/^.*\.rle$/)>=0?"image/rle":fn.search(/^.*\.svg$/)>=0?"image/svg+xml":fn.search(/^.*\.svgz$/)>=0?"image/svg+xml-compressed":fn.search(/^.*\.tif$/)>=0?"image/tiff":fn.search(/^.*\.tiff$/)>=0?"image/tiff":fn.search(/^.*\.eps$/)>=0?"image/x-eps":fn.search(/^.*\.ico$/)>=0?"image/x-ico":fn.search(/^.*\.psd$/)>=0?"image/x-psd":fn.search(/^.*\.vcs$/)>=0?"text/calendar":fn.search(/^.*\.ics$/)>=0?"text/calendar":fn.search(/^.*\.css$/)>=0?"text/css":fn.search(/^.*\.CSSL$/)>=0?"text/css":fn.search(/^.*\.rtx$/)>=0?"text/richtext":fn.search(/^.*\.rss$/)>=0?"application/rss+xml":fn.search(/^.*\.atom$/)>=0?"application/atom+xml":fn.search(/^.*\.opml$/)>=0?"text/x-opml+xml":fn.search(/^.*\.sgml$/)>=0?"text/sgml":fn.search(/^.*\.sgm$/)>=0?"text/sgml":fn.search(/^.*\.dtd$/)>=0?"text/x-dtd":fn.search(/^.*\.html$/)>=0?"text/html":fn.search(/^.*\.htm$/)>=0?"text/html":fn.search(/^.*\.log$/)>=0?"text/x-log":fn.search(/^README*$/)>=0?"text/x-readme":fn.search(/^.*\.uri$/)>=0?"text/x-uri":fn.search(/^.*\.url$/)>=0?"text/x-uri":fn.search(/^.*\.fo$/)>=0?"text/x-xslfo":fn.search(/^.*\.xslfo$/)>=0?"text/x-xslfo":fn.search(/^.*\.xml$/)>=0?"application/xml":fn.search(/^.*\.xsl$/)>=0?"application/xml":fn.search(/^.*\.xslt$/)>=0?"application/xml":fn.search(/^.*\.xbl$/)>=0?"application/xml":fn.search(/^.*\.mpeg$/)>=0?"video/mpeg":fn.search(/^.*\.mpg$/)>=0?"video/mpeg":fn.search(/^.*\.mp2$/)>=0?"video/mpeg":fn.search(/^.*\.mpe$/)>=0?"video/mpeg":fn.search(/^.*\.vob$/)>=0?"video/mpeg":fn.search(/^.*\.m2t$/)>=0?"video/mpeg":fn.search(/^.*\.qt$/)>=0?"video/quicktime":fn.search(/^.*\.mov$/)>=0?"video/quicktime":fn.search(/^.*\.moov$/)>=0?"video/quicktime":fn.search(/^.*\.qtvr$/)>=0?"video/quicktime":fn.search(/^.*\.qtif$/)>=0?"image/x-quicktime":fn.search(/^.*\.qif$/)>=0?"image/x-quicktime":fn.search(/^.*\.viv$/)>=0?"video/vivo":fn.search(/^.*\.vivo$/)>=0?"video/vivo":fn.search(/^.*\.anim[1-9j]$/)>=0?"video/x-anim":fn.search(/^.*\.fli$/)>=0?"video/x-flic":fn.search(/^.*\.flc$/)>=0?"video/x-flic":fn.search(/^.*\.hwp$/)>=0?"application/x-hwp":fn.search(/^.*\.hwt$/)>=0?"application/x-hwt":fn.search(/^.*\.mng$/)>=0?"video/x-mng":fn.search(/^.*\.asf$/)>=0?"video/x-ms-asf":fn.search(/^.*\.nsc$/)>=0?"application/x-netshow-channel":fn.search(/^.*\.wmv$/)>=0?"video/x-ms-wmv":fn.search(/^.*\.avi$/)>=0?"video/x-msvideo":fn.search(/^.*\.divx$/)>=0?"video/x-msvideo":"binary/octet-stream"}}(Agility.UGC.API);
Agility.RegisterNamespace("BNN.Cookie"),function(BC){BC.Set=function(c_name,value,expireminutes){var exdate=new Date,domain;expireminutes==undefined&&(expireminutes=-1),expireminutes==-1?exdate.setMinutes(exdate.getYear()+10):exdate.setMinutes(exdate.getMinutes()+expireminutes),domain=null,document.cookie=c_name+"="+escape(value)+(expireminutes==null?"expires=Thu, 01-Jan-1970 00:00:01 GMT":";expires="+exdate.toGMTString())+"; path="+escape("/")+(domain?";domain="+domain:"")},BC.Get=function(c_name){return document.cookie.length>0&&(c_start=document.cookie.indexOf(c_name+"="),c_start!=-1)?(c_start=c_start+c_name.length+1,c_end=document.cookie.indexOf(";",c_start),c_end==-1&&(c_end=document.cookie.length),unescape(document.cookie.substring(c_start,c_end))):""},BC.Clear=function(cookieName){BNN.Cookie.Set(cookieName,"",null)},BC.SetCommentAbuseCookie=function(IDs){BNN.Cookie.Set("BNN.CommentAbuseCookie",IDs)},BC.GetCommentAbuseCookie=function(){return BNN.Cookie.Get("BNN.CommentAbuseCookie")}}(BNN.Cookie,jQuery);
Agility.RegisterNamespace("BNN.NewOmniture"),function(NewOmniture){NewOmniture.BeginTracking=function(){var pUri=NewOmniture.parseUri(window.location),directoryPath=pUri.directory.toLowerCase().split("/"),omniture_news_sector,subSection;if((pUri.file=="beta_home.aspx"||pUri.file==""&&directoryPath[0]==""&&directoryPath[1]=="")&&(Tracking.setSiteId("bnn"),Tracking.setSiteSection("home"),Tracking.setSubSections("","",""),Tracking.track()),(pUri.file=="home.aspx"||pUri.file==""&&directoryPath[0]==""&&directoryPath[1]=="")&&(Tracking.setSiteId("bnn"),Tracking.setSiteSection("home"),Tracking.setSubSections("","",""),Tracking.track()),directoryPath.length==3&&directoryPath[0]==""&&directoryPath[2]=="")directoryPath[1].toLowerCase()=="news"?(omniture_news_sector=null,omniture_news_sector=pUri.query==""?"All":pUri.queryKey.Sector.toLowerCase(),Tracking.setSiteSection(directoryPath[1].toLowerCase()),Tracking.setSubSections(pUri.file.toLowerCase().replace(".aspx","").replace("-","_"),omniture_news_sector,""),Tracking.track()):directoryPath[1].toLowerCase()=="video"?(Tracking.setSiteSection(directoryPath[1].toLowerCase()+" - hub"),Tracking.setSubSections(pUri.file.toLowerCase().replace(".aspx","").replace("-","_"),"",""),Tracking.track()):(Tracking.setSiteSection(directoryPath[1].toLowerCase()),Tracking.setSubSections(pUri.file.toLowerCase().replace(".aspx","").replace("-","_"),"",""),Tracking.track());else if(directoryPath.length==6)directoryPath[1].toLowerCase()=="news"?(subSection=directoryPath[1].toLowerCase()=="blog"?"blog":"story",Tracking.setSiteSection(directoryPath[1].toLowerCase()),Tracking.setSubSections(subSection,"",""),Tracking.setContentTitle(directoryPath[1].toLowerCase()+"_"+pUri.file.toLowerCase().replace(".aspx",""))):directoryPath[1].toLowerCase()=="blogs"&&(subSection=directoryPath[1].toLowerCase()=="blog"?"blog":"story",Tracking.setSiteSection(directoryPath[1].toLowerCase()),Tracking.setSubSections(subSection,"",""),Tracking.setContentTitle(directoryPath[1].toLowerCase()+"_"+pUri.file.toLowerCase().replace(".aspx","")));else if(directoryPath.length==2&&directoryPath[0]==""&&directoryPath[1]=="")if(pUri.file.toLowerCase().replace(".aspx","").replace("-","_")=="blogs"){var omniture_blogs_sector=null,omniture_blogs_author=null,omnitureSection=null;pUri.query==""?(omniture_blogs_sector="All",omniture_blogs_author="All"):pUri.query.substring(0,6)=="author"?omniture_blogs_author=pUri.queryKey.author.toLowerCase():omniture_blogs_sector=pUri.queryKey.sector.toLowerCase(),omnitureSection=omniture_blogs_sector==""||omniture_blogs_sector==null?omniture_blogs_author:omniture_blogs_sector,Tracking.setSiteSection(pUri.file.toLowerCase().replace(".aspx","").replace("-","_")),Tracking.setSubSections("blog_listing",omnitureSection,""),Tracking.track()}else pUri.file.toLowerCase().replace(".aspx","")=="stock"?pUri.query!=""&&(Tracking.setPageName("Stock.aspx - "+pUri.queryKey.pi_symbol.toLowerCase()),Tracking.setSiteSection(pUri.file.toLowerCase().replace(".aspx","")),Tracking.setSubSections("stock_"+pUri.queryKey.pi_symbol.toLowerCase(),"",""),Tracking.track()):pUri.file.toLowerCase().replace(".aspx","")=="search"||(Tracking.setSiteSection(pUri.file.toLowerCase().replace(".aspx","").replace("-","_").replace("-","_").replace("-","_")),Tracking.setSubSections("home","",""),Tracking.track());s.trackExternalLinks=!1},NewOmniture.parseUri=function parseUri(str){for(var o=NewOmniture.parseUri.options,m=o.parser[o.strictMode?"strict":"loose"].exec(str),uri={},i=14;i--;)uri[o.key[i]]=m[i]||"";return uri[o.q.name]={},uri[o.key[12]].replace(o.q.parser,function($0,$1,$2){$1&&(uri[o.q.name][$1]=$2)}),uri},NewOmniture.parseUri.options={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},NewOmniture.getQueryString=function(variable){for(var query=window.location.search.substring(1),vars=query.split("&"),pair,i=0;i<vars.length;i++)if(pair=vars[i].split("="),pair[0]==variable||pair[0]==variable.toLowerCase())return unescape(pair[1].replace(/-/g,"").toLowerCase())}}(BNN.NewOmniture);
Agility.RegisterNamespace("BNN.Controls.NewHeader"),function(NewHeader){function timeUpdater(EST){var updateTime=function(){var now=new Date,nowMilis=now.getTime(),est;nowMilis=nowMilis-now.getTimezoneOffset()*6e4,nowMilis=nowMilis-EST*6e4,est=new Date(nowMilis),$("div.NewETDateTime span").html(dateFormat(est,"mmmm d, yyyy hh:MM TT")),setTimeout(function(){updateTime()},6e4)};updateTime()}function reloadPage(interval){setInterval(function(){var current_url=window.location.href;window.location.assign(current_url)},interval)}function updateNewBreakingNews(breakingNewsRotation,liveIds){Array.prototype.indexOf||(Array.prototype.indexOf=function(elt){var len=this.length>>>0,from=Number(arguments[1])||0;for(from=from<0?Math.ceil(from):Math.floor(from),from<0&&(from+=len);from<len;from++)if(from in this&&this[from]===elt)return from;return-1});var liveIDs=liveIds.split(",");$.getJSON(Agility.ResolveUrl("~/Handlers/Header.ashx")+"?get=NewBreakingNews",function(result){var breakingNews=result.NewBreakingNews;if(breakingNews!=undefined&&breakingNews!=null&&breakingNews.length>0){$("#NewHeader_BreakingNews").show();var news=$("#NewBreakingNews .News span"),breakingTitle=$("#NewBreakingNews .Title span"),rotateBreakingNews=function(idx){if(breakingNews[idx].URL!=""&&$.trim(breakingNews[idx].URL)!="javascript:void(0)")if(breakingNews[idx].URL.indexOf("?")!=-1){var videoID=breakingNews[idx].URL.split("?")[1].split("=")[1];liveIDs.indexOf(videoID)>-1?($("#NewBreakingNews").addClass("Live"),$("#NewHeader_BreakingNews").addClass("Live")):($("#NewBreakingNews").removeClass("Live"),$("#NewHeader_BreakingNews").removeClass("Live"))}else $("#NewBreakingNews").removeClass("Live"),$("#NewHeader_BreakingNews").removeClass("Live");else $("#NewBreakingNews").removeClass("Live"),$("#NewHeader_BreakingNews").removeClass("Live");breakingTitle.html(breakingNews[idx].Title),news.fadeOut("fast",function(){news.html('<a href="'+Agility.ResolveUrl(breakingNews[idx].URL)+'" target="'+breakingNews[idx].Target+'" >'+breakingNews[idx].Description+"</a>"),news.fadeIn("fast",function(){setTimeout(function(){rotateBreakingNews((idx+1)%breakingNews.length)},breakingNewsRotation)})})};rotateBreakingNews(0),wrapFlag==!1&&$("#body_id").css("background-image","url("+Agility.ResolveUrl("/Images/Backgrounds/bkg_site_origin_tickerchange_breaking.png")+")")}else $("#NewHeader_BreakingNews ").hide(),wrapFlag==!1&&$("#body_id").css("background-image","url("+Agility.ResolveUrl("/Images/Backgrounds/bkg_site_origin_tickerchange.png")+")")})}function updateProgramAlerts(breakingNewsRotation){$.getJSON(Agility.ResolveUrl("~/Handlers/Header.ashx")+"?get=ProgramAlerts",function(result){var programAlerts=result.ProgramAlerts;if(programAlerts!=undefined&&programAlerts!=null&&programAlerts.length>0){var alertTitle=$("#ProgramAlert .Title"),alert=$("#ProgramAlert .Alert"),rotateProgramAlerts=function(idx){alertTitle.html(programAlerts[idx].Title),alert.fadeOut("fast",function(){alert.html('<a href="'+Agility.ResolveUrl(programAlerts[idx].URL)+'" target="'+programAlerts[idx].Target+'" >'+programAlerts[idx].Description+"</a>"),alert.fadeIn("fast",function(){setTimeout(function(){rotateProgramAlerts((idx+1)%programAlerts.length)},breakingNewsRotation-5)})})};rotateProgramAlerts(0)}else $("#ProgramAlert").hide()})}var _isOverStockSearchMenu=!1;NewHeader.Init=function(searchDefault,breakingNewsRotation,EST,LiveIDs,loadInterval,reload){var count,$sep,searchBox,stockSearchMenu,pUri,directoryPath,bkgImageUrl;reload&&(window.location.pathname=="/"||window.location.pathname=="/home.aspx")&&reloadPage(parseInt(loadInterval)),count=$("#Header_Extended #Items a").length,$sep=$("<span/>"),$sep.append("&raquo;"),$("#Header_Extended #Items a").each(function(index){index<count-1&&$(this).append("&nbsp;&raquo;")}),timeUpdater(EST),updateNewBreakingNews(breakingNewsRotation,LiveIDs),updateProgramAlerts(breakingNewsRotation),$("#NewHeader_Links a").each(function(){var currentPath=window.location.pathname;currentPath.slice(1).split("/")[0].toLowerCase().replace(".aspx","")==$.trim($(this).text().toLowerCase())&&$(this).addClass("Active"),(currentPath.slice(1).split("/")[0].toLowerCase().replace(".aspx","")==""||currentPath.slice(1).split("/")[0].toLowerCase().replace(".aspx","")=="beta_home"||currentPath.slice(1).split("/")[0].toLowerCase().replace(".aspx","")=="test2636176"||currentPath.slice(1).split("/")[0].toLowerCase().replace(".aspx","")=="home")&&$.trim($(this).text().toLowerCase())=="home"&&$(this).addClass("Active")});var showsLink=$("#NewHeader_Links a").filter(function(){return $(this).html().toLowerCase().indexOf("shows")!=-1}),showsMenu=$("#NewHeader_ShowsDropDown"),newsLink=$("#NewHeader_Links a").filter(function(){return $(this).html().toLowerCase().indexOf("news")!=-1}),newsMenu=$("#NewHeader_NewsDropDown"),specialCoverageLink=$("#NewHeader_Links a").filter(function(){return $(this).html().toLowerCase().indexOf("special coverage")!=-1}),specialCoverageMenu=$("#NewHeader_SpecialCoverageDropDown"),videoLink=$("#NewHeader_Links a").filter(function(){return $(this).html().toLowerCase().indexOf("video")!=-1});showsLink.bind("mouseenter",function(){_updateMenuPosition(showsLink,showsMenu),showsMenu.show(),showsLink.find(".dropIcon").attr("src","http://ctvbnn.s3.amazonaws.com/Images/Icons/icn_menu_drop_red.png")}),showsLink.bind("mouseleave",function(){showsMenu.hide(),showsLink.find(".dropIcon").attr("src","http://ctvbnn.s3.amazonaws.com/Images/Icons/icn_menu_drop.png")}),showsMenu.bind("mouseenter",function(){showsLink.addClass("ShowHighlighted"),showsLink.removeClass("Active"),_updateMenuPosition(showsLink,showsMenu),showsMenu.show(),showsLink.find(".dropIcon").attr("src","http://ctvbnn.s3.amazonaws.com/Images/Icons/icn_menu_drop_red.png")}),showsMenu.bind("mouseleave",function(){showsLink.removeClass("ShowHighlighted"),showsMenu.hide(),showsLink.find(".dropIcon").attr("src","http://ctvbnn.s3.amazonaws.com/Images/Icons/icn_menu_drop.png")}),newsLink.bind("mouseenter",function(){_updateNewsMenuPosition(newsLink,newsMenu),newsMenu.show(),newsLink.find(".dropIcon").attr("src","http://ctvbnn.s3.amazonaws.com/Images/Icons/icn_menu_drop_red.png")}),newsLink.bind("mouseleave",function(){newsMenu.hide(),newsLink.find(".dropIcon").attr("src","http://ctvbnn.s3.amazonaws.com/Images/Icons/icn_menu_drop.png")}),newsMenu.bind("mouseenter",function(){newsLink.addClass("NewsHighlighted"),newsLink.removeClass("Active"),_updateNewsMenuPosition(newsLink,newsMenu),newsMenu.show(),newsLink.find(".dropIcon").attr("src","http://ctvbnn.s3.amazonaws.com/Images/Icons/icn_menu_drop_red.png")}),newsMenu.bind("mouseleave",function(){newsLink.removeClass("NewsHighlighted"),newsMenu.hide(),newsLink.find(".dropIcon").attr("src","http://ctvbnn.s3.amazonaws.com/Images/Icons/icn_menu_drop.png")}),specialCoverageLink.bind("mouseenter",function(){_updateSpecialCoverageMenuPosition(specialCoverageLink,specialCoverageMenu),specialCoverageMenu.show(),specialCoverageLink.find(".dropIcon").attr("src","http://ctvbnn.s3.amazonaws.com/Images/Icons/icn_menu_drop_red.png")}),specialCoverageLink.bind("mouseleave",function(){specialCoverageMenu.hide(),specialCoverageLink.find(".dropIcon").attr("src","http://ctvbnn.s3.amazonaws.com/Images/Icons/icn_menu_drop.png")}),specialCoverageMenu.bind("mouseenter",function(){specialCoverageLink.addClass("SpecialHighlighted"),specialCoverageLink.removeClass("Active"),_updateSpecialCoverageMenuPosition(specialCoverageLink,specialCoverageMenu),specialCoverageMenu.show(),specialCoverageLink.find(".dropIcon").attr("src","http://ctvbnn.s3.amazonaws.com/Images/Icons/icn_menu_drop_red.png")}),specialCoverageMenu.bind("mouseleave",function(){specialCoverageLink.removeClass("SpecialHighlighted"),specialCoverageMenu.hide(),specialCoverageLink.find(".dropIcon").attr("src","http://ctvbnn.s3.amazonaws.com/Images/Icons/icn_menu_drop.png")}),searchBox=$("#txtHeaderSearch"),stockSearchMenu=$("#NewHeader_StockSearch"),stockSearchMenu.bind("mouseenter",function(){_isOverStockSearchMenu=!0}),stockSearchMenu.bind("mouseleave",function(){_isOverStockSearchMenu=!1}),searchBox.bind("focus",function(){searchBox.val()==searchDefault&&searchBox.val("")}).bind("keyup",function(){if(searchBox.val()==""){stockSearchMenu.hide();return}isHtml(searchBox.val())||$.getJSON(MarketDataServiceUrl+"/GetTopNReutersSearch?symbolBeginsWith="+searchBox.val()+"&pageSize=5&pageNo=0",function(result){var templateUrl,container,moreUrl,newMoreUrl;result!=undefined&&result.length>0?(templateUrl=Agility.ResolveUrl("~/ClientTemplates/ReutersSearchResults.htm"),container=$("#NewHeader_StockSearch .Results"),container.setTemplateURL(templateUrl),container.processTemplate(result),_updateNewStockSearchPosition(searchBox,stockSearchMenu),stockSearchMenu.show(),moreUrl=$(".MoreResults a",stockSearchMenu).attr("href"),newMoreUrl=moreUrl.substring(0,moreUrl.indexOf("Search.aspx")+11)+"?query="+searchBox.val(),$(".MoreResults a",stockSearchMenu).attr("href",newMoreUrl),container.children(".DataItem").bind("mouseenter",function(){$(this).addClass("Hover")}),container.children(".DataItem").bind("mouseleave",function(){$(this).removeClass("Hover")})):stockSearchMenu.hide()})}).bind("blur",function(){searchBox.val()==""&&searchBox.val(searchDefault),_isOverStockSearchMenu?stockSearchMenu.bind("mouseleave",function(){stockSearchMenu.hide()}):stockSearchMenu.hide()}).bind("keydown",function(event){(event.which||event.keyCode)&&(event.which==13||event.keyCode==13)&&$(this).next().trigger("click")}),$("#btnHeaderSearch").bind("click",function(){var query=searchBox.val();query!=""&&query!=searchDefault?isHtml(query)?alert("please enter a valid search term"):window.location=Agility.ResolveUrl("~/Search.aspx")+"?query="+escape(query):alert("please enter a valid search term")}),pUri=BNN.Modules.DFPAdModule.parseUri(window.location),directoryPath=pUri.directory.toLowerCase().split("/"),directoryPath[1]=="test2636176"&&pUri.file.toLowerCase().replace(".aspx",""
).replace("-","")=="test_home"&&(bkgImageUrl=GetQuerystring("bkgImageUrl",null),bkgImageUrl!=""&&(wrapFlag=!0,$("#NewHeader_Menu").css("width","970px"),$("#NewHeader_Menu").css("margin","0 auto"),$("#NewHeader_BreakingNews").css("width","970px"),$("#NewHeader_BreakingNews").css("margin","0 auto"),$("body").css("background-color","#fff"),$("body").css("background-position","top center"),$("body").css("background-attachment","fixed"),$("body").css("background-repeat","no-repeat"),$("body").css("background-image","url("+bkgImageUrl+")"),$("body").css("cursor","top center")))},GetQuerystring=function(key,default_){default_==null&&(default_=""),key=key.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var regex=new RegExp("[\\?&]"+key+"=([^&#]*)"),qs=regex.exec(window.location.href);return qs==null?default_:qs[1]},_updateMenuPosition=function(linkElement,menuElement){if(linkElement.length>0&&menuElement.length>0){var homeLink=$("#NewHeader_Links a").filter(function(){return $(this).html().toLowerCase().indexOf("home")!=-1}),x=homeLink.position().left,y=linkElement.offset().top+linkElement.height()+10;menuElement.css("left",x+"px"),menuElement.css("top",y+"px")}},_updateNewsMenuPosition=function(linkElement,menuElement){if(linkElement.length>0&&menuElement.length>0){var x=linkElement.position().left,y=linkElement.offset().top+linkElement.height()+10;menuElement.css("left",x+"px"),menuElement.css("top",y+"px")}},_updateSpecialCoverageMenuPosition=function(linkElement,menuElement){if(linkElement.length>0&&menuElement.length>0){var x=linkElement.position().left+linkElement.outerWidth()-menuElement.outerWidth(),y=linkElement.offset().top+linkElement.height()+10;menuElement.css("left",x+"px"),menuElement.css("top",y+"px")}},_updateVideoMenuPosition=function(linkElement,menuElement){if(linkElement.length>0&&menuElement.length>0){var x=linkElement.position().left,y=linkElement.offset().top+linkElement.height()+5;menuElement.css("left",x+"px"),menuElement.css("top",y+"px")}},_updateNewStockSearchPosition=function(searchBoxElement,stockSearchMenuElement){if(searchBoxElement.length>0&&stockSearchMenuElement.length>0){var x=searchBoxElement.offset().left-4,y=searchBoxElement.offset().top+searchBoxElement.height();stockSearchMenuElement.css("left",x+"px"),stockSearchMenuElement.css("top",y+"px")}},isHtml=function(testString){return/<|>|"|'|\/|=|\\/i.test(testString)}}(BNN.Controls.NewHeader);
Agility.RegisterNamespace("BNN.Controls.DynamicStockQuotes"),function(DSQ,$){var defaults={Container:{}},properties=null,sponsor=null,stockElemClassKey=".DynamicStockQuote",_getStockQuote,_formatData;DSQ.OnLoad=function(s){sponsor=s,$(stockElemClassKey).each(function(){var symbol=$(this).text();symbol!=""&&_getStockQuote($(this),symbol)})},_getStockQuote=function(obj,symbol){$.getJSON(MarketDataServiceUrl+"/GetStockQuote?symbol="+symbol+"",function(result){var stockLink,percentChange,ds_con,container,templateUrl,CssClass,cName;if(result!=undefined){stockLink=$("<a class='DSQ'></a>").attr("href",StockPageUrl+result.Ticker).text(result.Ticker),obj.text(""),obj.append(stockLink);var change=result.NetChange,fltChange=parseFloat(change),spanChange=$("<span></span>");fltChange>0?spanChange.addClass("Positive"):fltChange<0&&spanChange.addClass("Negative"),percentChange=result.PercentChange,percentChange!=null&&percentChange!=""&&(spanChange.append("&nbsp;"),spanChange.append(_formatData(percentChange)+"%")),obj.append(spanChange),ds_con=$("<div class='tooltip'></div>"),obj.find("a.DSQ").after(ds_con),container=obj.find("a").next(),templateUrl=Agility.ResolveUrl("~/ClientTemplates/DynamicStockQuote.htm"),container.html(""),CssClass=result.NetChange==undefined||result.NetChange==""?"Neutral":result.NetChange.indexOf("-")==0?"Negative":"Positive",$.getJSON(MarketDataServiceUrl+"/GetReutersCompanySnapshot?symbol="+symbol+"",function(){}).done(function(snapResult){var CompanyName,mCap,$chartContainer,$videoContainer;snapResult!=undefined&&(cName=snapResult.CompanyName,mCap=snapResult.RatioGroups[1].Ratios[0].Value),CompanyName=cName!=undefined||cName!=null?cName:result.CompanyName,container.hasTemplate()||(container.setTemplateURL(templateUrl),container.setParam("CssClass",CssClass),container.setParam("CompanyName",CompanyName),container.setParam("MarketCap",mCap)),container.processTemplate(result),$chartContainer=obj.find("a.DSQ").next().find(".Chart"),$videoContainer=obj.find("a.DSQ").next().find(".relatedVideo"),BNN.Controls.TimeSeriesChart.HighChartDynamicStockQuote($chartContainer,result),DSQ.searchInAxis(result.Ticker,$videoContainer),sponsor!=null||sponsor!=""?($("#DynamicQuote  div.sponsor").show(),$("#DynamicQuote  div.sponsor").html(sponsor)):$("#DynamicQuote  div.sponsor").hide(),obj.find("a.DSQ").tooltip({effect:"slide",position:"center right",offset:[10,0]})})}})},DSQ.GetStockURL=function(symbol){if(symbol!=null||symbol!="")return StockPageUrl+symbol},DSQ.searchInAxis=function(searchFor,$container){var total=0;SearchFor=searchFor,$.ajaxSetup({cache:!0}),$.ajax({url:AxisShowServiceURL+"/contents?$inlinecount=true&$include=["+fieldNames+"]&$top=1&$sort=BroadcastDate&$order=desc&$search="+escape(searchFor),contentType:"application/json;",dataType:"jsonp",cache:!0,jsonpCallback:"getJsonFromCAPI_DynamicStockQuote_searchInAxis_"+searchFor.replace(".","_"),success:function(){}}).done(function(jsonResponse){var result=jsonResponse,templateUrl;result.Count>0?(templateUrl=Agility.ResolveUrl("~/ClientTemplates/DynamicStockQuoteVideoResult.htm"),$container.setTemplateURL(templateUrl),$container.processTemplate(result.Items)):$container.hide()})},_formatData=function(data){var tmp=data,tmpFloat,tmpStr;return tmp.indexOf(".")==0?tmp="0"+tmp:tmp.indexOf("-.")==0&&(tmp="-0."+tmp.substring(2)),tmpFloat=Math.round(100*parseFloat(tmp))/100,tmpStr=tmpFloat.toString(),tmpStr.indexOf(".")<0&&(tmpStr+=".00"),tmpStr.indexOf(".")==tmpStr.length-2&&(s+="0"),tmpStr}}(BNN.Controls.DynamicStockQuotes,jQuery);
Agility.RegisterNamespace("BNN.Controls.Tracking"),function(CT){CT.OnInit=function(p){if(!(p.ContentID<=0)){var cacheKey=p.ContentRefName+"-"+p.ContentID,searchArg={RecordTypeName:"AccessTracking",Search:"Key = '"+cacheKey+"'",CacheKey:cacheKey};Agility.UGC.API.ClearCache(cacheKey,function(){Agility.UGC.API.SearchRecords(searchArg,function(data){var count,record;data.ResponseType!=Agility.UGC.API.ResponseType.OK||(count=0,data.ResponseData.TotalRecords>0&&(count=eval(data.ResponseData.Records[0].Count)),count++,record={ID:data.ResponseData.TotalRecords==0?-1:data.ResponseData.Records[0].ID,RecordTypeName:"AccessTracking",Key:p.ContentRefName+"-"+p.ContentID,Title:p.ContentTitle,ContentDate:p.ContentDate,Count:count},Agility.UGC.API.SaveRecord(record,function(data){data.ResponseType!=0},cacheKey))})})}}}(BNN.Controls.Tracking,jQuery);
Agility.RegisterNamespace("BNN.Controls.Pager"),function(Pager){function configLinks(){$(".Links a.Page",$pager).each(function(){bindPageFn($(this),parseInt($(this).text()))}),bindPageFn($previousBtn,Pager.CurrentPage-1),bindPageFn($nextBtn,Pager.CurrentPage+1)}function pageLink(pageNum){if(pageNum!=Pager.CurrentPage){var $page=$('<a class="Page"></a>').text(pageNum).attr("href",getPageUrl(pageNum));return bindPageFn($page,pageNum)}return $('<a class="CurrentPage"></a>').text(pageNum)}function bindPageFn($p,num){return $p.unbind("click").bind("click",function(){return Pager.CurrentPage=num,$.isFunction(properties.LoadFn)&&properties.LoadFn(),!1}),$p}function getPageUrl(pageNum){return itemType.indexOf("Pick")>=0?location.protocol+"//"+location.hostname+location.pathname+setUrlEncodedKey("PicksPage",pageNum):location.protocol+"//"+location.hostname+location.pathname+setUrlEncodedKey("page",pageNum)}function setUrlEncodedKey(key,value,query){query=query||window.location.search;var q=query+"&",re=new RegExp("[?|&]"+key+"=.*?&");return re.test(q)?q=q.replace(re,"&"+key+"="+encodeURIComponent(value)+"&"):q+=key+"="+encodeURI(value),q=q.trimStart("&").trimEnd("&"),q[0]=="?"?q:q="?"+q}var properties=null,$pager,$nextBtn,$previousBtn,itemType,currentPage=1,postsPerPage=10;Pager.CurrentPage=1,Pager.OnInit=function(p){properties=p,$pager=$("#"+properties.PagerID),$nextBtn=$("#"+properties.NextID),$previousBtn=$("#"+properties.PreviousID),itemType=properties.Type,postsPerPage=properties.PostsPerPage,Pager.CurrentPage=properties.CurrentPage,configLinks()},Pager.Render=function(numItems){var numPages=Math.ceil(numItems/postsPerPage),currentPage=Pager.CurrentPage,links=$('<span class="Links"></span>'),i;if(numItems==0||numPages<=1){$pager.hide();return}for(currentPage<=1?$previousBtn.hide():$previousBtn.attr("href",getPageUrl(currentPage-1)).show(),currentPage>=numPages?$nextBtn.hide():$nextBtn.attr("href",getPageUrl(currentPage+1)).show(),links.append(pageLink(1)),currentPage>4&&links.append($("<span>...</span>")),i=Math.max(2,currentPage-2);i<=Math.min(numPages-1,currentPage+2);i++)links.append(pageLink(i));currentPage<numPages-3&&links.append($("<span>...</span>")),links.append(pageLink(numPages)),configLinks(),$(".Links",$pager).replaceWith(links).show()},String.prototype.trimEnd=function(c){return c?this.replace(new RegExp(c.escapeRegExp()+"*$"),""):this.replace(/\s+$/,"")},String.prototype.trimStart=function(c){return c?this.replace(new RegExp("^"+c.escapeRegExp()+"*"),""):this.replace(/^\s+/,"")},String.prototype.escapeRegExp=function(){return this.replace(/[.*+?^${}()|[\]\/\\]/g,"\\$0")}}(BNN.Controls.Pager);
Agility.RegisterNamespace("BNN.Controls.PicksPager"),function(PicksPager){function configLinks(){$(".Links a.Page",$pager).each(function(){bindPageFn($(this),parseInt($(this).text()))}),bindPageFn($previousBtn,PicksPager.CurrentPage-1),bindPageFn($nextBtn,PicksPager.CurrentPage+1)}function pageLink(pageNum){if(pageNum!=PicksPager.CurrentPage){var $page=$('<a class="Page"></a>').text(pageNum).attr("href",getPageUrl(pageNum));return bindPageFn($page,pageNum)}return $('<a class="CurrentPage"></a>').text(pageNum)}function bindPageFn($p,num){return $p.unbind("click").bind("click",function(){return PicksPager.CurrentPage=num,$.isFunction(properties.LoadFn)&&properties.LoadFn(),!1}),$p}function getPageUrl(pageNum){return itemType.indexOf("Pick")>=0?location.protocol+"//"+location.hostname+location.pathname+setUrlEncodedKey("PicksPage",pageNum):location.protocol+"//"+location.hostname+location.pathname+setUrlEncodedKey("page",pageNum)}function setUrlEncodedKey(key,value,query){query=query||window.location.search;var q=query+"&",re=new RegExp("[?|&]"+key+"=.*?&");return re.test(q)?q=q.replace(re,"&"+key+"="+encodeURIComponent(value)+"&"):q+=key+"="+encodeURI(value),q=q.trimStart("&").trimEnd("&"),q[0]=="?"?q:q="?"+q}var properties=null,$pager,$nextBtn,$previousBtn,itemType,currentPage=1,postsPerPage=10;PicksPager.CurrentPage=1,PicksPager.OnInit=function(p){properties=p,$pager=$("#"+properties.PagerID),$nextBtn=$("#"+properties.NextID),$previousBtn=$("#"+properties.PreviousID),itemType=properties.Type,postsPerPage=properties.PostsPerPage,PicksPager.CurrentPage=properties.CurrentPage,configLinks()},PicksPager.Render=function(numItems){var numPages=Math.ceil(numItems/postsPerPage),currentPage=PicksPager.CurrentPage,links=$('<span class="Links"></span>'),i;if(numItems==0||numPages<=1){$pager.hide();return}for(currentPage<=1?$previousBtn.hide():$previousBtn.attr("href",getPageUrl(currentPage-1)).show(),currentPage>=numPages?$nextBtn.hide():$nextBtn.attr("href",getPageUrl(currentPage+1)).show(),links.append(pageLink(1)),currentPage>4&&links.append($("<span>...</span>")),i=Math.max(2,currentPage-2);i<=Math.min(numPages-1,currentPage+2);i++)links.append(pageLink(i));currentPage<numPages-3&&links.append($("<span>...</span>")),links.append(pageLink(numPages)),configLinks(),$(".Links",$pager).replaceWith(links).show()},String.prototype.trimEnd=function(c){return c?this.replace(new RegExp(c.escapeRegExp()+"*$"),""):this.replace(/\s+$/,"")},String.prototype.trimStart=function(c){return c?this.replace(new RegExp("^"+c.escapeRegExp()+"*"),""):this.replace(/^\s+/,"")},String.prototype.escapeRegExp=function(){return this.replace(/[.*+?^${}()|[\]\/\\]/g,"\\$0")}}(BNN.Controls.PicksPager);
Agility.RegisterNamespace("BNN.Controls.VideoPlayer"),function(VideoPlayer){var properties=null,clipId,instanceId,width,height,mode;VideoPlayer.Load=function(p){var container;if(properties=p,clipId=properties.ClipId,instanceId=properties.InstanceId,width=properties.Width,height=properties.Height,mode=properties.Mode,(width==undefined||width==null)&&(width=300),(height==undefined||height==null)&&(height=225),container=$("#"+instanceId),container.size()>0&&container.html(""),clipId!=null&&clipId.length>0){container.show(),templateUrl=Agility.ResolveUrl("~/ClientTemplates/VideoPlayer.htm"),container.setTemplateURL(templateUrl),container.setParam("ClipId",clipId),container.setParam("Width",width),container.setParam("Height",height),container.setParam("Mode",mode),container.processTemplate([]),Interface.PermalinkClicked=function(url){Playlist.GetInstance().Current.IsAd&&window.open(url,"player")},Interface.GetInstance().PlayerViewer=document.getElementById(instanceId),Playlist.FeaturedVideos=[],Playlist.FeaturedVideos.push(new Video({Title:properties.Description,Format:"FLV",ClipId:clipId,Permalink:"http://watch.bnn.ca/Redirect/?ClipId="+clipId}));var dartSiteId="ctv.bnnwatch.ca",pUri=parseUri(window.location),directoryPath=pUri.directory.toLowerCase().split("/");pUri.file.length>0&&pUri.file.toLowerCase()=="videoplayer.aspx"&&(pUri=parseUri(window.top.location),directoryPath=pUri.directory.toLowerCase().split("/")),(directoryPath[1]=="shows"||directoryPath[1]=="features")&&pUri.file.length>0&&(dartSiteId+="/"+pUri.file.toLowerCase().replace(".aspx","").replace(/-/g,"")),new Framework(Format.FlashVideo,3,"chumtvbnn","One Clip Player",dartSiteId,"/Controls/OneClipTheme.aspx?Size="+width+","+height,"/Handlers/VideoThumb.ashx?Clip="+clipId+","+width+","+height+","+mode)}else container.hide()}}(BNN.Controls.VideoPlayer);
Agility.RegisterNamespace("BNN.Controls.TimeSeriesChart"),function(TimeSeriesChart){function getColor(symbol){return $("#ResultContainer .seriesLink[data-value='"+symbol+"']").css("background-color")}var IntraDayStartTime=null,IntraDayEndTime=null,FiveDayStartTime=null,FiveDayEndTime=null,OneYearStartTime=null,OneYearEndTime=null,DaysOfWeek=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],Flot5Days=null,INTR_Plot=null,updateTooltipTimeout=null,latestPosition=null,legends=null,seriesColors=["#4673b1","#000000","#ffff00","#cccccc","#00ccff"];TimeSeriesChart.OnLoad=function(p){IntraDayStartTime=p.IntradayStartTime,IntraDayEndTime=p.IntradayEndTime,FiveDayStartTime=p.FiveDayStartTime,FiveDayEndTime=p.FiveDayEndTime,OneYearStartTime=p.OneYearStartTime,OneYearEndTime=p.OneYearEndTime,Flot5Days=p.Flot5Days},TimeSeriesChart.HighChartHomePageINTRA=function(container,quote){var currentDate=new Date,cls=quote.Gv1_Text!=null?$.trim(quote.Gv1_Text):"_",isClosed=cls=="CLS"?!0:!1,isWeekend=currentDate.getDay()%6==0,ChartDate=quote.NetChange==0&&quote.Volume==0||isWeekend||isClosed?new Date(parseInt(quote.HistoricalCloseDate.replace("/Date(","").replace(")/",""),10)):currentDate,formatStart=ChartDate.getDate()+"/"+(ChartDate.getMonth()+1)+"/"+ChartDate.getFullYear()+"/9:30:00/AM",formatEnd=ChartDate.getDate()+"/"+(ChartDate.getMonth()+1)+"/"+ChartDate.getFullYear()+"/16:30:00/PM",OneYearcloseArray=[];$.getJSON(MarketDataServiceUrl+"/GetReutersIntradayTimeSeriesForChart?symbol="+quote.Ticker+"&startdate="+formatStart+"&enddate="+formatEnd+"&type=1day&interval=minute",function(result){for(var chart,i=0;i<result.CloseData.length;i++)result.VolumeData[i].Volume>0&&OneYearcloseArray.push([+new Date(parseInt(result.CloseData[i].SeriesDate.replace("/Date(","").replace(")/",""),10)),result.CloseData[i].Close]);Highcharts.setOptions({global:{useUTC:!1}}),chart=$(container).highcharts("StockChart",{chart:{height:82,width:186,backgroundColor:"rgba(255, 255, 255, 0)"},xAxis:{gridLineWidth:1,showAxes:!0,tickPixelInterval:40,dateTimeLabelFormats:{day:"%e of %b"},labels:{style:{fontSize:"8px"}}},yAxis:{gridLineWidth:1,tickPixelInterval:20,opposite:!1,labels:{style:{fontSize:"8px"},align:"right",x:-5,y:0}},plotOptions:{series:{pointStart:Date.UTC(ChartDate.getFullYear(),ChartDate.getMonth(),ChartDate.getDate(),14,30,0)},fillOpacity:1},tooltip:{enabled:!1},navigator:{enabled:!1},rangeSelector:{enabled:!1},credits:{enabled:!1},scrollbar:{enabled:!1},hover:{enabled:!1},series:[{type:"area",name:"close",yAxis:0,color:"#4673b1",data:OneYearcloseArray,threshold:null,marker:{symbol:"circle"}}]})})},TimeSeriesChart.HighChartDynamicStockQuote=function(con,quote){var currentDate=new Date,cls=quote.Gv1_Text!=null?$.trim(quote.Gv1_Text):"_",isClosed=cls=="CLS"?!0:!1,isWeekend=currentDate.getDay()%6==0,ChartDate=quote.NetChange==0&&quote.Volume==0||isWeekend||isClosed?new Date(parseInt(quote.HistoricalCloseDate.replace("/Date(","").replace(")/",""),10)):currentDate,formatStart=ChartDate.getDate()+"/"+(ChartDate.getMonth()+1)+"/"+ChartDate.getFullYear()+"/9:30:00/AM",formatEnd=ChartDate.getDate()+"/"+(ChartDate.getMonth()+1)+"/"+ChartDate.getFullYear()+"/16:30:00/PM",OneYearcloseArray=[],ajaxParam=TimeSeriesChart.BuildAjaxParameters("1year",ChartDate);$.getJSON(MarketDataServiceUrl+"/"+ajaxParam.method+"?symbol="+quote.Ticker+"&startdate="+ajaxParam.startDate+"&enddate="+ajaxParam.endDate+"&interval="+ajaxParam.interval,function(result){for(var chart,i=0;i<result.CloseData.length;i++)result.VolumeData[i].Volume>0&&OneYearcloseArray.push([+new Date(parseInt(result.CloseData[i].SeriesDate.replace("/Date(","").replace(")/",""),10)),result.CloseData[i].Close]);Highcharts.setOptions({global:{useUTC:!1}}),chart=$(con).highcharts("StockChart",{chart:{height:180,width:300,backgroundColor:"rgba(255, 255, 255, 0)"},xAxis:{gridLineWidth:1,showAxes:!0,labels:{style:{fontSize:"8px"}}},yAxis:{gridLineWidth:1,tickPixelInterval:20,opposite:!1,labels:{style:{fontSize:"8px"},align:"right",x:-5,y:0,style:{color:Highcharts.getOptions().colors[0]}}},tooltip:{valueDecimals:2},navigator:{enabled:!1},rangeSelector:{enabled:!1},credits:{enabled:!1},scrollbar:{enabled:!1},hover:{enabled:!1},series:[{type:"area",name:"close "+quote.Ticker,yAxis:0,color:"#4673b1",data:OneYearcloseArray,threshold:null,marker:{symbol:"circle"}}]})})},TimeSeriesChart.HighChartINTRA=function(container,quote){var currentDate=new Date,cls=quote.Gv1_Text!=null?$.trim(quote.Gv1_Text):"_",isClosed=cls=="CLS"?!0:!1,isWeekend=currentDate.getDay()%6==0,ChartDate=quote.NetChange==0&&quote.Volume==0||isWeekend||isClosed?new Date(parseInt(quote.HistoricalCloseDate.replace("/Date(","").replace(")/",""),10)):currentDate,formatStart=ChartDate.getDate()+"/"+(ChartDate.getMonth()+1)+"/"+ChartDate.getFullYear()+"/9:30:00/AM",formatEnd=ChartDate.getDate()+"/"+(ChartDate.getMonth()+1)+"/"+ChartDate.getFullYear()+"/16:30:00/PM",CloseArray=[],VolArray=[],height=$(container).height();$(container).html('<div class="VideoLoading">'),$(container+" .VideoLoading").css("height",height+"px"),$.getJSON(MarketDataServiceUrl+"/GetReutersIntradayTimeSeriesForChart?symbol="+quote.Ticker+"&startdate="+formatStart+"&enddate="+formatEnd+"&interval=minute",function(result){var i,chart;if(result!=undefined||result!=null){for(i=0;i<result.CloseData.length;i++)result.VolumeData[i].Volume>0&&(CloseArray.push([+new Date(parseInt(result.CloseData[i].SeriesDate.replace("/Date(","").replace(")/",""),10)),result.CloseData[i].Close]),VolArray.push([+new Date(parseInt(result.VolumeData[i].SeriesDate.replace("/Date(","").replace(")/",""),10)),result.VolumeData[i].Volume]),$(container+" .VideoLoading").hide());Highcharts.setOptions({global:{useUTC:!1}}),chart=new $(container).highcharts("StockChart",{chart:{spacingLeft:0,spacingRight:0},xAxis:{gridLineWidth:1,showAxes:!0,labels:{formatter:function(){return Highcharts.dateFormat("%H:%M",this.value)},style:{fontSize:"8px"}}},yAxis:[{opposite:!1,title:{text:"Close Price",style:{color:Highcharts.getOptions().colors[0]},margin:50},labels:{align:"left",x:-40,style:{color:Highcharts.getOptions().colors[0]}}},{opposite:!0,title:{text:"Volume",style:{color:Highcharts.getOptions().colors[1]}},labels:{align:"left",x:10,style:{color:Highcharts.getOptions().colors[1]}}}],navigator:{enabled:!1},tooltip:{valueDecimals:2},rangeSelector:{enabled:!1},credits:{enabled:!1},scrollbar:{enabled:!1},hover:{enabled:!1},series:[{type:"area",name:"close",color:"#4673b1",yAxis:0,data:CloseArray,threshold:null,marker:{symbol:"circle"}},{color:"rgba(0,0,0,0.5)",type:"column",name:"vol.",yAxis:1,data:VolArray,threshold:null,marker:{symbol:"circle"}}]})}CloseArray.length<2&&($(container).highcharts().destroy(),$(container).html("<div class='chartError'>We're sorry, there's not enough data to process a one day chart.<br>Please try the next charting option.</div>"))})},TimeSeriesChart.HighChartStockDetailFiveDay=function(container,quote){var currentDate=new Date,cls=quote.Gv1_Text!=null?$.trim(quote.Gv1_Text):"_",isClosed=cls=="CLS"?!0:!1,isWeekend=currentDate.getDay()%6==0,ChartDate=quote.Change==0&&quote.Volume==0||isWeekend||isClosed?new Date(parseInt(quote.HistoricalCloseDate.replace("/Date(","").replace(")/",""),10)):currentDate;ChartDate.addBusDays(-5);var formatStart=ChartDate.getDate()+"/"+(ChartDate.getMonth()+1)+"/"+ChartDate.getFullYear()+"/00:00:00/PM",formatEnd=(new Date).getDate()+"/"+((new Date).getMonth()+1)+"/"+(new Date).getFullYear()+"/23:59:00/PM",CloseArray=[],VolArray=[],height=$(container).height();$(container).html('<div class="VideoLoading">'),$(container+" .VideoLoading").css("height",height+"px"),$.getJSON(MarketDataServiceUrl+"/GetReutersIntradayTimeSeriesForChart?symbol="+quote.Ticker+"&startdate="+formatStart+"&enddate="+formatEnd+"&interval=minute",function(result){for(var chart,i=0;i<result.CloseData.length;i++)result.VolumeData[i].Volume>0&&(CloseArray.push([+new Date(parseInt(result.CloseData[i].SeriesDate.replace("/Date(","").replace(")/",""),10)),result.CloseData[i].Close]),VolArray.push([+new Date(parseInt(result.VolumeData[i].SeriesDate.replace("/Date(","").replace(")/",""),10)),result.VolumeData[i].Volume]),$(container+" .VideoLoading").hide());Highcharts.setOptions({global:{useUTC:!1}}),chart=$(container).highcharts("StockChart",{chart:{spacingLeft:0,spacingRight:0},xAxis:{gridLineWidth:1,showAxes:!0},yAxis:[{opposite:!1,title:{text:"Close Price",style:{color:Highcharts.getOptions().colors[0]},margin:50},labels:{align:"left",x:-40,style:{color:Highcharts.getOptions().colors[0]}}},{opposite:!0,title:{text:"Volume",style:{color:Highcharts.getOptions().colors[1]}},labels:{align:"left",x:10,style:{color:Highcharts.getOptions().colors[1]}}}],navigator:{enabled:!1},tooltip:{valueDecimals:2},rangeSelector:{enabled:!1},credits:{enabled:!1},scrollbar:{enabled:!1},hover:{enabled:!1},series:[{type:"area",name:"close",yAxis:0,color:"#4673b1",data:CloseArray,threshold:null,marker:{symbol:"circle"}},{type:"column",name:"vol.",yAxis:1,color:"rgba(0,0,0,0.5)",data:VolArray,threshold:null,marker:{symbol:"circle"}}]}),CloseArray.length<2&&($(container).highcharts().destroy(),$(container).html("<div class='chartError'>We're sorry, there's not enough data to process a five day chart.<br>Please try the next charting option.</div>"))})},TimeSeriesChart.HighChartStockDetailOneYear=function(container,quote){var currentDate=new Date,cls=quote.Gv1_Text!=null?$.trim(quote.Gv1_Text):"_",isClosed=cls=="CLS"?!0:!1,isWeekend=currentDate.getDay()%6==0,ChartDate=quote.Change==0&&quote.Volume==0||isWeekend||isClosed?new Date(parseInt(quote.HistoricalCloseDate.replace("/Date(","").replace(")/",""),10)):currentDate;ChartDate.dateAdd("year",-4);var formatStart=ChartDate.getDate()+"/"+(ChartDate.getMonth()+1)+"/"+ChartDate.getFullYear()+"/00:00:00/PM",formatEnd=(new Date).getDate()+"/"+((new Date).getMonth()+1)+"/"+(new
 Date).getFullYear()+"/23:59:00/PM",CloseArray=[],VolArray=[],height=$(container).height();$(container).html('<div class="VideoLoading">'),$(container+" .VideoLoading").css("height",height+"px"),$.getJSON(MarketDataServiceUrl+"/GetReutersInterdayTimeSeriesForChart?symbol="+quote.Ticker+"&startdate="+formatStart+"&enddate="+formatEnd+"&interval=daily",function(result){for(var chart,i=0;i<result.CloseData.length;i++)result.VolumeData[i].Volume>0&&(CloseArray.push([+new Date(parseInt(result.CloseData[i].SeriesDate.replace("/Date(","").replace(")/",""),10)),result.CloseData[i].Close]),VolArray.push([+new Date(parseInt(result.VolumeData[i].SeriesDate.replace("/Date(","").replace(")/",""),10)),result.VolumeData[i].Volume]),$(container+" .VideoLoading").hide());Highcharts.setOptions({global:{useUTC:!1}}),chart=$(container).highcharts("StockChart",{chart:{spacingLeft:0,spacingRight:0},xAxis:{gridLineWidth:1,tickInterval:36e5,showAxes:!0},yAxis:[{opposite:!1,title:{text:"Close Price",style:{color:Highcharts.getOptions().colors[0]},margin:50},labels:{align:"left",x:-40,style:{color:Highcharts.getOptions().colors[0]}}},{opposite:!0,title:{text:"Volume",style:{color:Highcharts.getOptions().colors[1]}},labels:{align:"left",x:10,style:{color:Highcharts.getOptions().colors[1]}}}],navigator:{enabled:!1},tooltip:{valueDecimals:2},rangeSelector:{enabled:!1},credits:{enabled:!1},scrollbar:{enabled:!1},hover:{enabled:!1},series:[{type:"area",name:"close",yAxis:0,color:"#4673b1",data:CloseArray,threshold:null,marker:{symbol:"circle"}},{type:"column",name:"vol.",yAxis:1,color:"rgba(0,0,0,0.5)",data:VolArray,threshold:null,marker:{symbol:"circle"}}]})})},TimeSeriesChart.HighChartInterDay=function(container,quote){var currentDate=new Date,cls=quote.Gv1_Text!=null?$.trim(quote.Gv1_Text):"_",isClosed=cls=="CLS"?!0:!1,isWeekend=currentDate.getDay()%6==0,ChartDate=quote.Change==0&&quote.Volume==0||isWeekend||isClosed?new Date(parseInt(quote.HistoricalCloseDate.replace("/Date(","").replace(")/",""),10)):currentDate,DailyCloseArray=[],DailyVolArray=[],DailyChartDate=quote.NetChange==0&&quote.Volume==0||isWeekend||isClosed?new Date(parseInt(quote.HistoricalCloseDate.replace("/Date(","").replace(")/",""),10)):currentDate,DailyFormatStart=DailyChartDate.getDate()+"/"+(DailyChartDate.getMonth()+1)+"/"+DailyChartDate.getFullYear()+"/00:00:00/PM",DailyFormatEnd=(new Date).getDate()+"/"+((new Date).getMonth()+1)+"/"+(new Date).getFullYear()+"/16:30:00/PM",dailyCounter;ChartDate.dateAdd("year",-4);var formatStart=ChartDate.getDate()+"/"+(ChartDate.getMonth()+1)+"/"+ChartDate.getFullYear()+"/00:00:00/PM",formatEnd=(new Date).getDate()+"/"+((new Date).getMonth()+1)+"/"+(new Date).getFullYear()+"/23:59:00/PM",CloseArray=[],VolArray=[],height=$(container).height();$(container).html('<div class="VideoLoading">'),$(container+" .VideoLoading").css("height",height+"px"),dailyCounter=0,$.getJSON(MarketDataServiceUrl+"/GetReutersIntradayTimeSeriesForChart?symbol="+quote.Ticker+"&startdate="+DailyFormatStart+"&enddate="+DailyFormatEnd+"&interval=minute",function(dailyresult){if(dailyresult!=undefined||dailyresult!=null)for(var i=0;i<dailyresult.CloseData.length;i++)dailyresult.VolumeData[i].Volume>0&&(DailyCloseArray.push([+new Date(parseInt(dailyresult.CloseData[i].SeriesDate.replace("/Date(","").replace(")/",""),10)),dailyresult.CloseData[i].Close]),DailyVolArray.push([+new Date(parseInt(dailyresult.VolumeData[i].SeriesDate.replace("/Date(","").replace(")/",""),10)),dailyresult.VolumeData[i].Volume]),dailyCounter++,dailyCounter==dailyresult.CloseData.length&&$.getJSON(MarketDataServiceUrl+"/GetReutersInterdayTimeSeriesForChart?symbol="+quote.Ticker+"&startdate="+formatStart+"&enddate="+formatEnd+"&interval=daily",function(result){for(var combinedClose,combinedVolume,chart,i=0;i<result.CloseData.length;i++)result.VolumeData[i].Volume>0&&(CloseArray.push([+new Date(parseInt(result.CloseData[i].SeriesDate.replace("/Date(","").replace(")/",""),10)),result.CloseData[i].Close]),VolArray.push([+new Date(parseInt(result.VolumeData[i].SeriesDate.replace("/Date(","").replace(")/",""),10)),result.VolumeData[i].Volume]),$(container+" .VideoLoading").hide());CloseArray.concat(DailyCloseArray),VolArray.concat(DailyVolArray),$(container).attr("data-value-extreme",CloseArray[CloseArray.length-1][0]),combinedClose=CloseArray.concat(DailyCloseArray),combinedVolume=VolArray.concat(DailyVolArray),combinedClose.sort(function(x,y){return x[0]-y[0]}),combinedVolume.sort(function(x,y){return x[0]-y[0]}),Highcharts.setOptions({global:{useUTC:!1}}),chart=$(container).highcharts("StockChart",{chart:{spacingLeft:0,spacingRight:0,zoomType:"x"},xAxis:{gridLineWidth:1,showAxes:!0,events:{afterSetExtremes:function(e){var tDate,sDate,tstamp,date;e.trigger=="rangeSelectorButton"&&e.rangeSelectorButton.text=="1m"?(tstamp=$(container).attr("data-value-extreme"),date=new Date(parseInt(tstamp)),date.dateAdd("month",-1),setTimeout(function(){Highcharts.charts[0].xAxis[0].setExtremes(date.getTime(),parseInt(tstamp))},1)):e.trigger=="rangeSelectorButton"&&e.rangeSelectorButton.text=="1d"?(tDate=new Date(parseInt(DailyCloseArray[DailyCloseArray.length-1][0])),sDate=new Date(tDate.setHours(9,0,0,0)),Highcharts.charts[0].rangeSelector.buttons[0].setState(2),Highcharts.charts[0].xAxis[0].setExtremes(sDate.getTime(),parseInt(DailyCloseArray[DailyCloseArray.length-1][0]))):e.trigger=="rangeSelectorButton"&&e.rangeSelectorButton.text=="5d"&&(tstamp=$(container).attr("data-value-extreme"),date=new Date(parseInt(tstamp)),date.addBusDays(-5),setTimeout(function(){Highcharts.charts[0].xAxis[0].setExtremes(date.getTime(),parseInt(tstamp))},1))}}},yAxis:[{opposite:!1,title:{text:"Close Price",style:{color:Highcharts.getOptions().colors[0]},margin:50},labels:{align:"left",x:-40,style:{color:Highcharts.getOptions().colors[0]}}},{opposite:!0,title:{text:"Volume",style:{color:Highcharts.getOptions().colors[1]}},labels:{align:"left",x:10,style:{color:Highcharts.getOptions().colors[1]}}}],navigator:{enabled:!0},tooltip:{valueDecimals:2},rangeSelector:{allButtonsEnabled:!0,inputEnabled:$(container).width()>480,selected:0,buttons:[{type:"day",count:1,text:"1d"},{type:"day",count:5,text:"5d"},{type:"month",count:1,text:"1m"},{type:"month",count:3,text:"3m"},{type:"month",count:6,text:"6m"},{type:"ytd",text:"YTD"},{type:"year",count:1,text:"1y"},{type:"all",text:"All"}]},credits:{enabled:!1},scrollbar:{enabled:!1},hover:{enabled:!1},series:[{type:"area",name:"close",yAxis:0,data:combinedClose,threshold:null,marker:{symbol:"circle"}},{color:"rgba(0,0,0,0.5)",type:"column",name:"vol.",yAxis:1,data:combinedVolume,threshold:null,marker:{symbol:"circle"}}]})}))})},TimeSeriesChart.TestCombinedSeries=function(container,symbol){var OneYearcloseArray=[],OneYearVolArray=[];$.getJSON(MarketDataServiceUrl+"/TestCombinedSeries?symbol="+symbol+"&startdate="+OneYearStartTime+"&enddate="+OneYearEndTime,function(result){for(var i=0;i<result.CloseData.length;i++)OneYearcloseArray.push([+new Date(parseInt(result.CloseData[i].SeriesDate.replace("/Date(","").replace(")/",""),10)),result.CloseData[i].Close]),OneYearVolArray.push([+new Date(parseInt(result.VolumeData[i].SeriesDate.replace("/Date(","").replace(")/",""),10)),result.VolumeData[i].Volume]);$(container).highcharts("StockChart",{xAxis:{gridLineWidth:1},rangeSelector:{buttons:[{type:"hour",count:1,text:"1 H"},{type:"day",count:1,text:"1d"},{type:"day",count:5,text:"5d"},{type:"month",count:1,text:"1m"},{type:"month",count:3,text:"3m"},{type:"month",count:6,text:"6m"},{type:"YTD",text:"YTD"},{type:"year",count:1,text:"1y"},{type:"all",text:"All"}],selected:1},yAxis:[{opposite:!1,labels:{align:"left",x:10}},{opposite:!0,labels:{align:"left",x:10}}],series:[{type:"area",name:" ",yAxis:0,data:OneYearcloseArray,threshold:null,marker:{symbol:"circle"}},{type:"column",name:"vol.",yAxis:1,data:OneYearVolArray,threshold:null,marker:{symbol:"circle"}}]})})},TimeSeriesChart.HighChartMultipleSeriesINTRA=function(container,quote,type,symbolList){function createChart(){Highcharts.setOptions({global:{useUTC:!1}});var chart=new $(container).highcharts("StockChart",{chart:{spacingLeft:0,spacingRight:0},xAxis:{gridLineWidth:1,showAxes:!0,labels:{style:{fontSize:"8px"}}},yAxis:[{labels:{align:"right",x:-3,style:{color:Highcharts.getOptions().colors[0]}},title:{text:"Close Price",style:{color:Highcharts.getOptions().colors[0]}},height:"70%",lineWidth:2}],plotOptions:{series:{compare:"percent"}},navigator:{enabled:!0},tooltip:{valueDecimals:2},rangeSelector:{enabled:!1},credits:{enabled:!1},scrollbar:{enabled:!1},hover:{enabled:!1},series:seriesOptions})}var currentDate=new Date,cls=quote.Gv1_Text!=null?$.trim(quote.Gv1_Text):"_",isClosed=cls=="CLS"?!0:!1,isWeekend=currentDate.getDay()%6==0,ChartDate=quote.NetChange==0&&quote.Volume==0||isWeekend||isClosed?new Date(quote.HistoricalCloseDate):currentDate,ajaxParam=TimeSeriesChart.BuildAjaxParameters(type,ChartDate),arr=new Array(symbolList.length+1),seriesOptions=[],seriesCloseData=[],seriesVolData=[],seriesCounter=0,symbolArray=symbolList.split(",");$.each(symbolArray,function(i,symbol){var CloseArray=[];$.getJSON(MarketDataServiceUrl+"/"+ajaxParam.method+"?symbol="+symbol+"&startdate="+ajaxParam.startDate+"&enddate="+ajaxParam.endDate+"&interval="+ajaxParam.interval,function(result){for(var x=0;x<result.CloseData.length;x++)result.VolumeData[x].Volume>0&&CloseArray.push([+new Date(parseInt(result.CloseData[x].SeriesDate.replace("/Date(","").replace(")/",""),10)),result.CloseData[x].Close]),x==result.CloseData.length-1&&(seriesCloseData[i]=CloseArray);seriesOptions[i]={type:i==0?"area":"line",name:symbol,data:seriesCloseData[i],color:getColor(symbol),threshold:null,marker:{symbol:"circle"}},seriesCounter+=1,seriesCounter==symbolArray.length&&createChart()})})},TimeSeriesChart.StockChart=function(container,quote,type,navEnabled){var currentDate=new Date,cls=quote.Gv1_Text!=null?$.trim(quote.Gv1_Text):"_",isClosed=cls=="CLS"?!0:!1,isWeekend=currentDate
.getDay()%6==0,ChartDate=quote.NetChange==0&&quote.Volume==0||isWeekend||isClosed?new Date(quote.HistoricalCloseDate):currentDate,CloseArray=[],VolArray=[],ajaxParam=TimeSeriesChart.BuildAjaxParameters(type,ChartDate),height=$(container).height();$(container).html('<div class="VideoLoading">'),$(container+" .VideoLoading").css("height",height+"px"),$.getJSON(MarketDataServiceUrl+"/"+ajaxParam.method+"?symbol="+quote.Ticker+"&startdate="+ajaxParam.startDate+"&enddate="+ajaxParam.endDate+"&interval="+ajaxParam.interval,function(result){var i,chart;if(result!=undefined||result!=null){for(i=0;i<result.CloseData.length;i++)result.VolumeData[i].Volume>0&&(CloseArray.push([+new Date(parseInt(result.CloseData[i].SeriesDate.replace("/Date(","").replace(")/",""),10)),result.CloseData[i].Close]),VolArray.push([+new Date(parseInt(result.VolumeData[i].SeriesDate.replace("/Date(","").replace(")/",""),10)),result.VolumeData[i].Volume]),$(container+" .VideoLoading").hide());Highcharts.setOptions({global:{useUTC:!1}}),chart=new $(container).highcharts("StockChart",{chart:{spacingLeft:0,spacingRight:0},xAxis:{gridLineWidth:1,showAxes:!0,labels:{style:{fontSize:"8px"}}},yAxis:[{opposite:!1,labels:{align:"right",x:-3,style:{color:Highcharts.getOptions().colors[0]}},title:{text:"Close Price",style:{color:Highcharts.getOptions().colors[0]}},height:"70%",lineWidth:2},{labels:{align:"right",x:-3,style:{color:Highcharts.getOptions().colors[1]}},title:{text:"Volume",style:{color:Highcharts.getOptions().colors[1]}},top:"75%",height:"25%",offset:0,lineWidth:2}],navigator:{enabled:navEnabled},tooltip:{backgroundColor:"rgba(255,255,255,1)",valueDecimals:2,crosshairs:!0,shared:!0,followPointer:!0},rangeSelector:{enabled:!1},credits:{enabled:!1},scrollbar:{enabled:!1},hover:{enabled:!1},series:[{type:"area",id:"primary",name:"primary",data:CloseArray,threshold:null,marker:{symbol:"circle"}},{color:"rgba(0,0,0,0.5)",type:"column",name:"volume",yAxis:1,data:VolArray,threshold:null,marker:{symbol:"circle"}}]}),chart=$("#highStockContainer").highcharts(),BNN.Modules.InteractiveStockChart.AddSeriesResult(quote,chart.series[chart.series.length-1].color,chart),$("#IndicatorContainer .boxContainer input[type='checkbox']").each(function(){$(this).trigger("change")})}CloseArray.length<2&&($(container).highcharts().destroy(),$(container).html("<div class='chartError'>We're sorry, there's not enough data to process a one day chart.<br>Please try the next charting option.</div>"))})},TimeSeriesChart.StockDetailsChart=function(container,quote,type,navEnabled){var currentDate=new Date,isWeekend=currentDate.getDay()%6==0,hdate=new Date(parseInt(quote.HistoricalCloseDate.replace("/Date(","").replace(")/",""),10)),ChartDate;if(quote.Exchange=="NSQ"||quote.Exchange=="NSM")var isClosed=hdate<currentDate?!0:!1,isWeekend=currentDate.getDay()%6==0,ChartDate=quote.NetChange==0||isWeekend||isClosed?new Date(parseInt(quote.HistoricalCloseDate.replace("/Date(","").replace(")/",""),10)):currentDate;else isWeekend=currentDate.getDay()%6==0,ChartDate=quote.NetChange==0&&quote.Volume==0||isWeekend?new Date(parseInt(quote.HistoricalCloseDate.replace("/Date(","").replace(")/",""),10)):currentDate;var CloseArray=[],VolArray=[],ajaxParam=TimeSeriesChart.BuildAjaxParameters(type,ChartDate),height=$(container).height();$(container).html('<div class="VideoLoading">'),$(container+" .VideoLoading").css("height",height+"px"),$.getJSON(MarketDataServiceUrl+"/"+ajaxParam.method+"?symbol="+quote.Ticker+"&startdate="+ajaxParam.startDate+"&enddate="+ajaxParam.endDate+"&type="+ajaxParam.type+"&interval="+ajaxParam.interval,function(result){var i,quoteDate,currentUTC,chart;if(result!=undefined||result!=null){for(i=0;i<result.CloseData.length;i++)CloseArray.push([+new Date(parseInt(result.CloseData[i].SeriesDate.replace("/Date(","").replace(")/",""),10)),result.CloseData[i].Close]),VolArray.push([+new Date(parseInt(result.VolumeData[i].SeriesDate.replace("/Date(","").replace(")/",""),10)),result.VolumeData[i].Volume]),$(container+" .VideoLoading").hide();ajaxParam.type!="1day"&&ajaxParam.type!="5day"&&(quoteDate=new Date,currentUTC=Date.UTC(quoteDate.getFullYear(),quoteDate.getMonth(),quoteDate.getDate(),quoteDate.getHours(),quoteDate.getMinutes(),quoteDate.getSeconds(),0),CloseArray.push([currentUTC,parseFloat(quote.Last)]),VolArray.push([currentUTC,parseFloat(quote.Volume)])),Highcharts.setOptions({global:{useUTC:ajaxParam.type=="1day"||ajaxParam.type=="5day"?!1:!0}}),chart=new $(container).highcharts("StockChart",{chart:{spacingLeft:0,spacingRight:0},xAxis:{gridLineWidth:1,showAxes:!0,labels:{style:{fontSize:"8px"}}},yAxis:[{opposite:!1,labels:{align:"right",x:-3,style:{color:Highcharts.getOptions().colors[0]}},title:{text:"Close Price",style:{color:Highcharts.getOptions().colors[0]}},height:"80%",lineWidth:2},{labels:{align:"right",x:-3,style:{color:Highcharts.getOptions().colors[1]}},title:{text:"Volume",style:{color:Highcharts.getOptions().colors[1]}},top:"85%",height:"15%",offset:0,lineWidth:2}],navigator:{enabled:navEnabled},tooltip:{backgroundColor:"rgba(255,255,255,1)",valueDecimals:2,crosshairs:!0,shared:!0,followPointer:!0},rangeSelector:{enabled:!1},credits:{enabled:!1},scrollbar:{enabled:!1},hover:{enabled:!1},series:[{type:"area",id:"primary",name:"close: "+quote.Ticker,color:"#4673b1",data:CloseArray,threshold:null,marker:{symbol:"circle"},dataGrouping:{enabled:ajaxParam.type=="5year"||ajaxParam.type=="3year"?!0:!1}},{color:"rgba(0,0,0,0.5)",type:"column",name:"volume",yAxis:1,data:VolArray,threshold:null,marker:{symbol:"circle"},dataGrouping:{enabled:ajaxParam.type=="5year"||ajaxParam.type=="3year"?!0:!1}}]})}CloseArray.length<2&&($(container).highcharts().destroy(),$(container).html("<div class='chartError'>We're sorry, there's not enough data to process a one day chart.<br>Please try the next charting option.</div>"))})},TimeSeriesChart.StoryDetailStockChart=function(container,quote,type,navEnabled){var currentDate=new Date,cls=quote.Gv1_Text!=null?$.trim(quote.Gv1_Text):"_",isClosed=cls=="CLS"?!0:!1,isWeekend=currentDate.getDay()%6==0,ChartDate=quote.NetChange==0&&quote.Volume==0||isWeekend||isClosed?new Date(parseInt(quote.HistoricalCloseDate.replace("/Date(","").replace(")/",""),10)):currentDate,CloseArray=[],VolArray=[],ajaxParam=TimeSeriesChart.BuildAjaxParameters(type,ChartDate),height=$(container).height();$(container).html('<div class="VideoLoading">'),$(container+" .VideoLoading").css("height",height+"px"),$.getJSON(MarketDataServiceUrl+"/"+ajaxParam.method+"?symbol="+quote.Ticker+"&startdate="+ajaxParam.startDate+"&enddate="+ajaxParam.endDate+"&type="+ajaxParam.type+"&interval="+ajaxParam.interval,function(result){var i,quoteDate,currentUTC,chart;if(result!=undefined||result!=null){for(i=0;i<result.CloseData.length;i++)CloseArray.push([+new Date(parseInt(result.CloseData[i].SeriesDate.replace("/Date(","").replace(")/",""),10)),result.CloseData[i].Close]),VolArray.push([+new Date(parseInt(result.VolumeData[i].SeriesDate.replace("/Date(","").replace(")/",""),10)),result.VolumeData[i].Volume]),$(container+" .VideoLoading").hide();ajaxParam.type!="1day"&&ajaxParam.type!="5day"&&(quoteDate=new Date,currentUTC=Date.UTC(quoteDate.getFullYear(),quoteDate.getMonth(),quoteDate.getDate(),quoteDate.getHours(),quoteDate.getMinutes(),quoteDate.getSeconds(),0),CloseArray.push([currentUTC,parseFloat(quote.Last)]),VolArray.push([currentUTC,parseFloat(quote.Volume)])),Highcharts.setOptions({global:{useUTC:ajaxParam.type=="1day"||ajaxParam.type=="5day"?!1:!0}}),chart=new $(container).highcharts("StockChart",{chart:{spacingLeft:0,spacingRight:0,width:310,height:200,marginRight:10},xAxis:{gridLineWidth:1,showAxes:!0,labels:{style:{fontSize:"8px"}}},yAxis:[{opposite:!1,labels:{align:"right",x:-3,style:{color:Highcharts.getOptions().colors[0]}},title:{style:{color:Highcharts.getOptions().colors[0]}},lineWidth:2}],navigator:{enabled:navEnabled},tooltip:{backgroundColor:"rgba(255,255,255,1)",valueDecimals:2,crosshairs:!0,shared:!0,followPointer:!0},rangeSelector:{enabled:!1},credits:{enabled:!1},scrollbar:{enabled:!1},hover:{enabled:!1},series:[{type:"area",id:"primary",name:"close: "+quote.Ticker,color:"#4673b1",data:CloseArray,threshold:null,marker:{symbol:"circle"},dataGrouping:{enabled:ajaxParam.type=="5year"||ajaxParam.type=="3year"?!0:!1}}]})}CloseArray.length<2&&($(container).highcharts().destroy(),$(container).html("<div class='chartError'>We're sorry, there's not enough data to process a one day chart.<br>Please try the next charting option.</div>"))})},TimeSeriesChart.StoryDetailStockChartCompare=function(container,quotes,type,symbolList){function createChart(){Highcharts.setOptions({global:{useUTC:ajaxParam.type=="1day"||ajaxParam.type=="5day"?!1:!0}});var chart=new $(container).highcharts("StockChart",{chart:{spacingLeft:0,spacingRight:0,width:310,height:210,marginBottom:60,events:{load:function(){for(var chart=this,legend=chart.legend,item,i=0;i<legend.allItems.length;i++){item=legend.allItems[i].legendItem;item.on("mouseover",function(){$(this)[0].innerHTML=$(this)[0].innerHTML+" [x]"}).on("mouseout",function(){$(this)[0].innerHTML=$(this)[0].innerHTML.split(" ")[0]})}}}},legend:{enabled:!0,align:"center",verticalAlign:"bottom",floating:!0,x:0,y:10,itemStyle:{fontSize:"11px"}},xAxis:{gridLineWidth:1,showAxes:!0,labels:{style:{fontSize:"8px"}}},yAxis:[{opposite:!1,labels:{align:"right",x:-3,style:{color:Highcharts.getOptions().colors[0]},formatter:function(){return this.value!=0?this.value+"%":this.value}},title:{style:{color:Highcharts.getOptions().colors[0]}},lineWidth:2}],plotOptions:{series:{compare:"percent"}},navigator:{enabled:!1},tooltip:{valueDecimals:2},rangeSelector:{enabled:!1},credits:{enabled:!1},scrollbar:{enabled:!1},series:seriesOptions})}var currentDate=new Date,cls=quotes[0].Gv1_Text!=null?$.trim(quotes[0].Gv1_Text):"_",isClosed=cls=="CLS"?!0:!1,isWeekend=currentDate.getDay()%6==0,ChartDate=quotes[0].NetChange==0&&quotes[0].Volume==0||isWeekend||isClos
ed?new Date(parseInt(quotes[0].HistoricalCloseDate.replace("/Date(","").replace(")/",""),10)):currentDate,ajaxParam=TimeSeriesChart.BuildAjaxParameters(type,ChartDate),arr=new Array(symbolList.length+1),seriesOptions=[],seriesCloseData=[],seriesVolData=[],seriesCounter=0,symbolArray=symbolList.split(",");$.each(symbolArray,function(i,symbol){var CloseArray=[];symbol=$.trim(symbol),$.getJSON(MarketDataServiceUrl+"/"+ajaxParam.method+"?symbol="+symbol+"&startdate="+ajaxParam.startDate+"&enddate="+ajaxParam.endDate+"&type="+ajaxParam.type+"&interval="+ajaxParam.interval,function(result){for(var quoteDate,currentUTC,x=0;x<result.CloseData.length;x++)CloseArray.push([+new Date(parseInt(result.CloseData[x].SeriesDate.replace("/Date(","").replace(")/",""),10)),result.CloseData[x].Close]),x==result.CloseData.length-1&&(seriesCloseData[i]=CloseArray,ajaxParam.type!="1day"&&ajaxParam.type!="5day"&&(quoteDate=new Date,currentUTC=Date.UTC(quoteDate.getFullYear(),quoteDate.getMonth(),quoteDate.getDate(),quoteDate.getHours(),quoteDate.getMinutes(),quoteDate.getSeconds(),0),seriesCloseData[i].push([currentUTC,parseFloat(quotes[i].Last)])));seriesOptions[i]={type:i==0?"area":"line",name:symbol,data:seriesCloseData[i],color:i==0?"#4673b1":seriesColors[i],threshold:null,marker:{symbol:"circle"},dataGrouping:{enabled:ajaxParam.type=="5year"||ajaxParam.type=="3year"?!0:!1}},seriesCounter+=1,seriesCounter==symbolArray.length&&createChart()})})},TimeSeriesChart.AddSeries=function(quote,chart,seriesQuote,type){var currentDate=new Date,cls=quote.Gv1_Text!=null?$.trim(quote.Gv1_Text):"_",isClosed=cls=="CLS"?!0:!1,isWeekend=currentDate.getDay()%6==0,ChartDate=quote.NetChange==0&&quote.Volume==0||isWeekend||isClosed?new Date(quote.HistoricalCloseDate):currentDate,UpdateCloseArray=[],UpdateVolArray=[],returnQuote,counter=0,seriesClose=chart.series[0],seriesVol=chart.series[1],ajaxParam=TimeSeriesChart.BuildAjaxParameters(type,ChartDate),CloseArray;$.getJSON(MarketDataServiceUrl+"/"+ajaxParam.method+"?symbol="+quote.Ticker+"&startdate="+ajaxParam.startDate+"&enddate="+ajaxParam.endDate+"&type="+ajaxParam.type+"&interval="+ajaxParam.interval,function(AddPointResult){if(AddPointResult!=undefined||AddPointResult!=null){for(var i=0;i<AddPointResult.CloseData.length;i++)UpdateCloseArray.push([+new Date(parseInt(AddPointResult.CloseData[i].SeriesDate.replace("/Date(","").replace(")/",""),10)),AddPointResult.CloseData[i].Close]),UpdateVolArray.push([+new Date(parseInt(AddPointResult.VolumeData[i].SeriesDate.replace("/Date(","").replace(")/",""),10)),AddPointResult.VolumeData[i].Volume]);seriesClose.setData(UpdateCloseArray),seriesVol.setData(UpdateVolArray)}}),CloseArray=[],$.getJSON(MarketDataServiceUrl+"/"+ajaxParam.method+"?symbol="+seriesQuote.Ticker+"&startdate="+ajaxParam.startDate+"&enddate="+ajaxParam.endDate+"&interval="+ajaxParam.interval,function(result){if(result!=undefined||result!=null){for(var i=0;i<result.CloseData.length;i++)result.VolumeData[i].Volume>0&&CloseArray.push([+new Date(parseInt(result.CloseData[i].SeriesDate.replace("/Date(","").replace(")/",""),10)),result.CloseData[i].Close]);chart.addSeries({Id:seriesQuote.Ticker,name:seriesQuote.Ticker,data:CloseArray,type:"line"}),chart.yAxis[0].setCompare("percent"),BNN.Modules.InteractiveStockChart.AddSeriesResult(seriesQuote,chart.series[chart.series.length-1].color,chart,chart.series.length-1)}})},TimeSeriesChart.BuildAjaxParameters=function(type,chartDate){var AjaxParameters={startDate:"",endDate:"",method:"",interval:"",type:""},d;AjaxParameters.type=type;switch(type){case"1day":AjaxParameters.startDate=chartDate.format("d/m/yyyy/9:30:00"),AjaxParameters.endDate=chartDate.format("d/m/yyyy/23:59:00"),AjaxParameters.method="GetReutersIntradayTimeSeriesForChart",AjaxParameters.interval="minute";break;case"5day":chartDate.addBusDays(-5),AjaxParameters.startDate=chartDate.format("d/m/yyyy/00:00:00"),AjaxParameters.endDate=(new Date).format("d/m/yyyy/23:59:00"),AjaxParameters.method="GetReutersIntradayTimeSeriesForChart",AjaxParameters.interval="minute";break;case"1month":chartDate.dateAdd("month",-1),AjaxParameters.startDate=chartDate.format("d/m/yyyy/00:00:00/TT"),AjaxParameters.endDate=(new Date).format("d/m/yyyy/23:59:00/TT"),AjaxParameters.method="GetReutersInterdayTimeSeriesForChart",AjaxParameters.interval="daily";break;case"3month":chartDate.dateAdd("month",-3),AjaxParameters.startDate=chartDate.format("d/m/yyyy/00:00:00/TT"),AjaxParameters.endDate=(new Date).format("d/m/yyyy/23:59:00/TT"),AjaxParameters.method="GetReutersInterdayTimeSeriesForChart",AjaxParameters.interval="daily";break;case"6month":chartDate.dateAdd("month",-6),AjaxParameters.startDate=chartDate.format("d/m/yyyy/00:00:00/TT"),AjaxParameters.endDate=(new Date).format("d/m/yyyy/23:59:00/TT"),AjaxParameters.method="GetReutersInterdayTimeSeriesForChart",AjaxParameters.interval="daily";break;case"YTD":d=new Date(chartDate.format("yyyy"),0,1),AjaxParameters.startDate=d.format("d/m/yyyy/00:00:00/TT"),AjaxParameters.endDate=(new Date).format("d/m/yyyy/23:59:00/TT"),AjaxParameters.method="GetReutersInterdayTimeSeriesForChart",AjaxParameters.interval="daily";break;case"1year":chartDate.dateAdd("year",-1),AjaxParameters.startDate=chartDate.format("d/m/yyyy/00:00:00"),AjaxParameters.endDate=(new Date).format("d/m/yyyy/00:00:00"),AjaxParameters.method="GetReutersInterdayTimeSeriesForChart",AjaxParameters.interval="daily";break;case"3year":chartDate.dateAdd("year",-3),AjaxParameters.startDate=chartDate.format("d/m/yyyy/00:00:00/TT"),AjaxParameters.endDate=(new Date).format("d/m/yyyy/23:59:00/TT"),AjaxParameters.method="GetReutersInterdayTimeSeriesForChart",AjaxParameters.interval="daily";break;case"5year":chartDate.dateAdd("year",-5),AjaxParameters.startDate=chartDate.format("d/m/yyyy/00:00:00/TT"),AjaxParameters.endDate=(new Date).format("d/m/yyyy/23:59:00/TT"),AjaxParameters.method="GetReutersInterdayTimeSeriesForChart",AjaxParameters.interval="daily";break;case"max":chartDate.dateAdd("year",-5),AjaxParameters.startDate=chartDate.format("d/m/yyyy/00:00:00/TT"),AjaxParameters.endDate=(new Date).format("d/m/yyyy/23:59:00/TT"),AjaxParameters.method="GetReutersInterdayTimeSeriesForChart",AjaxParameters.interval="daily"}return AjaxParameters},Date.prototype.dateAdd=function(size,value){value=parseInt(value);var incr=0;switch(size){case"day":incr=value*24,this.dateAdd("hour",incr);break;case"hour":incr=value*60,this.dateAdd("minute",incr);break;case"week":incr=value*7,this.dateAdd("day",incr);break;case"minute":incr=value*60,this.dateAdd("second",incr);break;case"second":incr=value*1e3,this.dateAdd("millisecond",incr);break;case"month":value=value+this.getUTCMonth(),value/12>0&&(this.dateAdd("year",value/12),value=value%12),this.setUTCMonth(value);break;case"millisecond":this.setTime(this.getTime()+value);break;case"year":this.setFullYear(this.getUTCFullYear()+value);break;default:throw new Error("Invalid date increment passed");}},Number.prototype.mod=function(n){return(this%n+n)%n},Date.prototype.addBusDays=function(dd){var wks=Math.floor(dd/5),dys=dd.mod(5),dy=this.getDay();dy===6&&dys>-1&&(dys===0&&(dys-=2,dy+=2),dys++,dy-=6),dy===0&&dys<1&&(dys===0&&(dys+=2,dy-=2),dys--,dy+=6),dy+dys>5&&(dys+=2),dy+dys<1&&(dys-=2),this.setDate(this.getDate()+wks*7+dys)}}(BNN.Controls.TimeSeriesChart);
Agility.RegisterNamespace("BNN.Controls.AxisHubNavigation"),function(AxisHubNavigation){AxisHubNavigation.Init=function(){$(".vh-left-channel-switcher .switcher-list .switcher-box").bind("click",function(){$(this).next().is(":visible")?($(this).css("border","1px solid #ccc"),$(this).next().hide()):($(this).css("border-bottom","0"),$(this).next().show())}),$(".vh-left-channel-switcher .switcher-list .switcher-select").bind("mouseleave",function(){$(this).prev().css("border","1px solid #ccc"),$(this).hide()}),$(".vh-left-channel-switcher div.switcher-list ul.switcher-select li").live("click",function(){$(this).parent().hide(),$(this).parent().prev().html($(this).html()),$(this).parent().prev().attr("data-value",$(this).attr("data-value")),$(this).parent().prev().css("border","1px solid #ccc")}),$(".vh-left-channel-switcher div.switcher-button").bind("click",function(){var url=$(".vh-left-channel-switcher .switcher-list .switcher-box").attr("data-value");window.open(url)}),$(".vh-left-nav .vh-left-container .vh-nav-container ul li.nav-item").live("click",function(){var index=$(this).attr("data-index");(index!=null||index!=undefined||index!="undefined")&&BNN.Modules.AxisVideoHub.LoadNavClick(index)}),$(".vh-left-nav .vh-left-container .vh-nav-container ul li.nav-item").hover(function(){$(this).find(">:first-child").toggleClass("hover")}),$(".vh-left-nav .vh-left-container .vh-nav-container .vh-left-must-watch ul li.nav-item-mw").live("click",function(){BNN.Modules.AxisVideoHub.LoadMediaContent(1,$(this).attr("data-id"),$(this).find(">:first-child"))}),$(".vh-left-nav .vh-left-container .vh-nav-container .vh-left-must-watch ul li.nav-item-mw").hover(function(){$(this).find(">:first-child").toggleClass("hover")}),$(".vh-left-nav div.vh-left-container div.vh-nav-container div.vh-left-playlist").live("click",function(){BNN.Modules.AxisVideoHub.LoadPlayList()})}}(BNN.Controls.AxisHubNavigation);
var swfobject=function(){function f(){var Z,X,Y;if(!J){try{Z=j.getElementsByTagName("body")[0].appendChild(C("span")),Z.parentNode.removeChild(Z)}catch(aa){return}for(J=!0,X=U.length,Y=0;Y<X;Y++)U[Y]()}}function K(X){J?X():U[U.length]=X}function s(Y){if(typeof O.addEventListener!=D)O.addEventListener("load",Y,!1);else if(typeof j.addEventListener!=D)j.addEventListener("load",Y,!1);else if(typeof O.attachEvent!=D)i(O,"onload",Y);else if(typeof O.onload=="function"){var X=O.onload;O.onload=function(){X(),Y()}}else O.onload=Y}function h(){T?V():H()}function V(){var X=j.getElementsByTagName("body")[0],aa=C(r),Z,Y;aa.setAttribute("type",q),Z=X.appendChild(aa),Z?(Y=0,function(){if(typeof Z.GetVariable!=D){var ab=Z.GetVariable("$version");ab&&(ab=ab.split(" ")[1].split(","),M.pv=[parseInt(ab[0],10),parseInt(ab[1],10),parseInt(ab[2],10)])}else if(Y<10){Y++,setTimeout(arguments.callee,10);return}X.removeChild(aa),Z=null,H()}()):H()}function H(){var ag=o.length,af,ae,ai,ad,Z;if(ag>0)for(af=0;af<ag;af++){var Y=o[af].id,ab=o[af].callbackFn,aa={success:!1,id:Y};if(M.pv[0]>0){if(ae=c(Y),ae)if(!F(o[af].swfVersion)||M.wk&&M.wk<312)if(o[af].expressInstall&&A()){ai={},ai.data=o[af].expressInstall,ai.width=ae.getAttribute("width")||"0",ai.height=ae.getAttribute("height")||"0",ae.getAttribute("class")&&(ai.styleclass=ae.getAttribute("class")),ae.getAttribute("align")&&(ai.align=ae.getAttribute("align"));var ah={},X=ae.getElementsByTagName("param"),ac=X.length;for(ad=0;ad<ac;ad++)X[ad].getAttribute("name").toLowerCase()!="movie"&&(ah[X[ad].getAttribute("name")]=X[ad].getAttribute("value"));P(ai,ah,Y,ab)}else p(ae),ab&&ab(aa);else w(Y,!0),ab&&(aa.success=!0,aa.ref=z(Y),ab(aa))}else w(Y,!0),ab&&(Z=z(Y),Z&&typeof Z.SetVariable!=D&&(aa.success=!0,aa.ref=Z),ab(aa))}}function z(aa){var X=null,Y=c(aa),Z;return Y&&Y.nodeName=="OBJECT"&&(typeof Y.SetVariable!=D?X=Y:(Z=Y.getElementsByTagName(r)[0],Z&&(X=Z))),X}function A(){return!a&&F("6.0.65")&&(M.win||M.mac)&&!(M.wk&&M.wk<312)}function P(aa,ab,X,Z){var ae,ad,ac,Y;a=!0,E=Z||null,B={success:!1,id:X},ae=c(X),ae&&(ae.nodeName=="OBJECT"?(l=g(ae),Q=null):(l=ae,Q=X),aa.id=R,(typeof aa.width==D||!/%$/.test(aa.width)&&parseInt(aa.width,10)<310)&&(aa.width="310"),(typeof aa.height==D||!/%$/.test(aa.height)&&parseInt(aa.height,10)<137)&&(aa.height="137"),j.title=j.title.slice(0,47)+" - Flash Player Installation",ad=M.ie&&M.win?"ActiveX":"PlugIn",ac="MMredirectURL="+O.location.toString().replace(/&/g,"%26")+"&MMplayerType="+ad+"&MMdoctitle="+j.title,typeof ab.flashvars!=D?ab.flashvars+="&"+ac:ab.flashvars=ac,M.ie&&M.win&&ae.readyState!=4&&(Y=C("div"),X+="SWFObjectNew",Y.setAttribute("id",X),ae.parentNode.insertBefore(Y,ae),ae.style.display="none",function(){ae.readyState==4?ae.parentNode.removeChild(ae):setTimeout(arguments.callee,10)}()),u(aa,ab,X))}function p(Y){if(M.ie&&M.win&&Y.readyState!=4){var X=C("div");Y.parentNode.insertBefore(X,Y),X.parentNode.replaceChild(g(Y),X),Y.style.display="none",function(){Y.readyState==4?Y.parentNode.removeChild(Y):setTimeout(arguments.callee,10)}()}else Y.parentNode.replaceChild(g(Y),Y)}function g(ab){var aa=C("div"),Y,ad,X,Z;if(M.win&&M.ie)aa.innerHTML=ab.innerHTML;else if(Y=ab.getElementsByTagName(r)[0],Y&&(ad=Y.childNodes,ad))for(X=ad.length,Z=0;Z<X;Z++)ad[Z].nodeType==1&&ad[Z].nodeName=="PARAM"||ad[Z].nodeType==8||aa.appendChild(ad[Z].cloneNode(!0));return aa}function u(ai,ag,Y){var X,aa=c(Y),ah,ae,af,ad,Z,ac,ab;if(M.wk&&M.wk<312)return X;if(aa)if(typeof ai.id==D&&(ai.id=Y),M.ie&&M.win){ah="";for(ae in ai)ai[ae]!=Object.prototype[ae]&&(ae.toLowerCase()=="data"?ag.movie=ai[ae]:ae.toLowerCase()=="styleclass"?ah+=' class="'+ai[ae]+'"':ae.toLowerCase()!="classid"&&(ah+=" "+ae+'="'+ai[ae]+'"'));af="";for(ad in ag)ag[ad]!=Object.prototype[ad]&&(af+='<param name="'+ad+'" value="'+ag[ad]+'" />');aa.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+ah+">"+af+"</object>",N[N.length]=ai.id,X=c(ai.id)}else{Z=C(r),Z.setAttribute("type",q);for(ac in ai)ai[ac]!=Object.prototype[ac]&&(ac.toLowerCase()=="styleclass"?Z.setAttribute("class",ai[ac]):ac.toLowerCase()!="classid"&&Z.setAttribute(ac,ai[ac]));for(ab in ag)ag[ab]!=Object.prototype[ab]&&ab.toLowerCase()!="movie"&&e(Z,ab,ag[ab]);aa.parentNode.replaceChild(Z,aa),X=Z}return X}function e(Z,X,Y){var aa=C("param");aa.setAttribute("name",X),aa.setAttribute("value",Y),Z.appendChild(aa)}function y(Y){var X=c(Y);X&&X.nodeName=="OBJECT"&&(M.ie&&M.win?(X.style.display="none",function(){X.readyState==4?b(Y):setTimeout(arguments.callee,10)}()):X.parentNode.removeChild(X))}function b(Z){var Y=c(Z),X;if(Y){for(X in Y)typeof Y[X]=="function"&&(Y[X]=null);Y.parentNode.removeChild(Y)}}function c(Z){var X=null;try{X=j.getElementById(Z)}catch(Y){}return X}function C(X){return j.createElement(X)}function i(Z,X,Y){Z.attachEvent(X,Y),I[I.length]=[Z,X,Y]}function F(Z){var Y=M.pv,X=Z.split(".");return X[0]=parseInt(X[0],10),X[1]=parseInt(X[1],10)||0,X[2]=parseInt(X[2],10)||0,Y[0]>X[0]||Y[0]==X[0]&&Y[1]>X[1]||Y[0]==X[0]&&Y[1]==X[1]&&Y[2]>=X[2]?!0:!1}function v(ac,Y,ad,ab){var aa,X,Z;M.ie&&M.mac||(aa=j.getElementsByTagName("head")[0],aa)&&(X=ad&&typeof ad=="string"?ad:"screen",ab&&(n=null,G=null),n&&G==X||(Z=C("style"),Z.setAttribute("type","text/css"),Z.setAttribute("media",X),n=aa.appendChild(Z),M.ie&&M.win&&typeof j.styleSheets!=D&&j.styleSheets.length>0&&(n=j.styleSheets[j.styleSheets.length-1]),G=X),M.ie&&M.win?n&&typeof n.addRule==r&&n.addRule(ac,Y):n&&typeof j.createTextNode!=D&&n.appendChild(j.createTextNode(ac+" {"+Y+"}")))}function w(Z,X){if(m){var Y=X?"visible":"hidden";J&&c(Z)?c(Z).style.visibility=Y:v("#"+Z,"visibility:"+Y)}}function L(Y){var Z=/[\\\"<>\.;]/,X=Z.exec(Y)!=null;return X&&typeof encodeURIComponent!=D?encodeURIComponent(Y):Y}var D="undefined",r="object",S="Shockwave Flash",W="ShockwaveFlash.ShockwaveFlash",q="application/x-shockwave-flash",R="SWFObjectExprInst",x="onreadystatechange",O=window,j=document,t=navigator,T=!1,U=[h],o=[],N=[],I=[],l,Q,E,B,J=!1,a=!1,n,G,m=!0,M=function(){var aa=typeof j.getElementById!=D&&typeof j.getElementsByTagName!=D&&typeof j.createElement!=D,ah=t.userAgent.toLowerCase(),Y=t.platform.toLowerCase(),ae=Y?/win/.test(Y):/win/.test(ah),ac=Y?/mac/.test(Y):/mac/.test(ah),af=/webkit/.test(ah)?parseFloat(ah.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,X=!+"\v1",ag=[0,0,0],ab=null,ad;if(typeof t.plugins!=D&&typeof t.plugins[S]==r)ab=t.plugins[S].description,!ab||typeof t.mimeTypes!=D&&t.mimeTypes[q]&&!t.mimeTypes[q].enabledPlugin||(T=!0,X=!1,ab=ab.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),ag[0]=parseInt(ab.replace(/^(.*)\..*$/,"$1"),10),ag[1]=parseInt(ab.replace(/^.*\.(.*)\s.*$/,"$1"),10),ag[2]=/[a-zA-Z]/.test(ab)?parseInt(ab.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof O.ActiveXObject!=D)try{ad=new ActiveXObject(W),ad&&(ab=ad.GetVariable("$version"),ab&&(X=!0,ab=ab.split(" ")[1].split(","),ag=[parseInt(ab[0],10),parseInt(ab[1],10),parseInt(ab[2],10)]))}catch(Z){}return{w3:aa,pv:ag,wk:af,ie:X,win:ae,mac:ac}}(),k=function(){M.w3&&((typeof j.readyState!=D&&j.readyState=="complete"||typeof j.readyState==D&&(j.getElementsByTagName("body")[0]||j.body))&&f(),J||(typeof j.addEventListener!=D&&j.addEventListener("DOMContentLoaded",f,!1),M.ie&&M.win&&(j.attachEvent(x,function(){j.readyState=="complete"&&(j.detachEvent(x,arguments.callee),f())}),O==top&&function(){if(!J){try{j.documentElement.doScroll("left")}catch(X){setTimeout(arguments.callee,0);return}f()}}()),M.wk&&function(){if(!J){if(!/loaded|complete/.test(j.readyState)){setTimeout(arguments.callee,0);return}f()}}(),s(f)))}(),d=function(){M.ie&&M.win&&window.attachEvent("onunload",function(){for(var ac=I.length,Z,aa,Y,X,ab=0;ab<ac;ab++)I[ab][0].detachEvent(I[ab][1],I[ab][2]);for(Z=N.length,aa=0;aa<Z;aa++)y(N[aa]);for(Y in M)M[Y]=null;M=null;for(X in swfobject)swfobject[X]=null;swfobject=null})}();return{registerObject:function(ab,X,aa,Z){if(M.w3&&ab&&X){var Y={};Y.id=ab,Y.swfVersion=X,Y.expressInstall=aa,Y.callbackFn=Z,o[o.length]=Y,w(ab,!1)}else Z&&Z({success:!1,id:ab})},getObjectById:function(X){if(M.w3)return z(X)},embedSWF:function(ab,ah,ae,ag,Y,aa,Z,ad,af,ac){var X={success:!1,id:ah};M.w3&&!(M.wk&&M.wk<312)&&ab&&ah&&ae&&ag&&Y?(w(ah,!1),K(function(){var aj,al,am,ak,ai,an;if(ae+="",ag+="",aj={},af&&typeof af===r)for(al in af)aj[al]=af[al];if(aj.data=ab,aj.width=ae,aj.height=ag,am={},ad&&typeof ad===r)for(ak in ad)am[ak]=ad[ak];if(Z&&typeof Z===r)for(ai in Z)typeof am.flashvars!=D?am.flashvars+="&"+ai+"="+Z[ai]:am.flashvars=ai+"="+Z[ai];if(F(Y))an=u(aj,am,ah),aj.id==ah&&w(ah,!0),X.success=!0,X.ref=an;else{if(aa&&A()){aj.data=aa,P(aj,am,ah,ac);return}w(ah,!0)}ac&&ac(X)})):ac&&ac(X)},switchOffAutoHideShow:function(){m=!1},ua:M,getFlashPlayerVersion:function(){return{major:M.pv[0],minor:M.pv[1],release:M.pv[2]}},hasFlashPlayerVersion:F,createSWF:function(Z,Y,X){return M.w3?u(Z,Y,X):undefined},showExpressInstall:function(Z,aa,X,Y){M.w3&&A()&&P(Z,aa,X,Y)},removeSWF:function(X){M.w3&&y(X)},createCSS:function(aa,Z,Y,X){M.w3&&v(aa,Z,Y,X)},addDomLoadEvent:K,addLoadEvent:s,getQueryParamValue:function(aa){var Z=j.location.search||j.location.hash,Y,X;if(Z){if(/\?/.test(Z)&&(Z=Z.split("?")[1]),aa==null)return L(Z);for(Y=Z.split("&"),X=0;X<Y.length;X++)if(Y[X].substring(0,Y[X].indexOf("="))==aa)return L(Y[X].substring(Y[X].indexOf("=")+1))}return""},expressInstallCallback:function(){if(a){var X=c(R);X&&l&&(X.parentNode.replaceChild(l,X),Q&&(w(Q,!0),M.ie&&M.win&&(l.style.display="block")),E&&E(B)),a=!1}}}}();
(function(b){var m,t,u,f,D,j,E,n,z,A,q=0,e={},o=[],p=0,d={},l=[],G=null,v=new Image,J=/\.(jpg|gif|png|bmp|jpeg)(.*)?$/i,W=/[^\.]\.(swf)\s*$/i,K,L=1,y=0,s="",r,i,h=!1,B=b.extend(b("<div/>")[0],{prop:0}),M=b.browser.msie&&b.browser.version<7&&!window.XMLHttpRequest,N=function(){t.hide(),v.onerror=v.onload=null,G&&G.abort(),m.empty()},O=function(){!1===e.onError(o,q,e)?(t.hide(),h=!1):(e.titleShow=!1,e.width="auto",e.height="auto",m.html('<p id="fancybox-error">The requested content cannot be loaded.<br />Please try again later.</p>'),F())},I=function(){var a=o[q],c,g,k,C,P,w;if(N(),e=b.extend({},b.fn.fancybox.defaults,typeof b(a).data("fancybox")=="undefined"?e:b(a).data("fancybox")),w=e.onStart(o,q,e),w===!1)h=!1;else if(typeof w=="object"&&(e=b.extend(e,w)),k=e.title||(a.nodeName?b(a).attr("title"):a.title)||"",a.nodeName&&!e.orig&&(e.orig=b(a).children("img:first").length?b(a).children("img:first"):b(a)),k===""&&e.orig&&e.titleFromAlt&&(k=e.orig.attr("alt")),c=e.href||(a.nodeName?b(a).attr("href"):a.href)||null,(/^(?:javascript)/i.test(c)||c=="#")&&(c=null),e.type?(g=e.type,c||(c=e.content)):e.content?g="html":c&&(g=c.match(J)?"image":c.match(W)?"swf":b(a).hasClass("iframe")?"iframe":c.indexOf("#")===0?"inline":"ajax"),g){g=="inline"&&(a=c.substr(c.indexOf("#")),g=b(a).length>0?"inline":"ajax"),e.type=g,e.href=c,e.title=k,e.autoDimensions&&(e.type=="html"||e.type=="inline"||e.type=="ajax"?(e.width="auto",e.height="auto"):e.autoDimensions=!1),e.modal&&(e.overlayShow=!0,e.hideOnOverlayClick=!1,e.hideOnContentClick=!1,e.enableEscapeButton=!1,e.showCloseButton=!1),e.padding=parseInt(e.padding,10),e.margin=parseInt(e.margin,10),m.css("padding",e.padding+e.margin),b(".fancybox-inline-tmp").unbind("fancybox-cancel").bind("fancybox-change",function(){b(this).replaceWith(j.children())});switch(g){case"html":m.html(e.content),F();break;case"inline":if(b(a).parent().is("#fancybox-content")===!0){h=!1;break}b('<div class="fancybox-inline-tmp" />').hide().insertBefore(b(a)).bind("fancybox-cleanup",function(){b(this).replaceWith(j.children())}).bind("fancybox-cancel",function(){b(this).replaceWith(m.children())}),b(a).appendTo(m),F();break;case"image":h=!1,b.fancybox.showActivity(),v=new Image,v.onerror=function(){O()},v.onload=function(){h=!0,v.onerror=v.onload=null,e.width=v.width,e.height=v.height,b("<img />").attr({id:"fancybox-img",src:v.src,alt:e.title}).appendTo(m),Q()},v.src=c;break;case"swf":e.scrolling="no",C='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+e.width+'" height="'+e.height+'"><param name="movie" value="'+c+'"></param>',P="",b.each(e.swf,function(x,H){C+='<param name="'+x+'" value="'+H+'"></param>',P+=" "+x+'="'+H+'"'}),C+='<embed src="'+c+'" type="application/x-shockwave-flash" width="'+e.width+'" height="'+e.height+'"'+P+"></embed></object>",m.html(C),F();break;case"ajax":h=!1,b.fancybox.showActivity(),e.ajax.win=e.ajax.success,G=b.ajax(b.extend({},e.ajax,{url:c,data:e.ajax.data||{},error:function(x){x.status>0&&O()},success:function(x,H,R){if((typeof R=="object"?R:G).status==200){if(typeof e.ajax.win=="function"){if(w=e.ajax.win(c,x,H,R),w===!1){t.hide();return}(typeof w=="string"||typeof w=="object")&&(x=w)}m.html(x),F()}}}));break;case"iframe":Q()}}else O()},F=function(){var a=e.width,c=e.height;a=a.toString().indexOf("%")>-1?parseInt((b(window).width()-e.margin*2)*parseFloat(a)/100,10)+"px":a=="auto"?"auto":a+"px",c=c.toString().indexOf("%")>-1?parseInt((b(window).height()-e.margin*2)*parseFloat(c)/100,10)+"px":c=="auto"?"auto":c+"px",m.wrapInner('<div style="width:'+a+";height:"+c+";overflow: "+(e.scrolling=="auto"?"auto":e.scrolling=="yes"?"scroll":"hidden")+';position:relative;"></div>'),e.width=m.width(),e.height=m.height(),Q()},Q=function(){var a,c;if(t.hide(),f.is(":visible")&&!1===d.onCleanup(l,p,d))b.event.trigger("fancybox-cancel"),h=!1;else{if(h=!0,b(j.add(u)).unbind(),b(window).unbind("resize.fb scroll.fb"),b(document).unbind("keydown.fb"),f.is(":visible")&&d.titlePosition!=="outside"&&f.css("height",f.height()),l=o,p=q,d=e,d.overlayShow?(u.css({"background-color":d.overlayColor,opacity:d.overlayOpacity,cursor:d.hideOnOverlayClick?"pointer":"auto",height:b(document).height()}),u.is(":visible")||(M&&b("select:not(#fancybox-tmp select)").filter(function(){return this.style.visibility!=="hidden"}).css({visibility:"hidden"}).one("fancybox-cleanup",function(){this.style.visibility="inherit"}),u.show())):u.hide(),i=X(),s=d.title||"",y=0,n.empty().removeAttr("style").removeClass(),d.titleShow!==!1&&(a=b.isFunction(d.titleFormat)?d.titleFormat(s,l,p,d):s&&s.length?d.titlePosition=="float"?'<table id="fancybox-title-float-wrap" cellpadding="0" cellspacing="0"><tr><td id="fancybox-title-float-left"></td><td id="fancybox-title-float-main">'+s+'</td><td id="fancybox-title-float-right"></td></tr></table>':'<div id="fancybox-title-'+d.titlePosition+'">'+s+"</div>":!1,s=a,!(!s||s===""))){n.addClass("fancybox-title-"+d.titlePosition).html(s).appendTo("body").show();switch(d.titlePosition){case"inside":n.css({width:i.width-d.padding*2,marginLeft:d.padding,marginRight:d.padding}),y=n.outerHeight(!0),n.appendTo(D),i.height+=y;break;case"over":n.css({marginLeft:d.padding,width:i.width-d.padding*2,bottom:d.padding}).appendTo(D);break;case"float":n.css("left",parseInt((n.width()-i.width-40)/2,10)*-1).appendTo(f);break;default:n.css({width:i.width-d.padding*2,paddingLeft:d.padding,paddingRight:d.padding}).appendTo(f)}}n.hide(),f.is(":visible")?(b(E.add(z).add(A)).hide(),a=f.position(),r={top:a.top,left:a.left,width:f.width(),height:f.height()},c=r.width==i.width&&r.height==i.height,j.fadeTo(d.changeFade,.3,function(){var g=function(){j.html(m.contents()).fadeTo(d.changeFade,1,S)};b.event.trigger("fancybox-change"),j.empty().removeAttr("filter").css({"border-width":d.padding,width:i.width-d.padding*2,height:e.autoDimensions?"auto":i.height-y-d.padding*2}),c?g():(B.prop=0,b(B).animate({prop:1},{duration:d.changeSpeed,easing:d.easingChange,step:T,complete:g}))})):(f.removeAttr("style"),j.css("border-width",d.padding),d.transitionIn=="elastic"?(r=V(),j.html(m.contents()),f.show(),d.opacity&&(i.opacity=0),B.prop=0,b(B).animate({prop:1},{duration:d.speedIn,easing:d.easingIn,step:T,complete:S})):(d.titlePosition=="inside"&&y>0&&n.show(),j.css({width:i.width-d.padding*2,height:e.autoDimensions?"auto":i.height-y-d.padding*2}).html(m.contents()),f.css(i).fadeIn(d.transitionIn=="none"?0:d.speedIn,S)))}},Y=function(){(d.enableEscapeButton||d.enableKeyboardNav)&&b(document).bind("keydown.fb",function(a){a.keyCode==27&&d.enableEscapeButton?(a.preventDefault(),b.fancybox.close()):(a.keyCode==37||a.keyCode==39)&&d.enableKeyboardNav&&a.target.tagName!=="INPUT"&&a.target.tagName!=="TEXTAREA"&&a.target.tagName!=="SELECT"&&(a.preventDefault(),b.fancybox[a.keyCode==37?"prev":"next"]())}),d.showNavArrows?((d.cyclic&&l.length>1||p!==0)&&z.show(),(d.cyclic&&l.length>1||p!=l.length-1)&&A.show()):(z.hide(),A.hide())},S=function(){b.support.opacity||(j.get(0).style.removeAttribute("filter"),f.get(0).style.removeAttribute("filter")),e.autoDimensions&&j.css("height","auto"),f.css("height","auto"),s&&s.length&&n.show(),d.showCloseButton&&E.show(),Y(),d.hideOnContentClick&&j.bind("click",b.fancybox.close),d.hideOnOverlayClick&&u.bind("click",b.fancybox.close),b(window).bind("resize.fb",b.fancybox.resize),d.centerOnScroll&&b(window).bind("scroll.fb",b.fancybox.center),d.type=="iframe"&&b('<iframe id="fancybox-frame" name="fancybox-frame'+ +new Date+'" frameborder="0" hspace="0" '+(b.browser.msie?'allowtransparency="true""':"")+' scrolling="'+e.scrolling+'" src="'+d.href+'"></iframe>').appendTo(j),f.show(),h=!1,b.fancybox.center();d.onComplete(l,p,d);var a,c;l.length-1>p&&(a=l[p+1].href,typeof a!="undefined"&&a.match(J)&&(c=new Image,c.src=a)),p>0&&(a=l[p-1].href,typeof a!="undefined"&&a.match(J)&&(c=new Image,c.src=a))},T=function(a){var c={width:parseInt(r.width+(i.width-r.width)*a,10),height:parseInt(r.height+(i.height-r.height)*a,10),top:parseInt(r.top+(i.top-r.top)*a,10),left:parseInt(r.left+(i.left-r.left)*a,10)};typeof i.opacity!="undefined"&&(c.opacity=a<.5?.5:a),f.css(c),j.css({width:c.width-d.padding*2,height:c.height-y*a-d.padding*2})},U=function(){return[b(window).width()-d.margin*2,b(window).height()-d.margin*2,b(document).scrollLeft()+d.margin,b(document).scrollTop()+d.margin]},X=function(){var a=U(),c={},g=d.autoScale,k=d.padding*2;return c.width=d.width.toString().indexOf("%")>-1?parseInt(a[0]*parseFloat(d.width)/100,10):d.width+k,c.height=d.height.toString().indexOf("%")>-1?parseInt(a[1]*parseFloat(d.height)/100,10):d.height+k,g&&(c.width>a[0]||c.height>a[1])&&(e.type=="image"||e.type=="swf"?(g=d.width/d.height,c.width>a[0]&&(c.width=a[0],c.height=parseInt((c.width-k)/g+k,10)),c.height>a[1]&&(c.height=a[1],c.width=parseInt((c.height-k)*g+k,10))):(c.width=Math.min(c.width,a[0]),c.height=Math.min(c.height,a[1]))),c.top=parseInt(Math.max(a[3]-20,a[3]+(a[1]-c.height-40)*.5),10),c.left=parseInt(Math.max(a[2]-20,a[2]+(a[0]-c.width-40)*.5),10),c},V=function(){var a=e.orig?b(e.orig):!1,c={};return a&&a.length?(c=a.offset(),c.top+=parseInt(a.css("paddingTop"),10)||0,c.left+=parseInt(a.css("paddingLeft"),10)||0,c.top+=parseInt(a.css("border-top-width"),10)||0,c.left+=parseInt(a.css("border-left-width"),10)||0,c.width=a.width(),c.height=a.height(),c={width:c.width+d.padding*2,height:c.height+d.padding*2,top:c.top-d.padding-20,left:c.left-d.padding-20}):(a=U(),c={width:d.padding*2,height:d.padding*2,top:parseInt(a[3]+a[1]*.5,10),left:parseInt(a[2]+a[0]*.5,10)}),c},Z=function(){t.is(":visible")?(b("div",t).css("top",L*-40+"px"),L=(L+1)%12):clearInterval(K)};b.fn.fancybox=function(a){return b(this).length?(b(this).data("fancybox",b.extend({},a,b.metadata?b(this).metadata():{})).unbind("click.fb").bind("click.fb",function(c){c.preventDefault(),h||(h=!0,b(this).blur(),o=[],q=0,c=b(this).attr("rel")||"",c&&c!=""&&c!=="nofollow"?(o=b("a[rel="+c+"],
 area[rel="+c+"]"),q=o.index(this)):o.push(this),I())}),this):this},b.fancybox=function(a,c){var g,k,C;if(!h){if(h=!0,g=typeof c!="undefined"?c:{},o=[],q=parseInt(g.index,10)||0,b.isArray(a)){for(k=0,C=a.length;k<C;k++)typeof a[k]=="object"?b(a[k]).data("fancybox",b.extend({},g,a[k])):a[k]=b({}).data("fancybox",b.extend({content:a[k]},g));o=jQuery.merge(o,a)}else typeof a=="object"?b(a).data("fancybox",b.extend({},g,a)):a=b({}).data("fancybox",b.extend({content:a},g)),o.push(a);(q>o.length||q<0)&&(q=0),I()}},b.fancybox.showActivity=function(){clearInterval(K),t.show(),K=setInterval(Z,66)},b.fancybox.hideActivity=function(){t.hide()},b.fancybox.next=function(){return b.fancybox.pos(p+1)},b.fancybox.prev=function(){return b.fancybox.pos(p-1)},b.fancybox.pos=function(a){h||(a=parseInt(a),o=l,a>-1&&a<l.length?(q=a,I()):d.cyclic&&l.length>1&&(q=a>=l.length?0:l.length-1,I()))},b.fancybox.cancel=function(){if(!h){h=!0,b.event.trigger("fancybox-cancel"),N();e.onCancel(o,q,e);h=!1}},b.fancybox.close=function(){function a(){u.fadeOut("fast"),n.empty().hide(),f.hide(),b.event.trigger("fancybox-cleanup"),j.empty();d.onClosed(l,p,d);l=e=[],p=q=0,d=e={},h=!1}if(!(h||f.is(":hidden")))if(h=!0,d&&!1===d.onCleanup(l,p,d))h=!1;else if(N(),b(E.add(z).add(A)).hide(),b(j.add(u)).unbind(),b(window).unbind("resize.fb scroll.fb"),b(document).unbind("keydown.fb"),j.find("iframe").attr("src",M&&/^https/i.test(window.location.href||"")?"javascript:void(false)":"about:blank"),d.titlePosition!=="inside"&&n.empty(),f.stop(),d.transitionOut=="elastic"){r=V();var c=f.position();i={top:c.top,left:c.left,width:f.width(),height:f.height()},d.opacity&&(i.opacity=1),n.empty().hide(),B.prop=1,b(B).animate({prop:0},{duration:d.speedOut,easing:d.easingOut,step:T,complete:a})}else f.fadeOut(d.transitionOut=="none"?0:d.speedOut,a)},b.fancybox.resize=function(){u.is(":visible")&&u.css("height",b(document).height()),b.fancybox.center(!0)},b.fancybox.center=function(a){var c,g;h||(g=a===!0?1:0,c=U(),!g&&(f.width()>c[0]||f.height()>c[1])||f.stop().animate({top:parseInt(Math.max(c[3]-20,c[3]+(c[1]-j.height()-40)*.5-d.padding)),left:parseInt(Math.max(c[2]-20,c[2]+(c[0]-j.width()-40)*.5-d.padding))},typeof a=="number"?a:200))},b.fancybox.init=function(){b("#fancybox-wrap").length||(b("body").append(m=b('<div id="fancybox-tmp"></div>'),t=b('<div id="fancybox-loading"><div></div></div>'),u=b('<div id="fancybox-overlay"></div>'),f=b('<div id="fancybox-wrap"></div>')),D=b('<div id="fancybox-outer"></div>').append('<div class="fancybox-bg" id="fancybox-bg-n"></div><div class="fancybox-bg" id="fancybox-bg-ne"></div><div class="fancybox-bg" id="fancybox-bg-e"></div><div class="fancybox-bg" id="fancybox-bg-se"></div><div class="fancybox-bg" id="fancybox-bg-s"></div><div class="fancybox-bg" id="fancybox-bg-sw"></div><div class="fancybox-bg" id="fancybox-bg-w"></div><div class="fancybox-bg" id="fancybox-bg-nw"></div>').appendTo(f),D.append(j=b('<div id="fancybox-content"></div>'),E=b('<a id="fancybox-close"></a>'),n=b('<div id="fancybox-title"></div>'),z=b('<a href="javascript:;" id="fancybox-left"><span class="fancy-ico" id="fancybox-left-ico"></span></a>'),A=b('<a href="javascript:;" id="fancybox-right"><span class="fancy-ico" id="fancybox-right-ico"></span></a>')),E.click(b.fancybox.close),t.click(b.fancybox.cancel),z.click(function(a){a.preventDefault(),b.fancybox.prev()}),A.click(function(a){a.preventDefault(),b.fancybox.next()}),b.fn.mousewheel&&f.bind("mousewheel.fb",function(a,c){h?a.preventDefault():(b(a.target).get(0).clientHeight==0||b(a.target).get(0).scrollHeight===b(a.target).get(0).clientHeight)&&(a.preventDefault(),b.fancybox[c>0?"prev":"next"]())}),b.support.opacity||f.addClass("fancybox-ie"),M&&(t.addClass("fancybox-ie6"),f.addClass("fancybox-ie6"),b('<iframe id="fancybox-hide-sel-frame" src="'+(/^https/i.test(window.location.href||"")?"javascript:void(false)":"about:blank")+'" scrolling="no" border="0" frameborder="0" tabindex="-1"></iframe>').prependTo(D)))},b.fn.fancybox.defaults={padding:10,margin:40,opacity:!1,modal:!1,cyclic:!1,scrolling:"auto",width:560,height:340,autoScale:!0,autoDimensions:!0,centerOnScroll:!1,ajax:{},swf:{wmode:"transparent"},hideOnOverlayClick:!0,hideOnContentClick:!1,overlayShow:!0,overlayOpacity:.7,overlayColor:"#777",titleShow:!0,titlePosition:"float",titleFormat:null,titleFromAlt:!1,transitionIn:"fade",transitionOut:"fade",speedIn:300,speedOut:300,changeSpeed:300,changeFade:"fast",easingIn:"swing",easingOut:"swing",showCloseButton:!0,showNavArrows:!0,enableEscapeButton:!0,enableKeyboardNav:!0,onStart:function(){},onCancel:function(){},onComplete:function(){},onCleanup:function(){},onClosed:function(){},onError:function(){}},b(document).ready(function(){b.fancybox.init()})})(jQuery);
eval(function(p,a,c,k,e,r){if(e=function(c){return(c<a?"":e(parseInt(c/a)))+((c=c%a)>35?String.fromCharCode(c+29):c.toString(36))},!"".replace(/^/,String)){while(c--)r[e(c)]=k[c]||e(c);k=[function(e){return r[e]}],e=function(){return"\\w+"},c=1}while(c--)k[c]&&(p=p.replace(new RegExp("\\b"+e(c)+"\\b","g"),k[c]));return p}("a(37.b&&!37.b.38){(9(b){6 m=9(s,A,f){5.1M=[];5.1u={};5.2p=E;5.1N={};5.1c={};5.f=b.1m({1Z:1f,3a:1O,2q:1f,2r:1f,3b:1O,3c:1O},f);5.1v=(5.f.1v!==F)?(5.f.1v):(13.20);5.Y=(5.f.Y!==F)?(5.f.Y):(13.3d);5.3e(s,A);a(s){5.1w(5.1c['21'],A,5.f)}5.1c=E};m.y.2s='0.7.8';m.R=1O;m.y.3e=9(s,A){6 2t=/\\{#14 *(\\w*?)( .*)*\\}/g;6 22,1x,M;6 1y=E;6 2u=[];2v((22=2t.3N(s))!=E){1y=2t.1y;1x=22[1];M=s.2w('{#/14 '+1x+'}',1y);a(M==-1){C j Z('15: m \"'+1x+'\" 2x 23 3O.');}5.1c[1x]=s.2y(1y,M);2u[1x]=13.2z(22[2])}a(1y===E){5.1c['21']=s;c}N(6 i 24 5.1c){a(i!='21'){5.1N[i]=j m()}}N(6 i 24 5.1c){a(i!='21'){5.1N[i].1w(5.1c[i],b.1m({},A||{},5.1N||{}),b.1m({},5.f,2u[i]));5.1c[i]=E}}};m.y.1w=9(s,A,f){a(s==F){5.1M.B(j 1g('',1,5));c}s=s.U(/[\\n\\r]/g,'');s=s.U(/\\{\\*.*?\\*\\}/g,'');5.2p=b.1m({},5.1N||{},A||{});5.f=j 2A(f);6 p=5.1M;6 1P=s.1h(/\\{#.*?\\}/g);6 16=0,M=0;6 e;6 1i=0;6 25=0;N(6 i=0,l=(1P)?(1P.V):(0);i<l;++i){6 17=1P[i];a(1i){M=s.2w('{#/1z}');a(M==-1){C j Z(\"15: 3P 1Q 3f 1z.\");}a(M>16){p.B(j 1g(s.2y(16,M),1,5))}16=M+11;1i=0;i=b.3Q('{#/1z}',1P);1R}M=s.2w(17,16);a(M>16){p.B(j 1g(s.2y(16,M),1i,5))}6 3R=17.1h(/\\{#([\\w\\/]+).*?\\}/);6 26=I.$1;2B(26){q'3S':++25;p.27();q'a':e=j 1A(17,p);p.B(e);p=e;D;q'J':p.27();D;q'/a':2v(25){p=p.28();--25}q'/N':q'/29':p=p.28();D;q'29':e=j 1n(17,p,5);p.B(e);p=e;D;q'N':e=2a(17,p,5);p.B(e);p=e;D;q'1R':q'D':p.B(j 18(26));D;q'2C':p.B(j 2D(17,5.2p));D;q'h':p.B(j 2E(17));D;q'2F':p.B(j 2G(17));D;q'3T':p.B(j 1g('{',1,5));D;q'3U':p.B(j 1g('}',1,5));D;q'1z':1i=1;D;q'/1z':a(m.R){C j Z(\"15: 3V 2H 3f 1z.\");}D;2I:a(m.R){C j Z('15: 3W 3X: '+26+'.');}}16=M+17.V}a(s.V>16){p.B(j 1g(s.3Y(16),1i,5))}};m.y.K=9(d,h,z,H){++H;6 $T=d,2b,2c;a(5.f.3b){$T=5.1v(d,{2d:(5.f.3a&&H==1),1S:5.f.1Z},5.Y)}a(!5.f.3c){2b=5.1u;2c=h}J{2b=5.1v(5.1u,{2d:(5.f.2q),1S:1f},5.Y);2c=5.1v(h,{2d:(5.f.2q&&H==1),1S:1f},5.Y)}6 $P=b.1m({},2b,2c);6 $Q=(z!=F)?(z):({});$Q.2s=5.2s;6 19='';N(6 i=0,l=5.1M.V;i<l;++i){19+=5.1M[i].K($T,$P,$Q,H)}--H;c 19};m.y.2J=9(1T,1o){5.1u[1T]=1o};13=9(){};13.3d=9(3g){c 3g.U(/&/g,'&3Z;').U(/>/g,'&3h;').U(/</g,'&3i;').U(/\"/g,'&40;').U(/'/g,'&#39;')};13.20=9(d,1B,Y){a(d==E){c d}2B(d.2K){q 2A:6 o={};N(6 i 24 d){o[i]=13.20(d[i],1B,Y)}a(!1B.1S){a(d.41(\"2L\"))o.2L=d.2L}c o;q 42:6 o=[];N(6 i=0,l=d.V;i<l;++i){o[i]=13.20(d[i],1B,Y)}c o;q 2M:c(1B.2d)?(Y(d)):(d);q 43:a(1B.1S){a(m.R)C j Z(\"15: 44 45 23 46.\");J c F}2I:c d}};13.2z=9(2e){a(2e===E||2e===F){c{}}6 o=2e.47(/[= ]/);a(o[0]===''){o.48()}6 2N={};N(6 i=0,l=o.V;i<l;i+=2){2N[o[i]]=o[i+1]}c 2N};6 1g=9(2O,1i,14){5.2f=2O;5.3j=1i;5.1d=14};1g.y.K=9(d,h,z,H){6 2g=5.2f;a(!5.3j){6 2P=5.1d;6 $T=d;6 $P=h;6 $Q=z;2g=2g.U(/\\{(.*?)\\}/g,9(49,3k){1C{6 1D=10(3k);a(1E 1D=='9'){a(2P.f.1Z||!2P.f.2r){c''}J{1D=1D($T,$P,$Q)}}c(1D===F)?(\"\"):(2M(1D))}1F(e){a(m.R){a(e 1G 18)e.1j=\"4a\";C e;}c\"\"}})}c 2g};6 1A=9(L,1H){5.2h=1H;L.1h(/\\{#(?:J)*a (.*?)\\}/);5.3l=I.$1;5.1p=[];5.1q=[];5.1I=5.1p};1A.y.B=9(e){5.1I.B(e)};1A.y.28=9(){c 5.2h};1A.y.27=9(){5.1I=5.1q};1A.y.K=9(d,h,z,H){6 $T=d;6 $P=h;6 $Q=z;6 19='';1C{6 2Q=(10(5.3l))?(5.1p):(5.1q);N(6 i=0,l=2Q.V;i<l;++i){19+=2Q[i].K(d,h,z,H)}}1F(e){a(m.R||(e 1G 18))C e;}c 19};2a=9(L,1H,14){a(L.1h(/\\{#N (\\w+?) *= *(\\S+?) +4b +(\\S+?) *(?:12=(\\S+?))*\\}/)){L='{#29 2a.3m 3n '+I.$1+' 2H='+(I.$2||0)+' 1Q='+(I.$3||-1)+' 12='+(I.$4||1)+' u=$T}';c j 1n(L,1H,14)}J{C j Z('15: 4c 4d \"3o\": '+L);}};2a.3m=9(i){c i};6 1n=9(L,1H,14){5.2h=1H;5.1d=14;L.1h(/\\{#29 (.+?) 3n (\\w+?)( .+)*\\}/);5.3p=I.$1;5.x=I.$2;5.W=I.$3||E;5.W=13.2z(5.W);5.1p=[];5.1q=[];5.1I=5.1p};1n.y.B=9(e){5.1I.B(e)};1n.y.28=9(){c 5.2h};1n.y.27=9(){5.1I=5.1q};1n.y.K=9(d,h,z,H){1C{6 $T=d;6 $P=h;6 $Q=z;6 1r=10(5.3p);6 1U=[];6 1J=1E 1r;a(1J=='3q'){6 2R=[];b.1e(1r,9(k,v){1U.B(k);2R.B(v)});1r=2R}6 u=(5.W.u!==F)?(10(5.W.u)):(($T!=E)?($T):({}));6 s=1V(10(5.W.2H)||0),e;6 12=1V(10(5.W.12)||1);a(1J!='9'){e=1r.V}J{a(5.W.1Q===F||5.W.1Q===E){e=1V.4e}J{e=1V(10(5.W.1Q))+((12>0)?(1):(-1))}}6 19='';6 i,l;a(5.W.1W){6 2S=s+1V(10(5.W.1W));e=(2S>e)?(e):(2S)}a((e>s&&12>0)||(e<s&&12<0)){6 1K=0;6 3r=(1J!='9')?(4f.4g((e-s)/12)):F;6 1s,1k;N(;((12>0)?(s<e):(s>e));s+=12,++1K){1s=1U[s];a(1J!='9'){1k=1r[s]}J{1k=1r(s);a(1k===F||1k===E){D}}a((1E 1k=='9')&&(5.1d.f.1Z||!5.1d.f.2r)){1R}a((1J=='3q')&&(1s 24 2A)){1R}6 3s=u[5.x];u[5.x]=1k;u[5.x+'$3t']=s;u[5.x+'$1K']=1K;u[5.x+'$3u']=(1K==0);u[5.x+'$3v']=(s+12>=e);u[5.x+'$3w']=3r;u[5.x+'$1U']=(1s!==F&&1s.2K==2M)?(5.1d.Y(1s)):(1s);u[5.x+'$1E']=1E 1k;N(i=0,l=5.1p.V;i<l;++i){1C{19+=5.1p[i].K(u,h,z,H)}1F(2T){a(2T 1G 18){2B(2T.1j){q'1R':i=l;D;q'D':i=l;s=e;D;2I:C e;}}J{C e;}}}1l u[5.x+'$3t'];1l u[5.x+'$1K'];1l u[5.x+'$3u'];1l u[5.x+'$3v'];1l u[5.x+'$3w'];1l u[5.x+'$1U'];1l u[5.x+'$1E'];1l u[5.x];u[5.x]=3s}}J{N(i=0,l=5.1q.V;i<l;++i){19+=5.1q[i].K($T,h,z,H)}}c 19}1F(e){a(m.R||(e 1G 18))C e;c\"\"}};6 18=9(1j){5.1j=1j};18.y=Z;18.y.K=9(d){C 5;};6 2D=9(L,A){L.1h(/\\{#2C (.*?)(?: 4h=(.*?))?\\}/);5.1d=A[I.$1];a(5.1d==F){a(m.R)C j Z('15: 4i 3o 2C: '+I.$1);}5.3x=I.$2};2D.y.K=9(d,h,z,H){6 $T=d;6 $P=h;1C{c 5.1d.K(10(5.3x),h,z,H)}1F(e){a(m.R||(e 1G 18))C e;}c''};6 2E=9(L){L.1h(/\\{#h 1T=(\\w*?) 1o=(.*?)\\}/);5.x=I.$1;5.2f=I.$2};2E.y.K=9(d,h,z,H){6 $T=d;6 $P=h;6 $Q=z;1C{h[5.x]=10(5.2f)}1F(e){a(m.R||(e 1G 18))C e;h[5.x]=F}c''};6 2G=9(L){L.1h(/\\{#2F 4j=(.*?)\\}/);5.2U=10(I.$1);5.2V=5.2U.V;a(5.2V<=0){C j Z('15: 2F 4k 4l 4m');}5.2W=0;5.2X=-1};2G.y.K=9(d,h,z,H){6 2Y=b.O(z,'1X');a(2Y!=5.2X){5.2X=2Y;5.2W=0}6 i=5.2W++%5.2V;c 5.2U[i]};b.1a.1w=9(s,A,f){a(s.2K===m){c b(5).1e(9(){b.O(5,'2i',s);b.O(5,'1X',0)})}J{c b(5).1e(9(){b.O(5,'2i',j m(s,A,f));b.O(5,'1X',0)})}};b.1a.4n=9(1L,A,f){6 s=b.2Z({1t:1L,1Y:1f}).3y;c b(5).1w(s,A,f)};b.1a.4o=9(30,A,f){6 s=b('#'+30).2O();a(s==E){s=b('#'+30).3z();s=s.U(/&3i;/g,\"<\").U(/&3h;/g,\">\")}s=b.4p(s);s=s.U(/^<\\!\\[4q\\[([\\s\\S]*)\\]\\]>$/3A,'$1');s=s.U(/^<\\!--([\\s\\S]*)-->$/3A,'$1');c b(5).1w(s,A,f)};b.1a.4r=9(){6 1W=0;b(5).1e(9(){a(b.2j(5)){++1W}});c 1W};b.1a.4s=9(){b(5).3B();c b(5).1e(9(){b.3C(5,'2i')})};b.1a.2J=9(1T,1o){c b(5).1e(9(){6 t=b.2j(5);a(t===F){a(m.R)C j Z('15: m 2x 23 3D.');J c}t.2J(1T,1o)})};b.1a.31=9(d,h){c b(5).1e(9(){6 t=b.2j(5);a(t===F){a(m.R)C j Z('15: m 2x 23 3D.');J c}b.O(5,'1X',b.O(5,'1X')+1);b(5).3z(t.K(d,h,5,0))})};b.1a.4t=9(1L,h,G){6 X=5;G=b.1m({1j:'4u',1Y:1O,32:1f},G);b.2Z({1t:1L,1j:G.1j,O:G.O,3E:G.3E,1Y:G.1Y,32:G.32,3F:G.3F,4v:'4w',4x:9(d){6 r=b(X).31(d,h);a(G.2k){G.2k(r)}},4y:G.4z,4A:G.4B});c 5};6 2l=9(1t,h,2m,2n,1b,G){5.3G=1t;5.1u=h;5.3H=2m;5.3I=2n;5.1b=1b;5.3J=E;5.33=G||{};6 X=5;b(1b).1e(9(){b.O(5,'34',X)});5.35()};2l.y.35=9(){5.3K();a(5.1b.V==0){c}6 X=5;b.4C(5.3G,5.3I,9(d){6 r=b(X.1b).31(d,X.1u);a(X.33.2k){X.33.2k(r)}});5.3J=4D(9(){X.35()},5.3H)};2l.y.3K=9(){5.1b=b.3L(5.1b,9(o){a(b.4E.4F){6 n=o.36;2v(n&&n!=4G){n=n.36}c n!=E}J{c o.36!=E}})};b.1a.4H=9(1t,h,2m,2n,G){c j 2l(1t,h,2m,2n,5,G)};b.1a.3B=9(){c b(5).1e(9(){6 2o=b.O(5,'34');a(2o==E){c}6 X=5;2o.1b=b.3L(2o.1b,9(o){c o!=X});b.3C(5,'34')})};b.1m({38:9(s,A,f){c j m(s,A,f)},4I:9(1L,A,f){6 s=b.2Z({1t:1L,1Y:1f}).3y;c j m(s,A,f)},2j:9(z){c b.O(z,'2i')},4J:9(14,O,3M){c 14.K(O,3M,F,0)},4K:9(1o){m.R=1o}})})(b)}",62,295,"|||||this|var|||function|if|jQuery|return|||settings||param||new|||Template|||node|case||||extData|||_name|prototype|element|includes|push|throw|break|null|undefined|options|deep|RegExp|else|get|oper|se|for|data|||DEBUG_MODE|||replace|length|_option|that|f_escapeString|Error|eval||step|TemplateUtils|template|jTemplates|ss|this_op|JTException|ret|fn|objs|_templates_code|_template|each|false|TextNode|match|literalMode|type|cval|delete|extend|opFOREACH|value|_onTrue|_onFalse|fcount|ckey|url|_param|f_cloneData|setTemplate|tname|lastIndex|literal|opIF|filter|try|__tmp|typeof|catch|instanceof|par|_currentState|mode|iteration|url_|_tree|_templates|true|op|end|continue|noFunc|name|key|Number|count|jTemplateSID|async|disallow_functions|cloneData|MAIN|iter|not|in|elseif_level|op_|switchToElse|getParent|foreach|opFORFactory|_param1|_param2|escapeData|optionText|_value|__t|_parent|jTemplate|getTemplate|on_success|Updater|interval|args|updater|_includes|filter_params|runnable_functions|version|reg|_template_settings|while|indexOf|is|substring|optionToObject|Object|switch|include|Include|UserParam|cycle|Cycle|begin|default|setParam|constructor|toString|String|obj|val|__template|tab|arr|tmp|ex|_values|_length|_index|_lastSessionID|sid|ajax|elementName|processTemplate|cache|_options|jTemplateUpdater|run|parentNode|window|createTemplate||filter_data|clone_data|clone_params|escapeHTML|splitTemplates|of|txt|gt|lt|_literalMode|__1|_cond|funcIterator|as|find|_arg|object|_total|prevValue|index|first|last|total|_root|responseText|html|im|processTemplateStop|removeData|defined|dataFilter|timeout|_url|_interval|_args|timer|detectDeletedNodes|grep|parameter|exec|closed|No|inArray|ppp|elseif|ldelim|rdelim|Missing|unknown|tag|substr|amp|quot|hasOwnProperty|Array|Function|Functions|are|allowed|split|shift|__0|subtemplate|to|Operator|failed|MAX_VALUE|Math|ceil|root|Cannot|values|has|no|elements|setTemplateURL|setTemplateElement|trim|CDATA|hasTemplate|removeTemplate|processTemplateURL|GET|dataType|json|success|error|on_error|complete|on_complete|getJSON|setTimeout|browser|msie|document|processTemplateStart|createTemplateURL|processTemplateToText|jTemplatesDebugMode".split("|"),0,{}));
Encoder={EncodeType:"entity",isEmpty:function(val){return val?val===null||val.length==0||/^\s+$/.test(val):!0},HTML2Numerical:function(s){var arr1=["&nbsp;","&iexcl;","&cent;","&pound;","&curren;","&yen;","&brvbar;","&sect;","&uml;","&copy;","&ordf;","&laquo;","&not;","&shy;","&reg;","&macr;","&deg;","&plusmn;","&sup2;","&sup3;","&acute;","&micro;","&para;","&middot;","&cedil;","&sup1;","&ordm;","&raquo;","&frac14;","&frac12;","&frac34;","&iquest;","&agrave;","&aacute;","&acirc;","&atilde;","&Auml;","&aring;","&aelig;","&ccedil;","&egrave;","&eacute;","&ecirc;","&euml;","&igrave;","&iacute;","&icirc;","&iuml;","&eth;","&ntilde;","&ograve;","&oacute;","&ocirc;","&otilde;","&Ouml;","&times;","&oslash;","&ugrave;","&uacute;","&ucirc;","&Uuml;","&yacute;","&thorn;","&szlig;","&agrave;","&aacute;","&acirc;","&atilde;","&auml;","&aring;","&aelig;","&ccedil;","&egrave;","&eacute;","&ecirc;","&euml;","&igrave;","&iacute;","&icirc;","&iuml;","&eth;","&ntilde;","&ograve;","&oacute;","&ocirc;","&otilde;","&ouml;","&divide;","&oslash;","&ugrave;","&uacute;","&ucirc;","&uuml;","&yacute;","&thorn;","&yuml;","&quot;","&amp;","&lt;","&gt;","&oelig;","&oelig;","&scaron;","&scaron;","&yuml;","&circ;","&tilde;","&ensp;","&emsp;","&thinsp;","&zwnj;","&zwj;","&lrm;","&rlm;","&ndash;","&mdash;","&lsquo;","&rsquo;","&sbquo;","&ldquo;","&rdquo;","&bdquo;","&dagger;","&dagger;","&permil;","&lsaquo;","&rsaquo;","&euro;","&fnof;","&alpha;","&beta;","&gamma;","&delta;","&epsilon;","&zeta;","&eta;","&theta;","&iota;","&kappa;","&lambda;","&mu;","&nu;","&xi;","&omicron;","&pi;","&rho;","&sigma;","&tau;","&upsilon;","&phi;","&chi;","&psi;","&omega;","&alpha;","&beta;","&gamma;","&delta;","&epsilon;","&zeta;","&eta;","&theta;","&iota;","&kappa;","&lambda;","&mu;","&nu;","&xi;","&omicron;","&pi;","&rho;","&sigmaf;","&sigma;","&tau;","&upsilon;","&phi;","&chi;","&psi;","&omega;","&thetasym;","&upsih;","&piv;","&bull;","&hellip;","&prime;","&prime;","&oline;","&frasl;","&weierp;","&image;","&real;","&trade;","&alefsym;","&larr;","&uarr;","&rarr;","&darr;","&harr;","&crarr;","&larr;","&uarr;","&rarr;","&darr;","&harr;","&forall;","&part;","&exist;","&empty;","&nabla;","&isin;","&notin;","&ni;","&prod;","&sum;","&minus;","&lowast;","&radic;","&prop;","&infin;","&ang;","&and;","&or;","&cap;","&cup;","&int;","&there4;","&sim;","&cong;","&asymp;","&ne;","&equiv;","&le;","&ge;","&sub;","&sup;","&nsub;","&sube;","&supe;","&oplus;","&otimes;","&perp;","&sdot;","&lceil;","&rceil;","&lfloor;","&rfloor;","&lang;","&rang;","&loz;","&spades;","&clubs;","&hearts;","&diams;"],arr2=["&#160;","&#161;","&#162;","&#163;","&#164;","&#165;","&#166;","&#167;","&#168;","&#169;","&#170;","&#171;","&#172;","&#173;","&#174;","&#175;","&#176;","&#177;","&#178;","&#179;","&#180;","&#181;","&#182;","&#183;","&#184;","&#185;","&#186;","&#187;","&#188;","&#189;","&#190;","&#191;","&#192;","&#193;","&#194;","&#195;","&#196;","&#197;","&#198;","&#199;","&#200;","&#201;","&#202;","&#203;","&#204;","&#205;","&#206;","&#207;","&#208;","&#209;","&#210;","&#211;","&#212;","&#213;","&#214;","&#215;","&#216;","&#217;","&#218;","&#219;","&#220;","&#221;","&#222;","&#223;","&#224;","&#225;","&#226;","&#227;","&#228;","&#229;","&#230;","&#231;","&#232;","&#233;","&#234;","&#235;","&#236;","&#237;","&#238;","&#239;","&#240;","&#241;","&#242;","&#243;","&#244;","&#245;","&#246;","&#247;","&#248;","&#249;","&#250;","&#251;","&#252;","&#253;","&#254;","&#255;","&#34;","&#38;","&#60;","&#62;","&#338;","&#339;","&#352;","&#353;","&#376;","&#710;","&#732;","&#8194;","&#8195;","&#8201;","&#8204;","&#8205;","&#8206;","&#8207;","&#8211;","&#8212;","&#8216;","&#8217;","&#8218;","&#8220;","&#8221;","&#8222;","&#8224;","&#8225;","&#8240;","&#8249;","&#8250;","&#8364;","&#402;","&#913;","&#914;","&#915;","&#916;","&#917;","&#918;","&#919;","&#920;","&#921;","&#922;","&#923;","&#924;","&#925;","&#926;","&#927;","&#928;","&#929;","&#931;","&#932;","&#933;","&#934;","&#935;","&#936;","&#937;","&#945;","&#946;","&#947;","&#948;","&#949;","&#950;","&#951;","&#952;","&#953;","&#954;","&#955;","&#956;","&#957;","&#958;","&#959;","&#960;","&#961;","&#962;","&#963;","&#964;","&#965;","&#966;","&#967;","&#968;","&#969;","&#977;","&#978;","&#982;","&#8226;","&#8230;","&#8242;","&#8243;","&#8254;","&#8260;","&#8472;","&#8465;","&#8476;","&#8482;","&#8501;","&#8592;","&#8593;","&#8594;","&#8595;","&#8596;","&#8629;","&#8656;","&#8657;","&#8658;","&#8659;","&#8660;","&#8704;","&#8706;","&#8707;","&#8709;","&#8711;","&#8712;","&#8713;","&#8715;","&#8719;","&#8721;","&#8722;","&#8727;","&#8730;","&#8733;","&#8734;","&#8736;","&#8743;","&#8744;","&#8745;","&#8746;","&#8747;","&#8756;","&#8764;","&#8773;","&#8776;","&#8800;","&#8801;","&#8804;","&#8805;","&#8834;","&#8835;","&#8836;","&#8838;","&#8839;","&#8853;","&#8855;","&#8869;","&#8901;","&#8968;","&#8969;","&#8970;","&#8971;","&#9001;","&#9002;","&#9674;","&#9824;","&#9827;","&#9829;","&#9830;"];return this.swapArrayVals(s,arr1,arr2)},NumericalToHTML:function(s){var arr1=["&#160;","&#161;","&#162;","&#163;","&#164;","&#165;","&#166;","&#167;","&#168;","&#169;","&#170;","&#171;","&#172;","&#173;","&#174;","&#175;","&#176;","&#177;","&#178;","&#179;","&#180;","&#181;","&#182;","&#183;","&#184;","&#185;","&#186;","&#187;","&#188;","&#189;","&#190;","&#191;","&#192;","&#193;","&#194;","&#195;","&#196;","&#197;","&#198;","&#199;","&#200;","&#201;","&#202;","&#203;","&#204;","&#205;","&#206;","&#207;","&#208;","&#209;","&#210;","&#211;","&#212;","&#213;","&#214;","&#215;","&#216;","&#217;","&#218;","&#219;","&#220;","&#221;","&#222;","&#223;","&#224;","&#225;","&#226;","&#227;","&#228;","&#229;","&#230;","&#231;","&#232;","&#233;","&#234;","&#235;","&#236;","&#237;","&#238;","&#239;","&#240;","&#241;","&#242;","&#243;","&#244;","&#245;","&#246;","&#247;","&#248;","&#249;","&#250;","&#251;","&#252;","&#253;","&#254;","&#255;","&#34;","&#38;","&#60;","&#62;","&#338;","&#339;","&#352;","&#353;","&#376;","&#710;","&#732;","&#8194;","&#8195;","&#8201;","&#8204;","&#8205;","&#8206;","&#8207;","&#8211;","&#8212;","&#8216;","&#8217;","&#8218;","&#8220;","&#8221;","&#8222;","&#8224;","&#8225;","&#8240;","&#8249;","&#8250;","&#8364;","&#402;","&#913;","&#914;","&#915;","&#916;","&#917;","&#918;","&#919;","&#920;","&#921;","&#922;","&#923;","&#924;","&#925;","&#926;","&#927;","&#928;","&#929;","&#931;","&#932;","&#933;","&#934;","&#935;","&#936;","&#937;","&#945;","&#946;","&#947;","&#948;","&#949;","&#950;","&#951;","&#952;","&#953;","&#954;","&#955;","&#956;","&#957;","&#958;","&#959;","&#960;","&#961;","&#962;","&#963;","&#964;","&#965;","&#966;","&#967;","&#968;","&#969;","&#977;","&#978;","&#982;","&#8226;","&#8230;","&#8242;","&#8243;","&#8254;","&#8260;","&#8472;","&#8465;","&#8476;","&#8482;","&#8501;","&#8592;","&#8593;","&#8594;","&#8595;","&#8596;","&#8629;","&#8656;","&#8657;","&#8658;","&#8659;","&#8660;","&#8704;","&#8706;","&#8707;","&#8709;","&#8711;","&#8712;","&#8713;","&#8715;","&#8719;","&#8721;","&#8722;","&#8727;","&#8730;","&#8733;","&#8734;","&#8736;","&#8743;","&#8744;","&#8745;","&#8746;","&#8747;","&#8756;","&#8764;","&#8773;","&#8776;","&#8800;","&#8801;","&#8804;","&#8805;","&#8834;","&#8835;","&#8836;","&#8838;","&#8839;","&#8853;","&#8855;","&#8869;","&#8901;","&#8968;","&#8969;","&#8970;","&#8971;","&#9001;","&#9002;","&#9674;","&#9824;","&#9827;","&#9829;","&#9830;"],arr2=["&nbsp;","&iexcl;","&cent;","&pound;","&curren;","&yen;","&brvbar;","&sect;","&uml;","&copy;","&ordf;","&laquo;","&not;","&shy;","&reg;","&macr;","&deg;","&plusmn;","&sup2;","&sup3;","&acute;","&micro;","&para;","&middot;","&cedil;","&sup1;","&ordm;","&raquo;","&frac14;","&frac12;","&frac34;","&iquest;","&agrave;","&aacute;","&acirc;","&atilde;","&Auml;","&aring;","&aelig;","&ccedil;","&egrave;","&eacute;","&ecirc;","&euml;","&igrave;","&iacute;","&icirc;","&iuml;","&eth;","&ntilde;","&ograve;","&oacute;","&ocirc;","&otilde;","&Ouml;","&times;","&oslash;","&ugrave;","&uacute;","&ucirc;","&Uuml;","&yacute;","&thorn;","&szlig;","&agrave;","&aacute;","&acirc;","&atilde;","&auml;","&aring;","&aelig;","&ccedil;","&egrave;","&eacute;","&ecirc;","&euml;","&igrave;","&iacute;","&icirc;","&iuml;","&eth;","&ntilde;","&ograve;","&oacute;","&ocirc;","&otilde;","&ouml;","&divide;","&oslash;","&ugrave;","&uacute;","&ucirc;","&uuml;","&yacute;","&thorn;","&yuml;","&quot;","&amp;","&lt;","&gt;","&oelig;","&oelig;","&scaron;","&scaron;","&yuml;","&circ;","&tilde;","&ensp;","&emsp;","&thinsp;","&zwnj;","&zwj;","&lrm;","&rlm;","&ndash;","&mdash;","&lsquo;","&rsquo;","&sbquo;","&ldquo;","&rdquo;","&bdquo;","&dagger;","&dagger;","&permil;","&lsaquo;","&rsaquo;","&euro;","&fnof;","&alpha;","&beta;","&gamma;","&delta;","&epsilon;","&zeta;","&eta;","&theta;","&iota;","&kappa;","&lambda;","&mu;","&nu;","&xi;","&omicron;","&pi;","&rho;","&sigma;","&tau;","&upsilon;","&phi;","&chi;","&psi;","&omega;","&alpha;","&beta;","&gamma;","&delta;","&epsilon;","&zeta;","&eta;","&theta;","&iota;","&kappa;","&lambda;","&mu;","&nu;","&xi;","&omicron;","&pi;","&rho;","&sigmaf;","&sigma;","&tau;","&upsilon;","&phi;","&chi;","&psi;","&omega;","&thetasym;","&upsih;","&piv;","&bull;","&hellip;","&prime;","&prime;","&oline;","&frasl;","&weierp;","&image;","&real;","&trade;","&alefsym;","&larr;","&uarr;","&rarr;","&darr;","&harr;","&crarr;","&larr;","&uarr;","&rarr;","&darr;","&harr;","&forall;","&part;","&exist;","&empty;","&nabla;","&isin;","&notin;","&ni;","&prod;","&sum;","&minus;","&lowast;","&radic;","&prop;","&infin;","&ang;","&and;","&or;","&cap;","&cup;","&int;","&there4;","&sim;","&cong;","&asymp;","&ne;","&equiv;","&le;","&ge;","&sub;","&sup;","&nsub;","&sube;","&supe;","&oplus;","&otimes;","&perp;","&sdot;","&lceil;","&rceil;","&lfloor;","&rfloor;","&lang;","&rang;","&loz;","&spades;","&clubs;","&hearts;","&diams;"];return this.swapArrayVals(s,arr1,arr2)},numEncode:function(s){var e,i,c;if(this.isEmpty(s))return"";for(e="",i=0;i<s.length;i++)c=s.charAt(i),(c<"
 "||c>"~")&&(c="&#"+c.charCodeAt()+";"),e+=c;return e},htmlDecode:function(s){var c,m,d=s,x;if(this.isEmpty(d))return"";if(d=this.HTML2Numerical(d),arr=d.match(/&#[0-9]{1,5};/g),arr!=null)for(x=0;x<arr.length;x++)m=arr[x],c=m.substring(2,m.length-1),d=c>=-32768&&c<=65535?d.replace(m,String.fromCharCode(c)):d.replace(m,"");return d},htmlEncode:function(s,dbl){return this.isEmpty(s)?"":(dbl=dbl|!1,dbl&&(s=this.EncodeType=="numerical"?s.replace(/&/g,"&#38;"):s.replace(/&/g,"&amp;")),s=this.XSSEncode(s,!1),this.EncodeType!="numerical"&&dbl||(s=this.HTML2Numerical(s)),s=this.numEncode(s),dbl||(s=s.replace(/&#/g,"##AMPHASH##"),s=this.EncodeType=="numerical"?s.replace(/&/g,"&#38;"):s.replace(/&/g,"&amp;"),s=s.replace(/##AMPHASH##/g,"&#")),s=s.replace(/&#\d*([^\d;]|$)/g,"$1"),dbl||(s=this.correctEncoding(s)),this.EncodeType=="entity"&&(s=this.NumericalToHTML(s)),s)},XSSEncode:function(s,en){return this.isEmpty(s)?"":(en=en||!0,en?(s=s.replace(/\'/g,"&#39;"),s=s.replace(/\"/g,"&quot;"),s=s.replace(/</g,"&lt;"),s=s.replace(/>/g,"&gt;")):(s=s.replace(/\'/g,"&#39;"),s=s.replace(/\"/g,"&#34;"),s=s.replace(/</g,"&#60;"),s=s.replace(/>/g,"&#62;")),s)},hasEncoded:function(s){return/&#[0-9]{1,5};/g.test(s)?!0:/&[A-Z]{2,6};/gi.test(s)?!0:!1},stripUnicode:function(s){return s.replace(/[^\x20-\x7E]/g,"")},correctEncoding:function(s){return s.replace(/(&amp;)(amp;)+/,"$1")},swapArrayVals:function(s,arr1,arr2){var re,x,i;if(this.isEmpty(s))return"";if(arr1&&arr2&&arr1.length==arr2.length)for(x=0,i=arr1.length;x<i;x++)re=new RegExp(arr1[x],"g"),s=s.replace(re,arr2[x]);return s},inArray:function(item,arr){for(var i=0,x=arr.length;i<x;i++)if(arr[i]===item)return i;return-1}};
function RenderDateFromJSON(data){var result=data.replace(/"\\\/Date\(([0-9]+)[-0-9]+\)\\\/"/gi,"new Date($1)"),integer,formattedDate;return result=data.substring(data.indexOf("(")+1,data.indexOf(")")),result=result.substring(0,result.indexOf("-")),integer=parseInt(result),formattedDate=new Date(integer),formattedDate}var dateFormat=function(){var token=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,timezone=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,timezoneClip=/[^-+\dA-Z]/g,pad=function(val,len){for(val=String(val),len=len||2;val.length<len;)val="0"+val;return val};return function(date,mask,utc){var dF=dateFormat;if(arguments.length!=1||Object.prototype.toString.call(date)!="[object String]"||/\d/.test(date)||(mask=date,date=undefined),date=date?new Date(date):new Date,isNaN(date))throw SyntaxError("invalid date");mask=String(dF.masks[mask]||mask||dF.masks["default"]),mask.slice(0,4)=="UTC:"&&(mask=mask.slice(4),utc=!0);var _=utc?"getUTC":"get",d=date[_+"Date"](),D=date[_+"Day"](),m=date[_+"Month"](),y=date[_+"FullYear"](),H=date[_+"Hours"](),M=date[_+"Minutes"](),s=date[_+"Seconds"](),L=date[_+"Milliseconds"](),o=utc?0:date.getTimezoneOffset(),flags={d:d,dd:pad(d),ddd:dF.i18n.dayNames[D],dddd:dF.i18n.dayNames[D+7],m:m+1,mm:pad(m+1),mmm:dF.i18n.monthNames[m],mmmm:dF.i18n.monthNames[m+12],yy:String(y).slice(2),yyyy:y,h:H%12||12,hh:pad(H%12||12),H:H,HH:pad(H),M:M,MM:pad(M),s:s,ss:pad(s),l:pad(L,3),L:pad(L>99?Math.round(L/10):L),t:H<12?"a":"p",tt:H<12?"am":"pm",T:H<12?"A":"P",TT:H<12?"AM":"PM",Z:utc?"UTC":(String(date).match(timezone)||[""]).pop().replace(timezoneClip,""),o:(o>0?"-":"+")+pad(Math.floor(Math.abs(o)/60)*100+Math.abs(o)%60,4),S:["th","st","nd","rd"][d%10>3?0:(d%100-d%10!=10)*d%10]};return mask.replace(token,function($0){return $0 in flags?flags[$0]:$0.slice(1,$0.length-1)})}}();dateFormat.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"},dateFormat.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]},Date.prototype.format=function(mask,utc){return dateFormat(this,mask,utc)};
jQuery.cookie=function(key,value,options){var days,t,result,decode;return arguments.length>1&&String(value)!=="[object Object]"?(options=jQuery.extend({},options),(value===null||value===undefined)&&(options.expires=-1),typeof options.expires=="number"&&(days=options.expires,t=options.expires=new Date,t.setDate(t.getDate()+days)),value=String(value),document.cookie=[encodeURIComponent(key),"=",options.raw?value:encodeURIComponent(value),options.expires?"; expires="+options.expires.toUTCString():"",options.path?"; path="+options.path:"",options.domain?"; domain="+options.domain:"",options.secure?"; secure":""].join("")):(options=value||{},decode=options.raw?function(s){return s}:decodeURIComponent,(result=new RegExp("(?:^|; )"+encodeURIComponent(key)+"=([^;]*)").exec(document.cookie))?decode(result[1]):null)};
/*!
 * jQuery Tools v1.2.7 - The missing UI library for the Web
 * 
 * tooltip/tooltip.js
 * tooltip/tooltip.dynamic.js
 * tooltip/tooltip.slide.js
 * 
 * NO COPYRIGHTS OR LICENSES. DO WHAT YOU LIKE.
 * 
 * http://flowplayer.org/tools/
 * 
 */
(function(a){function c(b,c,d){var e=d.relative?b.position().top:b.offset().top,f=d.relative?b.position().left:b.offset().left,g=d.position[0],h,i;return e-=c.outerHeight()-d.offset[0],f+=b.outerWidth()+d.offset[1],/iPad/i.test(navigator.userAgent)&&(e-=a(window).scrollTop()),h=c.outerHeight()+b.outerHeight(),g=="center"&&(e+=h/2),g=="bottom"&&(e+=h),g=d.position[1],i=c.outerWidth()+b.outerWidth(),g=="center"&&(f-=i/2),g=="left"&&(f-=i),{top:e,left:f}}function d(d,e){var f=this,g=d.add(f),h,i=0,j=0,k=d.attr("title"),l=d.attr("data-tooltip"),m=b[e.effect],n,o=d.is(":input"),p=o&&d.is(":checkbox, :radio, select, :button, :submit"),q=d.attr("type"),r=e.events[q]||e.events[o?p?"widget":"input":"def"];if(!m)throw'Nonexistent effect "'+e.effect+'"';if(r=r.split(/,\s*/),r.length!=2)throw"Tooltip: bad events configuration for "+q;d.on(r[0],function(a){clearTimeout(i),e.predelay?j=setTimeout(function(){f.show(a)},e.predelay):f.show(a)}).on(r[1],function(a){clearTimeout(j),e.delay?i=setTimeout(function(){f.hide(a)},e.delay):f.hide(a)}),k&&e.cancelDefault&&(d.removeAttr("title"),d.data("title",k)),a.extend(f,{show:function(b){var o,p;if(!h&&(l?h=a(l):e.tip?h=a(e.tip).eq(0):k?h=a(e.layout).addClass(e.tipClass).appendTo(document.body).hide().append(k):(h=d.next(),h.length||(h=d.parent().next())),!h.length))throw"Cannot find tooltip for "+d;return f.isShown()?f:(h.stop(!0,!0),o=c(d,h,e),e.tip&&h.html(d.data("title")),b=a.Event(),b.type="onBeforeShow",g.trigger(b,[o]),b.isDefaultPrevented())?f:(o=c(d,h,e),h.css({position:"absolute",top:o.top,left:o.left}),n=!0,m[0].call(f,function(){b.type="onShow",n="full",g.trigger(b)}),p=e.events.tooltip.split(/,\s*/),h.data("__set")||(h.off(p[0]).on(p[0],function(){clearTimeout(i),clearTimeout(j)}),p[1]&&!d.is("input:not(:checkbox, :radio), textarea")&&h.off(p[1]).on(p[1],function(a){a.relatedTarget!=d[0]&&d.trigger(r[1].split(" ")[0])}),e.tip||h.data("__set",!0)),f)},hide:function(c){return!h||!f.isShown()?f:(c=a.Event(),c.type="onBeforeHide",g.trigger(c),c.isDefaultPrevented()?void 0:(n=!1,b[e.effect][1].call(f,function(){c.type="onHide",g.trigger(c)}),f))},isShown:function(a){return a?n=="full":n},getConf:function(){return e},getTip:function(){return h},getTrigger:function(){return d}}),a.each("onHide,onBeforeShow,onShow,onBeforeHide".split(","),function(b,c){a.isFunction(e[c])&&a(f).on(c,e[c]),f[c]=function(b){return b&&a(f).on(c,b),f}})}a.tools=a.tools||{version:"v1.2.7"},a.tools.tooltip={conf:{effect:"toggle",fadeOutSpeed:"fast",predelay:0,delay:30,opacity:1,tip:0,fadeIE:!1,position:["top","center"],offset:[0,0],relative:!1,cancelDefault:!0,events:{def:"mouseenter,mouseleave",input:"focus,blur",widget:"focus mouseenter,blur mouseleave",tooltip:"mouseenter,mouseleave"},layout:"<div/>",tipClass:"tooltip"},addEffect:function(a,c,d){b[a]=[c,d]}};var b={toggle:[function(a){var b=this.getConf(),c=this.getTip(),d=b.opacity;d<1&&c.css({opacity:d}),c.show(),a.call()},function(a){this.getTip().hide(),a.call()}],fade:[function(b){var c=this.getConf();!a.browser.msie||c.fadeIE?this.getTip().fadeTo(c.fadeInSpeed,c.opacity,b):(this.getTip().show(),b())},function(b){var c=this.getConf();!a.browser.msie||c.fadeIE?this.getTip().fadeOut(c.fadeOutSpeed,b):(this.getTip().hide(),b())}]};a.fn.tooltip=function(b){var c=this.data("tooltip");return c?c:(b=a.extend(!0,{},a.tools.tooltip.conf,b),typeof b.position=="string"&&(b.position=b.position.split(/,?\s/)),this.each(function(){c=new d(a(this),b),a(this).data("tooltip",c)}),b.api?c:this)}})(jQuery),function(a){function c(b){var c=a(window),d=c.width()+c.scrollLeft(),e=c.height()+c.scrollTop();return[b.offset().top<=c.scrollTop(),d<=b.offset().left+b.width(),e<=b.offset().top+b.height(),c.scrollLeft()>=b.offset().left]}function d(a){for(var b=a.length;b--;)if(a[b])return!1;return!0}var b=a.tools.tooltip;b.dynamic={conf:{classNames:"top right bottom left"}},a.fn.dynamic=function(e){typeof e=="number"&&(e={speed:e}),e=a.extend({},b.dynamic.conf,e);var f=a.extend(!0,{},e),g=e.classNames.split(/\s/),h;return this.each(function(){var b=a(this).tooltip().onBeforeShow(function(b,e){var i=this.getTip(),j=this.getConf(),k,l;h||(h=[j.position[0],j.position[1],j.offset[0],j.offset[1],a.extend({},j)]),a.extend(j,h[4]),j.position=[h[0],h[1]],j.offset=[h[2],h[3]],i.css({visibility:"hidden",position:"absolute",top:e.top,left:e.left}).show(),k=a.extend(!0,{},f),l=c(i),d(l)||(l[2]&&(a.extend(j,k.top),j.position[0]="top",i.addClass(g[0])),l[3]&&(a.extend(j,k.right),j.position[1]="right",i.addClass(g[1])),l[0]&&(a.extend(j,k.bottom),j.position[0]="bottom",i.addClass(g[2])),l[1]&&(a.extend(j,k.left),j.position[1]="left",i.addClass(g[3])),(l[0]||l[2])&&(j.offset[0]*=-1),(l[1]||l[3])&&(j.offset[1]*=-1)),i.css({visibility:"visible"}).hide()});b.onBeforeShow(function(){var a=this.getConf(),b=this.getTip();setTimeout(function(){a.position=[h[0],h[1]],a.offset=[h[2],h[3]]},0)}),b.onHide(function(){var a=this.getTip();a.removeClass(e.classNames)}),ret=b}),e.api?ret:this}}(jQuery),function(a){var b=a.tools.tooltip,c;a.extend(b.conf,{direction:"up",bounce:!1,slideOffset:10,slideInSpeed:200,slideOutSpeed:200,slideFade:!a.browser.msie}),c={up:["-","top"],down:["+","top"],left:["-","left"],right:["+","left"]},b.addEffect("slide",function(a){var b=this.getConf(),d=this.getTip(),e=b.slideFade?{opacity:b.opacity}:{},f=c[b.direction]||c.up;e[f[1]]=f[0]+"="+b.slideOffset,b.slideFade&&d.css({opacity:0}),d.show().animate(e,b.slideInSpeed,a)},function(b){var d=this.getConf(),e=d.slideOffset,f=d.slideFade?{opacity:0}:{},g=c[d.direction]||c.up,h=""+g[0];d.bounce&&(h=h=="+"?"-":"+"),f[g[1]]=h+"="+e,this.getTip().animate(f,d.slideOutSpeed,function(){a(this).hide(),b.call()})})}(jQuery),function(a){function d(c,d,e){var f=this,g=c.add(this),h=c.find(e.tabs2),i=d.jquery?d:c.children(d),j;h.length||(h=c.children()),i.length||(i=c.parent().find(d)),i.length||(i=a(d)),a.extend(this,{click:function(c,d){var i=h.eq(c),k;if(typeof c=="string"&&c.replace("#","")&&(i=h.filter("[href*="+c.replace("#","")+"]"),c=Math.max(h.index(i),0)),e.rotate){if(k=h.length-1,c<0)return f.click(k,d);if(c>k)return f.click(0,d)}if(!i.length){if(j>=0)return f;c=e.initialIndex,i=h.eq(c)}return c===j?f:(d=d||a.Event(),d.type="onBeforeClick",g.trigger(d,[c]),d.isDefaultPrevented()?void 0:(b[e.effect].call(f,c,function(){d.type="onClick",g.trigger(d,[c])}),j=c,h.removeClass(e.current),i.addClass(e.current),f))},getConf:function(){return e},getTabs:function(){return h},getPanes:function(){return i},getCurrentPane:function(){return i.eq(j)},getCurrentTab:function(){return h.eq(j)},getIndex:function(){return j},next:function(){return f.click(j+1)},prev:function(){return f.click(j-1)},destroy:function(){return h.unbind(e.event).removeClass(e.current),i.find("a[href^=#]").unbind("click.T"),f}}),a.each("onBeforeClick,onClick".split(","),function(b,c){a.isFunction(e[c])&&a(f).bind(c,e[c]),f[c]=function(b){return b&&a(f).bind(c,b),f}}),e.history&&a.fn.history&&(a.tools.history.init(h),e.event="history"),h.each(function(b){a(this).bind(e.event,function(a){return f.click(b,a),a.preventDefault()})}),i.find("a[href^=#]").bind("click.T",function(b){f.click(a(this).attr("href"),b)}),location.hash&&e.tabs2=="a"&&c.find("[href="+location.hash+"]").length?f.click(location.hash):(e.initialIndex===0||e.initialIndex>0)&&f.click(e.initialIndex)}a.tools=a.tools||{version:"v1.2.5"},a.tools.tabs2={conf:{tabs2:"a",current:"current",onBeforeClick:null,onClick:null,effect:"default",initialIndex:0,event:"click",rotate:!1,history:!1},addEffect:function(a,c){b[a]=c}};var b={"default":function(a,b){this.getPanes().hide().eq(a).show(),b.call()},fade:function(a,b){var c=this.getConf(),d=c.fadeOutSpeed,e=this.getPanes();d?e.fadeOut(d):e.hide(),e.eq(a).fadeIn(c.fadeInSpeed,b)},slide:function(a,b){this.getPanes().slideUp(200),this.getPanes().eq(a).slideDown(400,b)},ajax:function(a,b){this.getPanes().eq(0).load(this.getTabs().eq(a).attr("href"),b)}},c;a.tools.tabs2.addEffect("horizontal",function(b,d){c||(c=this.getPanes().eq(0).width()),this.getCurrentPane().animate({width:0},function(){a(this).hide()}),this.getPanes().eq(b).animate({width:c},function(){a(this).show(),d.call()})}),a.fn.tabs2=function(b,c){var e=this.data("tabs2");return e&&(e.destroy(),this.removeData("tabs2")),a.isFunction(c)&&(c={onBeforeClick:c}),c=a.extend({},a.tools.tabs2.conf,c),this.each(function(){e=new d(a(this),b,c),a(this).data("tabs2",e)}),c.api?e:this}}(jQuery),function(a){function c(b,c){function i(c){var d=a(c);return d.length<2?d:b.parent().find(c)}var d=this,e=b.add(this),f=b.data("tabs2"),g,h=!0,j=i(c.next).click(function(){f.next()}),k=i(c.prev).click(function(){f.prev()}),l;a.extend(d,{getTabs:function(){return f},getConf:function(){return c},play:function(){if(g)return d;var b=a.Event("onBeforePlay");return(e.trigger(b),b.isDefaultPrevented())?d:(g=setInterval(f.next,c.interval),h=!1,e.trigger("onPlay"),d)},pause:function(){if(!g)return d;var b=a.Event("onBeforePause");return(e.trigger(b),b.isDefaultPrevented())?d:(g=clearInterval(g),e.trigger("onPause"),d)},stop:function(){d.pause(),h=!0}}),a.each("onBeforePlay,onPlay,onBeforePause,onPause".split(","),function(b,e){a.isFunction(c[e])&&a(d).bind(e,c[e]),d[e]=function(b){return a(d).bind(e,b)}}),c.autopause&&f.getTabs().add(j).add(k).add(f.getPanes()).hover(d.pause,function(){h||d.play()}),c.autoplay&&d.play(),c.clickable&&f.getPanes().click(function(){f.next()}),f.getConf().rotate||(l=c.disabledClass,f.getIndex()||k.addClass(l),f.onBeforeClick(function(a,b){k.toggleClass(l,!b),j.toggleClass(l,b==f.getTabs().length-1)}))}var b;b=a.tools.tabs2.slideshow={conf:{next:".forward",prev:".backward",disabledClass:"disabled",autoplay:!1,autopause:!0,interval:3e3,clickable:!0,api:!1}},a.fn.slideshow=function(d){var e=this.data("slideshow");return e?e:(d=a.extend({},b.conf,d),this.each(function(){e=new c(a(this),d),a(this).data("slideshow",e)}),d.api?e:this)}}(jQuery);
(function($){function createHelper(settings){helper.parent||(helper.parent=$('<div id="'+settings.id+'"><h3></h3><div class="body"></div><div class="url"></div></div>').appendTo(document.body).hide(),$.fn.bgiframe&&helper.parent.bgiframe(),helper.title=$("h3",helper.parent),helper.body=$("div.body",helper.parent),helper.url=$("div.url",helper.parent))}function settings(element){return $.data(element,"tooltip2")}function handle(event){settings(this).delay?tID=setTimeout(show,settings(this).delay):show(),track=!!settings(this).track,$(document.body).bind("mousemove",update),update(event)}function save(){var bodyContent,parts,i,part;if(!$.tooltip2.blocked&&this!=current&&(this.tooltipText||settings(this).bodyHandler)){if(current=this,title=this.tooltipText,settings(this).bodyHandler)helper.title.hide(),bodyContent=settings(this).bodyHandler.call(this),bodyContent.nodeType||bodyContent.jquery?helper.body.empty().append(bodyContent):helper.body.html(bodyContent),helper.body.show();else if(settings(this).showBody){for(parts=title.split(settings(this).showBody),helper.title.html(parts.shift()).show(),helper.body.empty(),i=0;part=parts[i];i++)i>0&&helper.body.append("<br/>"),helper.body.append(part);helper.body.hideWhenEmpty()}else helper.title.html(title).show(),helper.body.hide();settings(this).showURL&&$(this).url()?helper.url.html($(this).url().replace("http://","")).show():helper.url.hide(),helper.parent.addClass(settings(this).extraClass),settings(this).fixPNG&&helper.parent.fixPNG(),handle.apply(this,arguments)}}function show(){tID=null,IE&&$.fn.bgiframe||!settings(current).fade?helper.parent.show():helper.parent.is(":animated")?helper.parent.stop().show().fadeTo(settings(current).fade,current.tOpacity):helper.parent.is(":visible")?helper.parent.fadeTo(settings(current).fade,current.tOpacity):helper.parent.fadeIn(settings(current).fade),update()}function update(event){var left,top,right,v,h;if(!$.tooltip2.blocked&&(!event||event.target.tagName!="OPTION")){if(!track&&helper.parent.is(":visible")&&$(document.body).unbind("mousemove",update),current==null){$(document.body).unbind("mousemove",update);return}helper.parent.removeClass("viewport-right").removeClass("viewport-bottom"),left=helper.parent[0].offsetLeft,top=helper.parent[0].offsetTop,event&&(left=event.pageX+settings(current).left,top=event.pageY+settings(current).top,right="auto",settings(current).positionLeft&&(right=$(window).width()-left,left="auto"),helper.parent.css({left:left,right:right,top:top})),v=viewport(),h=helper.parent[0],v.x+v.cx<h.offsetLeft+h.offsetWidth&&(left-=h.offsetWidth+20+settings(current).left,helper.parent.css({left:left+"px"}).addClass("viewport-right")),v.y+v.cy<h.offsetTop+h.offsetHeight&&(top-=h.offsetHeight+20+settings(current).top,helper.parent.css({top:top+"px"}).addClass("viewport-bottom"))}}function viewport(){return{x:$(window).scrollLeft(),y:$(window).scrollTop(),cx:$(window).width(),cy:$(window).height()}}function hide(){function complete(){helper.parent.removeClass(tsettings.extraClass).hide().css("opacity","")}if(!$.tooltip2.blocked){tID&&clearTimeout(tID),current=null;var tsettings=settings(this);IE&&$.fn.bgiframe||!tsettings.fade?complete():helper.parent.is(":animated")?helper.parent.stop().fadeTo(tsettings.fade,0,complete):helper.parent.stop().fadeOut(tsettings.fade,complete),settings(this).fixPNG&&helper.parent.unfixPNG()}}var helper={},current,title,tID,IE=$.browser.msie&&/MSIE\s(5\.5|6\.)/.test(navigator.userAgent),track=!1;$.tooltip2={blocked:!1,defaults:{delay:200,fade:!1,showURL:!0,extraClass:"",top:15,left:15,id:"tooltip"},block:function(){$.tooltip2.blocked=!$.tooltip2.blocked}},$.fn.extend({tooltip2:function(settings){return settings=$.extend({},$.tooltip2.defaults,settings),createHelper(settings),this.each(function(){$.data(this,"tooltip2",settings),this.tOpacity=helper.parent.css("opacity"),this.tooltipText=this.title,$(this).removeAttr("title"),this.alt=""}).mouseover(save).mouseout(hide).click(hide)},fixPNG:IE?function(){return this.each(function(){var image=$(this).css("backgroundImage");image.match(/^url\(["']?(.*\.png)["']?\)$/i)&&(image=RegExp.$1,$(this).css({backgroundImage:"none",filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod=crop, src='"+image+"')"}).each(function(){var position=$(this).css("position");position!="absolute"&&position!="relative"&&$(this).css("position","relative")}))})}:function(){return this},unfixPNG:IE?function(){return this.each(function(){$(this).css({filter:"",backgroundImage:""})})}:function(){return this},hideWhenEmpty:function(){return this.each(function(){$(this)[$(this).html()?"show":"hide"]()})},url:function(){return this.attr("href")||this.attr("src")}})})(jQuery);
(function(){function ls(){for(var c=document.cookie.split(";"),p,j,e,o,i=0;i<c.length;i++)if(p=c[i].split("="),p[0]=="scrollPosition"){for(p=unescape(p[1]).split("/"),j=0;j<p.length;j++){e=p[j].split(",");try{e[0]=="window"?window.scrollTo(e[1],e[2]):e[0]&&(o=document.getElementById(e[0]),o.scrollLeft=e[1],o.scrollTop=e[2])}catch(ex){}}return}}function ss(){var s="scrollPosition=",l,t,es,i,e;for(window.pageXOffset!==undefined?(l=window.pageXOffset,t=window.pageYOffset):document.documentElement&&document.documentElement.scrollLeft!==undefined?(l=document.documentElement.scrollLeft,t=document.documentElement.scrollTop):(l=document.body.scrollLeft,t=document.body.scrollTop),(l||t)&&(s+="window,"+l+","+t+"/"),es=document.all?document.all:document.getElementsByTagName("*"),i=0;i<es.length;i++)e=es[i],e.id&&(e.scrollLeft||e.scrollTop)&&(s+=e.id+","+e.scrollLeft+","+e.scrollTop+"/");document.cookie=s+";"}var a,p;window.attachEvent?(a=window.attachEvent,p="on"):(a=window.addEventListener,p=""),a(p+"load",function(){ls(),typeof Sys!="undefined"&&typeof Sys.WebForms!="undefined"&&(Sys.WebForms.PageRequestManager.getInstance().add_endRequest(ls),Sys.WebForms.PageRequestManager.getInstance().add_beginRequest(ss))},!1),a(p+"unload",ss,!1)})();
(function($){$.fn.lightBox=function(settings){function _initialize(){return _start(this,jQueryMatchedObj),!1}function _start(objClicked,jQueryMatchedObj){if($("embed, object, select").css({visibility:"hidden"}),_set_interface(),settings.imageArray.length=0,settings.activeImage=0,jQueryMatchedObj.length==1)settings.imageArray.push([objClicked.getAttribute("href"),objClicked.getAttribute("title")]);else for(var i=0;i<jQueryMatchedObj.length;i++)settings.imageArray.push([jQueryMatchedObj[i].getAttribute("href"),jQueryMatchedObj[i].getAttribute("title")]);while(settings.imageArray[settings.activeImage][0]!=objClicked.getAttribute("href"))settings.activeImage++;_set_image_to_view()}function _set_interface(){var arrPageSizes,arrPageScroll;$("body").append('<div id="jquery-overlay"></div><div id="jquery-lightbox"><div id="lightbox-container-image-box"><div id="lightbox-container-image"><img id="lightbox-image"><div style="" id="lightbox-nav"><a href="#" id="lightbox-nav-btnPrev"></a><a href="#" id="lightbox-nav-btnNext"></a></div><div id="lightbox-loading"><a href="#" id="lightbox-loading-link"><img src="'+settings.imageLoading+'"></a></div></div></div><div id="lightbox-container-image-data-box"><div id="lightbox-container-image-data"><div id="lightbox-image-details"><span id="lightbox-image-details-caption"></span><span id="lightbox-image-details-currentNumber"></span></div><div id="lightbox-secNav"><a href="#" id="lightbox-secNav-btnClose"><img src="'+settings.imageBtnClose+'"></a></div></div></div></div>'),arrPageSizes=___getPageSize(),$("#jquery-overlay").css({backgroundColor:settings.overlayBgColor,opacity:settings.overlayOpacity,width:arrPageSizes[0],height:arrPageSizes[1]}).fadeIn(),arrPageScroll=___getPageScroll(),$("#jquery-lightbox").css({top:arrPageScroll[1]+arrPageSizes[3]/10,left:arrPageScroll[0]}).show(),$("#jquery-overlay,#jquery-lightbox").click(function(){_finish()}),$("#lightbox-loading-link,#lightbox-secNav-btnClose").click(function(){return _finish(),!1}),$(window).resize(function(){var arrPageSizes=___getPageSize(),arrPageScroll;$("#jquery-overlay").css({width:arrPageSizes[0],height:arrPageSizes[1]}),arrPageScroll=___getPageScroll(),$("#jquery-lightbox").css({top:arrPageScroll[1]+arrPageSizes[3]/10,left:arrPageScroll[0]})})}function _set_image_to_view(){$("#lightbox-loading").show(),settings.fixedNavigation?$("#lightbox-image,#lightbox-container-image-data-box,#lightbox-image-details-currentNumber").hide():$("#lightbox-image,#lightbox-nav,#lightbox-nav-btnPrev,#lightbox-nav-btnNext,#lightbox-container-image-data-box,#lightbox-image-details-currentNumber").hide();var objImagePreloader=new Image;objImagePreloader.onload=function(){$("#lightbox-image").attr("src",settings.imageArray[settings.activeImage][0]),_resize_container_image_box(objImagePreloader.width,objImagePreloader.height),objImagePreloader.onload=function(){}},objImagePreloader.src=settings.imageArray[settings.activeImage][0]}function _resize_container_image_box(intImageWidth,intImageHeight){var intCurrentWidth=$("#lightbox-container-image-box").width(),intCurrentHeight=$("#lightbox-container-image-box").height(),intWidth=intImageWidth+settings.containerBorderSize*2,intHeight=intImageHeight+settings.containerBorderSize*2,intDiffW=intCurrentWidth-intWidth,intDiffH=intCurrentHeight-intHeight;$("#lightbox-container-image-box").animate({width:intWidth,height:intHeight},settings.containerResizeSpeed,function(){_show_image()}),intDiffW==0&&intDiffH==0&&($.browser.msie?___pause(250):___pause(100)),$("#lightbox-container-image-data-box").css({width:intImageWidth}),$("#lightbox-nav-btnPrev,#lightbox-nav-btnNext").css({height:intImageHeight+settings.containerBorderSize*2})}function _show_image(){$("#lightbox-loading").hide(),$("#lightbox-image").fadeIn(function(){_show_image_data(),_set_navigation()}),_preload_neighbor_images()}function _show_image_data(){$("#lightbox-container-image-data-box").slideDown("fast"),$("#lightbox-image-details-caption").hide(),settings.imageArray[settings.activeImage][1]&&$("#lightbox-image-details-caption").html(settings.imageArray[settings.activeImage][1]).show(),settings.imageArray.length>1&&$("#lightbox-image-details-currentNumber").html(settings.txtImage+" "+(settings.activeImage+1)+" "+settings.txtOf+" "+settings.imageArray.length).show()}function _set_navigation(){$("#lightbox-nav").show(),$("#lightbox-nav-btnPrev,#lightbox-nav-btnNext").css({background:"transparent url("+settings.imageBlank+") no-repeat"}),settings.activeImage!=0&&(settings.fixedNavigation?$("#lightbox-nav-btnPrev").css({background:"url("+settings.imageBtnPrev+") left 15% no-repeat"}).unbind().bind("click",function(){return settings.activeImage=settings.activeImage-1,_set_image_to_view(),!1}):$("#lightbox-nav-btnPrev").unbind().hover(function(){$(this).css({background:"url("+settings.imageBtnPrev+") left 15% no-repeat"})},function(){$(this).css({background:"transparent url("+settings.imageBlank+") no-repeat"})}).show().bind("click",function(){return settings.activeImage=settings.activeImage-1,_set_image_to_view(),!1})),settings.activeImage!=settings.imageArray.length-1&&(settings.fixedNavigation?$("#lightbox-nav-btnNext").css({background:"url("+settings.imageBtnNext+") right 15% no-repeat"}).unbind().bind("click",function(){return settings.activeImage=settings.activeImage+1,_set_image_to_view(),!1}):$("#lightbox-nav-btnNext").unbind().hover(function(){$(this).css({background:"url("+settings.imageBtnNext+") right 15% no-repeat"})},function(){$(this).css({background:"transparent url("+settings.imageBlank+") no-repeat"})}).show().bind("click",function(){return settings.activeImage=settings.activeImage+1,_set_image_to_view(),!1})),_enable_keyboard_navigation()}function _enable_keyboard_navigation(){$(document).keydown(function(objEvent){_keyboard_action(objEvent)})}function _disable_keyboard_navigation(){$(document).unbind()}function _keyboard_action(objEvent){objEvent==null?(keycode=event.keyCode,escapeKey=27):(keycode=objEvent.keyCode,escapeKey=objEvent.DOM_VK_ESCAPE),key=String.fromCharCode(keycode).toLowerCase(),(key==settings.keyToClose||key=="x"||keycode==escapeKey)&&_finish(),(key==settings.keyToPrev||keycode==37)&&settings.activeImage!=0&&(settings.activeImage=settings.activeImage-1,_set_image_to_view(),_disable_keyboard_navigation()),(key==settings.keyToNext||keycode==39)&&settings.activeImage!=settings.imageArray.length-1&&(settings.activeImage=settings.activeImage+1,_set_image_to_view(),_disable_keyboard_navigation())}function _preload_neighbor_images(){settings.imageArray.length-1>settings.activeImage&&(objNext=new Image,objNext.src=settings.imageArray[settings.activeImage+1][0]),settings.activeImage>0&&(objPrev=new Image,objPrev.src=settings.imageArray[settings.activeImage-1][0])}function _finish(){$("#jquery-lightbox").remove(),$("#jquery-overlay").fadeOut(function(){$("#jquery-overlay").remove()}),$("embed, object, select").css({visibility:"visible"})}function ___getPageSize(){var xScroll,yScroll,windowWidth,windowHeight;return window.innerHeight&&window.scrollMaxY?(xScroll=window.innerWidth+window.scrollMaxX,yScroll=window.innerHeight+window.scrollMaxY):document.body.scrollHeight>document.body.offsetHeight?(xScroll=document.body.scrollWidth,yScroll=document.body.scrollHeight):(xScroll=document.body.offsetWidth,yScroll=document.body.offsetHeight),self.innerHeight?(windowWidth=document.documentElement.clientWidth?document.documentElement.clientWidth:self.innerWidth,windowHeight=self.innerHeight):document.documentElement&&document.documentElement.clientHeight?(windowWidth=document.documentElement.clientWidth,windowHeight=document.documentElement.clientHeight):document.body&&(windowWidth=document.body.clientWidth,windowHeight=document.body.clientHeight),pageHeight=yScroll<windowHeight?windowHeight:yScroll,pageWidth=xScroll<windowWidth?xScroll:windowWidth,arrayPageSize=[pageWidth,pageHeight,windowWidth,windowHeight]}function ___getPageScroll(){var xScroll,yScroll;return self.pageYOffset?(yScroll=self.pageYOffset,xScroll=self.pageXOffset):document.documentElement&&document.documentElement.scrollTop?(yScroll=document.documentElement.scrollTop,xScroll=document.documentElement.scrollLeft):document.body&&(yScroll=document.body.scrollTop,xScroll=document.body.scrollLeft),arrayPageScroll=[xScroll,yScroll]}function ___pause(ms){var date=new Date,curDate;curDate=null;do curDate=new Date;while(curDate-date<ms)}settings=jQuery.extend({overlayBgColor:"#000",overlayOpacity:.8,fixedNavigation:!1,imageLoading:"/images/lightbox/lightbox-ico-loading.gif",imageBtnPrev:"/images/lightbox/lightbox-btn-prev.gif",imageBtnNext:"/images/lightbox/lightbox-btn-next.gif",imageBtnClose:"/images/lightbox/lightbox-btn-close.gif",imageBlank:"/images/lightbox/lightbox-blank.gif",containerBorderSize:10,containerResizeSpeed:400,txtImage:"Image",txtOf:"of",keyToClose:"c",keyToPrev:"p",keyToNext:"n",imageArray:[],activeImage:0},settings);var jQueryMatchedObj=this;return this.unbind("click").click(_initialize)}})(jQuery);
(function($){$.fn.hoverIntent=function(f,g){var cfg={sensitivity:7,interval:100,timeout:0};cfg=$.extend(cfg,g?{over:f,out:g}:f);var cX,cY,pX,pY,track=function(ev){cX=ev.pageX,cY=ev.pageY},compare=function(ev,ob){if(ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t),Math.abs(pX-cX)+Math.abs(pY-cY)<cfg.sensitivity)return $(ob).unbind("mousemove",track),ob.hoverIntent_s=1,cfg.over.apply(ob,[ev]);pX=cX,pY=cY,ob.hoverIntent_t=setTimeout(function(){compare(ev,ob)},cfg.interval)},delay=function(ev,ob){return ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t),ob.hoverIntent_s=0,cfg.out.apply(ob,[ev])},handleHover=function(e){for(var p=(e.type=="mouseover"?e.fromElement:e.toElement)||e.relatedTarget,ev,ob;p&&p!=this;)try{p=p.parentNode}catch(e){p=this}if(p==this)return!1;ev=jQuery.extend({},e),ob=this,ob.hoverIntent_t&&(ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t)),e.type=="mouseover"?(pX=ev.pageX,pY=ev.pageY,$(ob).bind("mousemove",track),ob.hoverIntent_s!=1&&(ob.hoverIntent_t=setTimeout(function(){compare(ev,ob)},cfg.interval))):($(ob).unbind("mousemove",track),ob.hoverIntent_s==1&&(ob.hoverIntent_t=setTimeout(function(){delay(ev,ob)},cfg.timeout)))};return this.mouseover(handleHover).mouseout(handleHover)}})(jQuery);
/*! jQuery Validation Plugin - v1.10.0 - 9/7/2012
* https://github.com/jzaefferer/jquery-validation
* Copyright (c) 2012 Jörn Zaefferer; Licensed MIT, GPL */
(function(a){a.extend(a.fn,{validate:function(b){if(!this.length){b&&b.debug&&window.console&&console.warn("nothing selected, can't validate, returning nothing");return}var c=a.data(this[0],"validator");return c?c:(this.attr("novalidate","novalidate"),c=new a.validator(b,this[0]),a.data(this[0],"validator",c),c.settings.onsubmit&&(this.validateDelegate(":submit","click",function(b){c.settings.submitHandler&&(c.submitButton=b.target),a(b.target).hasClass("cancel")&&(c.cancelSubmit=!0)}),this.submit(function(b){function d(){var d;return c.settings.submitHandler?(c.submitButton&&(d=a("<input type='hidden'/>").attr("name",c.submitButton.name).val(c.submitButton.value).appendTo(c.currentForm)),c.settings.submitHandler.call(c,c.currentForm,b),c.submitButton&&d.remove(),!1):!0}return c.settings.debug&&b.preventDefault(),c.cancelSubmit?(c.cancelSubmit=!1,d()):c.form()?c.pendingRequest?(c.formSubmitted=!0,!1):d():(c.focusInvalid(),!1)})),c)},valid:function(){if(a(this[0]).is("form"))return this.validate().form();var b=!0,c=a(this[0].form).validate();return this.each(function(){b&=c.element(this)}),b},removeAttrs:function(b){var c={},d=this;return a.each(b.split(/\s/),function(a,b){c[b]=d.attr(b),d.removeAttr(b)}),c},rules:function(b,c){var d=this[0],h,i,j;if(b){var e=a.data(d.form,"validator").settings,f=e.rules,g=a.validator.staticRules(d);switch(b){case"add":a.extend(g,a.validator.normalizeRule(c)),f[d.name]=g,c.messages&&(e.messages[d.name]=a.extend(e.messages[d.name],c.messages));break;case"remove":return c?(h={},a.each(c.split(/\s/),function(a,b){h[b]=g[b],delete g[b]}),h):(delete f[d.name],g)}}return i=a.validator.normalizeRules(a.extend({},a.validator.metadataRules(d),a.validator.classRules(d),a.validator.attributeRules(d),a.validator.staticRules(d)),d),i.required&&(j=i.required,delete i.required,i=a.extend({required:j},i)),i}}),a.extend(a.expr[":"],{blank:function(b){return!a.trim(""+b.value)},filled:function(b){return!!a.trim(""+b.value)},unchecked:function(a){return!a.checked}}),a.validator=function(b,c){this.settings=a.extend(!0,{},a.validator.defaults,b),this.currentForm=c,this.init()},a.validator.format=function(b,c){return arguments.length===1?function(){var c=a.makeArray(arguments);return c.unshift(b),a.validator.format.apply(this,c)}:(arguments.length>2&&c.constructor!==Array&&(c=a.makeArray(arguments).slice(1)),c.constructor!==Array&&(c=[c]),a.each(c,function(a,c){b=b.replace(new RegExp("\\{"+a+"\\}","g"),c)}),b)},a.extend(a.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",validClass:"valid",errorElement:"label",focusInvalid:!0,errorContainer:a([]),errorLabelContainer:a([]),onsubmit:!0,ignore:":hidden",ignoreTitle:!1,onfocusin:function(a){this.lastActive=a,this.settings.focusCleanup&&!this.blockFocusCleanup&&(this.settings.unhighlight&&this.settings.unhighlight.call(this,a,this.settings.errorClass,this.settings.validClass),this.addWrapper(this.errorsFor(a)).hide())},onfocusout:function(a){!this.checkable(a)&&(a.name in this.submitted||!this.optional(a))&&this.element(a)},onkeyup:function(a,b){(b.which!==9||this.elementValue(a)!=="")&&(a.name in this.submitted||a===this.lastActive)&&this.element(a)},onclick:function(a){a.name in this.submitted?this.element(a):a.parentNode.name in this.submitted&&this.element(a.parentNode)},highlight:function(b,c,d){b.type==="radio"?this.findByName(b.name).addClass(c).removeClass(d):a(b).addClass(c).removeClass(d)},unhighlight:function(b,c,d){b.type==="radio"?this.findByName(b.name).removeClass(c).addClass(d):a(b).removeClass(c).addClass(d)}},setDefaults:function(b){a.extend(a.validator.defaults,b)},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",maxlength:a.validator.format("Please enter no more than {0} characters."),minlength:a.validator.format("Please enter at least {0} characters."),rangelength:a.validator.format("Please enter a value between {0} and {1} characters long."),range:a.validator.format("Please enter a value between {0} and {1}."),max:a.validator.format("Please enter a value less than or equal to {0}."),min:a.validator.format("Please enter a value greater than or equal to {0}.")},autoCreateRanges:!1,prototype:{init:function(){function d(b){var c=a.data(this[0].form,"validator"),d="on"+b.type.replace(/^validate/,"");c.settings[d]&&c.settings[d].call(c,this[0],b)}var b,c;this.labelContainer=a(this.settings.errorLabelContainer),this.errorContext=this.labelContainer.length&&this.labelContainer||a(this.currentForm),this.containers=a(this.settings.errorContainer).add(this.settings.errorLabelContainer),this.submitted={},this.valueCache={},this.pendingRequest=0,this.pending={},this.invalid={},this.reset(),b=this.groups={},a.each(this.settings.groups,function(c,d){a.each(d.split(/\s/),function(a,d){b[d]=c})}),c=this.settings.rules,a.each(c,function(b,d){c[b]=a.validator.normalizeRule(d)}),a(this.currentForm).validateDelegate(":text, [type='password'], [type='file'], select, textarea, [type='number'], [type='search'] ,[type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], [type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'] ","focusin focusout keyup",d).validateDelegate("[type='radio'], [type='checkbox'], select, option","click",d),this.settings.invalidHandler&&a(this.currentForm).bind("invalid-form.validate",this.settings.invalidHandler)},form:function(){return this.checkForm(),a.extend(this.submitted,this.errorMap),this.invalid=a.extend({},this.errorMap),this.valid()||a(this.currentForm).triggerHandler("invalid-form",[this]),this.showErrors(),this.valid()},checkForm:function(){this.prepareForm();for(var a=0,b=this.currentElements=this.elements();b[a];a++)this.check(b[a]);return this.valid()},element:function(b){b=this.validationTargetFor(this.clean(b)),this.lastElement=b,this.prepareElement(b),this.currentElements=a(b);var c=this.check(b)!==!1;return c?delete this.invalid[b.name]:this.invalid[b.name]=!0,this.numberOfInvalids()||(this.toHide=this.toHide.add(this.containers)),this.showErrors(),c},showErrors:function(b){if(b){a.extend(this.errorMap,b),this.errorList=[];for(var c in b)this.errorList.push({message:b[c],element:this.findByName(c)[0]});this.successList=a.grep(this.successList,function(a){return!(a.name in b)})}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){a.fn.resetForm&&a(this.currentForm).resetForm(),this.submitted={},this.lastElement=null,this.prepareForm(),this.hideErrors(),this.elements().removeClass(this.settings.errorClass).removeData("previousValue")},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(a){var b=0,c;for(c in a)b++;return b},hideErrors:function(){this.addWrapper(this.toHide).hide()},valid:function(){return this.size()===0},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid)try{a(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(b){}},findLastActive:function(){var b=this.lastActive;return b&&a.grep(this.errorList,function(a){return a.element.name===b.name}).length===1&&b},elements:function(){var b=this,c={};return a(this.currentForm).find("input, select, textarea").not(":submit, :reset, :image, [disabled]").not(this.settings.ignore).filter(function(){return!this.name&&b.settings.debug&&window.console&&console.error("%o has no name assigned",this),this.name in c||!b.objectLength(a(this).rules())?!1:(c[this.name]=!0,!0)})},clean:function(b){return a(b)[0]},errors:function(){var b=this.settings.errorClass.replace(" ",".");return a(this.settings.errorElement+"."+b,this.errorContext)},reset:function(){this.successList=[],this.errorList=[],this.errorMap={},this.toShow=a([]),this.toHide=a([]),this.currentElements=a([])},prepareForm:function(){this.reset(),this.toHide=this.errors().add(this.containers)},prepareElement:function(a){this.reset(),this.toHide=this.errorsFor(a)},elementValue:function(b){var c=a(b).attr("type"),d=a(b).val();return c==="radio"||c==="checkbox"?a('input[name="'+a(b).attr("name")+'"]:checked').val():typeof d=="string"?d.replace(/\r/g,""):d},check:function(b){var g,h;b=this.validationTargetFor(this.clean(b));var c=a(b).rules(),d=!1,e=this.elementValue(b),f;for(g in c){h={method:g,parameters:c[g]};try{if(f=a.validator.methods[g].call(this,e,b,h.parameters),f==="dependency-mismatch"){d=!0;continue}if(d=!1,f==="pending"){this.toHide=this.toHide.not(this.errorsFor(b));return}if(!f)return this.formatAndAdd(b,h),!1}catch(i){throw this.settings.debug&&window.console&&console.log("exception occured when checking element "+b.id+", check the '"+h.method+"' method",i),i;}}if(!d)return this.objectLength(c)&&this.successList.push(b),!0},customMetaMessage:function(b,c){if(a.metadata){var d=this.settings.meta?a(b).metadata()[this.settings.meta]:a(b).metadata();return d&&d.messages&&d.messages[c]}},customDataMessage:function(b,c){return a(b).data("msg-"+c.toLowerCase())||b.attributes&&a(b).attr("data-msg-"+c.toLowerCase())},customMessage:function(a,b){var c=this.settings.messages[a];return c&&(c.constructor===String?c:c[b])},findDefined:function(){for(var a=0;a<arguments.length;a++)if(arguments[a]!==undefined)return arguments[a];return undefined},defaultMessage:function(b,c){return this.findDefined(this.customMessage(b.name,c),this.customDataMessage(b,c),this.customMetaMessage(b,c),!this.settings.ignoreTitle&&b.title||undefined,a.validator.messages[c],"<strong>Warning:
 No message defined for "+b.name+"</strong>")},formatAndAdd:function(b,c){var d=this.defaultMessage(b,c.method),e=/\$?\{(\d+)\}/g;typeof d=="function"?d=d.call(this,c.parameters,b):e.test(d)&&(d=a.validator.format(d.replace(e,"{$1}"),c.parameters)),this.errorList.push({message:d,element:b}),this.errorMap[b.name]=d,this.submitted[b.name]=d},addWrapper:function(a){return this.settings.wrapper&&(a=a.add(a.parent(this.settings.wrapper))),a},defaultShowErrors:function(){for(var b,c,a=0;this.errorList[a];a++)c=this.errorList[a],this.settings.highlight&&this.settings.highlight.call(this,c.element,this.settings.errorClass,this.settings.validClass),this.showLabel(c.element,c.message);if(this.errorList.length&&(this.toShow=this.toShow.add(this.containers)),this.settings.success)for(a=0;this.successList[a];a++)this.showLabel(this.successList[a]);if(this.settings.unhighlight)for(a=0,b=this.validElements();b[a];a++)this.settings.unhighlight.call(this,b[a],this.settings.errorClass,this.settings.validClass);this.toHide=this.toHide.not(this.toShow),this.hideErrors(),this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return a(this.errorList).map(function(){return this.element})},showLabel:function(b,c){var d=this.errorsFor(b);d.length?(d.removeClass(this.settings.validClass).addClass(this.settings.errorClass),d.attr("generated")&&d.html(c)):(d=a("<"+this.settings.errorElement+"/>").attr({"for":this.idOrName(b),generated:!0}).addClass(this.settings.errorClass).html(c||""),this.settings.wrapper&&(d=d.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()),this.labelContainer.append(d).length||(this.settings.errorPlacement?this.settings.errorPlacement(d,a(b)):d.insertAfter(b))),!c&&this.settings.success&&(d.text(""),typeof this.settings.success=="string"?d.addClass(this.settings.success):this.settings.success(d,b)),this.toShow=this.toShow.add(d)},errorsFor:function(b){var c=this.idOrName(b);return this.errors().filter(function(){return a(this).attr("for")===c})},idOrName:function(a){return this.groups[a.name]||(this.checkable(a)?a.name:a.id||a.name)},validationTargetFor:function(a){return this.checkable(a)&&(a=this.findByName(a.name).not(this.settings.ignore)[0]),a},checkable:function(a){return/radio|checkbox/i.test(a.type)},findByName:function(b){return a(this.currentForm).find('[name="'+b+'"]')},getLength:function(b,c){switch(c.nodeName.toLowerCase()){case"select":return a("option:selected",c).length;case"input":if(this.checkable(c))return this.findByName(c.name).filter(":checked").length}return b.length},depend:function(a,b){return this.dependTypes[typeof a]?this.dependTypes[typeof a](a,b):!0},dependTypes:{boolean:function(a){return a},string:function(b,c){return!!a(b,c.form).length},"function":function(a,b){return a(b)}},optional:function(b){var c=this.elementValue(b);return!a.validator.methods.required.call(this,c,b)&&"dependency-mismatch"},startRequest:function(a){this.pending[a.name]||(this.pendingRequest++,this.pending[a.name]=!0)},stopRequest:function(b,c){this.pendingRequest--,this.pendingRequest<0&&(this.pendingRequest=0),delete this.pending[b.name],c&&this.pendingRequest===0&&this.formSubmitted&&this.form()?(a(this.currentForm).submit(),this.formSubmitted=!1):!c&&this.pendingRequest===0&&this.formSubmitted&&(a(this.currentForm).triggerHandler("invalid-form",[this]),this.formSubmitted=!1)},previousValue:function(b){return a.data(b,"previousValue")||a.data(b,"previousValue",{old:null,valid:!0,message:this.defaultMessage(b,"remote")})}},classRuleSettings:{required:{required:!0},email:{email:!0},url:{url:!0},date:{date:!0},dateISO:{dateISO:!0},number:{number:!0},digits:{digits:!0},creditcard:{creditcard:!0}},addClassRules:function(b,c){b.constructor===String?this.classRuleSettings[b]=c:a.extend(this.classRuleSettings,b)},classRules:function(b){var c={},d=a(b).attr("class");return d&&a.each(d.split(" "),function(){this in a.validator.classRuleSettings&&a.extend(c,a.validator.classRuleSettings[this])}),c},attributeRules:function(b){var c={},d=a(b),e,f;for(e in a.validator.methods)e==="required"?(f=d.get(0).getAttribute(e),f===""&&(f=!0),f=!!f):f=d.attr(e),f?c[e]=f:d[0].getAttribute("type")===e&&(c[e]=!0);return c.maxlength&&/-1|2147483647|524288/.test(c.maxlength)&&delete c.maxlength,c},metadataRules:function(b){if(!a.metadata)return{};var c=a.data(b.form,"validator").settings.meta;return c?a(b).metadata()[c]:a(b).metadata()},staticRules:function(b){var c={},d=a.data(b.form,"validator");return d.settings.rules&&(c=a.validator.normalizeRule(d.settings.rules[b.name])||{}),c},normalizeRules:function(b,c){return a.each(b,function(d,e){if(e===!1){delete b[d];return}if(e.param||e.depends){var f=!0;switch(typeof e.depends){case"string":f=!!a(e.depends,c.form).length;break;case"function":f=e.depends.call(c,c)}f?b[d]=e.param!==undefined?e.param:!0:delete b[d]}}),a.each(b,function(d,e){b[d]=a.isFunction(e)?e(c):e}),a.each(["minlength","maxlength","min","max"],function(){b[this]&&(b[this]=Number(b[this]))}),a.each(["rangelength","range"],function(){b[this]&&(b[this]=[Number(b[this][0]),Number(b[this][1])])}),a.validator.autoCreateRanges&&(b.min&&b.max&&(b.range=[b.min,b.max],delete b.min,delete b.max),b.minlength&&b.maxlength&&(b.rangelength=[b.minlength,b.maxlength],delete b.minlength,delete b.maxlength)),b.messages&&delete b.messages,b},normalizeRule:function(b){if(typeof b=="string"){var c={};a.each(b.split(/\s/),function(){c[this]=!0}),b=c}return b},addMethod:function(b,c,d){a.validator.methods[b]=c,a.validator.messages[b]=d!==undefined?d:a.validator.messages[b],c.length<3&&a.validator.addClassRules(b,a.validator.normalizeRule(b))},methods:{required:function(b,c,d){if(!this.depend(d,c))return"dependency-mismatch";if(c.nodeName.toLowerCase()==="select"){var e=a(c).val();return e&&e.length>0}return this.checkable(c)?this.getLength(b,c)>0:a.trim(b).length>0},remote:function(b,c,d){var e,f,g;return this.optional(c)?"dependency-mismatch":(e=this.previousValue(c),this.settings.messages[c.name]||(this.settings.messages[c.name]={}),e.originalMessage=this.settings.messages[c.name].remote,this.settings.messages[c.name].remote=e.message,d=typeof d=="string"&&{url:d}||d,this.pending[c.name])?"pending":e.old===b?e.valid:(e.old=b,f=this,this.startRequest(c),g={},g[c.name]=b,a.ajax(a.extend(!0,{url:d,mode:"abort",port:"validate"+c.name,dataType:"json",data:g,success:function(d){var g,h,i,j;f.settings.messages[c.name].remote=e.originalMessage,g=d===!0||d==="true",g?(h=f.formSubmitted,f.prepareElement(c),f.formSubmitted=h,f.successList.push(c),delete f.invalid[c.name],f.showErrors()):(i={},j=d||f.defaultMessage(c,"remote"),i[c.name]=e.message=a.isFunction(j)?j(b):j,f.invalid[c.name]=!0,f.showErrors(i)),e.valid=g,f.stopRequest(c,g)}},d)),"pending")},minlength:function(b,c,d){var e=a.isArray(b)?b.length:this.getLength(a.trim(b),c);return this.optional(c)||e>=d},maxlength:function(b,c,d){var e=a.isArray(b)?b.length:this.getLength(a.trim(b),c);return this.optional(c)||e<=d},rangelength:function(b,c,d){var e=a.isArray(b)?b.length:this.getLength(a.trim(b),c);return this.optional(c)||e>=d[0]&&e<=d[1]},min:function(a,b,c){return this.optional(b)||a>=c},max:function(a,b,c){return this.optional(b)||a<=c},range:function(a,b,c){return this.optional(b)||a>=c[0]&&a<=c[1]},email:function(a,b){return this.optional(b)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(a)},url:function(a,b){return this.optional(b)||/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(a)},date:function(a,b){return this.optional(b)||!/Invalid|NaN/.test(new Date(a))},dateISO:function(a,b){return this.optional(b)||/^\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}$/.test(a)},number:function(a,b){return this.optional(b)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(a)},digits:function(a,b){return this.optional(b)||/^\d+$/.test(a)},creditcard:function(a,b){var
 f,g;if(this.optional(b))return"dependency-mismatch";if(/[^0-9 \-]+/.test(a))return!1;var c=0,d=0,e=!1;for(a=a.replace(/\D/g,""),f=a.length-1;f>=0;f--)g=a.charAt(f),d=parseInt(g,10),e&&(d*=2)>9&&(d-=9),c+=d,e=!e;return c%10==0},equalTo:function(b,c,d){var e=a(d);return this.settings.onfocusout&&e.unbind(".validate-equalTo").bind("blur.validate-equalTo",function(){a(c).valid()}),b===e.val()}}}),a.format=a.validator.format})(jQuery),function(a){var b={},c;a.ajaxPrefilter?a.ajaxPrefilter(function(a,c,d){var e=a.port;a.mode==="abort"&&(b[e]&&b[e].abort(),b[e]=d)}):(c=a.ajax,a.ajax=function(d){var e=("mode"in d?d:a.ajaxSettings).mode,f=("port"in d?d:a.ajaxSettings).port;return e==="abort"?(b[f]&&b[f].abort(),b[f]=c.apply(this,arguments)):c.apply(this,arguments)})}(jQuery),function(a){!jQuery.event.special.focusin&&!jQuery.event.special.focusout&&document.addEventListener&&a.each({focus:"focusin",blur:"focusout"},function(b,c){function d(b){return b=a.event.fix(b),b.type=c,a.event.handle.call(this,b)}a.event.special[c]={setup:function(){this.addEventListener(b,d,!0)},teardown:function(){this.removeEventListener(b,d,!0)},handler:function(b){var d=arguments;return d[0]=a.event.fix(b),d[0].type=c,a.event.handle.apply(this,d)}}}),a.extend(a.fn,{validateDelegate:function(b,c,d){return this.bind(c,function(c){var e=a(c.target);if(e.is(b))return d.apply(e,arguments)})}})}(jQuery);
(function(n,t,i){var g="TEXTAREA",d="function",nt="password",c="maxLength",v="type",r="",u=!0,rt="placeholder",h=!1,tt="watermark",s=tt,o="watermarkClass",w="watermarkFocus",a="watermarkSubmit",b="watermarkMaxLength",e="watermarkPassword",f="watermarkText",l=/\r/g,ft=/^(button|checkbox|hidden|image|radio|range|reset|submit)$/i,it="input:data("+s+"),textarea:data("+s+")",p=":watermarkable",k=["Page_ClientValidate"],y=h,ut=rt in document.createElement("input");n.watermark=n.watermark||{version:"3.1.4",runOnce:u,options:{className:tt,useNative:u,hideBeforeUnload:u},hide:function(t){n(t).filter(it).each(function(){n.watermark._hide(n(this))})},_hide:function(n,i){var a=n[0],w=(a.value||r).replace(l,r),h=n.data(f)||r,p=n.data(b)||0,y=n.data(o),s,u;h.length&&w==h&&(a.value=r,n.data(e)&&(n.attr(v)||r)==="text"&&(s=n.data(e)||[],u=n.parent()||[],s.length&&u.length&&(u[0].removeChild(n[0]),u[0].appendChild(s[0]),n=s)),p&&(n.attr(c,p),n.removeData(b)),i&&(n.attr("autocomplete","off"),t.setTimeout(function(){n.select()},1))),y&&n.removeClass(y)},show:function(t){n(t).filter(it).each(function(){n.watermark._show(n(this))})},_show:function(t){var p=t[0],g=(p.value||r).replace(l,r),i=t.data(f)||r,k=t.attr(v)||r,d=t.data(o),h,s,a;g.length!=0&&g!=i||t.data(w)?n.watermark._hide(t):(y=u,t.data(e)&&k===nt&&(h=t.data(e)||[],s=t.parent()||[],h.length&&s.length&&(s[0].removeChild(t[0]),s[0].appendChild(h[0]),t=h,t.attr(c,i.length),p=t[0])),(k==="text"||k==="search")&&(a=t.attr(c)||0,a>0&&i.length>a&&(t.data(b,a),t.attr(c,i.length))),d&&t.addClass(d),p.value=i)},hideAll:function(){y&&(n.watermark.hide(p),y=h)},showAll:function(){n.watermark.show(p)}},n.fn.watermark=n.fn.watermark||function(i,y){var tt="string",k,b;return this.length?(k=h,b=typeof i==tt,b&&(i=i.replace(l,r)),typeof y=="object"?(k=typeof y.className==tt,y=n.extend({},n.watermark.options,y)):typeof y==tt?(k=u,y=n.extend({},n.watermark.options,{className:y})):y=n.watermark.options,typeof y.useNative!=d&&(y.useNative=y.useNative?function(){return u}:function(){return h}),this.each(function(){var et="dragleave",ot="dragenter",ft=this,h=n(ft),st,d,tt,it;if(h.is(p)){if(h.data(s))(b||k)&&(n.watermark._hide(h),b&&h.data(f,i),k&&h.data(o,y.className));else{if(ut&&y.useNative.call(ft,h)&&(h.attr("tagName")||r)!==g){b&&h.attr(rt,i);return}h.data(f,b?i:r),h.data(o,y.className),h.data(s,1),(h.attr(v)||r)===nt?(st=h.wrap("<span>").parent(),d=n(st.html().replace(/type=["']?password["']?/i,'type="text"')),d.data(f,h.data(f)),d.data(o,h.data(o)),d.data(s,1),d.attr(c,i.length),d.focus(function(){n.watermark._hide(d,u)}).bind(ot,function(){n.watermark._hide(d)}).bind("dragend",function(){t.setTimeout(function(){d.blur()},1)}),h.blur(function(){n.watermark._show(h)}).bind(et,function(){n.watermark._show(h)}),d.data(e,h),h.data(e,d)):h.focus(function(){h.data(w,1),n.watermark._hide(h,u)}).blur(function(){h.data(w,0),n.watermark._show(h)}).bind(ot,function(){n.watermark._hide(h)}).bind(et,function(){n.watermark._show(h)}).bind("dragend",function(){t.setTimeout(function(){n.watermark._show(h)},1)}).bind("drop",function(n){var i=h[0],t=n.originalEvent.dataTransfer.getData("Text");(i.value||r).replace(l,r).replace(t,r)===h.data(f)&&(i.value=t),h.focus()}),ft.form&&(tt=ft.form,it=n(tt),it.data(a)||(it.submit(n.watermark.hideAll),tt.submit?(it.data(a,tt.submit),tt.submit=function(t,i){return function(){var r=i.data(a);n.watermark.hideAll(),r.apply?r.apply(t,Array.prototype.slice.call(arguments)):r()}}(tt,it)):(it.data(a,1),tt.submit=function(t){return function(){n.watermark.hideAll(),delete t.submit,t.submit()}}(tt))))}n.watermark._show(h)}})):this},n.watermark.runOnce&&(n.watermark.runOnce=h,n.extend(n.expr[":"],{data:n.expr.createPseudo?n.expr.createPseudo(function(t){return function(i){return!!n.data(i,t)}}):function(t,i,r){return!!n.data(t,r[3])},watermarkable:function(n){var t,i=n.nodeName;return i===g?u:i!=="INPUT"?h:(t=n.getAttribute(v),!t||!ft.test(t))}}),function(t){n.fn.val=function(){var u=this,e=Array.prototype.slice.call(arguments),o;return u.length?e.length?(t.apply(u,e),n.watermark.show(u),u):u.data(s)?(o=(u[0].value||r).replace(l,r),o===(u.data(f)||r)?r:o):t.apply(u):e.length?u:i}}(n.fn.val),k.length&&n(function(){for(var u,r,i=k.length-1;i>=0;i--)u=k[i],r=t[u],typeof r==d&&(t[u]=function(t){return function(){return n.watermark.hideAll(),t.apply(null,Array.prototype.slice.call(arguments))}}(r))}),n(t).bind("beforeunload",function(){n.watermark.options.hideBeforeUnload&&n.watermark.hideAll()}))})(jQuery,window);
(function($){var defaults,$wsb;$.fn.WSelectBox=function(o){return new $wsb(this,o)},defaults={DefaultText:"",KeyFieldName:"Key",ValueFieldName:"Value",Items:[],SelectImage:"",SelectedValue:0,onSelectedChange:null,cssClass:"SelectBox",cssClassOpen:"SelectBoxOpen",cssClassSelected:"SelectBoxSelected",Horizontal:!1,VisibleItems:15},$.WSelectBox=function(e,o){this.opts=$.extend({},defaults,o||{}),this.selectBox=$(e),this.RenderControl(),this.SelectValue(this.opts.SelectedValue)},$wsb=$.WSelectBox,$wsb.fn=$wsb.prototype={WSelectBox:"0.2"},$wsb.fn.extend=$wsb.extend=$.extend,$wsb.fn.extend({SelectedValue:function(){return this.opts.SelectedValue},SelectValue:function(Value,NotFireEvent){var text,sb;if(this.opts.SelectedValue=Value,text=this.SelectedText(),text==this.opts.ClearItemText&&(text=""),text.length>1?($("."+this.opts.cssClass+" span",this.selectBox).html(text),$("."+this.opts.cssClassSelected+" span",this.selectBox).html(text),$("."+this.opts.cssClassOpen+" .Top span",this.selectBox).html(text),sb=$("."+this.opts.cssClass,this.selectBox),sb.removeClass(this.opts.cssClass),sb.addClass(this.opts.cssClassSelected)):(sb=$("."+this.opts.cssClassSelected,this.selectBox),sb.removeClass(this.opts.cssClassSelected),sb.addClass(this.opts.cssClass),$("."+this.opts.cssClass+" span",this.selectBox).html(this.opts.DefaultText),$("."+this.opts.cssClassOpen+" .Top span",this.selectBox).html(this.opts.DefaultText)),this.opts.onSelectedChange!=null&&NotFireEvent==undefined)this.opts.onSelectedChange(Value,text)},SelectedText:function(){var textFrom=$("."+this.opts.cssClassOpen+" .Content a."+this.opts.SelectedValue,this.selectBox);return textFrom!=null?textFrom.text():""},SetItems:function(newItems){this.opts.Items.Clear(),this.opts.Items=this.opts.Items.concat(newItems),this.RenderControl()},RenderControl:function(){var header="<span>"+this.opts.DefaultText+"</span>&nbsp;&nbsp;<img src='"+this.opts.SelectImage+"' />&nbsp;&nbsp;",offset,Left,Top,offsetParent,html,i,content,div1,div2,self;for(this.selectBox.html("<div class='"+this.opts.cssClass+"'>"+header+"</div>"),$("div."+this.opts.cssClass,this.selectBox).click(function(){$(this).hide(),$(this).next().show()}),offset=this.selectBox.offset(),Left=offset.left,this.opts.Horizontal&&(Left=0),Top=offset.top,$.browser.msie&&(offsetParent=this.selectBox.parent().offset(),this.opts.Horizontal||(Left-=offsetParent.left),Top-=offsetParent.top,$.browser.version=="7.0"&&(Top="0px")),html="<div class='"+this.opts.cssClassOpen+"' style='position:absolute;left:"+Left+";top:"+Top+";z-index:6;display:none' ><div class='Top'>"+header+"</div><div class='Content'>",this.opts.ClearItemText!=undefined&&this.opts.ClearItemText!=null&&(html+="<a href='javascript:void(0);' class='0' style='text-align:center'>"+this.opts.ClearItemText+"</a>"),i=0;i<this.opts.Items.length;i++)html+="<a href='javascript:void(0);' class='"+eval("this.opts.Items[i]."+this.opts.KeyFieldName)+"'>"+eval("this.opts.Items[i]."+this.opts.ValueFieldName)+"</a>";html+="</div><div class='Bottom'></div></div>",this.selectBox.append(html),this.opts.Items.length>this.opts.VisibleItems&&(content=$("div.Content",this.selectBox),content.css("height",this.opts.VisibleItems*18+"px"),content.css("overflow","hidden"),div1=jQuery("<div class='Content Hand' style='text-align:center;display:none;font-size:1.5em'>&#x25b4;</div>"),div1.click(function(){var st=$(this).next().scrollTop();st>0&&($(this).next().scrollTop(st-18),st-18<=0&&$(this).hide())}),content.before(div1),div2=jQuery("<div class='Content Hand' style='text-align:center;font-size:1.5em'>&#x25be;</div>"),div2.click(function(){var st=$(this).prev().scrollTop();$(this).prev().scrollTop(st+18),$(this).prev().prev().show(),$(this).prev().scrollTop()==st&&$(this).hide()}),content.after(div2)),$("."+this.opts.cssClassOpen+" .Top a",this.selectBox).click(function(){$(this).parent().parent().hide(),$(this).parent().parent().prev().show()}),self=this,$("."+this.opts.cssClassOpen+" .Content a",this.selectBox).click(function(){var Value=eval($(this).attr("class"));Value!=self.opts.SelectedValue&&self.SelectValue(Value),$(this).parent().parent().hide(),$(this).parent().parent().prev().show()}),$(document).click(function(e){var el=e.target;self.selectBox.find("*").index(el)>=0||($("."+self.opts.cssClassOpen,self.selectBox).hide(),$("div:first",self.selectBox).show())})}}),$wsb.extend({defaults:function(d){return $.extend(defaults,d||{})}})})(jQuery);
(function($){function both(a){return typeof a=="object"?a:{top:a,left:a}}var h=$.scrollTo=function(a,b,c){$(window).scrollTo(a,b,c)};h.defaults={axis:"xy",duration:parseFloat($.fn.jquery)>=1.3?0:1,limit:!0},h.window=function(){return $(window)._scrollable()},$.fn._scrollable=function(){return this.map(function(){var a=this,isWin=!a.nodeName||$.inArray(a.nodeName.toLowerCase(),["iframe","#document","html","body"])!=-1,b;return isWin?(b=(a.contentWindow||a).document||a.ownerDocument||a,/webkit/i.test(navigator.userAgent)||b.compatMode=="BackCompat"?b.body:b.documentElement):a})},$.fn.scrollTo=function(e,f,g){return typeof f=="object"&&(g=f,f=0),typeof g=="function"&&(g={onAfter:g}),e=="max"&&(e=9e9),g=$.extend({},h.defaults,g),f=f||g.duration,g.queue=g.queue&&g.axis.length>1,g.queue&&(f/=2),g.offset=both(g.offset),g.over=both(g.over),this._scrollable().each(function(){function animate(a){$elem.animate(attr,f,g.easing,a&&function(){a.call(this,e,g)})}if(e!=null){var d=this,$elem=$(d),targ=e,toff,attr={},win=$elem.is("html,body");switch(typeof targ){case"number":case"string":if(/^([+-]=?)?\d+(\.\d+)?(px|%)?$/.test(targ)){targ=both(targ);break}if(targ=$(targ,this),!targ.length)return;case"object":(targ.is||targ.style)&&(toff=(targ=$(targ)).offset())}$.each(g.axis.split(""),function(i,a){var b=a=="x"?"Left":"Top",pos=b.toLowerCase(),key="scroll"+b,old=d[key],max=h.max(d,a),c;toff?(attr[key]=toff[pos]+(win?0:old-$elem.offset()[pos]),g.margin&&(attr[key]-=parseInt(targ.css("margin"+b))||0,attr[key]-=parseInt(targ.css("border"+b+"Width"))||0),attr[key]+=g.offset[pos]||0,g.over[pos]&&(attr[key]+=targ[a=="x"?"width":"height"]()*g.over[pos])):(c=targ[pos],attr[key]=c.slice&&c.slice(-1)=="%"?parseFloat(c)/100*max:c),g.limit&&/^\d+$/.test(attr[key])&&(attr[key]=attr[key]<=0?0:Math.min(attr[key],max)),!i&&g.queue&&(old!=attr[key]&&animate(g.onAfterFirst),delete attr[key])}),animate(g.onAfter)}}).end()},h.max=function(a,b){var c=b=="x"?"Width":"Height",scroll="scroll"+c;if(!$(a).is("html,body"))return a[scroll]-$(a)[c.toLowerCase()]();var d="client"+c,html=a.ownerDocument.documentElement,body=a.ownerDocument.body;return Math.max(html[scroll],body[scroll])-Math.min(html[d],body[d])}})(jQuery);
(function($){$.fn.easySlider=function(options){var defaults={prevId:"prevBtn",prevText:"Previous",nextId:"nextBtn",nextText:"Next",controlsShow:!0,controlsBefore:"",controlsAfter:"",controlsFade:!0,firstId:"firstBtn",firstText:"First",firstShow:!1,lastId:"lastBtn",lastText:"Last",lastShow:!1,speed:800,auto:!1,pause:2e3,continuous:!1,numeric:!1,numericId:"controls",displayCount:3,itemMargin:0,showNextAndPrevious:!1},options=$.extend(defaults,options);this.each(function(){function setCurrent(i){i=parseInt(i)+1,$("li","#"+options.numericId).removeClass("current"),$("li#"+options.numericId+i).addClass("current")}function adjust(){t>ts&&(t=0),t<0&&(t=ts),$("ul",obj).css("margin-left",t*w*-1),clickable=!0,options.numeric&&setCurrent(t)}function animate(dir,clicked){var ot,diff,speed;if(clickable){clickable=!1,ot=t;switch(dir){case"next":t=ot>=ts?options.continuous?t+options.displayCount:ts:t+options.displayCount;break;case"prev":t=t<=0?options.continuous?t-options.displayCount:0:t-options.displayCount;break;case"first":t=0;break;case"last":t=ts;break;default:t=dir}diff=Math.abs(ot-t),speed=diff*options.speed,p=t*w*-1,$("ul",obj).animate({marginLeft:p},{queue:!1,duration:speed,complete:adjust}),options.showNextAndPrevious&&($("#"+options.prevId).unbind("click"),$("#"+options.nextId).unbind("click"),t>0&&$("#"+options.prevId).click(function(){animate(t-options.displayCount,!0)}),t<ts&&$("#"+options.nextId).click(function(){animate(t+options.displayCount,!0)})),!options.continuous&&options.controlsFade&&(t==ts?($("a","#"+options.nextId).hide(),$("a","#"+options.lastId).hide()):($("a","#"+options.nextId).show(),$("a","#"+options.lastId).show()),t==0?($("a","#"+options.prevId).hide(),$("a","#"+options.firstId).hide()):($("a","#"+options.prevId).show(),$("a","#"+options.firstId).show())),clicked&&clearTimeout(timeout),options.auto&&dir=="next"&&!clicked&&(timeout=setTimeout(function(){animate("next",!1)},diff*options.speed+options.pause))}}var obj=$(this),s=$("li",obj).length,w=$("li",obj).width()+options.itemMargin,h=$("li",obj).height(),clickable=!0,ts,t,gap,html,i,timeout;if(obj.width(w*options.displayCount),obj.height(h),obj.css("overflow","hidden"),ts=s-1,t=0,$("ul",obj).css("width",s*w),options.continuous){for(gap=s%options.displayCount==0?0:(options.displayCount-s%options.displayCount)*w-options.itemMargin,$("ul",obj).append("<li><div style='height : "+h+"px; width: "+gap+"px;'></div></li>"),i=1;i<=options.displayCount;i++)$("ul",obj).append($("ul li:nth-child("+i+")",obj).clone());$("ul",obj).css("width",(s+options.displayCount)*w+gap)}if($("li",obj).css("float","left"),options.controlsShow&&(html=options.controlsBefore,options.numeric?html+='<ol id="'+options.numericId+'"></ol>':(options.firstShow&&(html+='<span id="'+options.firstId+'"><a href="javascript:void(0);">'+options.firstText+"</a></span>"),html+=' <span id="'+options.prevId+'"><a href="javascript:void(0);">'+options.prevText+"</a></span>",html+=' <span id="'+options.nextId+'"><a href="javascript:void(0);">'+options.nextText+"</a></span>",options.lastShow&&(html+=' <span id="'+options.lastId+'"><a href="javascript:void(0);">'+options.lastText+"</a></span>")),options.showNextAndPrevious&&$("#"+options.nextId).click(function(){animate(options.displayCount,!0)}),html+=options.controlsAfter,$(obj).after(html)),options.numeric)for(i=0;i<s;i+=options.displayCount)$(document.createElement("li")).attr("id",options.numericId+(i+1)).html("<a rel="+i+' href="javascript:void(0);">&nbsp;</a>').appendTo($("#"+options.numericId)).click(function(){animate($("a",$(this)).attr("rel"),!0)});else $("a","#"+options.nextId).click(function(){animate("next",!0)}),$("a","#"+options.prevId).click(function(){animate("prev",!0)}),$("a","#"+options.firstId).click(function(){animate("first",!0)}),$("a","#"+options.lastId).click(function(){animate("last",!0)});options.auto&&(timeout=setTimeout(function(){animate("next",!1)},options.pause)),options.numeric&&setCurrent(0),!options.continuous&&options.controlsFade&&($("a","#"+options.prevId).hide(),$("a","#"+options.firstId).hide())})}})(jQuery);
(function($,global){function doEvil(code){var div=doc.createElement("div");doc.body.insertBefore(div,null),$.replaceWith(div,'<script type="text/javascript">'+code+"<\/script>")}function each(array,fn){for(var i=0,len=array.length;i<len;i++)if(fn(array[i])===!1)return}function isFunction(o){return Object.prototype.toString.call(o)==="[object Function]"}function slice(array,start,end){return Array.prototype.slice.call(array,start||0,end||array&&array.length)}function any(array,fn){function check(it){return!(result=fn(it))}var result=!1;return each(array,check),result}function SubQ(parent){this._queue=[],this._children=[],this._parent=parent,parent&&parent._addChild(this)}function Q(parent){if(parent)return new SubQ(parent);SubQ.call(this),this.paused=0}function MockDocument(){}function unProxy(elements){each(elements,function(it){var real=doc.getElementById(it.id);if(!real){logError("<proxyGetElementById - finish>","no element in writen markup with id "+it.id);return}each(it.el.childNodes,function(it){real.appendChild(it)}),real.contentWindow&&global.setTimeout(function(){it.el.contentWindow.document.copyTo(real.contentWindow.document)},1),$.copyAttrs(it.el,real)})}function getOption(name,options){return options&&options[name]===!1?!1:options&&options[name]||self[name]}function capture(context,options){function replacementWrite(s){state.out+=s}function replacementWriteln(s){state.out+=s+"\n"}function immediateWrite(s){var target=$.$(context.target),div=doc.createElement("div");target.parentNode.insertBefore(div,target),$.replaceWith(div,sanitize(s))}function immediateWriteln(s){var target=$.$(context.target),div=doc.createElement("div");target.parentNode.insertBefore(div,target),$.replaceWith(div,sanitize(s)+"\n")}function makeTemp(id){var t=doc.createElement("div");return tempEls.push({id:id,el:t}),t.contentWindow={document:new MockDocument},t}function writeThenGet(id){var target=$.$(context.target),div=doc.createElement("div");return target.parentNode.insertBefore(div,target),$.replaceWith(div,state.out),state.out="",canCall?state.getEl.call(doc,id):state.getEl(id)}function getEl(id){var result=canCall?state.getEl.call(doc,id):state.getEl(id);return result||findEl(id)}var tempEls=[],proxy=getOption("proxyGetElementById",options),forceLast=getOption("forceLastScriptTag",options),writeOnGet=getOption("writeOnGetElementById",options),immediate=getOption("immediateWrites",options),state={write:doc.write,writeln:doc.writeln,finish:function(){},out:""},f;return context.state=state,doc.write=immediate?immediateWrite:replacementWrite,doc.writeln=immediate?immediateWriteln:replacementWriteln,(proxy||writeOnGet)&&(state.getEl=doc.getElementById,doc.getElementById=getEl,writeOnGet?findEl=writeThenGet:(findEl=makeTemp,state.finish=function(){unProxy(tempEls)})),forceLast&&(state.getByTag=doc.getElementsByTagName,doc.getElementsByTagName=function(name){var result=slice(canCall?state.getByTag.call(doc,name):state.getByTag(name));return name==="script"&&result.push($.$(context.target)),result},f=state.finish,state.finish=function(){f(),doc.getElementsByTagName=state.getByTag}),state}function uncapture(state){return doc.write=state.write,doc.writeln=state.writeln,state.getEl&&(doc.getElementById=state.getEl),state.out}function clean(code){return code&&code.replace(/^\s*<!(\[CDATA\[|--)/,"").replace(/(\]\]|--)>\s*$/,"")}function ignore(){}function doLog(code,error){console.error("Error",error,"executing code:",code)}function captureWrite(code,context,options){var state=capture(context,options);try{doEvil(clean(code))}catch(e){logError(code,e)}finally{uncapture(state)}return state}function isXDomain(src){var parts=/^(\w+:)?\/\/([^\/?#]+)/.exec(src);return parts&&(parts[1]&&parts[1]!=location.protocol||parts[2]!=location.host)}function attrPattern(name){return new RegExp("[\\s\\r\\n]"+name+"[\\s\\r\\n]*=[\\s\\r\\n]*(?:([\"'])([\\s\\S]*?)\\1|([^\\s>]+))","i")}function matchAttr(name){var regex=attrPattern(name);return function(tag){var match=regex.exec(tag)||[];return match[2]||match[3]}}function nextId(){return(++global_id).toString()}function normalizeOptions(options,callback){var done;return isFunction(options)&&(done=options,options=null),options=options||{},done=done||options&&options.done,options.done=callback?function(){callback(done)}:done,options}function newCallback(fn){var id=nextId();return callbacks[id]=function(){fn(),delete callbacks[id]},id}function newCallbackTag(fn){return TEMPLATE_TAG.replace(/%d/,newCallback(fn))}function sanitize(html,options,parentQ,parentContext){function proxyBodyless(tag){return proxyTag(tag,tag.substring(0,tag.length-2)+">","")}function proxyTag(element,openTag,code){function queueScript(){queue.push(run)}function runInline(){captureHtml(code)}function loadSync(){$.ajax({url:src,type:"GET",dataType:"text",async:!1,success:function(html){captureHtml(html)}})}function logAjaxError(xhr,status,error){logError("<XHR for "+src+">",error),queue.resume()}function setupResume(){return newCallbackTag(function(){queue.resume()})}function loadAsync(){function captureAndResume(script){if(!ready){scriptText=script;return}try{captureHtml(script,setupResume())}catch(e){logError(script,e)}}var ready,scriptText;return $.ajax({url:src,type:"GET",dataType:"text",async:!0,success:captureAndResume,error:logAjaxError}),function(){ready=!0,scriptText?captureHtml(scriptText):queue.pause()}}function loadXDomain(){function captureAndResume(){logDebug("out",src,state.out),html(uncapture(state),newCallbackTag(state.finish)+setupResume()),logDebug("resume",src)}var state=capture(context,options);queue.pause(),logDebug("pause",src),doXDomainLoad(context.target,src,captureAndResume)}function captureHtml(script,cb){var state=captureWrite(script,context,options);cb=newCallbackTag(state.finish)+(cb||""),html(state.out,cb)}function safeOpts(options){var copy={},i;for(i in options)options.hasOwnProperty(i)&&(copy[i]=options[i]);return delete copy.done,copy}function html(markup,cb){$.replaceWith(context.target,sanitize(markup,safeOpts(options),queue,context)+(cb||""))}var src=SRC_ATTR(openTag),type=TYPE_ATTR(openTag)||"",lang=LANG_ATTR(openTag)||"",isJs=!type&&!lang||type.toLowerCase().indexOf("javascript")!==-1||lang.toLowerCase().indexOf("javascript")!==-1;if(logDebug("replace",src,element),!isJs)return element;var id=newCallback(queueScript),divId=DIV_PREFIX+id,run,context={target:"#"+divId,parent:parentContext};return src?(src=fixUrls(src),openTag=openTag.replace(SRC_REGEX,""),run=isXDomain(src)?loadXDomain:getOption("asyncAll",options)?loadAsync():loadSync):run=runInline,'<div style="display: none" id="'+divId+'"></div>'+openTag+TEMPLATE.replace(/%d/,id)+"<\/script>"}var queue=parentQ&&new Q(parentQ)||GLOBAL_Q;options=normalizeOptions(options);var done=getOption("done",options),doneHtml="",fixUrls=getOption("fixUrls",options);return isFunction(fixUrls)||(fixUrls=function(src){return src}),isFunction(done)&&(doneHtml=newCallbackTag(function(){queue.push(done)})),html.replace(SCRIPT_TAGS,proxyTag).replace(SCRIPT_2,proxyBodyless)+doneHtml}function doXDomainLoad(target,url,success){var script=document.createElement("script"),done,parent;script.src=url,target=$.$(target),done=!1,parent=target.parentNode,script.onload=script.onreadystatechange=function(){done||this.readyState&&this.readyState!="loaded"&&this.readyState!="complete"||(done=!0,success(),script.onload=script.onreadystatechange=null,parent.removeChild(script))},parent.insertBefore(script,target)}function sanitizeSerial(fragments,done){var queue=GLOBAL_Q;each(fragments,function(f){function run(){f.action(sanitize(f.html,f.options,queue),f)}queue.push(run)}),done&&queue.push(done)}function findLastChild(el){for(var n=el;n&&n.nodeType===1;)for(el=n,n=n.lastChild;n&&n.nodeType!==1;)n=n.previousSibling;return el}function autoCapture(done){var write=doc.write,writeln=doc.writeln,currentScript,autoQ=[],state;doc.writeln=function(s){doc.write(s+"\n")},doc.write=function(s){var scriptEl=findLastChild(doc.body);scriptEl!==currentScript&&(currentScript=scriptEl,autoQ.push(state={el:scriptEl,out:[]})),state.out.push(s)};$.onLoad(function(){var el,div,out,safe,doneFn,i,len;for(done=normalizeOptions(done),doneFn=done.done,done.done=function(){doc.write=write,doc.writeln=writeln,doneFn&&doneFn()},i=0,len=autoQ.length;i<len;i++)el=autoQ[i].el,div=doc.createElement("div"),el.parentNode.insertBefore(div,el.nextSibling),out=autoQ[i].out.join(""),safe=len-i==1?sanitize(out,done):sanitize(out),$.replaceWith(div,safe)})}function extsrc(cb){for(var scripts=document.getElementsByTagName("script"),s,o,html,q,ext,async,doneCount=0,done=cb?newCallbackTag(function(){++doneCount>=exts.length&&cb()}):"",exts=[],i=0,len=scripts.length;i<len;i++)s=scripts[i],ext=s.getAttribute("extsrc"),async=s.getAttribute("asyncsrc"),(ext||async)&&exts.push({ext:ext,async:async,s:s});for(i=0,len=exts.length;i<len;i++)o=exts[i],o.ext?(html='<script type="text/javascript" src="'+o.ext+'"> <\/script>',$.replaceWith(o.s,sanitize(html)+done)):o.async&&(html='<script type="text/javascript" src="'+o.async+'"> <\/script>',$.replaceWith(o.s,sanitize(html,{asyncAll:!0},new Q)+done))}var doc=global.document,canCall,logError,name,self;$=$||function(jQuery){return{ajax:jQuery.ajax,$:function(s){return jQuery(s)[0]},replaceWith:function(selector,content){var el=jQuery(selector)[0],next=el.nextSibling,parent=el.parentNode;jQuery(el).remove(),next?jQuery(next).before(content):jQuery(parent).append(content)},onLoad:function(fn){jQuery(fn)},copyAttrs:function(src,dest){for(var el=jQuery(dest),attrs=src.attributes,i=0,len=attrs.length;i<len;i++)if(attrs[i]&&attrs[i].value)try{el.attr(attrs[i].name,attrs[i].value)}catch(e){}}}}(global.jQuery),$.copyAttrs=$.copyAttrs||function(){},$.onLoad=$.onLoad||function(){throw"error: autoAsync cannot be used without jQuery or defining writeCaptureSupport.onLoad";},SubQ.prototype={_addChild:function(q){this._children.push(q)},push:function(task){this._queue.push(task),this._bubble("_doRun"
)},pause:function(){this._bubble("_doPause")},resume:function(){this._bubble("_doResume")},_bubble:function(name){for(var root=this;!root[name];)root=root._parent;return root[name]()},_next:function(){function runNext(c){return c._next()}if(any(this._children,runNext))return!0;var task=this._queue.shift();return task&&task(),!!task}},Q.prototype=function(){function f(){}return f.prototype=SubQ.prototype,new f}(),Q.prototype._doRun=function(){if(!this.running){this.running=!0;try{while(this.paused<1&&this._next());}finally{this.running=!1}}},Q.prototype._doPause=function(){this.paused++},Q.prototype._doResume=function(){this.paused--,this._doRun()},MockDocument.prototype={_html:"",open:function(){this._opened=!0,this._delegate&&this._delegate.open()},write:function(s){this._closed||(this._written=!0,this._delegate?this._delegate.write(s):this._html+=s)},writeln:function(s){this.write(s+"\n")},close:function(){this._closed=!0,this._delegate&&this._delegate.close()},copyTo:function(d){this._delegate=d,d.foobar=!0,this._opened&&d.open(),this._written&&d.write(this._html),this._closed&&d.close()}},canCall=function(){var f={f:doc.getElementById};try{return f.f.call(doc,"abc"),!0}catch(e){return!1}}(),logError=isFunction(global.console&&console.error)?doLog:ignore;var SCRIPT_TAGS=/(<script[^>]*>)([\s\S]*?)<\/script>/ig,SCRIPT_2=/<script[^>]*\/>/ig,SRC_REGEX=attrPattern("src"),SRC_ATTR=matchAttr("src"),TYPE_ATTR=matchAttr("type"),LANG_ATTR=matchAttr("language"),GLOBAL="__document_write_ajax_callbacks__",DIV_PREFIX="__document_write_ajax_div-",TEMPLATE="window['"+GLOBAL+"']['%d']();",callbacks=global[GLOBAL]={},TEMPLATE_TAG='<script type="text/javascript">'+TEMPLATE+"<\/script>",global_id=0;var GLOBAL_Q=new Q,debug=[],logDebug=window._debugWriteCapture?function(){}:function(type,src,data){debug.push({type:type,src:src,data:data})},logString=window._debugWriteCapture?function(){}:function(){debug.push(arguments)};name="writeCapture",self=global[name]={_original:global[name],support:$,fixUrls:function(src){return src.replace(/&amp;/g,"&")},noConflict:function(){return global[name]=this._original,this},debug:debug,proxyGetElementById:!1,_forTest:{Q:Q,GLOBAL_Q:GLOBAL_Q,$:$,matchAttr:matchAttr,slice:slice,capture:capture,uncapture:uncapture,captureWrite:captureWrite},replaceWith:function(selector,content,options){$.replaceWith(selector,sanitize(content,options))},html:function(selector,content,options){var el=$.$(selector);el.innerHTML="<span/>",$.replaceWith(el.firstChild,sanitize(content,options))},load:function(selector,url,options){$.ajax({url:url,dataType:"text",type:"GET",success:function(content){self.html(selector,content,options)}})},extsrc:extsrc,autoAsync:autoCapture,sanitize:sanitize,sanitizeSerial:sanitizeSerial}})(this.writeCaptureSupport,this);
/*!
 * jCarousel - Riding carousels with jQuery
 *   http://sorgalla.com/jcarousel/
 *
 * Copyright (c) 2006 Jan Sorgalla (http://sorgalla.com)
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 *
 * Built on top of the jQuery library
 *   http://jquery.com
 *
 * Inspired by the "Carousel Component" by Bill Scott
 *   http://billwscott.com/carousel/
 */
(function(g){var q={vertical:!1,rtl:!1,start:1,offset:1,size:null,scroll:3,visible:null,animation:"normal",easing:"swing",auto:0,wrap:null,initCallback:null,setupCallback:null,reloadCallback:null,itemLoadCallback:null,itemFirstInCallback:null,itemFirstOutCallback:null,itemLastInCallback:null,itemLastOutCallback:null,itemVisibleInCallback:null,itemVisibleOutCallback:null,animationStepCallback:null,buttonNextHTML:"<div></div>",buttonPrevHTML:"<div></div>",buttonNextEvent:"click",buttonPrevEvent:"click",buttonNextCallback:null,buttonPrevCallback:null,itemFallbackDimension:null},m=!1,f;g(window).bind("load.jcarousel",function(){m=!0}),g.jcarousel=function(a,c){var h,i;this.options=g.extend({},q,c||{}),this.autoStopped=this.locked=!1,this.buttonPrevState=this.buttonNextState=this.buttonPrev=this.buttonNext=this.list=this.clip=this.container=null,c&&c.rtl!==void 0||(this.options.rtl=(g(a).attr("dir")||g("html").attr("dir")||"").toLowerCase()=="rtl"),this.wh=this.options.vertical?"height":"width",this.lt=this.options.vertical?"top":this.options.rtl?"right":"left";for(var b="",d=a.className.split(" "),f=0;f<d.length;f++)if(d[f].indexOf("jcarousel-skin")!=-1){g(a).removeClass(d[f]),b=d[f];break}a.nodeName.toUpperCase()=="UL"||a.nodeName.toUpperCase()=="OL"?(this.list=g(a),this.clip=this.list.parents(".jcarousel-clip"),this.container=this.list.parents(".jcarousel-container")):(this.container=g(a),this.list=this.container.find("ul,ol").eq(0),this.clip=this.container.find(".jcarousel-clip")),this.clip.size()===0&&(this.clip=this.list.wrap("<div></div>").parent()),this.container.size()===0&&(this.container=this.clip.wrap("<div></div>").parent()),b!==""&&this.container.parent()[0].className.indexOf("jcarousel-skin")==-1&&this.container.wrap('<div class=" '+b+'"></div>'),this.buttonPrev=g(".jcarousel-prev",this.container),this.buttonPrev.size()===0&&this.options.buttonPrevHTML!==null&&(this.buttonPrev=g(this.options.buttonPrevHTML).appendTo(this.container)),this.buttonPrev.addClass(this.className("jcarousel-prev")),this.buttonNext=g(".jcarousel-next",this.container),this.buttonNext.size()===0&&this.options.buttonNextHTML!==null&&(this.buttonNext=g(this.options.buttonNextHTML).appendTo(this.container)),this.buttonNext.addClass(this.className("jcarousel-next")),this.clip.addClass(this.className("jcarousel-clip")).css({position:"relative"}),this.list.addClass(this.className("jcarousel-list")).css({overflow:"hidden",position:"relative",top:0,margin:0,padding:0}).css(this.options.rtl?"right":"left",0),this.container.addClass(this.className("jcarousel-container")).css({position:"relative"}),!this.options.vertical&&this.options.rtl&&this.container.addClass("jcarousel-direction-rtl").attr("dir","rtl");var j=this.options.visible!==null?Math.ceil(this.clipping()/this.options.visible):null,b=this.list.children("li"),e=this;b.size()>0&&(h=0,i=this.options.offset,b.each(function(){e.format(this,i++),h+=e.dimension(this,j)}),this.list.css(this.wh,h+100+"px"),c&&c.size!==void 0||(this.options.size=b.size())),this.container.css("display","block"),this.buttonNext.css("display","block"),this.buttonPrev.css("display","block"),this.funcNext=function(){e.next()},this.funcPrev=function(){e.prev()},this.funcResize=function(){e.resizeTimer&&clearTimeout(e.resizeTimer),e.resizeTimer=setTimeout(function(){e.reload()},100)},this.options.initCallback!==null&&this.options.initCallback(this,"init"),!m&&g.browser.safari?(this.buttons(!1,!1),g(window).bind("load.jcarousel",function(){e.setup()})):this.setup()},f=g.jcarousel,f.fn=f.prototype={jcarousel:"0.2.8"},f.fn.extend=f.extend=g.extend,f.fn.extend({setup:function(){if(this.prevLast=this.prevFirst=this.last=this.first=null,this.animating=!1,this.tail=this.resizeTimer=this.timer=null,this.inTail=!1,!this.locked){this.list.css(this.lt,this.pos(this.options.offset)+"px");var a=this.pos(this.options.start,!0);this.prevFirst=this.prevLast=null,this.animate(a,!1),g(window).unbind("resize.jcarousel",this.funcResize).bind("resize.jcarousel",this.funcResize),this.options.setupCallback!==null&&this.options.setupCallback(this)}},reset:function(){this.list.empty(),this.list.css(this.lt,"0px"),this.list.css(this.wh,"10px"),this.options.initCallback!==null&&this.options.initCallback(this,"reset"),this.setup()},reload:function(){if(this.tail!==null&&this.inTail&&this.list.css(this.lt,f.intval(this.list.css(this.lt))+this.tail),this.tail=null,this.inTail=!1,this.options.reloadCallback!==null&&this.options.reloadCallback(this),this.options.visible!==null){var a=this,c=Math.ceil(this.clipping()/this.options.visible),b=0,d=0;this.list.children("li").each(function(f){b+=a.dimension(this,c),f+1<a.first&&(d=b)}),this.list.css(this.wh,b+"px"),this.list.css(this.lt,-d+"px")}this.scroll(this.first,!1)},lock:function(){this.locked=!0,this.buttons()},unlock:function(){this.locked=!1,this.buttons()},size:function(a){return a!==void 0&&(this.options.size=a,this.locked||this.buttons()),this.options.size},has:function(a,c){var b,d;for(c!==void 0&&c||(c=a),this.options.size!==null&&c>this.options.size&&(c=this.options.size),b=a;b<=c;b++)if(d=this.get(b),!d.length||d.hasClass("jcarousel-item-placeholder"))return!1;return!0},get:function(a){return g(">.jcarousel-item-"+a,this.list)},add:function(a,c){var b=this.get(a),d=0,p=g(c),j,e;if(b.length===0){for(e=f.intval(a),b=this.create(a);;)if(j=this.get(--e),e<=0||j.length){e<=0?this.list.prepend(b):j.after(b);break}}else d=this.dimension(b);return p.get(0).nodeName.toUpperCase()=="LI"?(b.replaceWith(p),b=p):b.empty().append(c),this.format(b.removeClass(this.className("jcarousel-item-placeholder")),a),p=this.options.visible!==null?Math.ceil(this.clipping()/this.options.visible):null,d=this.dimension(b,p)-d,a>0&&a<this.first&&this.list.css(this.lt,f.intval(this.list.css(this.lt))-d+"px"),this.list.css(this.wh,f.intval(this.list.css(this.wh))+d+"px"),b},remove:function(a){var c=this.get(a),b;!c.length||a>=this.first&&a<=this.last||(b=this.dimension(c),a<this.first&&this.list.css(this.lt,f.intval(this.list.css(this.lt))+b+"px"),c.remove(),this.list.css(this.wh,f.intval(this.list.css(this.wh))-b+"px"))},next:function(){this.tail!==null&&!this.inTail?this.scrollTail(!1):this.scroll((this.options.wrap=="both"||this.options.wrap=="last")&&this.options.size!==null&&this.last==this.options.size?1:this.first+this.options.scroll)},prev:function(){this.tail!==null&&this.inTail?this.scrollTail(!0):this.scroll((this.options.wrap=="both"||this.options.wrap=="first")&&this.options.size!==null&&this.first==1?this.options.size:this.first-this.options.scroll)},scrollTail:function(a){if(!this.locked&&!this.animating&&this.tail){this.pauseAuto();var c=f.intval(this.list.css(this.lt)),c=a?c+this.tail:c-this.tail;this.inTail=!a,this.prevFirst=this.first,this.prevLast=this.last,this.animate(c)}},scroll:function(a,c){!this.locked&&!this.animating&&(this.pauseAuto(),this.animate(this.pos(a),c))},pos:function(a,c){var b=f.intval(this.list.css(this.lt));if(this.locked||this.animating)return b;this.options.wrap!="circular"&&(a=a<1?1:this.options.size&&a>this.options.size?this.options.size:a);for(var d=this.first>a,g=this.options.wrap!="circular"&&this.first<=1?1:this.first,j=d?this.get(g):this.get(this.last),e=d?g:g-1,h=null,i=0,k=!1,l=0;d?--e>=a:++e<a;)h=this.get(e),k=!h.length,h.length===0&&(h=this.create(e).addClass(this.className("jcarousel-item-placeholder")),j[d?"before":"after"](h),this.first!==null&&this.options.wrap=="circular"&&this.options.size!==null&&(e<=0||e>this.options.size))&&(j=this.get(this.index(e)),j.length&&(h=this.add(e,j.clone(!0)))),j=h,l=this.dimension(h),k&&(i+=l),this.first!==null&&(this.options.wrap=="circular"||e>=1&&(this.options.size===null||e<=this.options.size))&&(b=d?b+l:b-l);for(var g=this.clipping(),m=[],o=0,n=0,j=this.get(a-1),e=a;++o;){if(h=this.get(e),k=!h.length,h.length===0&&(h=this.create(e).addClass(this.className("jcarousel-item-placeholder")),j.length===0?this.list.prepend(h):j[d?"before":"after"](h),this.first!==null&&this.options.wrap=="circular"&&this.options.size!==null&&(e<=0||e>this.options.size)&&(j=this.get(this.index(e)),j.length&&(h=this.add(e,j.clone(!0))))),j=h,l=this.dimension(h),l===0)throw Error("jCarousel: No width/height set for items. This will cause an infinite loop. Aborting...");if(this.options.wrap!="circular"&&this.options.size!==null&&e>this.options.size?m.push(h):k&&(i+=l),n+=l,n>=g)break;e++}for(h=0;h<m.length;h++)m[h].remove();if(i>0&&(this.list.css(this.wh,this.dimension(this.list)+i+"px"),d&&(b-=i,this.list.css(this.lt,f.intval(this.list.css(this.lt))-i+"px"))),i=a+o-1,this.options.wrap!="circular"&&this.options.size&&i>this.options.size&&(i=this.options.size),e>i)for(o=0,e=i,n=0;++o;){if(h=this.get(e--),!h.length)break;if(n+=this.dimension(h),n>=g)break}for(e=i-o+1,this.options.wrap!="circular"&&e<1&&(e=1),this.inTail&&d&&(b+=this.tail,this.inTail=!1),this.tail=null,this.options.wrap!="circular"&&i==this.options.size&&i-o+1>=1&&(d=f.intval(this.get(i).css(this.options.vertical?"marginBottom":"marginRight")),n-d>g)&&(this.tail=n-g-d),c&&a===this.options.size&&this.tail&&(b-=this.tail,this.inTail=!0);a-->e;)b+=this.dimension(this.get(a));return this.prevFirst=this.first,this.prevLast=this.last,this.first=e,this.last=i,b},animate:function(a,c){var b,f,d;this.locked||this.animating||(this.animating=!0,b=this,d=function(){if(b.animating=!1,a===0&&b.list.css(b.lt,0),!b.autoStopped&&(b.options.wrap=="circular"||b.options.wrap=="both"||b.options.wrap=="last"||b.options.size===null||b.last<b.options.size||b.last==b.options.size&&b.tail!==null&&!b.inTail)&&b.startAuto(),b.buttons(),b.notify("onAfterAnimation"),b.options.wrap=="circular"&&b.options.size!==null)for(var c=b.prevFirst;c<=b.prevLast;c++)c!==null&&!(c>=b.first&&c<=b.last)&&(c<1||c>b.options.size)&&b.remove(c)},this.notify("onBeforeAnimation"),this.options.animation&&c!==!1?(f=this.options.vertical?{top:a}:this.options.rtl?{right:a}:{left:a},d={duration:this.options.animation,easing:this.opti
ons.easing,complete:d},g.isFunction(this.options.animationStepCallback)&&(d.step=this.options.animationStepCallback),this.list.animate(f,d)):(this.list.css(this.lt,a+"px"),d()))},startAuto:function(a){if(a!==void 0&&(this.options.auto=a),this.options.auto===0)return this.stopAuto();if(this.timer===null){this.autoStopped=!1;var c=this;this.timer=window.setTimeout(function(){c.next()},this.options.auto*1e3)}},stopAuto:function(){this.pauseAuto(),this.autoStopped=!0},pauseAuto:function(){this.timer!==null&&(window.clearTimeout(this.timer),this.timer=null)},buttons:function(a,c){a==null&&(a=!this.locked&&this.options.size!==0&&(this.options.wrap&&this.options.wrap!="first"||this.options.size===null||this.last<this.options.size),!this.locked&&(!this.options.wrap||this.options.wrap=="first")&&this.options.size!==null&&this.last>=this.options.size)&&(a=this.tail!==null&&!this.inTail),c!=null||(c=!this.locked&&this.options.size!==0&&(this.options.wrap&&this.options.wrap!="last"||this.first>1),this.locked||this.options.wrap&&this.options.wrap!="last"||this.options.size===null||this.first!=1)||(c=this.tail!==null&&this.inTail);var b=this;this.buttonNext.size()>0?(this.buttonNext.unbind(this.options.buttonNextEvent+".jcarousel",this.funcNext),a&&this.buttonNext.bind(this.options.buttonNextEvent+".jcarousel",this.funcNext),this.buttonNext[a?"removeClass":"addClass"](this.className("jcarousel-next-disabled")).attr("disabled",a?!1:!0),this.options.buttonNextCallback!==null&&this.buttonNext.data("jcarouselstate")!=a&&this.buttonNext.each(function(){b.options.buttonNextCallback(b,this,a)}).data("jcarouselstate",a)):this.options.buttonNextCallback!==null&&this.buttonNextState!=a&&this.options.buttonNextCallback(b,null,a),this.buttonPrev.size()>0?(this.buttonPrev.unbind(this.options.buttonPrevEvent+".jcarousel",this.funcPrev),c&&this.buttonPrev.bind(this.options.buttonPrevEvent+".jcarousel",this.funcPrev),this.buttonPrev[c?"removeClass":"addClass"](this.className("jcarousel-prev-disabled")).attr("disabled",c?!1:!0),this.options.buttonPrevCallback!==null&&this.buttonPrev.data("jcarouselstate")!=c&&this.buttonPrev.each(function(){b.options.buttonPrevCallback(b,this,c)}).data("jcarouselstate",c)):this.options.buttonPrevCallback!==null&&this.buttonPrevState!=c&&this.options.buttonPrevCallback(b,null,c),this.buttonNextState=a,this.buttonPrevState=c},notify:function(a){var c=this.prevFirst===null?"init":this.prevFirst<this.first?"next":"prev";this.callback("itemLoadCallback",a,c),this.prevFirst!==this.first&&(this.callback("itemFirstInCallback",a,c,this.first),this.callback("itemFirstOutCallback",a,c,this.prevFirst)),this.prevLast!==this.last&&(this.callback("itemLastInCallback",a,c,this.last),this.callback("itemLastOutCallback",a,c,this.prevLast)),this.callback("itemVisibleInCallback",a,c,this.first,this.last,this.prevFirst,this.prevLast),this.callback("itemVisibleOutCallback",a,c,this.prevFirst,this.prevLast,this.first,this.last)},callback:function(a,c,b,d,f,j,e){var h,i,a,k;if(!(this.options[a]==null||typeof this.options[a]!="object"&&c!="onAfterAnimation")&&(h=typeof this.options[a]=="object"?this.options[a][c]:this.options[a],g.isFunction(h)))if(i=this,d===void 0)h(i,b,c);else if(f===void 0)this.get(d).each(function(){h(i,this,d,b,c)});else for(a=function(a){i.get(a).each(function(){h(i,this,a,b,c)})},k=d;k<=f;k++)k!==null&&!(k>=j&&k<=e)&&a(k)},create:function(a){return this.format("<li></li>",a)},format:function(a,c){for(var a=g(a),b=a.get(0).className.split(" "),d=0;d<b.length;d++)b[d].indexOf("jcarousel-")!=-1&&a.removeClass(b[d]);return a.addClass(this.className("jcarousel-item")).addClass(this.className("jcarousel-item-"+c)).css({float:this.options.rtl?"right":"left","list-style":"none"}).attr("jcarouselindex",c),a},className:function(a){return a+" "+a+(this.options.vertical?"-vertical":"-horizontal")},dimension:function(a,c){var b=g(a),d;return c==null?this.options.vertical?b.outerHeight(!0)||f.intval(this.options.itemFallbackDimension):b.outerWidth(!0)||f.intval(this.options.itemFallbackDimension):(d=this.options.vertical?c-f.intval(b.css("marginTop"))-f.intval(b.css("marginBottom")):c-f.intval(b.css("marginLeft"))-f.intval(b.css("marginRight")),g(b).css(this.wh,d+"px"),this.dimension(b))},clipping:function(){return this.options.vertical?this.clip[0].offsetHeight-f.intval(this.clip.css("borderTopWidth"))-f.intval(this.clip.css("borderBottomWidth")):this.clip[0].offsetWidth-f.intval(this.clip.css("borderLeftWidth"))-f.intval(this.clip.css("borderRightWidth"))},index:function(a,c){return c==null&&(c=this.options.size),Math.round(((a-1)/c-Math.floor((a-1)/c))*c)+1}}),f.extend({defaults:function(a){return g.extend(q,a||{})},intval:function(a){return a=parseInt(a,10),isNaN(a)?0:a},windowLoaded:function(){m=!0}}),g.fn.jcarousel=function(a){if(typeof a=="string"){var c=g(this).data("jcarousel"),b=Array.prototype.slice.call(arguments,1);return c[a].apply(c,b)}return this.each(function(){var b=g(this).data("jcarousel");b?(a&&g.extend(b.options,a),b.reload()):g(this).data("jcarousel",new f(this,a))})}})(jQuery);
(function($){var defaults={autoPlay:!0,speed:5e3,text:{play:"",stop:"",previous:"Previous",next:"Next",loading:"Loading"},transition:[1],showCaption:!0,IESafe:!1,showTooltips:!1,carousel:!1,carouselVertical:!1,animationFinished:null,buildFinished:null,bindsFinished:null,startOn:0,thumbOpacity:.4,hoverPause:!1,animationSpeed:600,fadeThumbsIn:!1,carouselOptions:{},thumbChangeEvent:"click.pikachoose",stopOnClick:!1},$pc;$.fn.PikaChoose=function(o){return this.each(function(){$(this).data("pikachoose",new $pc(this,o))})},$.PikaChoose=function(e,o){var y,x,t,a;if(this.options=$.extend({},defaults,o||{}),this.list=null,this.image=null,this.anchor=null,this.caption=null,this.imgNav=null,this.imgPlay=null,this.imgPrev=null,this.imgNext=null,this.textNext=null,this.textPrev=null,this.previous=null,this.next=null,this.aniWrap=null,this.aniDiv=null,this.aniImg=null,this.thumbs=null,this.transition=null,this.active=null,this.tooltip=null,this.animating=!1,this.stillOut=null,this.counter=null,this.timeOut=null,this.pikaStage=null,typeof this.options.data!="undefined"&&(e=$("<ul></ul>").addClass("jcarousel-skin-pika").appendTo(e),$.each(this.options.data,function(){var tmp=null;typeof this.link!="undefined"?(tmp=$("<li><a href='"+this.link+"'><img></a></li>").appendTo(e),typeof this.title!="undefined"&&tmp.find("a").attr("title",this.title)):tmp=$("<li><img></li>").appendTo(e),typeof this.caption!="undefined"&&tmp.append("<span>"+this.caption+"</span>"),typeof this.thumbnail!="undefined"?(tmp.find("img").attr("ref",this.image),tmp.find("img").attr("src",this.thumbnail)):tmp.find("img").attr("src",this.image)})),e instanceof jQuery||e.nodeName.toUpperCase()=="UL"||e.nodeName.toUpperCase()=="OL")this.list=$(e),this.build(),this.bindEvents();else return;for(y=0,x=0,t=0;t<25;t++)a='<div col="'+y+'" row="'+x+'"></div>',this.aniDiv.append(a),y++,y==5&&(x++,y=0)},$pc=$.PikaChoose,$pc.fn=$pc.prototype={pikachoose:"4.4.8"},$.fn.pikachoose=$.fn.PikaChoose,$pc.fn.extend=$pc.extend=$.extend,$pc.fn.extend({build:function(){var self,carouselDefaults,carouselOptions;this.step=0,this.options.pikaStage?(this.wrap=this.options.pikaStage,this.wrap.addClass("pika-stage")):this.wrap=$("<div class='pika-stage'></div>").insertBefore(this.list),this.image=$("<img>").appendTo(this.wrap),this.imgNav=$("<div class='pika-imgnav'></div>").insertAfter(this.image),this.imgPlay=$("<a></a>").appendTo(this.imgNav),this.counter=$("<span class='pika-counter'></span>").appendTo(this.imgNav),this.options.autoPlay?this.imgPlay.addClass("pause"):this.imgPlay.addClass("play"),this.imgPrev=$("<a class='previous'></a>").insertAfter(this.imgPlay),this.imgNext=$("<a class='next'></a>").insertAfter(this.imgPrev),this.caption=$("<div class='caption'></div>").insertAfter(this.imgNav).hide(),this.tooltip=$("<div class='pika-tooltip'></div>").insertAfter(this.list).hide(),this.aniWrap=$("<div class='pika-aniwrap'></div>").insertAfter(this.caption),this.aniImg=$("<img>").appendTo(this.aniWrap).hide(),this.aniDiv=$("<div class='pika-ani'></div>").appendTo(this.aniWrap),this.textNav=$("<div class='pika-textnav'></div>").insertAfter(this.aniWrap),this.textPrev=$("<a class='previous'>"+this.options.text.previous+"</a>").appendTo(this.textNav),this.textNext=$("<a class='next'>"+this.options.text.next+"</a>").appendTo(this.textNav),this.list.addClass("pika-thumbs"),this.thumbs=this.list.find("img"),this.loader=$("<div class='pika-loader'></div>").appendTo(this.wrap).hide().html(this.options.text.loading),this.active=this.thumbs.eq(this.options.startOn),this.finishAnimating({index:this.options.startOn,source:this.active.attr("ref")||this.active.attr("src"),caption:this.active.parents("li:first").find("span:first").html(),clickThrough:this.active.parent().attr("href")||"",clickThroughTarget:this.active.parent().attr("target")||"",clickThroughTitle:this.active.parent().attr("title")||""}),this.aniDiv.css({position:"relative"}),self=this,this.updateThumbs(),this.options.fadeThumbsIn&&this.list.fadeIn(),this.options.carousel&&(carouselDefaults={vertical:this.options.carouselVertical,initCallback:function(carousel){jQuery(carousel.list).find("img").click(function(e,x){if(typeof x!="undefined"&&x.how=="auto"&&self.options.autoPlay==!1)return!1;var clicked=parseInt(jQuery(this).parents(".jcarousel-item").attr("jcarouselindex")),last=jQuery(this).parents("ul").find("li:last").attr("jcarouselindex")==clicked-1?!0:!1;last||(clicked=clicked-2<=0?0:clicked-2),clicked++,carousel.scroll(clicked)})}},carouselOptions=$.extend({},carouselDefaults,this.options.carouselOptions||{}),this.list.jcarousel(carouselOptions)),typeof this.options.buildFinished=="function"&&this.options.buildFinished(this)},createThumb:function(ele){var self=ele,that=this,data;(this.thumbs=this.list.find("img"),typeof $.data(ele[0],"source")=="undefined")&&(ele.parents("li:first").wrapInner("<div class='clip' />"),self.hide(),$.data(ele[0],"clickThrough",self.parent("a").attr("href")||""),$.data(ele[0],"clickThroughTarget",self.parent("a").attr("target")||""),$.data(ele[0],"clickThroughTitle",self.parent("a").attr("title")||""),self.parent("a").length>0&&self.unwrap(),$.data(ele[0],"caption",self.next("span").html()||""),self.next("span").remove(),$.data(ele[0],"source",self.attr("ref")||self.attr("src")),$.data(ele[0],"imageTitle",self.attr("title")||""),$.data(ele[0],"imageAlt",self.attr("alt")||""),$.data(ele[0],"index",this.thumbs.index(ele)),$.data(ele[0],"order",self.closest("ul").find("li").index(self.parents("li"))),data=$.data(ele[0]),$("<img />").bind("load",{data:data},function(){var ph,pw,rw,rh,ratio;typeof that.options.buildThumbStart=="function"&&that.options.buildThumbStart(that);var img=$(this),w=this.width,h=this.height;w===0&&(w=img.attr("width")),h===0&&(h=img.attr("height")),ph=parseInt(self.parents(".clip").css("height").slice(0,-2)),pw=parseInt(self.parents(".clip").css("width").slice(0,-2)),pw===0&&(pw=self.parents("li:first").outerWidth()),ph===0&&(ph=self.parents("li:first").outerHeight()),rw=pw/w,rh=ph/h,rw<rh?self.css({height:"100%"}):self.css({width:"100%"}),self.hover(function(){(clearTimeout(that.stillOut),$(this).stop(!0,!0).fadeTo(250,1),that.options.showTooltips)&&that.tooltip.show().stop(!0,!0).html(data.caption).animate({top:$(this).parent().position().top,left:$(this).parent().position().left,opacity:1},"fast")},function(){$(this).hasClass("active")||($(this).stop(!0,!0).fadeTo(250,that.options.thumbOpacity),that.stillOut=setTimeout(that.hideTooltip,700))}),data.order==that.options.startOn?(self.fadeTo(250,1),self.addClass("active"),self.parents("li").eq(0).addClass("active")):self.fadeTo(250,that.options.thumbOpacity),typeof that.options.buildThumbFinish=="function"&&that.options.buildThumbFinish(that)}).attr("src",self.attr("src")))},bindEvents:function(){this.thumbs.bind(this.options.thumbChangeEvent,{self:this},this.imgClick),this.imgNext.bind("click.pikachoose",{self:this},this.nextClick),this.textNext.bind("click.pikachoose",{self:this},this.nextClick),this.imgPrev.bind("click.pikachoose",{self:this},this.prevClick),this.textPrev.bind("click.pikachoose",{self:this},this.prevClick),this.imgPlay.unbind("click.pikachoose").bind("click.pikachoose",{self:this},this.playClick),this.wrap.unbind("mouseenter.pikachoose").bind("mouseenter.pikachoose",{self:this},function(e){e.data.self.imgNav.stop(!0,!0).fadeTo("slow",1),e.data.self.options.hoverPause===!0&&clearTimeout(e.data.self.timeOut)}),this.wrap.unbind("mouseleave.pikachoose").bind("mouseleave.pikachoose",{self:this},function(e){e.data.self.imgNav.stop(!0,!0).fadeTo("slow",0),e.data.self.options.autoPlay&&e.data.self.options.hoverPause&&(e.data.self.timeOut=setTimeout(function(self){return function(){self.nextClick()}}(e.data.self),e.data.self.options.speed))}),this.tooltip.unbind("mouseenter.pikachoose").bind("mouseenter.pikachoose",{self:this},function(e){clearTimeout(e.data.self.stillOut)}),this.tooltip.unbind("mouseleave.pikachoose").bind("mouseleave.pikachoose",{self:this},function(e){e.data.self.stillOut=setTimeout(e.data.self.hideTooltip,700)}),typeof this.options.bindsFinished=="function"&&this.options.bindsFinished(this)},hideTooltip:function(){$(".pika-tooltip").animate({opacity:.01})},imgClick:function(e,x){var self=e.data.self,data=$.data(this);if(!self.animating){if(typeof x=="undefined"||x.how!="auto")self.options.autoPlay&&self.options.stopOnClick?self.imgPlay.trigger("click"):clearTimeout(self.timeOut);else if(!self.options.autoPlay)return!1;$(this).attr("src")!==$.data(this).source&&self.loader.fadeIn("fast"),self.caption.fadeOut("slow"),self.animating=!0,self.active.fadeTo(300,self.options.thumbOpacity).removeClass("active"),self.active.parents(".active").eq(0).removeClass("active"),self.active=$(this),self.active.addClass("active").fadeTo(200,1),self.active.parents("li").eq(0).addClass("active"),$("<img />").bind("load",{self:self,data:data},function(){self.loader.fadeOut("fast"),self.aniDiv.css({height:self.image.height(),width:self.image.width()}).show(),self.aniDiv.children("div").css({width:"20%",height:"20%",float:"left"});var n=0;self.options.transition[0]==-1?n=Math.floor(Math.random()*7)+1:(n=self.options.transition[self.step],self.step++,self.step>=self.options.transition.length&&(self.step=0)),self.options.IESafe&&$.browser.msie&&(n=1),self.doAnimation(n,data)}).attr("src",$.data(this).source)}},doAnimation:function(n,data){var self;this.aniWrap.css({position:"absolute",top:this.wrap.css("padding-top"),left:this.wrap.css("padding-left"),width:this.wrap.width()}),self=this,self.image.stop(!0,!1),self.caption.stop().fadeOut();var aWidth=self.aniDiv.children("div").eq(0).width(),aHeight=self.aniDiv.children("div").eq(0).height(),img=new Image;$(img).attr("src",data.source),(img.height!=self.image.height()||img.width!=self.image.width())&&n!==0&&n!==1&&n!==7,self.aniDiv.css({height:self.image.height(),width:self.image.width()}),self.aniDiv.children().each(function(){var
 div=$(this),xOffset=Math.floor(div.parent().width()/5)*div.attr("col"),yOffset=Math.floor(div.parent().height()/5)*div.attr("row");div.css({background:"url("+data.source+") -"+xOffset+"px -"+yOffset+"px","background-size":div.parent().width()+"px "+div.parent().height()+"px",width:"0px",height:"0px",position:"absolute",top:yOffset+"px",left:xOffset+"px",float:"none"})}),self.aniDiv.hide(),self.aniImg.hide();switch(n){case 0:self.image.stop(!0,!0).fadeOut(self.options.animationSpeed,function(){self.image.attr("src",data.source).fadeIn(self.options.animationSpeed,function(){self.finishAnimating(data)})});break;case 1:self.aniDiv.hide(),self.aniImg.height(self.image.height()).hide().attr("src",data.source),self.wrap.css({height:self.image.height()}),$.when(self.image.fadeOut(self.options.animationSpeed),self.aniImg.eq(0).fadeIn(self.options.animationSpeed)).done(function(){self.finishAnimating(data)});break;case 2:self.aniDiv.show().children().hide().each(function(index){var delay=index*30;$(this).css({opacity:.1}).show().delay(delay).animate({opacity:1,width:aWidth,height:aHeight},200,"linear",function(){self.aniDiv.find("div").index(this)==24&&self.finishAnimating(data)})});break;case 3:self.aniDiv.show().children("div:lt(5)").hide().each(function(){var delay=$(this).attr("col")*100;$(this).css({opacity:.1,width:aWidth}).show().delay(delay).animate({opacity:1,height:self.image.height()},self.options.animationSpeed,"linear",function(){self.aniDiv.find(" div").index(this)==4&&self.finishAnimating(data)})});break;case 4:self.aniDiv.show().children().hide().each(function(index){if(!(index>4)){var delay=$(this).attr("col")*30,gap=self.gapper($(this),aHeight,aWidth),speed=self.options.animationSpeed*.7;$(this).css({opacity:.1,height:"100%"}).show().delay(delay).animate({opacity:1,width:gap.width},speed,"linear",function(){self.aniDiv.find(" div").index(this)==4&&self.finishAnimating(data)})}});break;case 5:self.aniDiv.show().children().show().each(function(index){var delay=index*Math.floor(Math.random()*5)*7,gap=self.gapper($(this),aHeight,aWidth);$(".animation div").index(this)==24&&(delay=700),$(this).css({height:gap.height,width:gap.width,opacity:.01}).delay(delay).animate({opacity:1},self.options.animationSpeed,function(){self.aniDiv.find(" div").index(this)==24&&self.finishAnimating(data)})});break;case 6:self.aniDiv.height(self.image.height()).hide().css({background:"url("+data.source+") top left no-repeat"}),self.aniDiv.children("div").hide(),self.aniDiv.css({width:0}).show().animate({width:self.image.width()},self.options.animationSpeed,function(){self.finishAnimating(data),self.aniDiv.css({background:"transparent"})});break;case 7:self.wrap.css({overflow:"hidden"}),self.aniImg.height(self.image.height()).hide().attr("src",data.source),self.aniDiv.hide(),self.image.css({position:"relative"}).animate({left:"-"+self.wrap.outerWidth()+"px"}),self.aniImg.show(),self.aniWrap.css({left:self.wrap.outerWidth()}).show().animate({left:"0px"},self.options.animationSpeed,function(){self.finishAnimating(data)})}},finishAnimating:function(data){var cur,total,self;this.animating=!1,this.image.attr("src",data.source),this.image.attr("alt",data.imageAlt),this.image.attr("title",data.imageTitle),this.image.css({left:"0"}),this.image.show(),self=this,$("<img />").bind("load",function(){self.aniImg.fadeOut("fast"),self.aniDiv.fadeOut("fast")}).attr("src",data.source),cur=data.index+1,total=this.thumbs.length,this.counter.html(cur+"/"+total),data.clickThrough!==""?(this.anchor===null&&(this.anchor=this.image.wrap("<a>").parent()),this.anchor.attr("href",data.clickThrough),this.anchor.attr("title",data.clickThroughTitle),this.anchor.attr("target",data.clickThroughTarget)):(this.image.parent("a").length>0&&this.image.unwrap(),this.anchor=null),this.options.showCaption&&data.caption!==""&&data.caption!==null&&this.caption.html(data.caption).fadeTo("slow",1),this.options.autoPlay&&(self=this,this.timeOut=setTimeout(function(self){return function(){self.nextClick()}}(this),this.options.speed,this.timeOut)),typeof this.options.animationFinished=="function"&&this.options.animationFinished(this)},gapper:function(ele,aHeight,aWidth){var gap;return ele.attr("row")==4&&(gap=this.aniDiv.height()-aHeight*5+aHeight,aHeight=gap),ele.attr("col")==4&&(gap=this.aniDiv.width()-aWidth*5+aWidth,aWidth=gap),{height:aHeight,width:aWidth}},nextClick:function(e){var how="natural",self=null,next;try{self=e.data.self,typeof e.data.self.options.next=="function"&&e.data.self.options.next(this)}catch(err){self=this,how="auto"}next=self.active.parents("li:first").next().find("img"),next.length===0&&(next=self.list.find("img").eq(0)),next.trigger("click",{how:how})},prevClick:function(e){typeof e.data.self.options.previous=="function"&&e.data.self.options.previous(this);var self=e.data.self,prev=self.active.parents("li:first").prev().find("img");prev.length===0&&(prev=self.list.find("img:last")),prev.trigger("click")},playClick:function(e){var self=e.data.self;self.options.autoPlay=!self.options.autoPlay,self.imgPlay.toggleClass("play").toggleClass("pause"),self.options.autoPlay&&self.nextClick()},Next:function(){var e={data:{self:this}};this.nextClick(e)},Prev:function(){var e={data:{self:this}};this.prevClick(e)},GoTo:function(v){var e={data:{self:this}};this.list.find("img").eq(v).trigger("click")},Play:function(){if(!this.options.autoPlay){var e={data:{self:this}};this.playClick(e)}},Pause:function(){if(this.options.autoPlay){var e={data:{self:this}};this.playClick(e)}},updateThumbs:function(){var self=this;this.thumbs=this.list.find("img"),this.thumbs.each(function(){self.createThumb($(this),self)})}})})(jQuery);
(function($){$.fn.agile_carousel=function(options){var defaults={timer:0,continuous_scrolling:!1,transition_type:"slide",transition_time:600,number_slides_visible:1,change_on_hover:"",control_set_1:"",control_set_2:"",control_set_3:"",control_set_4:"",control_set_5:""};return options=$.extend(defaults,options),this.each(function(){function get_trigger_type(check_me){if(change_on_hover!==""){ac_trigger_type="ac_click";var change_on_hover_array=change_on_hover.split(",");$.inArray(check_me,change_on_hover_array)!=-1&&(ac_trigger_type="ac_hover")}return ac_trigger_type}function disable_buttons(slide_num){continuous_scrolling===!1&&number_slides_visible<2&&(slide_num==1?(previous_button_length>0&&(previous_button.addClass("ac_disabled"),previous_button.data("options").disabled=!0),hover_previous_button_length>0&&(hover_previous_button.addClass("ac_disabled"),hover_previous_button.data("options").disabled=!0)):(previous_button_length>0&&(previous_button.removeClass("ac_disabled"),previous_button.data("options").disabled=!1),hover_previous_button_length>0&&(hover_previous_button.removeClass("ac_disabled"),hover_previous_button.data("options").disabled=!1)),slide_num==number_of_slides?(next_button_length>0&&(next_button.addClass("ac_disabled"),next_button.data("options").disabled=!0),hover_next_button_length>0&&(hover_next_button.addClass("ac_disabled"),hover_next_button.data("options").disabled=!0)):(next_button_length>0&&(next_button.removeClass("ac_disabled"),next_button.data("options").disabled=!1),hover_next_button_length>0&&(hover_next_button.removeClass("ac_disabled"),hover_next_button.data("options").disabled=!1))),continuous_scrolling===!1&&number_slides_visible>1&&(slide_num<=number_slides_visible?(previous_button_length>0&&(previous_button.addClass("ac_disabled"),previous_button.data("options").disabled=!0),hover_previous_button_length>0&&(hover_previous_button.addClass("ac_disabled"),hover_previous_button.data("options").disabled=!0)):(previous_button_length>0&&(previous_button.removeClass("ac_disabled"),previous_button.data("options").disabled=!1),hover_previous_button_length>0&&(hover_previous_button.removeClass("ac_disabled"),hover_previous_button.data("options").disabled=!1)),slide_num>=number_of_slides-number_slides_visible+slide_remainder?(next_button_length>0&&(next_button.addClass("ac_disabled"),next_button.data("options").disabled=!0),hover_next_button_length>0&&(hover_next_button.addClass("ac_disabled"),hover_next_button.data("options").disabled=!0)):(next_button_length>0&&(next_button.removeClass("ac_disabled"),next_button.data("options").disabled=!1),hover_next_button_length>0&&(hover_next_button.removeClass("ac_disabled"),hover_next_button.data("options").disabled=!1)))}function update_current_slide_number(slide_num){current_slide_number_display_length>0&&current_slide_number_display.html(slide_num)}function add_selected_class(slide_num){obj.find(".ac_selected").removeClass("ac_selected"),obj.find(".slide_number_"+slide_num).addClass("ac_selected")}function transition_slides(button_data){var ac_disabled,go_to,curr_lookup,animate_current_slide_to;bd=$(button_data)[0],ac_disabled=bd.disabled,ac_disabled!==!0&&(button_type=bd.button_type,trigger_type=bd.trigger_type,button_action=bd.button_action,go_to=bd.go_to,ac_disabled=bd.disabled,next_slide_number!==!1&&(current_slide_number=next_slide_number),current_slide_index=current_slide_number-1,current_slide=$(ac_slides).eq(current_slide_index),number_slides_visible<2&&(button_action=="next"&&current_slide_number<number_of_slides?next_slide_number=current_slide_number+1:button_action=="next"&&current_slide_number==number_of_slides&&(next_slide_number=1),button_action=="previous"&&current_slide_number>1?next_slide_number=current_slide_number-1:button_action=="previous"&&current_slide_number==1&&(next_slide_number=number_of_slides)),number_slides_visible>1&&(button_action=="next"&&current_slide_number<number_of_slides-number_slides_visible+slide_remainder?next_slide_number=slide_number_conversion_array[Math.ceil(current_slide_number/number_slides_visible)]:button_action=="next"&&current_slide_number>=number_of_slides-number_slides_visible+slide_remainder&&number_slides_visible>1&&(next_slide_number=1),button_action=="previous"&&current_slide_number>number_slides_visible&&number_slides_visible>1?(curr_lookup=Math.floor(current_slide_number/number_slides_visible),curr_lookup=curr_lookup-1,next_slide_number=slide_number_conversion_array[curr_lookup]):button_action=="previous"&&current_slide_number<=number_slides_visible&&number_slides_visible>1&&(next_slide_number=slide_number_conversion_array_last)),button_action=="direct"&&(next_slide_number=go_to),next_slide_index=next_slide_number-1,next_slide=$(ac_slides).eq(next_slide_index),add_selected_class(next_slide_number),update_current_slide_number(next_slide_number),next_slide_index!=current_slide_index&&(transition_type=="slide"&&number_slides_visible>1&&ac_slides_container.stop().animate({left:(next_slide_number*slide_width-slide_width)*-1+"px"},{duration:transition_time}),transition_type=="slide"&&number_slides_visible==1&&(animate_current_slide_to="",(button_action=="next"||next_slide_number>current_slide_number&&button_action=="direct")&&(next_slide.css({top:0,left:slide_width}),animate_current_slide_to=slide_width*-1),(button_action=="previous"||next_slide_number<current_slide_number&&button_action=="direct")&&(next_slide.css({top:0,left:slide_width*-1}),animate_current_slide_to=slide_width),current_slide.stop().animate({left:animate_current_slide_to+"px"},{duration:transition_time,complete:slide_complete}),next_slide.stop().animate({left:"0px"},{duration:transition_time})),transition_type=="fade"&&number_slides_visible==1&&(ac_slides.not(current_slide,next_slide).css({top:"-5000px",left:0,"z-index":0,opacity:0}),button_action&&(next_slide.css({top:0,left:0,"z-index":20}),current_slide.css({"z-index":10,opacity:1})),next_slide.stop().animate({opacity:1},{duration:transition_time,complete:fade_complete})))),disable_buttons(next_slide_number),add_selected_class(next_slide_number)}function pause_slideshow(){pause_button.length>0&&(pause_button.html("play"),pause_button.data("options").paused=!0,pause_button.addClass("play_button")),clearInterval(ac_timer)}function timer_transition(){transition_slides(timer_data)}function play_slideshow(){return clearInterval(ac_timer),pause_button.html("pause"),pause_button.data("options").paused=!1,pause_button.addClass("pause_button"),pause_button.removeClass("play_button"),transition_slides(timer_data),ac_timer=setInterval(timer_transition,timer)}var combined_slide_width=0,number_of_slides=0,ac_html="",ac_content="",ac_numbered_buttons="",ac_group_numbered_buttons="",ac_thumbnails="",ac_content_buttons="",ac_pause="",ac_previous_button="",ac_next_button="",ac_hover_previous_button="",ac_hover_next_button="",ac_slide_count="",ac_current_slide_number="",ac_trigger_type="ac_click",bd="",button_type="",trigger_type="",button_action="",go_direct="",ac_disabled="",current_slide_number="",next_slide_number=!1,current_slide_index="",next_slide_index="",current_slide="",next_slide="",continuous_scrolling=options.continuous_scrolling,carousel_outer_width=options.carousel_outer_width,carousel_outer_height=options.carousel_outer_height,carousel_data=options.carousel_data,change_on_hover=options.change_on_hover,slide_width=options.slide_width,slide_height=options.slide_height,control_set_1=options.control_set_1,control_set_2=options.control_set_2,control_set_3=options.control_set_3,control_set_4=options.control_set_4,control_set_5=options.control_set_5,no_control_set=options.no_control_set,persistent_content=options.persistent_content,number_slides_visible=options.number_slides_visible,transition_type=options.transition_type,transition_time=options.transition_time,timer=options.timer,content="",obj_inner="",content_button="",$this="",timer_data="",ac_timer="",j,i,curr_num,obj,key,thumbnail_button,create_control_set,current_slide_number_display,current_slide_number_display_length,k,fade_complete,slide_complete,slide_number_conversion_array_last,agile_carousel_buttons_click,agile_carousel_buttons_hover,pause_button;$.each(carousel_data,function(){number_of_slides++});var slide_remainder=number_of_slides%number_slides_visible,slide_number_conversion_array=[],new_num="";for(j=0,i=0,i=0;i<number_of_slides;i++)i===0&&(ac_group_numbered_buttons+="<div class='group_numbered_buttons_container button_container'>"),curr_num=Math.floor((i+1)/number_slides_visible)*number_slides_visible+1,curr_num!==new_num&&curr_num<=number_of_slides&&(slide_number_conversion_array[j]=curr_num,ac_group_numbered_buttons+="<div class='slide_number_"+curr_num+" group_numbered_button slide_button "+get_trigger_type("group_numbered_buttons")+'\' data-options=\'{"button_type":"group_numbered_button","button_action":"direct","go_to":'+curr_num+', "trigger_type":"'+ac_trigger_type+'","disabled": false}\'>'+(j+1)+"</div>",new_num=curr_num,j++),i===number_of_slides-1&&(ac_group_numbered_buttons+="</div>");ac_pause+='<span class=\'pause_button slide_button pause\' data-options=\'{"button_type":"pause_button","trigger_type": "none","disabled": false,"paused": false}\'>Pause</span>',ac_previous_button+="<span class='previous_next_button previous_button slide_button "+get_trigger_type("previous_button")+'\' data-options=\'{"button_type":"previous_button","button_action":"previous","trigger_type": "'+ac_trigger_type+'","disabled": false}\'>Prev</span>',ac_next_button+="<span class='previous_next_button next_button slide_button "+get_trigger_type("next_button")+'\' data-options=\'{"button_type":"next_button","button_action":"next","trigger_type": "'+ac_trigger_type+'","disabled": false}\'>Next</span>',ac_hover_previous_button+="<div class='hover_previous_next_button hover_previous_button slide_button "+get_trigger_type("hover_previous_button")+'\'
 data-options=\'{"button_type":"hover_previous_button","button_action":"previous","trigger_type": "'+ac_trigger_type+"\",\"disabled\": false}'><span style='opacity: 0;' class='hover_previous_next_button_inner'>Prev</span></div>",ac_hover_next_button+="<div class='hover_previous_next_button hover_next_button slide_button "+get_trigger_type("hover_next_button")+'\' data-options=\'{"button_type":"hover_next_button","button_action":"next","trigger_type": "'+ac_trigger_type+"\",\"disabled\": false}'><span style='opacity: 0;' class='hover_previous_next_button_inner'>Next</span></div>",ac_slide_count+="<span class='slide_count'>"+number_of_slides+"</span>",ac_current_slide_number+="<span class='current_slide_number'>1</span>",ac_html+="<div class='agile_carousel' style='overflow: hidden; position: relative; width: "+carousel_outer_width+"px; height: "+carousel_outer_height+"px;'>",obj=$(this),i=1;for(key in carousel_data)carousel_data.hasOwnProperty(key)&&(obj_inner=carousel_data[key],content=obj_inner.content,thumbnail_button=obj_inner.thumbnail_button,content_button=obj_inner.content_button,i===1&&(ac_html+="<div class='slides' style='width: "+slide_width*number_of_slides+"px; height: "+slide_height+"px;'>"),content&&(ac_html+="<div class='slide_"+i+" slide' style='border: none; margin: 0; padding: 0; height: "+slide_height+"px; width: "+slide_width+"px;'>"+content+"</div>"),i===number_of_slides&&(ac_html+="</div>"),i==1&&(ac_numbered_buttons+="<div class='numbered_buttons_container  button_container'>"),ac_numbered_buttons+="<div class='slide_number_"+i+" numbered_button slide_button "+get_trigger_type("numbered_buttons")+'\' data-options=\'{"button_type":"numbered_button","button_action":"direct","go_to":'+i+', "trigger_type":"'+ac_trigger_type+'","disabled": false}\'></div>',i==number_of_slides&&(ac_numbered_buttons+="</div>"),thumbnail_button&&(i==1&&(ac_thumbnails+="<div class='thumbnail_buttons_container  button_container'>"),ac_thumbnails+="<div class='slide_number_"+i+" thumbnail_button slide_button "+get_trigger_type("thumbnails")+'\'  data-options=\'{"button_type":"thumbnail_button","button_action":"direct","go_to":'+i+',"trigger_type": "'+ac_trigger_type+'","disabled": false}\'>'+thumbnail_button+"</div>",i==number_of_slides&&(ac_thumbnails+="</div>")),content_button&&(i==1&&(ac_content_buttons+="<div class='content_buttons_container  button_container'>"),ac_content_buttons+="<div class='slide_number_"+i+" content_button_"+i+" content_button slide_button "+get_trigger_type("content_buttons")+'\' data-options=\'{"button_type":"content_button","button_action":"direct","go_to":'+i+',"trigger_type": "'+ac_trigger_type+"\",\"disabled\": false}'><div class='content_button_inner'>"+content_button+"</div></div>",i==number_of_slides&&(ac_content_buttons+="</div>")),i++);create_control_set=function(set,set_number){var control_set_html="",control_set_array;if(set!==""){for(set_number&&(control_set_html+="<div class='control_set_"+set_number+" control_set'><div class='control_set_"+set_number+"_inner control_set_inner'>"),control_set_array=set.split(","),j=0;j<control_set_array.length;j++)control_set_array[j]=="numbered_buttons"&&(control_set_html+=ac_numbered_buttons),control_set_array[j]=="group_numbered_buttons"&&(control_set_html+=ac_group_numbered_buttons),control_set_array[j]=="thumbnails"&&(control_set_html+=ac_thumbnails),control_set_array[j]=="content_buttons"&&(control_set_html+=ac_content_buttons),control_set_array[j]=="pause_button"&&(control_set_html+=ac_pause),control_set_array[j]=="previous_button"&&(control_set_html+=ac_previous_button),control_set_array[j]=="next_button"&&(control_set_html+=ac_next_button),control_set_array[j]=="hover_previous_button"&&(control_set_html+=ac_hover_previous_button),control_set_array[j]=="hover_next_button"&&(control_set_html+=ac_hover_next_button),control_set_array[j]=="slide_count"&&(control_set_html+=ac_slide_count),control_set_array[j]=="current_slide_number"&&(control_set_html+=ac_current_slide_number);set_number&&(control_set_html+="</div></div>"),ac_html+=control_set_html}},options.control_set_1&&create_control_set(control_set_1,1),options.control_set_2&&create_control_set(control_set_2,2),options.control_set_3&&create_control_set(control_set_3,3),options.control_set_4&&create_control_set(control_set_4,4),options.control_set_5&&create_control_set(control_set_5,5),options.no_control_set&&create_control_set(no_control_set),persistent_content&&(ac_html+=persistent_content),ac_html+="</div>",obj.html(ac_html);var ac_slides=obj.find(".slide"),ac_slides_container=obj.find(".slides"),ac_slide_buttons=obj.find(".slide_button"),ac_slide_buttons_length=ac_slide_buttons.length,agile_carousel=obj.find(".agile_carousel"),ac_previous_buttons=obj.find(".previous_button, .hover_previous_button"),ac_previous_buttons_length=ac_previous_buttons.length,ac_next_buttons=obj.find(".next_button, .hover_next_button"),previous_button=obj.find(".previous_button"),previous_button_length=previous_button.length,hover_previous_button=obj.find(".hover_previous_button"),hover_previous_button_length=hover_previous_button.length,next_button=obj.find(".next_button"),next_button_length=next_button.length,hover_next_button=obj.find(".hover_next_button"),hover_next_button_length=hover_next_button.length;if(current_slide_number_display=obj.find(".current_slide_number"),current_slide_number_display_length=current_slide_number_display.length,number_slides_visible==1&&(ac_slides.eq(0).css({position:"absolute",top:0,left:0}),ac_slides.slice(1,number_of_slides).css({position:"absolute",top:"-5000px",left:0}),ac_slides_container.css("width",slide_width+"px")),number_slides_visible>1)for(agile_carousel.css("width",number_slides_visible*slide_width+"px"),k=0,k=1;k<=number_of_slides;k++)ac_slides.eq(k).css({position:"absolute",top:0,left:slide_width*k+"px"});fade_complete=function(){current_slide.css({"z-index":10,top:-5e3})},slide_complete=function(){current_slide.css({position:"absolute",top:"-5000px",left:0})},disable_buttons(1),update_current_slide_number(1),add_selected_class(1),button_type=bd.button_type,current_slide_number=1,slide_number_conversion_array_last=slide_number_conversion_array[slide_number_conversion_array.length-1],agile_carousel_buttons_click=obj.find(".ac_click"),agile_carousel_buttons_hover=obj.find(".ac_hover"),timer!==0&&(ac_timer=setInterval(timer_transition,timer)),pause_button=obj.find(".pause_button"),$(agile_carousel_buttons_click).click(function(){if(pause_slideshow(),obj.find(":animated").length<1)transition_slides($(this).data().options);else if($this=$(this),$this.data("options").button_action!="next"&&$this.data("options").button_action!="previous"){function check_transition(){ac_slides_container.find(":animated").length<1&&(transition_slides($this.data().options),clearInterval($this.data("options").timeout))}t=setInterval(check_transition,30),$this.data("options").timeout=t}}),$(agile_carousel_buttons_hover).hover(function(){if(pause_slideshow(),ac_slides_container.find(":animated").length<1)transition_slides($(this).data().options);else{$this=$(this);function check_transition(){ac_slides_container.find(":animated").length<1&&(transition_slides($this.data().options),clearInterval($this.data("options").timeout))}t=setInterval(check_transition,30),$this.data("options").timeout=t}},function(){$this=$(this),clearInterval($this.data("options").timeout)}),timer_data={button_action:"next",button_type:"pause",disabled:!1,trigger_type:"ac_click"},pause_button.click(function(){var $this=$(this);$this.data("options").paused===!0?play_slideshow():$this.data("options").paused===!1&&(pause_slideshow(),clearInterval(ac_timer))}),$(".hover_previous_next_button").hover(function(){$(this).find(".hover_previous_next_button_inner").stop().fadeTo("fast",.85)},function(){$(this).find(".hover_previous_next_button_inner").stop().fadeTo("fast",0)})})}})(jQuery);
(function(){function s(a,b){var c;a||(a={});for(c in b)a[c]=b[c];return a}function x(){var a,b=arguments,c,d={},e=function(a,b){var c,d;typeof a!="object"&&(a={});for(d in b)b.hasOwnProperty(d)&&(c=b[d],a[d]=c&&typeof c=="object"&&Object.prototype.toString.call(c)!=="[object Array]"&&d!=="renderTo"&&typeof c.nodeType!="number"?e(a[d]||{},c):b[d]);return a};for(b[0]===!0&&(d=b[1],b=Array.prototype.slice.call(b,2)),c=b.length,a=0;a<c;a++)d=e(d,b[a]);return d}function G(a,b){return parseInt(a,b||10)}function Qa(a){return typeof a=="string"}function ga(a){return a&&typeof a=="object"}function Ra(a){return Object.prototype.toString.call(a)==="[object Array]"}function ma(a){return typeof a=="number"}function Ia(a){return X.log(a)/X.LN10}function ra(a){return X.pow(10,a)}function sa(a,b){for(var c=a.length;c--;)if(a[c]===b){a.splice(c,1);break}}function t(a){return a!==r&&a!==null}function Y(a,b,c){var d,e;if(Qa(b))t(c)?a.setAttribute(b,c):a&&a.getAttribute&&(e=a.getAttribute(b));else if(t(b)&&ga(b))for(d in b)a.setAttribute(d,b[d]);return e}function na(a){return Ra(a)?a:[a]}function q(){for(var a=arguments,c,d=a.length,b=0;b<d;b++)if(c=a[b],c!==r&&c!==null)return c}function K(a,b){Ja&&!da&&b&&b.opacity!==r&&(b.filter="alpha(opacity="+b.opacity*100+")"),s(a.style,b)}function aa(a,b,c,d,e){return a=D.createElement(a),b&&s(a,b),e&&K(a,{padding:0,border:$,margin:0}),c&&K(a,c),d&&d.appendChild(a),a}function ha(a,b){var c=function(){return r};return c.prototype=new a,s(c.prototype,b),c}function Ka(a,b,c,d){var e=F.lang,a=+a||0,f=b===-1?(a.toString().split(".")[1]||"").length:isNaN(b=P(b))?2:b,b=c===void 0?e.decimalPoint:c,d=d===void 0?e.thousandsSep:d,e=a<0?"-":"",c=String(G(a=P(a).toFixed(f))),g=c.length>3?c.length%3:0;return e+(g?c.substr(0,g)+d:"")+c.substr(g).replace(/(\d{3})(?=\d)/g,"$1"+d)+(f?b+P(a-c).toFixed(f).slice(2):"")}function Sa(a,b){return Array((b||2)+1-String(a).length).join(0)+a}function M(a,b,c){var d=a[b];a[b]=function(){var a=Array.prototype.slice.call(arguments);return a.unshift(d),c.apply(this,a)}}function La(a,b){for(var c="{",d=!1,e,f,g,h,i,j=[];(c=a.indexOf(c))!==-1;){if(e=a.slice(0,c),d){for(f=e.split(":"),g=f.shift().split("."),i=g.length,e=b,h=0;h<i;h++)e=e[g[h]];f.length&&(f=f.join(":"),g=/\.([0-9])/,h=F.lang,i=void 0,/f$/.test(f)?(i=(i=f.match(g))?i[1]:-1,e!==null&&(e=Ka(e,i,h.decimalPoint,f.indexOf(",")>-1?h.thousandsSep:""))):e=wa(f,e))}j.push(e),a=a.slice(c+1),c=(d=!d)?"}":"{"}return j.push(a),j.join("")}function ub(a){return X.pow(10,V(X.log(a)/X.LN10))}function vb(a,b,c,d){var e,c=q(c,1);for(e=a/c,b||(b=[1,2,2.5,5,10],d&&d.allowDecimals===!1&&(c===1?b=[1,2,5,10]:c<=.1&&(b=[1/c]))),d=0;d<b.length;d++)if(a=b[d],e<=(b[d]+(b[d+1]||b[d]))/2)break;return a*=c}function wb(a,b){for(var c=a.length,d,e=0;e<c;e++)a[e].ss_i=e;for(a.sort(function(a,c){return d=b(a,c),d===0?a.ss_i-c.ss_i:d}),e=0;e<c;e++)delete a[e].ss_i}function Ta(a){for(var b=a.length,c=a[0];b--;)a[b]<c&&(c=a[b]);return c}function Da(a){for(var b=a.length,c=a[0];b--;)a[b]>c&&(c=a[b]);return c}function Ma(a,b){for(var c in a)a[c]&&a[c]!==b&&a[c].destroy&&a[c].destroy(),delete a[c]}function Ua(a){jb||(jb=aa(Va)),a&&jb.appendChild(a),jb.innerHTML=""}function ia(a){return parseFloat(a.toPrecision(14))}function $a(a,b){Ea=q(a,b.animation)}function Lb(){var a=F.global.useUTC,b=a?"getUTC":"get",c=a?"setUTC":"set";Na=(a&&F.global.timezoneOffset||0)*6e4,kb=a?Date.UTC:function(a,b,c,g,h,i){return+new Date(a,b,q(c,1),q(g,0),q(h,0),q(i,0))},xb=b+"Minutes",yb=b+"Hours",zb=b+"Day",Wa=b+"Date",lb=b+"Month",mb=b+"FullYear",Mb=c+"Minutes",Nb=c+"Hours",Ab=c+"Date",Ob=c+"Month",Pb=c+"FullYear"}function Z(){}function ab(a,b,c,d){this.axis=a,this.pos=b,this.type=c||"",this.isNew=!0,!c&&!d&&this.addLabel()}function J(){this.init.apply(this,arguments)}function xa(){this.init.apply(this,arguments)}function Qb(a,b,c,d,e){var f=a.chart.inverted;this.axis=a,this.isNegative=c,this.options=b,this.x=d,this.total=null,this.points={},this.stack=e,this.alignOptions={align:b.align||(f?c?"left":"right":"center"),verticalAlign:b.verticalAlign||(f?"middle":c?"bottom":"top"),y:q(b.y,f?4:c?14:-6),x:q(b.x,f?c?-6:6:0)},this.textAlign=b.textAlign||(f?c?"right":"left":"center")}function Bb(a){var b=a.options,c=b.navigator,d=c.enabled,b=b.scrollbar,e=b.enabled,f=d?c.height:0,g=e?b.height:0;this.handles=[],this.scrollbarButtons=[],this.elementsToDestroy=[],this.chart=a,this.setBaseSeries(),this.height=f,this.scrollbarHeight=g,this.scrollbarEnabled=e,this.navigatorEnabled=d,this.navigatorOptions=c,this.scrollbarOptions=b,this.outlineHeight=f+g,this.init()}function Cb(a){this.init(a)}var r,D=document,S=window,X=Math,u=X.round,V=X.floor,Xa=X.ceil,v=X.max,A=X.min,P=X.abs,ea=X.cos,ja=X.sin,ta=X.PI,Oa=ta/180,Fa=navigator.userAgent,Rb=S.opera,Ja=/msie/i.test(Fa)&&!Rb,nb=D.documentMode===8,Db=/AppleWebKit/.test(Fa),bb=/Firefox/.test(Fa),eb=/(Mobile|Android|Windows Phone)/.test(Fa),Ga="http://www.w3.org/2000/svg",da=!!D.createElementNS&&!!D.createElementNS(Ga,"svg").createSVGRect,Xb=bb&&parseInt(Fa.split("Firefox/")[1],10)<4,ka=!da&&!Ja&&!!D.createElement("canvas").getContext,Ya,cb,Sb={},Eb=0,jb,F,wa,Ea,Fb,H,oa,pa=function(){return r},ba=[],fb=0,Va="div",$="none",Yb=/^[0-9]+$/,Zb="stroke-width",kb,Na,xb,yb,zb,Wa,lb,mb,Mb,Nb,Ab,Ob,Pb,B={},Q,T,W,la,hb,fa,Ub,Ib,ua,Za,rb,Ba,L,Ca,va,ib,sb,E,tb;S.Highcharts?oa(16,!0):Q=S.Highcharts={},wa=function(a,b,c){if(!t(b)||isNaN(b))return"Invalid date";var a=q(a,"%Y-%m-%d %H:%M:%S"),d=new Date(b-Na),e,f=d[yb](),g=d[zb](),h=d[Wa](),i=d[lb](),j=d[mb](),k=F.lang,l=k.weekdays,d=s({a:l[g].substr(0,3),A:l[g],d:Sa(h),e:h,b:k.shortMonths[i],B:k.months[i],m:Sa(i+1),y:j.toString().substr(2,2),Y:j,H:Sa(f),I:Sa(f%12||12),l:f%12||12,M:Sa(d[xb]()),p:f<12?"AM":"PM",P:f<12?"am":"pm",S:Sa(d.getSeconds()),L:Sa(u(b%1e3),3)},Q.dateFormats);for(e in d)for(;a.indexOf("%"+e)!==-1;)a=a.replace("%"+e,typeof d[e]=="function"?d[e](b):d[e]);return c?a.substr(0,1).toUpperCase()+a.substr(1):a},oa=function(a,b){var c="Highcharts error #"+a+": www.highcharts.com/errors/"+a;if(b)throw c;S.console&&console.log(c)},H={millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5,month:26784e5,year:31556952e3},Fb={init:function(a,b,c){var b=b||"",d=a.shift,e=b.indexOf("C")>-1,f=e?7:3,g,b=b.split(" "),c=[].concat(c),h,i,j=function(a){for(g=a.length;g--;)a[g]==="M"&&a.splice(g+1,0,a[g+1],a[g+2],a[g+1],a[g+2])};if(e&&(j(b),j(c)),a.isArea&&(h=b.splice(b.length-6,6),i=c.splice(c.length-6,6)),d<=c.length/f&&b.length===c.length)for(;d--;)c=[].concat(c).splice(0,f).concat(c);if(a.shift=0,b.length)for(a=c.length;b.length<a;)d=[].concat(b).splice(b.length-f,f),e&&(d[f-6]=d[f-2],d[f-5]=d[f-1]),b=b.concat(d);return h&&(b=b.concat(h),c=c.concat(i)),[b,c]},step:function(a,b,c,d){var e=[],f=a.length;if(c===1)e=d;else if(f===b.length&&c<1)for(;f--;)d=parseFloat(a[f]),e[f]=isNaN(d)?a[f]:c*parseFloat(b[f]-d)+d;else e=b;return e}},function(a){S.HighchartsAdapter=S.HighchartsAdapter||a&&{init:function(b){var c=a.fx,d=c.step,e,f=a.Tween,g=f&&f.propHooks;e=a.cssHooks.opacity,a.extend(a.easing,{easeOutQuad:function(a,b,c,d,e){return-d*(b/=e)*(b-2)+c}}),a.each(["cur","_default","width","height","opacity"],function(a,b){var e=d,k;b==="cur"?e=c.prototype:b==="_default"&&f&&(e=g[b],b="set"),(k=e[b])&&(e[b]=function(c){var d,c=a?c:this;if(c.prop!=="align")return d=c.elem,d.attr?d.attr(c.prop,b==="cur"?r:c.now):k.apply(this,arguments)})}),M(e,"get",function(a,b,c){return b.attr?b.opacity||0:a.call(this,b,c)}),e=function(a){var c=a.elem,d;a.started||(d=b.init(c,c.d,c.toD),a.start=d[0],a.end=d[1],a.started=!0),c.attr("d",b.step(a.start,a.end,a.pos,c.toD))},f?g.d={set:e}:d.d=e,this.each=Array.prototype.forEach?function(a,b){return Array.prototype.forEach.call(a,b)}:function(a,b){for(var d=a.length,c=0;c<d;c++)if(b.call(a[c],a[c],c,a)===!1)return c},a.fn.highcharts=function(){var a="Chart",b=arguments,c,d;return this[0]&&(Qa(b[0])&&(a=b[0],b=Array.prototype.slice.call(b,1)),c=b[0],c!==r&&(c.chart=c.chart||{},c.chart.renderTo=this[0],new Q[a](c,b[1]),d=this),c===r&&(d=ba[Y(this[0],"data-highcharts-chart")])),d}},getScript:a.getScript,inArray:a.inArray,adapterRun:function(b,c){return a(b)[c]()},grep:a.grep,map:function(a,c){for(var d=[],e=0,f=a.length;e<f;e++)d[e]=c.call(a[e],a[e],e,a);return d},offset:function(b){return a(b).offset()},addEvent:function(b,c,d){a(b).bind(c,d)},removeEvent:function(b,c,d){var e=D.removeEventListener?"removeEventListener":"detachEvent";D[e]&&b&&!b[e]&&(b[e]=function(){}),a(b).unbind(c,d)},fireEvent:function(b,c,d,e){var f=a.Event(c),g="detached"+c,h;!Ja&&d&&(delete d.layerX,delete d.layerY,delete d.returnValue),s(f,d),b[c]&&(b[g]=b[c],b[c]=null),a.each(["preventDefault","stopPropagation"],function(a,b){var c=f[b];f[b]=function(){try{c.call(f)}catch(a){b==="preventDefault"&&(h=!0)}}}),a(b).trigger(f),b[g]&&(b[c]=b[g],b[g]=null),e&&!f.isDefaultPrevented()&&!h&&e(f)},washMouseEvent:function(a){var c=a.originalEvent||a;return c.pageX===r&&(c.pageX=a.pageX,c.pageY=a.pageY),c},animate:function(b,c,d){var e=a(b);b.style||(b.style={}),c.d&&(b.toD=c.d,c.d=1),e.stop(),c.opacity!==r&&b.attr&&(c.opacity+="px"),e.animate(c,d)},stop:function(b){a(b).stop()}}}(S.jQuery),E=S.HighchartsAdapter,T=E||{},E&&E.init.call(E,Fb);var ob=T.adapterRun,$b=T.getScript,ya=T.inArray,p=T.each,pb=T.grep,ac=T.offset,za=T.map,z=T.addEvent,U=T.removeEvent,N=T.fireEvent,bc=T.washMouseEvent,qb=T.animate,gb=T.stop,T={enabled:!0,x:0,y:15,style:{color:"#606060",cursor:"default",fontSize:"11px"}};F={colors:"#7cb5ec,#434348,#90ed7d,#f7a35c,#8085e9,#f15c80,#e4d354,#8085e8,#8d4653,#91e8e1".split(","),symbols:["circle","diamond","square","triangle","triangle-down"],lang:{loading:"Loading...",months:"January,February,March,April,May,June,July,August,September,October,November,December".split(","),shortMonths:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),weekdays:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),decimalPoint:".",numericSymbols:"k,M,G,T,P,E".split(","),resetZoom:"Reset
 zoom",resetZoomTitle:"Reset zoom level 1:1",thousandsSep:","},global:{useUTC:!0,canvasToolsURL:"http://code.highcharts.com/stock/2.0.3/modules/canvas-tools.js",VMLRadialGradientURL:"http://code.highcharts.com/stock/2.0.3/gfx/vml-radial-gradient.png"},chart:{borderColor:"#4572A7",borderRadius:0,defaultSeriesType:"line",ignoreHiddenSeries:!0,spacing:[10,10,15,10],backgroundColor:"#FFFFFF",plotBorderColor:"#C0C0C0",resetZoomButton:{theme:{zIndex:20},position:{align:"right",x:-10,y:10}}},title:{text:"Chart title",align:"center",margin:15,style:{color:"#333333",fontSize:"18px"}},subtitle:{text:"",align:"center",style:{color:"#555555"}},plotOptions:{line:{allowPointSelect:!1,showCheckbox:!1,animation:{duration:1e3},events:{},lineWidth:2,marker:{lineWidth:0,radius:4,lineColor:"#FFFFFF",states:{hover:{enabled:!0,lineWidthPlus:1,radiusPlus:2},select:{fillColor:"#FFFFFF",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:x(T,{align:"center",enabled:!1,formatter:function(){return this.y===null?"":Ka(this.y,-1)},verticalAlign:"bottom",y:0}),cropThreshold:300,pointRange:0,states:{hover:{lineWidthPlus:1,marker:{},halo:{size:10,opacity:.25}},select:{marker:{}}},stickyTracking:!0,turboThreshold:1e3}},labels:{style:{position:"absolute",color:"#3E576F"}},legend:{enabled:!0,align:"center",layout:"horizontal",labelFormatter:function(){return this.name},borderColor:"#909090",borderRadius:0,navigation:{activeColor:"#274b6d",inactiveColor:"#CCC"},shadow:!1,itemStyle:{color:"#333333",fontSize:"12px",fontWeight:"bold"},itemHoverStyle:{color:"#000"},itemHiddenStyle:{color:"#CCC"},itemCheckboxStyle:{position:"absolute",width:"13px",height:"13px"},symbolPadding:5,verticalAlign:"bottom",x:0,y:0,title:{style:{fontWeight:"bold"}}},loading:{labelStyle:{fontWeight:"bold",position:"relative",top:"45%"},style:{position:"absolute",backgroundColor:"white",opacity:.5,textAlign:"center"}},tooltip:{enabled:!0,animation:da,backgroundColor:"rgba(249, 249, 249, .85)",borderWidth:1,borderRadius:3,dateTimeLabelFormats:{millisecond:"%A, %b %e, %H:%M:%S.%L",second:"%A, %b %e, %H:%M:%S",minute:"%A, %b %e, %H:%M",hour:"%A, %b %e, %H:%M",day:"%A, %b %e, %Y",week:"Week from %A, %b %e, %Y",month:"%B %Y",year:"%Y"},headerFormat:'<span style="font-size: 10px">{point.key}</span><br/>',pointFormat:'<span style="color:{series.color}">●</span> {series.name}: <b>{point.y}</b><br/>',shadow:!0,snap:eb?25:10,style:{color:"#333333",cursor:"default",fontSize:"12px",padding:"8px",whiteSpace:"nowrap"}},credits:{enabled:!0,text:"Highcharts.com",href:"http://www.highcharts.com",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#909090",fontSize:"9px"}}},W=F.plotOptions,E=W.line,Lb();var cc=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]?(?:\.[0-9]+)?)\s*\)/,dc=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,ec=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/,Ha=function(a){var b=[],c,d;return function(a){a&&a.stops?d=za(a.stops,function(a){return Ha(a[1])}):(c=cc.exec(a))?b=[G(c[1]),G(c[2]),G(c[3]),parseFloat(c[4],10)]:(c=dc.exec(a))?b=[G(c[1],16),G(c[2],16),G(c[3],16),1]:(c=ec.exec(a))&&(b=[G(c[1]),G(c[2]),G(c[3]),1])}(a),{get:function(c){var f;return d?(f=x(a),f.stops=[].concat(f.stops),p(d,function(a,b){f.stops[b]=[f.stops[b][0],a.get(c)]})):f=b&&!isNaN(b[0])?c==="rgb"?"rgb("+b[0]+","+b[1]+","+b[2]+")":c==="a"?b[3]:"rgba("+b.join(",")+")":a,f},brighten:function(a){if(d)p(d,function(b){b.brighten(a)});else if(ma(a)&&a!==0)for(var c=0;c<3;c++)b[c]+=G(a*255),b[c]<0&&(b[c]=0),b[c]>255&&(b[c]=255);return this},rgba:b,setOpacity:function(a){return b[3]=a,this}}};if(Z.prototype={opacity:1,textProps:"fontSize,fontWeight,fontFamily,color,lineHeight,width,textDecoration,textShadow,HcTextStroke".split(","),init:function(a,b){this.element=b==="span"?aa(b):D.createElementNS(Ga,b),this.renderer=a},animate:function(a,b,c){return b=q(b,Ea,!0),gb(this),b?(b=x(b,{}),c&&(b.complete=c),qb(this,a,b)):(this.attr(a),c&&c()),this},colorGradient:function(a,b,c){var d=this.renderer,e,f,g,h,i,j,k,l,m,n,o=[];if(a.linearGradient?f="linearGradient":a.radialGradient&&(f="radialGradient"),f){g=a[f],h=d.gradients,j=a.stops,m=c.radialReference,Ra(g)&&(a[f]=g={x1:g[0],y1:g[1],x2:g[2],y2:g[3],gradientUnits:"userSpaceOnUse"}),f==="radialGradient"&&m&&!t(g.gradientUnits)&&(g=x(g,{cx:m[0]-m[2]/2+g.cx*m[2],cy:m[1]-m[2]/2+g.cy*m[2],r:g.r*m[2],gradientUnits:"userSpaceOnUse"}));for(n in g)n!=="id"&&o.push(n,g[n]);for(n in j)o.push(j[n]);o=o.join(","),h[o]?a=h[o].attr("id"):(g.id=a="highcharts-"+Eb++,h[o]=i=d.createElement(f).attr(g).add(d.defs),i.stops=[],p(j,function(a){a[1].indexOf("rgba")===0?(e=Ha(a[1]),k=e.get("rgb"),l=e.get("a")):(k=a[1],l=1),a=d.createElement("stop").attr({offset:a[0],"stop-color":k,"stop-opacity":l}).add(i),i.stops.push(a)})),c.setAttribute(b,"url("+d.url+"#"+a+")")}},attr:function(a,b){var c,d,e=this.element,f,g=this,h;if(typeof a=="string"&&b!==r&&(c=a,a={},a[c]=b),typeof a=="string")g=(this[a+"Getter"]||this._defaultGetter).call(this,a,e);else{for(c in a)d=a[c],h=!1,this.symbolName&&/^(x|y|width|height|r|start|end|innerR|anchorX|anchorY)/.test(c)&&(f||(this.symbolAttr(a),f=!0),h=!0),this.rotation&&(c==="x"||c==="y")&&(this.doTransform=!0),h||(this[c+"Setter"]||this._defaultSetter).call(this,d,c,e),this.shadows&&/^(width|height|visibility|x|y|d|transform|cx|cy|r)$/.test(c)&&this.updateShadows(c,d);this.doTransform&&(this.updateTransform(),this.doTransform=!1)}return g},updateShadows:function(a,b){for(var c=this.shadows,d=c.length;d--;)c[d].setAttribute(a,a==="height"?v(b-(c[d].cutHeight||0),0):a==="d"?this.d:b)},addClass:function(a){var b=this.element,c=Y(b,"class")||"";return c.indexOf(a)===-1&&Y(b,"class",c+" "+a),this},symbolAttr:function(a){var b=this;p("x,y,r,start,end,width,height,innerR,anchorX,anchorY".split(","),function(c){b[c]=q(a[c],b[c])}),b.attr({d:b.renderer.symbols[b.symbolName](b.x,b.y,b.width,b.height,b)})},clip:function(a){return this.attr("clip-path",a?"url("+this.renderer.url+"#"+a.id+")":$)},crisp:function(a){var b,c={},d,e=a.strokeWidth||this.strokeWidth||0;d=u(e)%2/2,a.x=V(a.x||this.x||0)+d,a.y=V(a.y||this.y||0)+d,a.width=V((a.width||this.width||0)-2*d),a.height=V((a.height||this.height||0)-2*d),a.strokeWidth=e;for(b in a)this[b]!==a[b]&&(this[b]=c[b]=a[b]);return c},css:function(a){var b=this.styles,c={},d=this.element,e,f,g="";if(e=!b,a&&a.color&&(a.fill=a.color),b)for(f in a)a[f]!==b[f]&&(c[f]=a[f],e=!0);if(e){if(e=this.textWidth=a&&a.width&&d.nodeName.toLowerCase()==="text"&&G(a.width),b&&(a=s(b,c)),this.styles=a,e&&(ka||!da&&this.renderer.forExport)&&delete a.width,Ja&&!da)K(this.element,a);else{b=function(a,b){return"-"+b.toLowerCase()};for(f in a)g+=f.replace(/([A-Z])/g,b)+":"+a[f]+";";Y(d,"style",g)}e&&this.added&&this.renderer.buildText(this)}return this},on:function(a,b){var c=this,d=c.element;return cb&&a==="click"?(d.ontouchstart=function(a){c.touchEventFired=Date.now(),a.preventDefault(),b.call(d,a)},d.onclick=function(a){(Fa.indexOf("Android")===-1||Date.now()-(c.touchEventFired||0)>1100)&&b.call(d,a)}):d["on"+a]=b,this},setRadialReference:function(a){return this.element.radialReference=a,this},translate:function(a,b){return this.attr({translateX:a,translateY:b})},invert:function(){return this.inverted=!0,this.updateTransform(),this},updateTransform:function(){var a=this.translateX||0,b=this.translateY||0,c=this.scaleX,d=this.scaleY,e=this.inverted,f=this.rotation,g=this.element;e&&(a+=this.attr("width"),b+=this.attr("height")),a=["translate("+a+","+b+")"],e?a.push("rotate(90) scale(-1,1)"):f&&a.push("rotate("+f+" "+(g.getAttribute("x")||0)+" "+(g.getAttribute("y")||0)+")"),(t(c)||t(d))&&a.push("scale("+q(c,1)+" "+q(d,1)+")"),a.length&&g.setAttribute("transform",a.join(" "))},toFront:function(){var a=this.element;return a.parentNode.appendChild(a),this},align:function(a,b,c){var d,e,f,g,h={};return e=this.renderer,f=e.alignedObjects,a?(this.alignOptions=a,this.alignByTranslate=b,!c||Qa(c))&&(this.alignTo=d=c||"renderer",sa(f,this),f.push(this),c=null):(a=this.alignOptions,b=this.alignByTranslate,d=this.alignTo),c=q(c,e[d],e),d=a.align,e=a.verticalAlign,f=(c.x||0)+(a.x||0),g=(c.y||0)+(a.y||0),(d==="right"||d==="center")&&(f+=(c.width-(a.width||0))/{right:1,center:2}[d]),h[b?"translateX":"x"]=u(f),(e==="bottom"||e==="middle")&&(g+=(c.height-(a.height||0))/({bottom:1,middle:2}[e]||1)),h[b?"translateY":"y"]=u(g),this[this.placed?"animate":"attr"](h),this.placed=!0,this.alignAttr=h,this},getBBox:function(){var a=this.bBox,b=this.renderer,c,d,e=this.rotation,f,g,h;if(c=this.element,f=this.styles,g=e*Oa,d=this.textStr,(d===""||Yb.test(d))&&(h="num."+d.toString().length+(f?"|"+f.fontSize+"|"+f.fontFamily:"")),h&&(a=b.cache[h]),!a){if(c.namespaceURI===Ga||b.forExport){try{a=c.getBBox?s({},c.getBBox()):{width:c.offsetWidth,height:c.offsetHeight}}catch(i){}(!a||a.width<0)&&(a={width:0,height:0})}else a=this.htmlGetBBox();b.isSVG&&(c=a.width,d=a.height,Ja&&f&&f.fontSize==="11px"&&d.toPrecision(3)==="16.9"&&(a.height=d=14),e&&(a.width=P(d*ja(g))+P(c*ea(g)),a.height=P(d*ea(g))+P(c*ja(g)))),this.bBox=a,h&&(b.cache[h]=a)}return a},show:function(a){return a&&this.element.namespaceURI===Ga?(this.element.removeAttribute("visibility"),this):this.attr({visibility:a?"inherit":"visible"})},hide:function(){return this.attr({visibility:"hidden"})},fadeOut:function(a){var b=this;b.animate({opacity:0},{duration:a||150,complete:function(){b.hide()}})},add:function(a){var b=this.renderer,c=a||b,d=c.element||b.box,e=this.element,f=this.zIndex,g,h;if(a&&(this.parentGroup=a),this.parentInverted=a&&a.inverted,this.textStr!==void 0&&b.buildText(this),f&&(c.handleZ=!0,f=G(f)),c.handleZ)for(a=d.childNodes,g=0;g<a.length;g++)if(b=a[g],c=Y(b,"zIndex"),b!==e&&(G(c)>f||!t(f)&&t(c))){d.insertBefore(e,b),h=!0;break}return h||d.appendChild(e),this.added=!0,this.onAdd&&this.onAdd(),this},safeRemoveChild:function(a){var
 b=a.parentNode;b&&b.removeChild(a)},destroy:function(){var a=this,b=a.element||{},c=a.shadows,d=a.renderer.isSVG&&b.nodeName==="SPAN"&&a.parentGroup,e,f;if(b.onclick=b.onmouseout=b.onmouseover=b.onmousemove=b.point=null,gb(a),a.clipPath&&(a.clipPath=a.clipPath.destroy()),a.stops){for(f=0;f<a.stops.length;f++)a.stops[f]=a.stops[f].destroy();a.stops=null}for(a.safeRemoveChild(b),c&&p(c,function(b){a.safeRemoveChild(b)});d&&d.div&&d.div.childNodes.length===0;)b=d.parentGroup,a.safeRemoveChild(d.div),delete d.div,d=b;a.alignTo&&sa(a.renderer.alignedObjects,a);for(e in a)delete a[e];return null},shadow:function(a,b,c){var d=[],e,f,g=this.element,h,i,j,k;if(a){for(i=q(a.width,3),j=(a.opacity||.15)/i,k=this.parentInverted?"(-1,-1)":"("+q(a.offsetX,1)+", "+q(a.offsetY,1)+")",e=1;e<=i;e++)f=g.cloneNode(0),h=i*2+1-2*e,Y(f,{isShadow:"true",stroke:a.color||"black","stroke-opacity":j*e,"stroke-width":h,transform:"translate"+k,fill:$}),c&&(Y(f,"height",v(Y(f,"height")-h,0)),f.cutHeight=h),b?b.element.appendChild(f):g.parentNode.insertBefore(f,g),d.push(f);this.shadows=d}return this},xGetter:function(a){return this.element.nodeName==="circle"&&(a={x:"cx",y:"cy"}[a]||a),this._defaultGetter(a)},_defaultGetter:function(a){return a=q(this[a],this.element?this.element.getAttribute(a):null,0),/^[\-0-9\.]+$/.test(a)&&(a=parseFloat(a)),a},dSetter:function(a,b,c){a&&a.join&&(a=a.join(" ")),/(NaN| {2}|^$)/.test(a)&&(a="M 0 0"),c.setAttribute(b,a),this[b]=a},dashstyleSetter:function(a){var b;if(a=a&&a.toLowerCase()){for(a=a.replace("shortdashdotdot","3,1,1,1,1,1,").replace("shortdashdot","3,1,1,1").replace("shortdot","1,1,").replace("shortdash","3,1,").replace("longdash","8,3,").replace(/dot/g,"1,3,").replace("dash","4,3,").replace(/,$/,"").replace("solid",1).split(","),b=a.length;b--;)a[b]=G(a[b])*this["stroke-width"];a=a.join(","),this.element.setAttribute("stroke-dasharray",a)}},alignSetter:function(a){this.element.setAttribute("text-anchor",{left:"start",center:"middle",right:"end"}[a])},opacitySetter:function(a,b,c){this[b]=a,c.setAttribute(b,a)},titleSetter:function(a){var b=this.element.getElementsByTagName("title")[0];b||(b=D.createElementNS(Ga,"title"),this.element.appendChild(b)),b.textContent=a},textSetter:function(a){a!==this.textStr&&(delete this.bBox,this.textStr=a,this.added&&this.renderer.buildText(this))},fillSetter:function(a,b,c){typeof a=="string"?c.setAttribute(b,a):a&&this.colorGradient(a,b,c)},zIndexSetter:function(a,b,c){c.setAttribute(b,a),this[b]=a},_defaultSetter:function(a,b,c){c.setAttribute(b,a)}},Z.prototype.yGetter=Z.prototype.xGetter,Z.prototype.translateXSetter=Z.prototype.translateYSetter=Z.prototype.rotationSetter=Z.prototype.verticalAlignSetter=Z.prototype.scaleXSetter=Z.prototype.scaleYSetter=function(a,b){this[b]=a,this.doTransform=!0},Z.prototype["stroke-widthSetter"]=Z.prototype.strokeSetter=function(a,b,c){this[b]=a,this.stroke&&this["stroke-width"]?(this.strokeWidth=this["stroke-width"],Z.prototype.fillSetter.call(this,this.stroke,"stroke",c),c.setAttribute("stroke-width",this["stroke-width"]),this.hasStroke=!0):b==="stroke-width"&&a===0&&this.hasStroke&&(c.removeAttribute("stroke"),this.hasStroke=!1)},la=function(){this.init.apply(this,arguments)},la.prototype={Element:Z,init:function(a,b,c,d,e){var f=location,g,d=this.createElement("svg").attr({version:"1.1"}).css(this.getStyle(d)),h;g=d.element,a.appendChild(g),a.innerHTML.indexOf("xmlns")===-1&&Y(g,"xmlns",Ga),this.isSVG=!0,this.box=g,this.boxWrapper=d,this.alignedObjects=[],this.url=(bb||Db)&&D.getElementsByTagName("base").length?f.href.replace(/#.*?$/,"").replace(/([\('\)])/g,"\\$1").replace(/ /g,"%20"):"",this.createElement("desc").add().element.appendChild(D.createTextNode("Created with Highstock 2.0.3")),this.defs=this.createElement("defs").add(),this.forExport=e,this.gradients={},this.cache={},this.setSize(b,c,!1),bb&&a.getBoundingClientRect&&(this.subPixelFix=b=function(){K(a,{left:0,top:0}),h=a.getBoundingClientRect(),K(a,{left:Xa(h.left)-h.left+"px",top:Xa(h.top)-h.top+"px"})},b(),z(S,"resize",b))},getStyle:function(a){return this.style=s({fontFamily:'"Lucida Grande", "Lucida Sans Unicode", Arial, Helvetica, sans-serif',fontSize:"12px"},a)},isHidden:function(){return!this.boxWrapper.getBBox().width},destroy:function(){var a=this.defs;return this.box=null,this.boxWrapper=this.boxWrapper.destroy(),Ma(this.gradients||{}),this.gradients=null,a&&(this.defs=a.destroy()),this.subPixelFix&&U(S,"resize",this.subPixelFix),this.alignedObjects=null},createElement:function(a){var b=new this.Element;return b.init(this,a),b},draw:function(){},buildText:function(a){for(var b=a.element,c=this,d=c.forExport,e=q(a.textStr,"").toString(),f=e.indexOf("<")!==-1,g=b.childNodes,h,i,j=Y(b,"x"),k=a.styles,l=a.textWidth,m=k&&k.lineHeight,n=k&&k.HcTextStroke,o=g.length,y=function(a){return m?G(m):c.fontMetrics(/(px|em)$/.test(a&&a.style.fontSize)?a.style.fontSize:k&&k.fontSize||c.style.fontSize||12,a).h};o--;)b.removeChild(g[o]);!f&&!n&&e.indexOf(" ")===-1?b.appendChild(D.createTextNode(e)):(h=/<.*style="([^"]+)".*>/,i=/<.*href="(http[^"]+)".*>/,l&&!a.added&&this.box.appendChild(b),e=f?e.replace(/<(b|strong)>/g,'<span style="font-weight:bold">').replace(/<(i|em)>/g,'<span style="font-style:italic">').replace(/<a/g,"<span").replace(/<\/(b|strong|i|em|a)>/g,"</span>").split(/<br.*?>/g):[e],e[e.length-1]===""&&e.pop(),p(e,function(e,f){var g,m=0,e=e.replace(/<span/g,"|||<span").replace(/<\/span>/g,"</span>|||");g=e.split("|||"),p(g,function(e){var n,o,I;if((e!==""||g.length===1)&&(n={},o=D.createElementNS(Ga,"tspan"),h.test(e)&&(I=e.match(h)[1].replace(/(;| |^)color([ :])/,"$1fill$2"),Y(o,"style",I)),i.test(e)&&!d&&(Y(o,"onclick",'location.href="'+e.match(i)[1]+'"'),K(o,{cursor:"pointer"})),e=(e.replace(/<(.|\n)*?>/g,"")||" ").replace(/&lt;/g,"<").replace(/&gt;/g,">"),e!==" ")){if(o.appendChild(D.createTextNode(e)),m?n.dx=0:f&&j!==null&&(n.x=j),Y(o,n),b.appendChild(o),!m&&f&&(!da&&d&&K(o,{display:"block"}),Y(o,"dy",y(o))),l)for(var e=e.replace(/([^\^])-/g,"$1- ").split(" "),n=g.length>1||e.length>1&&k.whiteSpace!=="nowrap",q,p,r=k.HcHeight,u=[],t=y(o),Tb=1;n&&(e.length||u.length);)delete a.bBox,q=a.getBBox(),p=q.width,!da&&c.forExport&&(p=c.measureSpanWidth(o.firstChild.data,a.styles)),q=p>l,!q||e.length===1?(e=u,u=[],e.length&&(Tb++,r&&Tb*t>r?(e=["..."],a.attr("title",a.textStr)):(o=D.createElementNS(Ga,"tspan"),Y(o,{dy:t,x:j}),I&&Y(o,"style",I),b.appendChild(o))),p>l&&(l=p)):(o.removeChild(o.firstChild),u.unshift(e.pop())),e.length&&o.appendChild(D.createTextNode(e.join(" ").replace(/- /g,"-")));m++}})}))},button:function(a,b,c,d,e,f,g,h,i){var j=this.label(a,b,c,i,null,null,null,null,"button"),k=0,l,m,n,o,y,I,a={x1:0,y1:0,x2:0,y2:1},e=x({"stroke-width":1,stroke:"#CCCCCC",fill:{linearGradient:a,stops:[[0,"#FEFEFE"],[1,"#F6F6F6"]]},r:2,padding:5,style:{color:"black"}},e);return n=e.style,delete e.style,f=x(e,{stroke:"#68A",fill:{linearGradient:a,stops:[[0,"#FFF"],[1,"#ACF"]]}},f),o=f.style,delete f.style,g=x(e,{stroke:"#68A",fill:{linearGradient:a,stops:[[0,"#9BD"],[1,"#CDF"]]}},g),y=g.style,delete g.style,h=x(e,{style:{color:"#CCC"}},h),I=h.style,delete h.style,z(j.element,Ja?"mouseover":"mouseenter",function(){k!==3&&j.attr(f).css(o)}),z(j.element,Ja?"mouseout":"mouseleave",function(){k!==3&&(l=[e,f,g][k],m=[n,o,y][k],j.attr(l).css(m))}),j.setState=function(a){(j.state=k=a)?a===2?j.attr(g).css(y):a===3&&j.attr(h).css(I):j.attr(e).css(n)},j.on("click",function(){k!==3&&d.call(j)}).attr(e).css(s({cursor:"default"},n))},crispLine:function(a,b){return a[1]===a[4]&&(a[1]=a[4]=u(a[1])-b%2/2),a[2]===a[5]&&(a[2]=a[5]=u(a[2])+b%2/2),a},path:function(a){var b={fill:$};return Ra(a)?b.d=a:ga(a)&&s(b,a),this.createElement("path").attr(b)},circle:function(a,b,c){return a=ga(a)?a:{x:a,y:b,r:c},b=this.createElement("circle"),b.xSetter=function(a){this.element.setAttribute("cx",a)},b.ySetter=function(a){this.element.setAttribute("cy",a)},b.attr(a)},arc:function(a,b,c,d,e,f){return ga(a)&&(b=a.y,c=a.r,d=a.innerR,e=a.start,f=a.end,a=a.x),a=this.symbol("arc",a||0,b||0,c||0,c||0,{innerR:d||0,start:e||0,end:f||0}),a.r=c,a},rect:function(a,b,c,d,e,f){var e=ga(a)?a.r:e,g=this.createElement("rect"),a=ga(a)?a:a===r?{}:{x:a,y:b,width:v(c,0),height:v(d,0)};return f!==r&&(a.strokeWidth=f,a=g.crisp(a)),e&&(a.r=e),g.rSetter=function(a){Y(this.element,{rx:a,ry:a})},g.attr(a)},setSize:function(a,b,c){var d=this.alignedObjects,e=d.length;for(this.width=a,this.height=b,this.boxWrapper[q(c,!0)?"animate":"attr"]({width:a,height:b});e--;)d[e].align()},g:function(a){var b=this.createElement("g");return t(a)?b.attr({"class":"highcharts-"+a}):b},image:function(a,b,c,d,e){var f={preserveAspectRatio:$};return arguments.length>1&&s(f,{x:b,y:c,width:d,height:e}),f=this.createElement("image").attr(f),f.element.setAttributeNS?f.element.setAttributeNS("http://www.w3.org/1999/xlink","href",a):f.element.setAttribute("hc-svg-href",a),f},symbol:function(a,b,c,d,e,f){var g,h=this.symbols[a],h=h&&h(u(b),u(c),d,e,f),i=/^url\((.*?)\)$/,j,k;return h?(g=this.path(h),s(g,{symbolName:a,x:b,y:c,width:d,height:e}),f&&s(g,f)):i.test(a)&&(k=function(a,b){a.element&&(a.attr({width:b[0],height:b[1]}),a.alignByTranslate||a.translate(u((d-b[0])/2),u((e-b[1])/2)))},j=a.match(i)[1],a=Sb[j],g=this.image(j).attr({x:b,y:c}),g.isImg=!0,a?k(g,a):(g.attr({width:0,height:0}),aa("img",{onload:function(){k(g,Sb[j]=[this.width,this.height])},src:j}))),g},symbols:{circle:function(a,b,c,d){var e=.166*c;return["M",a+c/2,b,"C",a+c+e,b,a+c+e,b+d,a+c/2,b+d,"C",a-e,b+d,a-e,b,a+c/2,b,"Z"]},square:function(a,b,c,d){return["M",a,b,"L",a+c,b,a+c,b+d,a,b+d,"Z"]},triangle:function(a,b,c,d){return["M",a+c/2,b,"L",a+c,b+d,a,b+d,"Z"]},"triangle-down":function(a,b,c,d){return["M",a,b,"L",a+c,b,a+c/2,b+d,"Z"]},diamond:function(a,b,c,d){return["M",a+c/2,b,"L",a+c,b+d/2,a+c/2,b+d,a,b+d/2,"Z"]},arc:function(a,b,c,d,e){var f=e.start,c=e.r||c||d,g=e.end-.001,d=e.innerR,h=e.open,i=ea(f),j=ja(f),k=ea(g),g=ja(g),e=e.end-f<ta?0:1;return["M",a+c*i,b+c*j,"A",c,c
,0,e,1,a+c*k,b+c*g,h?"M":"L",a+d*k,b+d*g,"A",d,d,0,e,0,a+d*i,b+d*j,h?"":"Z"]},callout:function(a,b,c,d,e){var f=A(e&&e.r||0,c,d),g=f+6,h=e&&e.anchorX,i=e&&e.anchorY,e=u(e.strokeWidth||0)%2/2;return a+=e,b+=e,e=["M",a+f,b,"L",a+c-f,b,"C",a+c,b,a+c,b,a+c,b+f,"L",a+c,b+d-f,"C",a+c,b+d,a+c,b+d,a+c-f,b+d,"L",a+f,b+d,"C",a,b+d,a,b+d,a,b+d-f,"L",a,b+f,"C",a,b,a,b,a+f,b],h&&h>c&&i>b+g&&i<b+d-g?e.splice(13,3,"L",a+c,i-6,a+c+6,i,a+c,i+6,a+c,b+d-f):h&&h<0&&i>b+g&&i<b+d-g?e.splice(33,3,"L",a,i+6,a-6,i,a,i-6,a,b+f):i&&i>d&&h>a+g&&h<a+c-g?e.splice(23,3,"L",h+6,b+d,h,b+d+6,h-6,b+d,a+f,b+d):i&&i<0&&h>a+g&&h<a+c-g&&e.splice(3,3,"L",h-6,b,h,b-6,h+6,b,c-f,b),e}},clipRect:function(a,b,c,d){var e="highcharts-"+Eb++,f=this.createElement("clipPath").attr({id:e}).add(this.defs),a=this.rect(a,b,c,d,0).add(f);return a.id=e,a.clipPath=f,a},text:function(a,b,c,d){var e=ka||!da&&this.forExport,f={};return d&&!this.forExport?this.html(a,b,c):(f.x=Math.round(b||0),c&&(f.y=Math.round(c)),(a||a===0)&&(f.text=a),a=this.createElement("text").attr(f),e&&a.css({position:"absolute"}),d||(a.xSetter=function(a,b,c){for(var d=c.getElementsByTagName("tspan"),e,f=c.getAttribute(b),m=0;m<d.length;m++)e=d[m],e.getAttribute(b)===f&&e.setAttribute(b,a);c.setAttribute(b,a)}),a)},fontMetrics:function(a,b){a=a||this.style.fontSize,b&&S.getComputedStyle&&(b=b.element||b,a=S.getComputedStyle(b,"").fontSize);var a=/px/.test(a)?G(a):/em/.test(a)?parseFloat(a)*12:12,c=a<24?a+4:u(a*1.2),d=u(c*.8);return{h:c,b:d,f:a}},label:function(a,b,c,d,e,f,g,h,i){function j(){var a,b;a=o.element.style,I=(v===void 0||Gb===void 0||n.styles.textAlign)&&o.textStr&&o.getBBox(),n.width=(v||I.width||0)+2*w+db,n.height=(Gb||I.height||0)+2*w,R=w+m.fontMetrics(a&&a.fontSize,o).b,z&&(y||(a=u(-q*w),b=h?-R:0,n.box=y=d?m.symbol(d,a,b,n.width,n.height,C):m.rect(a,b,n.width,n.height,0,C[Zb]),y.attr("fill",$).add(n)),y.isImg||y.attr(s({width:u(n.width),height:u(n.height)},C)),C=null)}function k(){var a=n.styles,a=a&&a.textAlign,b=db+w*(1-q),c;c=h?0:R,t(v)&&I&&(a==="center"||a==="right")&&(b+={center:.5,right:1}[a]*(v-I.width)),(b!==o.x||c!==o.y)&&(o.attr("x",b),c!==r&&o.attr("y",c)),o.x=b,o.y=c}function l(a,b){y?y.attr(a,b):C[a]=b}var m=this,n=m.g(i),o=m.text("",0,0,g).attr({zIndex:1}),y,I,q=0,w=3,db=0,v,Gb,O,Hb,A=0,C={},R,z,D;return n.onAdd=function(){o.add(n),n.attr({text:a||"",x:b,y:c}),y&&t(e)&&n.attr({anchorX:e,anchorY:f})},n.widthSetter=function(a){v=a},n.heightSetter=function(a){Gb=a},n.paddingSetter=function(a){t(a)&&a!==w&&(w=a,k())},n.paddingLeftSetter=function(a){t(a)&&a!==db&&(db=a,k())},n.alignSetter=function(a){q={left:0,center:.5,right:1}[a]},n.textSetter=function(a){a!==r&&o.textSetter(a),j(),k()},n["stroke-widthSetter"]=function(a,b){a&&(z=!0),A=a%2/2,l(b,a)},n.strokeSetter=n.fillSetter=n.rSetter=function(a,b){b==="fill"&&a&&(z=!0),l(b,a)},n.anchorXSetter=function(a,b){e=a,l(b,a+A-O)},n.anchorYSetter=function(a,b){f=a,l(b,a-Hb)},n.xSetter=function(a){n.x=a,q&&(a-=q*((v||I.width)+w)),O=u(a),n.attr("translateX",O)},n.ySetter=function(a){Hb=n.y=u(a),n.attr("translateY",Hb)},D=n.css,s(n,{css:function(a){if(a){var b={},a=x(a);p(n.textProps,function(c){a[c]!==r&&(b[c]=a[c],delete a[c])}),o.css(b)}return D.call(n,a)},getBBox:function(){return{width:I.width+2*w,height:I.height+2*w,x:I.x-w,y:I.y-w}},shadow:function(a){return y&&y.shadow(a),n},destroy:function(){U(n.element,"mouseenter"),U(n.element,"mouseleave"),o&&(o=o.destroy()),y&&(y=y.destroy()),Z.prototype.destroy.call(n),n=m=j=k=l=null}})}},Ya=la,s(Z.prototype,{htmlCss:function(a){var b=this.element;return(b=a&&b.tagName==="SPAN"&&a.width)&&(delete a.width,this.textWidth=b,this.updateTransform()),this.styles=s(this.styles,a),K(this.element,a),this},htmlGetBBox:function(){var a=this.element,b=this.bBox;return b||(a.nodeName==="text"&&(a.style.position="absolute"),b=this.bBox={x:a.offsetLeft,y:a.offsetTop,width:a.offsetWidth,height:a.offsetHeight}),b},htmlUpdateTransform:function(){if(this.added){var a=this.renderer,b=this.element,c=this.translateX||0,d=this.translateY||0,e=this.x||0,f=this.y||0,g=this.textAlign||"left",h={left:0,center:.5,right:1}[g],i=this.shadows;if(K(b,{marginLeft:c,marginTop:d}),i&&p(i,function(a){K(a,{marginLeft:c+1,marginTop:d+1})}),this.inverted&&p(b.childNodes,function(c){a.invertChild(c,b)}),b.tagName==="SPAN"){var j=this.rotation,k,l=G(this.textWidth),m=[j,g,b.innerHTML,this.textWidth].join(",");m!==this.cTT&&(k=a.fontMetrics(b.style.fontSize).b,t(j)&&this.setSpanRotation(j,h,k),i=q(this.elemWidth,b.offsetWidth),i>l&&/[ \-]/.test(b.textContent||b.innerText)&&(K(b,{width:l+"px",display:"block",whiteSpace:"normal"}),i=l),this.getSpanCorrection(i,k,h,j,g)),K(b,{left:e+(this.xCorr||0)+"px",top:f+(this.yCorr||0)+"px"}),Db&&(k=b.offsetHeight),this.cTT=m}}else this.alignOnAdd=!0},setSpanRotation:function(a,b,c){var d={},e=Ja?"-ms-transform":Db?"-webkit-transform":bb?"MozTransform":Rb?"-o-transform":"";d[e]=d.transform="rotate("+a+"deg)",d[e+(bb?"Origin":"-origin")]=d.transformOrigin=b*100+"% "+c+"px",K(this.element,d)},getSpanCorrection:function(a,b,c){this.xCorr=-a*c,this.yCorr=-b}}),s(la.prototype,{html:function(a,b,c){var d=this.createElement("span"),e=d.element,f=d.renderer;return d.textSetter=function(a){a!==e.innerHTML&&delete this.bBox,e.innerHTML=this.textStr=a},d.xSetter=d.ySetter=d.alignSetter=d.rotationSetter=function(a,b){b==="align"&&(b="textAlign"),d[b]=a,d.htmlUpdateTransform()},d.attr({text:a,x:u(b),y:u(c)}).css({position:"absolute",whiteSpace:"nowrap",fontFamily:this.style.fontFamily,fontSize:this.style.fontSize}),d.css=d.htmlCss,f.isSVG&&(d.add=function(a){var b,c=f.box.parentNode,j=[];if(this.parentGroup=a){if(b=a.div,!b){for(;a;)j.push(a),a=a.parentGroup;p(j.reverse(),function(a){var d;b=a.div=a.div||aa(Va,{className:Y(a.element,"class")},{position:"absolute",left:(a.translateX||0)+"px",top:(a.translateY||0)+"px"},b||c),d=b.style,s(a,{translateXSetter:function(b,c){d.left=b+"px",a[c]=b,a.doTransform=!0},translateYSetter:function(b,c){d.top=b+"px",a[c]=b,a.doTransform=!0},visibilitySetter:function(a,b){d[b]=a}})})}}else b=c;return b.appendChild(e),d.added=!0,d.alignOnAdd&&d.htmlUpdateTransform(),d}),d}}),da||ka||(fa={init:function(a,b){var c=["<",b,' filled="f" stroked="f"'],d=["position: ","absolute",";"],e=b===Va;(b==="shape"||e)&&d.push("left:0;top:0;width:1px;height:1px;"),d.push("visibility: ",e?"hidden":"visible"),c.push(' style="',d.join(""),'"/>'),b&&(c=e||b==="span"||b==="img"?c.join(""):a.prepVML(c),this.element=aa(c)),this.renderer=a},add:function(a){var b=this.renderer,c=this.element,d=b.box,d=a?a.element||a:d;return a&&a.inverted&&b.invertChild(c,d),d.appendChild(c),this.added=!0,this.alignOnAdd&&!this.deferUpdateTransform&&this.updateTransform(),this.onAdd&&this.onAdd(),this},updateTransform:Z.prototype.htmlUpdateTransform,setSpanRotation:function(){var a=this.rotation,b=ea(a*Oa),c=ja(a*Oa);K(this.element,{filter:a?["progid:DXImageTransform.Microsoft.Matrix(M11=",b,", M12=",-c,", M21=",c,", M22=",b,", sizingMethod='auto expand')"].join(""):$})},getSpanCorrection:function(a,b,c,d,e){var f=d?ea(d*Oa):1,g=d?ja(d*Oa):0,h=q(this.elemHeight,this.element.offsetHeight),i;this.xCorr=f<0&&-a,this.yCorr=g<0&&-h,i=f*g<0,this.xCorr+=g*b*(i?1-c:c),this.yCorr-=f*b*(d?i?c:1-c:1),e&&e!=="left"&&(this.xCorr-=a*c*(f<0?-1:1),d&&(this.yCorr-=h*c*(g<0?-1:1)),K(this.element,{textAlign:e}))},pathToVML:function(a){for(var b=a.length,c=[];b--;)ma(a[b])?c[b]=u(a[b]*10)-5:a[b]==="Z"?c[b]="x":(c[b]=a[b],a.isArc&&(a[b]==="wa"||a[b]==="at"))&&(c[b+5]===c[b+7]&&(c[b+7]+=a[b+7]>a[b+5]?1:-1),c[b+6]===c[b+8]&&(c[b+8]+=a[b+8]>a[b+6]?1:-1));return c.join(" ")||"x"},clip:function(a){var b=this,c;return a?(c=a.members,sa(c,b),c.push(b),b.destroyClip=function(){sa(c,b)},a=a.getCSS(b)):(b.destroyClip&&b.destroyClip(),a={clip:nb?"inherit":"rect(auto)"}),b.css(a)},css:Z.prototype.htmlCss,safeRemoveChild:function(a){a.parentNode&&Ua(a)},destroy:function(){return this.destroyClip&&this.destroyClip(),Z.prototype.destroy.apply(this)},on:function(a,b){return this.element["on"+a]=function(){var a=S.event;a.target=a.srcElement,b(a)},this},cutOffPath:function(a,b){var c,a=a.split(/[ ,]/);return c=a.length,(c===9||c===11)&&(a[c-4]=a[c-2]=G(a[c-2])-10*b),a.join(" ")},shadow:function(a,b,c){var d=[],e,f=this.element,g=this.renderer,h,i=f.style,j,k=f.path,l,m,n,o;if(k&&typeof k.value!="string"&&(k="x"),m=k,a){for(n=q(a.width,3),o=(a.opacity||.15)/n,e=1;e<=3;e++)l=n*2+1-2*e,c&&(m=this.cutOffPath(k.value,l+.5)),j=['<shape isShadow="true" strokeweight="',l,'" filled="false" path="',m,'" coordsize="10 10" style="',f.style.cssText,'" />'],h=aa(g.prepVML(j),null,{left:G(i.left)+q(a.offsetX,1),top:G(i.top)+q(a.offsetY,1)}),c&&(h.cutOff=l+1),j=['<stroke color="',a.color||"black",'" opacity="',o*e,'"/>'],aa(g.prepVML(j),null,null,h),b?b.element.appendChild(h):f.parentNode.insertBefore(h,f),d.push(h);this.shadows=d}return this},updateShadows:pa,setAttr:function(a,b){nb?this.element[a]=b:this.element.setAttribute(a,b)},classSetter:function(a){this.element.className=a},dashstyleSetter:function(a,b,c){(c.getElementsByTagName("stroke")[0]||aa(this.renderer.prepVML(["<stroke/>"]),null,null,c))[b]=a||"solid",this[b]=a},dSetter:function(a,b,c){var d=this.shadows,a=a||[];if(this.d=a.join&&a.join(" "),c.path=a=this.pathToVML(a),d)for(c=d.length;c--;)d[c].path=d[c].cutOff?this.cutOffPath(a,d[c].cutOff):a;this.setAttr(b,a)},fillSetter:function(a,b,c){var d=c.nodeName;d==="SPAN"?c.style.color=a:d!=="IMG"&&(c.filled=a!==$,this.setAttr("fillcolor",this.renderer.color(a,c,b,this)))},opacitySetter:pa,rotationSetter:function(a,b,c){c=c.style,this[b]=c[b]=a,c.left=-u(ja(a*Oa)+1)+"px",c.top=u(ea(a*Oa))+"px"},strokeSetter:function(a,b,c){this.setAttr("strokecolor",this.renderer.color(a,c,b))},"stroke-widthSetter":function(a,b,c){c.stroked=!!a,this[b]=a,ma(a)&&(a+="px"),this.setAttr("strokeweight",a)},titleSetter:function(a,b){this.setAttr(b,a)},visibilitySetter:function(a,b,c){a==="inherit"&&(a="visible"),this.shadows&&p(this.shadows,function(c){c.style[b]=a}),
c.nodeName==="DIV"&&(a=a==="hidden"?"-999em":0,nb||(c.style[b]=a?"visible":"hidden"),b="top"),c.style[b]=a},xSetter:function(a,b,c){this[b]=a,b==="x"?b="left":b==="y"&&(b="top"),this.updateClipping?(this[b]=a,this.updateClipping()):c.style[b]=a},zIndexSetter:function(a,b,c){c.style[b]=a}},Q.VMLElement=fa=ha(Z,fa),fa.prototype.ySetter=fa.prototype.widthSetter=fa.prototype.heightSetter=fa.prototype.xSetter,fa={Element:fa,isIE8:Fa.indexOf("MSIE 8.0")>-1,init:function(a,b,c,d){var e;if(this.alignedObjects=[],d=this.createElement(Va).css(s(this.getStyle(d),{position:"relative"})),e=d.element,a.appendChild(d.element),this.isVML=!0,this.box=e,this.boxWrapper=d,this.cache={},this.setSize(b,c,!1),!D.namespaces.hcv){D.namespaces.add("hcv","urn:schemas-microsoft-com:vml");try{D.createStyleSheet().cssText="hcv\\:fill, hcv\\:path, hcv\\:shape, hcv\\:stroke{ behavior:url(#default#VML); display: inline-block; } "}catch(f){D.styleSheets[0].cssText+="hcv\\:fill, hcv\\:path, hcv\\:shape, hcv\\:stroke{ behavior:url(#default#VML); display: inline-block; } "}}},isHidden:function(){return!this.box.offsetWidth},clipRect:function(a,b,c,d){var e=this.createElement(),f=ga(a);return s(e,{members:[],left:(f?a.x:a)+1,top:(f?a.y:b)+1,width:(f?a.width:c)-1,height:(f?a.height:d)-1,getCSS:function(a){var b=a.element,c=b.nodeName,a=a.inverted,d=this.top-(c==="shape"?b.offsetTop:0),e=this.left,b=e+this.width,f=d+this.height,d={clip:"rect("+u(a?e:d)+"px,"+u(a?f:b)+"px,"+u(a?b:f)+"px,"+u(a?d:e)+"px)"};return!a&&nb&&c==="DIV"&&s(d,{width:b+"px",height:f+"px"}),d},updateClipping:function(){p(e.members,function(a){a.element&&a.css(e.getCSS(a))})}})},color:function(a,b,c,d){var e=this,f,g=/^rgba/,h,i,j=$;if(a&&a.linearGradient?i="gradient":a&&a.radialGradient&&(i="pattern"),i){var k,l,m=a.linearGradient||a.radialGradient,n,o,y,I,q,w="",a=a.stops,r,u=[],v=function(){h=['<fill colors="'+u.join(",")+'" opacity="',y,'" o:opacity2="',o,'" type="',i,'" ',w,'focus="100%" method="any" />'],aa(e.prepVML(h),null,null,b)};if(n=a[0],r=a[a.length-1],n[0]>0&&a.unshift([0,n[1]]),r[0]<1&&a.push([1,r[1]]),p(a,function(a,b){g.test(a[1])?(f=Ha(a[1]),k=f.get("rgb"),l=f.get("a")):(k=a[1],l=1),u.push(a[0]*100+"% "+k),b?(y=l,I=k):(o=l,q=k)}),c==="fill")if(i==="gradient")c=m.x1||m[0]||0,a=m.y1||m[1]||0,n=m.x2||m[2]||0,m=m.y2||m[3]||0,w='angle="'+(90-X.atan((m-a)/(n-c))*180/ta)+'"',v();else{var j=m.r,t=j*2,s=j*2,x=m.cx,C=m.cy,R=b.radialReference,A,j=function(){R&&(A=d.getBBox(),x+=(R[0]-A.x)/A.width-.5,C+=(R[1]-A.y)/A.height-.5,t*=R[2]/A.width,s*=R[2]/A.height),w='src="'+F.global.VMLRadialGradientURL+'" size="'+t+","+s+'" origin="0.5,0.5" position="'+x+","+C+'" color2="'+q+'" ',v()};d.added?j():d.onAdd=j,j=I}else j=k}else g.test(a)&&b.tagName!=="IMG"?(f=Ha(a),h=["<",c,' opacity="',f.get("a"),'"/>'],aa(this.prepVML(h),null,null,b),j=f.get("rgb")):(j=b.getElementsByTagName(c),j.length&&(j[0].opacity=1,j[0].type="solid"),j=a);return j},prepVML:function(a){var b=this.isIE8,a=a.join("");return b?(a=a.replace("/>",' xmlns="urn:schemas-microsoft-com:vml" />'),a=a.indexOf('style="')===-1?a.replace("/>",' style="display:inline-block;behavior:url(#default#VML);" />'):a.replace('style="','style="display:inline-block;behavior:url(#default#VML);')):a=a.replace("<","<hcv:"),a},text:la.prototype.html,path:function(a){var b={coordsize:"10 10"};return Ra(a)?b.d=a:ga(a)&&s(b,a),this.createElement("shape").attr(b)},circle:function(a,b,c){var d=this.symbol("circle");return ga(a)&&(c=a.r,b=a.y,a=a.x),d.isCircle=!0,d.r=c,d.attr({x:a,y:b})},g:function(a){var b;return a&&(b={className:"highcharts-"+a,"class":"highcharts-"+a}),this.createElement(Va).attr(b)},image:function(a,b,c,d,e){var f=this.createElement("img").attr({src:a});return arguments.length>1&&f.attr({x:b,y:c,width:d,height:e}),f},createElement:function(a){return a==="rect"?this.symbol(a):la.prototype.createElement.call(this,a)},invertChild:function(a,b){var c=this,d=b.style,e=a.tagName==="IMG"&&a.style;K(a,{flip:"x",left:G(d.width)-(e?G(e.top):1),top:G(d.height)-(e?G(e.left):1),rotation:-90}),p(a.childNodes,function(b){c.invertChild(b,a)})},symbols:{arc:function(a,b,c,d,e){var f=e.start,g=e.end,h=e.r||c||d,c=e.innerR,d=ea(f),i=ja(f),j=ea(g),k=ja(g);return g-f==0?["x"]:(f=["wa",a-h,b-h,a+h,b+h,a+h*d,b+h*i,a+h*j,b+h*k],e.open&&!c&&f.push("e","M",a,b),f.push("at",a-c,b-c,a+c,b+c,a+c*j,b+c*k,a+c*d,b+c*i,"x","e"),f.isArc=!0,f)},circle:function(a,b,c,d,e){return e&&(c=d=2*e.r),e&&e.isCircle&&(a-=c/2,b-=d/2),["wa",a,b,a+c,b+d,a+c,b+d/2,a+c,b+d/2,"e"]},rect:function(a,b,c,d,e){return la.prototype.symbols[!t(e)||!e.r?"square":"callout"].call(0,a,b,c,d,e)}}},Q.VMLRenderer=hb=function(){this.init.apply(this,arguments)},hb.prototype=x(la.prototype,fa),Ya=hb),la.prototype.measureSpanWidth=function(a,b){var c=D.createElement("span"),d;return d=D.createTextNode(a),c.appendChild(d),K(c,b),this.box.appendChild(c),d=c.offsetWidth,Ua(c),d},ka&&(Q.CanVGRenderer=fa=function(){Ga="http://www.w3.org/1999/xhtml"},fa.prototype.symbols={},Ub=function(){function a(){for(var a=b.length,d=0;d<a;d++)b[d]();b=[]}var b=[];return{push:function(c,d){b.length===0&&$b(d,a),b.push(c)}}}(),Ya=fa),ab.prototype={addLabel:function(){var a=this.axis,b=a.options,c=a.chart,d=a.horiz,e=a.categories,f=a.names,g=this.pos,h=b.labels,i=h.rotation,j=a.tickPositions,d=d&&e&&!h.step&&!h.staggerLines&&!h.rotation&&c.plotWidth/j.length||!d&&(c.margin[3]||c.chartWidth*.33),k=g===j[0],l=g===j[j.length-1],m,f=e?q(e[g],f[g],g):g,e=this.label,n=j.info;a.isDatetimeAxis&&n&&(m=b.dateTimeLabelFormats[n.higherRanks[g]||n.unitName]),this.isFirst=k,this.isLast=l,b=a.labelFormatter.call({axis:a,chart:c,isFirst:k,isLast:l,dateTimeLabelFormat:m,value:a.isLog?ia(ra(f)):f}),g=d&&{width:v(1,u(d-2*(h.padding||10)))+"px"},g=s(g,h.style),t(e)?e&&e.attr({text:b}).css(g):(m={align:a.labelAlign},ma(i)&&(m.rotation=i),d&&h.ellipsis&&(g.HcHeight=a.len/j.length),this.label=e=t(b)&&h.enabled?c.renderer.text(b,0,0,h.useHTML).attr(m).css(g).add(a.labelGroup):null,a.tickBaseline=c.renderer.fontMetrics(h.style.fontSize,e).b,i&&a.side===2&&(a.tickBaseline*=ea(i*Oa))),this.yOffset=e?q(h.y,a.tickBaseline+(a.side===2?8:-(e.getBBox().height/2))):0},getLabelSize:function(){var a=this.label,b=this.axis;return a?a.getBBox()[b.horiz?"height":"width"]:0},getLabelSides:function(){var a=this.label.getBBox(),b=this.axis,c=b.horiz,d=b.options.labels,a=c?a.width:a.height,b=c?d.x-a*{left:0,center:.5,right:1}[b.labelAlign]:0;return[b,c?a+b:a]},handleOverflow:function(a,b){var c=!0,d=this.axis,e=this.isFirst,f=this.isLast,g=d.horiz?b.x:b.y,h=d.reversed,i=d.tickPositions,j=this.getLabelSides(),k=j[0],j=j[1],l,m,n,o=this.label.line||0;if(l=d.labelEdge,m=d.justifyLabels&&(e||f),l[o]===r||g+k>l[o]?l[o]=g+j:m||(c=!1),m){l=(m=d.justifyToPlot)?d.pos:0,m=m?l+d.len:d.chart.chartWidth;do a+=e?1:-1,n=d.ticks[i[a]];while(i[a]&&(!n||!n.label||n.label.line!==o));d=n&&n.label.xy&&n.label.xy.x+n.getLabelSides()[e?0:1],e&&!h||f&&h?g+k<l&&(g=l-k,n&&g+j>d&&(c=!1)):g+j>m&&(g=m-j,n&&g+k<d&&(c=!1)),b.x=g}return c},getPosition:function(a,b,c,d){var e=this.axis,f=e.chart,g=d&&f.oldChartHeight||f.chartHeight;return{x:a?e.translate(b+c,null,null,d)+e.transB:e.left+e.offset+(e.opposite?(d&&f.oldChartWidth||f.chartWidth)-e.right-e.left:0),y:a?g-e.bottom+e.offset-(e.opposite?e.height:0):g-e.translate(b+c,null,null,d)-e.transB}},getLabelPosition:function(a,b,c,d,e,f,g,h){var i=this.axis,j=i.transA,k=i.reversed,l=i.staggerLines,a=a+e.x-(f&&d?f*j*(k?-1:1):0),b=b+this.yOffset-(f&&!d?f*j*(k?1:-1):0);return l&&(c.line=g/(h||1)%l,b+=c.line*(i.labelOffset/l)),{x:a,y:b}},getMarkPath:function(a,b,c,d,e,f){return f.crispLine(["M",a,b,"L",a+(e?0:-c),b+(e?c:0)],d)},render:function(a,b,c){var d=this.axis,e=d.options,f=d.chart.renderer,g=d.horiz,h=this.type,i=this.label,j=this.pos,k=e.labels,l=this.gridLine,m=h?h+"Grid":"grid",n=h?h+"Tick":"tick",o=e[m+"LineWidth"],y=e[m+"LineColor"],I=e[m+"LineDashStyle"],p=e[n+"Length"],m=e[n+"Width"]||0,w=e[n+"Color"],db=e[n+"Position"],n=this.mark,u=k.step,v=!0,t=d.tickmarkOffset,s=this.getPosition(g,j,t,b),x=s.x,s=s.y,C=g&&x===d.pos+d.len||!g&&s===d.pos?-1:1,c=q(c,1);this.isActive=!0,o&&(j=d.getPlotLinePath(j+t,o*C,b,!0),l===r&&(l={stroke:y,"stroke-width":o},I&&(l.dashstyle=I),h||(l.zIndex=1),b&&(l.opacity=0),this.gridLine=l=o?f.path(j).attr(l).add(d.gridGroup):null),!b&&l&&j&&l[this.isNew?"attr":"animate"]({d:j,opacity:c})),m&&p&&(db==="inside"&&(p=-p),d.opposite&&(p=-p),h=this.getMarkPath(x,s,p,m*C,g,f),n?n.animate({d:h,opacity:c}):this.mark=f.path(h).attr({stroke:w,"stroke-width":m,opacity:c}).add(d.axisGroup)),i&&!isNaN(x)&&(i.xy=s=this.getLabelPosition(x,s,i,g,k,t,a,u),this.isFirst&&!this.isLast&&!q(e.showFirstLabel,1)||this.isLast&&!this.isFirst&&!q(e.showLastLabel,1)?v=!1:!d.isRadial&&!k.step&&!k.rotation&&!b&&c!==0&&(v=this.handleOverflow(a,s)),u&&a%u&&(v=!1),v&&!isNaN(s.y)?(s.opacity=c,i[this.isNew?"attr":"animate"](s),this.isNew=!1):i.attr("y",-9999))},destroy:function(){Ma(this,this.axis)}},Q.PlotLineOrBand=function(a,b){this.axis=a,b&&(this.options=b,this.id=b.id)},Q.PlotLineOrBand.prototype={render:function(){var a=this,b=a.axis,c=b.horiz,d=(b.pointRange||0)/2,e=a.options,f=e.label,g=a.label,h=e.width,i=e.to,j=e.from,k=t(j)&&t(i),l=e.value,m=e.dashStyle,n=a.svgElem,o=[],y,q=e.color,p=e.zIndex,w=e.events,r={},u=b.chart.renderer;if(b.isLog&&(j=Ia(j),i=Ia(i),l=Ia(l)),h)(o=b.getPlotLinePath(l,h),r={stroke:q,"stroke-width":h},m)&&(r.dashstyle=m);else if(k)j=v(j,b.min-d),i=A(i,b.max+d),o=b.getPlotBandPath(j,i,e),q&&(r.fill=q),e.borderWidth&&(r.stroke=e.borderColor,r["stroke-width"]=e.borderWidth);else return;if(t(p)&&(r.zIndex=p),n)o?n.animate({d:o},null,n.onGetPath):(n.hide(),n.onGetPath=function(){n.show()},g)&&(a.label=g=g.destroy());else if(o&&o.length&&(a.svgElem=n=u.path(o).attr(r).add(),w))for(y in d=function(b){n.on(b,function(c){w[b].apply(a,[c])})},w)d(y);return f&&t(f.text)&&o&&o.length&&b.width>0&&b.height>0?(f=x({align:c&&k&&"center",x:c?!k&&4:10,verticalAlign:!c&&k&&"middle",y:c?k?16:10:k?6:-4,rotation:c&&!k&&90},f),g||
(r={align:f.textAlign||f.align,rotation:f.rotation},t(p)&&(r.zIndex=p),a.label=g=u.text(f.text,0,0,f.useHTML).attr(r).css(f.style).add()),b=[o[1],o[4],k?o[6]:o[1]],k=[o[2],o[5],k?o[7]:o[2]],o=Ta(b),c=Ta(k),g.align(f,!1,{x:o,y:c,width:Da(b)-o,height:Da(k)-c}),g.show()):g&&g.hide(),a},destroy:function(){sa(this.axis.plotLinesAndBands,this),delete this.axis,Ma(this)}},J.prototype={defaultOptions:{dateTimeLabelFormats:{millisecond:"%H:%M:%S.%L",second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:"%e. %b",week:"%e. %b",month:"%b '%y",year:"%Y"},endOnTick:!1,gridLineColor:"#C0C0C0",labels:T,lineColor:"#C0D0E0",lineWidth:1,minPadding:.01,maxPadding:.01,minorGridLineColor:"#E0E0E0",minorGridLineWidth:1,minorTickColor:"#A0A0A0",minorTickLength:2,minorTickPosition:"outside",startOfWeek:1,startOnTick:!1,tickColor:"#C0D0E0",tickLength:10,tickmarkPlacement:"between",tickPixelInterval:100,tickPosition:"outside",tickWidth:1,title:{align:"middle",style:{color:"#707070"}},type:"linear"},defaultYAxisOptions:{endOnTick:!0,gridLineWidth:1,tickPixelInterval:72,showLastLabel:!0,labels:{x:-8,y:3},lineWidth:0,maxPadding:.05,minPadding:.05,startOnTick:!0,tickWidth:0,title:{rotation:270,text:"Values"},stackLabels:{enabled:!1,formatter:function(){return Ka(this.total,-1)},style:T.style}},defaultLeftAxisOptions:{labels:{x:-15,y:null},title:{rotation:270}},defaultRightAxisOptions:{labels:{x:15,y:null},title:{rotation:90}},defaultBottomAxisOptions:{labels:{x:0,y:null},title:{rotation:0}},defaultTopAxisOptions:{labels:{x:0,y:-15},title:{rotation:0}},init:function(a,b){var c=b.isX,e,f,d;this.horiz=a.inverted?!c:c,this.coll=(this.isXAxis=c)?"xAxis":"yAxis",this.opposite=b.opposite,this.side=b.side||(this.horiz?this.opposite?0:2:this.opposite?1:3),this.setOptions(b),d=this.options,e=d.type,this.labelFormatter=d.labels.formatter||this.defaultLabelFormatter,this.userOptions=b,this.minPixelPadding=0,this.chart=a,this.reversed=d.reversed,this.zoomEnabled=d.zoomEnabled!==!1,this.categories=d.categories||e==="category",this.names=[],this.isLog=e==="logarithmic",this.isDatetimeAxis=e==="datetime",this.isLinked=t(d.linkedTo),this.tickmarkOffset=this.categories&&d.tickmarkPlacement==="between"?.5:0,this.ticks={},this.labelEdge=[],this.minorTicks={},this.plotLinesAndBands=[],this.alternateBands={},this.len=0,this.minRange=this.userMinRange=d.minRange||d.maxZoom,this.range=d.range,this.offset=d.offset||0,this.stacks={},this.oldStacks={},this.min=this.max=null,this.crosshair=q(d.crosshair,na(a.options.tooltip.crosshairs)[c?0:1],!1),d=this.options.events,ya(this,a.axes)===-1&&(c&&!this.isColorAxis?a.axes.splice(a.xAxis.length,0,this):a.axes.push(this),a[this.coll].push(this)),this.series=this.series||[],a.inverted&&c&&this.reversed===r&&(this.reversed=!0),this.removePlotLine=this.removePlotBand=this.removePlotBandOrLine;for(f in d)z(this,f,d[f]);this.isLog&&(this.val2lin=Ia,this.lin2val=ra)},setOptions:function(a){this.options=x(this.defaultOptions,this.isXAxis?{}:this.defaultYAxisOptions,[this.defaultTopAxisOptions,this.defaultRightAxisOptions,this.defaultBottomAxisOptions,this.defaultLeftAxisOptions][this.side],x(F[this.coll],a))},defaultLabelFormatter:function(){var a=this.axis,b=this.value,c=a.categories,d=this.dateTimeLabelFormat,e=F.lang.numericSymbols,f=e&&e.length,g,h=a.options.labels.format,a=a.isLog?b:a.tickInterval;if(h)g=La(h,this);else if(c)g=b;else if(d)g=wa(d,b);else if(f&&a>=1e3)for(;f--&&g===r;)c=Math.pow(1e3,f+1),a>=c&&e[f]!==null&&(g=Ka(b/c,-1)+e[f]);return g===r&&(g=P(b)>=1e4?Ka(b,0):Ka(b,-1,r,"")),g},getSeriesExtremes:function(){var a=this,b=a.chart;a.hasVisibleSeries=!1,a.dataMin=a.dataMax=null,a.buildStacks&&a.buildStacks(),p(a.series,function(c){var d,e;(c.visible||!b.options.chart.ignoreHiddenSeries)&&(d=c.options.threshold,a.hasVisibleSeries=!0,a.isLog&&d<=0&&(d=null),a.isXAxis?(d=c.xData,d.length)&&(a.dataMin=A(q(a.dataMin,d[0]),Ta(d)),a.dataMax=v(q(a.dataMax,d[0]),Da(d))):(c.getExtremes(),e=c.dataMax,c=c.dataMin,t(c)&&t(e)&&(a.dataMin=A(q(a.dataMin,c),c),a.dataMax=v(q(a.dataMax,e),e)),t(d)&&(a.dataMin>=d?(a.dataMin=d,a.ignoreMinPadding=!0):a.dataMax<d&&(a.dataMax=d,a.ignoreMaxPadding=!0))))})},translate:function(a,b,c,d,e,f){var g=1,h=0,i=d?this.oldTransA:this.transA,d=d?this.oldMin:this.min,j=this.minPixelPadding,e=(this.options.ordinal||this.isLog&&e)&&this.lin2val;return i||(i=this.transA),c&&(g*=-1,h=this.len),this.reversed&&(g*=-1,h-=g*(this.sector||this.len)),b?(a=a*g+h,a-=j,a=a/i+d,e&&(a=this.lin2val(a))):(e&&(a=this.val2lin(a)),f==="between"&&(f=.5),a=g*(a-d)*i+h+g*j+(ma(f)?i*f*this.pointRange:0)),a},toPixels:function(a,b){return this.translate(a,!1,!this.horiz,null,!0)+(b?0:this.pos)},toValue:function(a,b){return this.translate(a-(b?0:this.pos),!0,!this.horiz,null,!0)},getPlotLinePath:function(a,b,c,d,e){var f=this.chart,g=this.left,h=this.top,i,j,k=c&&f.oldChartHeight||f.chartHeight,l=c&&f.oldChartWidth||f.chartWidth,m;return i=this.transB,e=q(e,this.translate(a,null,null,c)),a=c=u(e+i),i=j=u(k-e-i),isNaN(e)?m=!0:this.horiz?(i=h,j=k-this.bottom,a<g||a>g+this.width)&&(m=!0):(a=g,c=l-this.right,i<h||i>h+this.height)&&(m=!0),m&&!d?null:f.renderer.crispLine(["M",a,i,"L",c,j],b||1)},getLinearTickPositions:function(a,b,c){var d,e=ia(V(b/a)*a),f=ia(Xa(c/a)*a),g=[];if(b===c&&ma(b))return[b];for(b=e;b<=f;){if(g.push(b),b=ia(b+a),b===d)break;d=b}return g},getMinorTickPositions:function(){var a=this.options,b=this.tickPositions,c=this.minorTickInterval,d=[],e;if(this.isLog)for(e=b.length,a=1;a<e;a++)d=d.concat(this.getLogTickPositions(c,b[a-1],b[a],!0));else if(this.isDatetimeAxis&&a.minorTickInterval==="auto")d=d.concat(this.getTimeTicks(this.normalizeTimeTickInterval(c),this.min,this.max,a.startOfWeek)),d[0]<this.min&&d.shift();else for(b=this.min+(b[0]-this.min)%c;b<=this.max;b+=c)d.push(b);return d},adjustForMinRange:function(){var a=this.options,b=this.min,c=this.max,d,e=this.dataMax-this.dataMin>=this.minRange,f,g,h,i,j,k;this.isXAxis&&this.minRange===r&&!this.isLog&&(t(a.min)||t(a.max)?this.minRange=null:(p(this.series,function(a){for(i=a.xData,g=j=a.xIncrement?1:i.length-1;g>0;g--)(h=i[g]-i[g-1],f===r||h<f)&&(f=h)}),this.minRange=A(f*5,this.dataMax-this.dataMin))),c-b<this.minRange&&(k=this.minRange,d=(k-c+b)/2,d=[b-d,q(a.min,b-d)],e&&(d[2]=this.dataMin),b=Da(d),c=[b+k,q(a.max,b+k)],e&&(c[2]=this.dataMax),c=Ta(c),c-b<k&&(d[0]=c-k,d[1]=q(a.min,c-k),b=Da(d))),this.min=b,this.max=c},setAxisTranslation:function(a){var b=this,c=b.max-b.min,d=b.axisPointRange||0,e,f=0,g=0,h=b.linkedParent,i=!!b.categories,j=b.transA;(b.isXAxis||i||d)&&(h?(f=h.minPointOffset,g=h.pointRangePadding):p(b.series,function(a){var h=i?1:b.isXAxis?a.pointRange:b.axisPointRange||0,j=a.options.pointPlacement,n=a.closestPointRange;h>c&&(h=0),d=v(d,h),f=v(f,Qa(j)?0:h/2),g=v(g,j==="on"?0:h),!a.noSharedTooltip&&t(n)&&(e=t(e)?A(e,n):n)}),h=b.ordinalSlope&&e?b.ordinalSlope/e:1,b.minPointOffset=f*=h,b.pointRangePadding=g*=h,b.pointRange=A(d,c),b.closestPointRange=e),a&&(b.oldTransA=j),b.translationSlope=b.transA=j=b.len/(c+g||1),b.transB=b.horiz?b.left:b.bottom,b.minPixelPadding=j*f},setTickPositions:function(a){var b=this,c=b.chart,d=b.options,e=d.startOnTick,f=d.endOnTick,g=b.isLog,h=b.isDatetimeAxis,i=b.isXAxis,j=b.isLinked,k=b.options.tickPositioner,l=d.maxPadding,m=d.minPadding,n=d.tickInterval,o=d.minTickInterval,y=d.tickPixelInterval,I,qa=b.categories;j?(b.linkedParent=c[b.coll][d.linkedTo],c=b.linkedParent.getExtremes(),b.min=q(c.min,c.dataMin),b.max=q(c.max,c.dataMax),d.type!==b.linkedParent.options.type&&oa(11,1)):(b.min=q(b.userMin,d.min,b.dataMin),b.max=q(b.userMax,d.max,b.dataMax)),g&&(!a&&A(b.min,q(b.dataMin,b.min))<=0&&oa(10,1),b.min=ia(Ia(b.min)),b.max=ia(Ia(b.max))),b.range&&t(b.max)&&(b.userMin=b.min=v(b.min,b.max-b.range),b.userMax=b.max,b.range=null),b.beforePadding&&b.beforePadding(),b.adjustForMinRange(),!qa&&!b.axisPointRange&&!b.usePercentage&&!j&&t(b.min)&&t(b.max)&&(c=b.max-b.min)&&(!t(d.min)&&!t(b.userMin)&&m&&(b.dataMin<0||!b.ignoreMinPadding)&&(b.min-=c*m),!t(d.max)&&!t(b.userMax)&&l&&(b.dataMax>0||!b.ignoreMaxPadding)&&(b.max+=c*l)),ma(d.floor)&&(b.min=v(b.min,d.floor)),ma(d.ceiling)&&(b.max=A(b.max,d.ceiling)),b.min===b.max||b.min===void 0||b.max===void 0?b.tickInterval=1:j&&!n&&y===b.linkedParent.options.tickPixelInterval?b.tickInterval=b.linkedParent.tickInterval:(b.tickInterval=q(n,qa?1:(b.max-b.min)*y/v(b.len,y)),!t(n)&&b.len<y&&!this.isRadial&&!this.isLog&&!qa&&e&&f&&(I=!0,b.tickInterval/=4)),i&&!a&&p(b.series,function(a){a.processData(b.min!==b.oldMin||b.max!==b.oldMax)}),b.setAxisTranslation(!0),b.beforeSetTickPositions&&b.beforeSetTickPositions(),b.postProcessTickInterval&&(b.tickInterval=b.postProcessTickInterval(b.tickInterval)),b.pointRange&&(b.tickInterval=v(b.pointRange,b.tickInterval)),!n&&b.tickInterval<o&&(b.tickInterval=o),h||g||n||(b.tickInterval=vb(b.tickInterval,null,ub(b.tickInterval),d)),b.minorTickInterval=d.minorTickInterval==="auto"&&b.tickInterval?b.tickInterval/5:d.minorTickInterval,b.tickPositions=a=d.tickPositions?[].concat(d.tickPositions):k&&k.apply(b,[b.min,b.max]),a||(!b.ordinalPositions&&(b.max-b.min)/b.tickInterval>v(2*b.len,200)&&oa(19,!0),a=h?b.getTimeTicks(b.normalizeTimeTickInterval(b.tickInterval,d.units),b.min,b.max,d.startOfWeek,b.ordinalPositions,b.closestPointRange,!0):g?b.getLogTickPositions(b.tickInterval,b.min,b.max):b.getLinearTickPositions(b.tickInterval,b.min,b.max),I&&a.splice(1,a.length-2),b.tickPositions=a),j||(d=a[0],g=a[a.length-1],h=b.minPointOffset||0,!e&&!f&&!qa&&a.length===2&&a.splice(1,0,(g+d)/2),e?b.min=d:b.min-h>d&&a.shift(),f?b.max=g:b.max+h<g&&a.pop(),a.length===1&&(e=P(b.max)>1e13?1:.001,b.min-=e,b.max+=e))},setMaxTicks:function(){var a=this.chart,b=a.maxTicks||{},c=this.tickPositions,d=this._maxTicksKey=[this.coll,this.pos,this.len].join("-");!this.isLinked&&!this.isDatetimeAxis&&c&&c.length>(b[d]||0)&&this.options.alignTicks!==!1&&(b[d]=c.length),a.maxTicks=b},adjustTickAmount:function(){var
 a=this._maxTicksKey,b=this.tickPositions,c=this.chart.maxTicks,d,e;if(c&&c[a]&&!this.isDatetimeAxis&&!this.categories&&!this.isLinked&&this.options.alignTicks!==!1&&this.min!==r){if(d=this.tickAmount,e=b.length,this.tickAmount=a=c[a],e<a){for(;b.length<a;)b.push(ia(b[b.length-1]+this.tickInterval));this.transA*=(e-1)/(a-1),this.max=b[b.length-1]}t(d)&&a!==d&&(this.isDirty=!0)}},setScale:function(){var a=this.stacks,b,c,d,e;if(this.oldMin=this.min,this.oldMax=this.max,this.oldAxisLength=this.len,this.setAxisSize(),e=this.len!==this.oldAxisLength,p(this.series,function(a){(a.isDirtyData||a.isDirty||a.xAxis.isDirty)&&(d=!0)}),e||d||this.isLinked||this.forceRedraw||this.userMin!==this.oldUserMin||this.userMax!==this.oldUserMax){if(!this.isXAxis)for(b in a)for(c in a[b])a[b][c].total=null,a[b][c].cum=0;this.forceRedraw=!1,this.getSeriesExtremes(),this.setTickPositions(),this.oldUserMin=this.userMin,this.oldUserMax=this.userMax,this.isDirty||(this.isDirty=e||this.min!==this.oldMin||this.max!==this.oldMax)}else if(!this.isXAxis){this.oldStacks&&(a=this.stacks=this.oldStacks);for(b in a)for(c in a[b])a[b][c].cum=a[b][c].total}this.setMaxTicks()},setExtremes:function(a,b,c,d,e){var f=this,g=f.chart,c=q(c,!0),e=s(e,{min:a,max:b});N(f,"setExtremes",e,function(){f.userMin=a,f.userMax=b,f.eventArgs=e,f.isDirtyExtremes=!0,c&&g.redraw(d)})},zoom:function(a,b){var c=this.dataMin,d=this.dataMax,e=this.options;return this.allowZoomOutside||(t(c)&&a<=A(c,q(e.min,c))&&(a=r),t(d)&&b>=v(d,q(e.max,d))&&(b=r)),this.displayBtn=a!==r||b!==r,this.setExtremes(a,b,!1,r,{trigger:"zoom"}),!0},setAxisSize:function(){var a=this.chart,b=this.options,c=b.offsetLeft||0,d=this.horiz,e=q(b.width,a.plotWidth-c+(b.offsetRight||0)),f=q(b.height,a.plotHeight),g=q(b.top,a.plotTop),b=q(b.left,a.plotLeft+c),c=/%$/;c.test(f)&&(f=parseInt(f,10)/100*a.plotHeight),c.test(g)&&(g=parseInt(g,10)/100*a.plotHeight+a.plotTop),this.left=b,this.top=g,this.width=e,this.height=f,this.bottom=a.chartHeight-f-g,this.right=a.chartWidth-e-b,this.len=v(d?e:f,0),this.pos=d?b:g},getExtremes:function(){var a=this.isLog;return{min:a?ia(ra(this.min)):this.min,max:a?ia(ra(this.max)):this.max,dataMin:this.dataMin,dataMax:this.dataMax,userMin:this.userMin,userMax:this.userMax}},getThreshold:function(a){var b=this.isLog,c=b?ra(this.min):this.min,b=b?ra(this.max):this.max;return c>a||a===null?a=c:b<a&&(a=b),this.translate(a,0,1,0,1)},autoLabelAlign:function(a){return a=(q(a,0)-this.side*90+720)%360,a>15&&a<165?"right":a>195&&a<345?"left":"center"},getOffset:function(){var a=this,b=a.chart,c=b.renderer,d=a.options,e=a.tickPositions,f=a.ticks,g=a.horiz,h=a.side,i=b.inverted?[1,0,3,2][h]:h,j,k,l=0,m,n=0,o=d.title,y=d.labels,I=0,qa=b.axisOffset,b=b.clipOffset,w=[-1,1,1,-1][h],u,s=1,x=q(y.maxStaggerLines,5),O,A,z,C,R;if(a.hasData=j=a.hasVisibleSeries||t(a.min)&&t(a.max)&&!!e,a.showAxis=k=j||q(d.showEmpty,!0),a.staggerLines=a.horiz&&y.staggerLines,a.axisGroup||(a.gridGroup=c.g("grid").attr({zIndex:d.gridZIndex||1}).add(),a.axisGroup=c.g("axis").attr({zIndex:d.zIndex||2}).add(),a.labelGroup=c.g("axis-labels").attr({zIndex:y.zIndex||7}).addClass("highcharts-"+a.coll.toLowerCase()+"-labels").add()),j||a.isLinked){if(a.labelAlign=q(y.align||a.autoLabelAlign(y.rotation)),p(e,function(b){f[b]?f[b].addLabel():f[b]=new ab(a,b)}),a.horiz&&!a.staggerLines&&x&&!y.rotation){for(j=a.reversed?[].concat(e).reverse():e;s<x;){for(O=[],A=!1,u=0;u<j.length;u++)z=j[u],C=(C=f[z].label&&f[z].label.getBBox())?C.width:0,R=u%s,C&&(z=a.translate(z),O[R]!==r&&z<O[R]&&(A=!0),O[R]=z+C);if(A)s++;else break}s>1&&(a.staggerLines=s)}p(e,function(b){(h===0||h===2||{1:"left",3:"right"}[h]===a.labelAlign)&&(I=v(f[b].getLabelSize(),I))}),a.staggerLines&&(I*=a.staggerLines,a.labelOffset=I)}else for(u in f)f[u].destroy(),delete f[u];o&&o.text&&o.enabled!==!1&&(a.axisTitle||(a.axisTitle=c.text(o.text,0,0,o.useHTML).attr({zIndex:7,rotation:o.rotation||0,align:o.textAlign||{low:"left",middle:"center",high:"right"}[o.align]}).addClass("highcharts-"+this.coll.toLowerCase()+"-title").css(o.style).add(a.axisGroup),a.axisTitle.isNew=!0),k&&(l=a.axisTitle.getBBox()[g?"height":"width"],m=o.offset,n=t(m)?0:q(o.margin,g?5:10)),a.axisTitle[k?"show":"hide"]()),a.offset=w*q(d.offset,qa[h]),c=h===2?a.tickBaseline:0,g=I+n+(I&&w*(g?q(y.y,a.tickBaseline+8):y.x)-c),a.axisTitleMargin=q(m,g),qa[h]=v(qa[h],a.axisTitleMargin+l+w*a.offset,g),b[i]=v(b[i],V(d.lineWidth/2)*2)},getLinePath:function(a){var b=this.chart,c=this.opposite,d=this.offset,e=this.horiz,f=this.left+(c?this.width:0)+d,d=b.chartHeight-this.bottom-(c?this.height:0)+d;return c&&(a*=-1),b.renderer.crispLine(["M",e?this.left:f,e?d:this.top,"L",e?b.chartWidth-this.right:f,e?d:b.chartHeight-this.bottom],a)},getTitlePosition:function(){var a=this.horiz,b=this.left,c=this.top,d=this.len,e=this.options.title,f=a?b:c,g=this.opposite,h=this.offset,i=G(e.style.fontSize||12),d={low:f+(a?0:d),middle:f+d/2,high:f+(a?d:0)}[e.align],b=(a?c+this.height:b)+(a?1:-1)*(g?-1:1)*this.axisTitleMargin+(this.side===2?i:0);return{x:a?d:b+(g?this.width:0)+h+(e.x||0),y:a?b-(g?this.height:0)+h:d+(e.y||0)}},render:function(){var a=this,b=a.horiz,c=a.reversed,d=a.chart,e=d.renderer,f=a.options,g=a.isLog,h=a.isLinked,i=a.tickPositions,j,k=a.axisTitle,l=a.ticks,m=a.minorTicks,n=a.alternateBands,o=f.stackLabels,y=f.alternateGridColor,q=a.tickmarkOffset,qa=f.lineWidth,w=d.hasRendered&&t(a.oldMin)&&!isNaN(a.oldMin),u=a.hasData,v=a.showAxis,s,x=f.labels.overflow,A=a.justifyLabels=b&&x!==!1,z;a.labelEdge.length=0,a.justifyToPlot=x==="justify",p([l,m,n],function(a){for(var b in a)a[b].isActive=!1}),(u||h)&&((a.minorTickInterval&&!a.categories&&p(a.getMinorTickPositions(),function(b){m[b]||(m[b]=new ab(a,b,"minor")),w&&m[b].isNew&&m[b].render(null,!0),m[b].render(null,!1,1)}),i.length&&(j=i.slice(),(b&&c||!b&&!c)&&j.reverse(),A&&(j=j.slice(1).concat([j[0]])),p(j,function(b,c){A&&(c=c===j.length-1?0:c+1),(!h||b>=a.min&&b<=a.max)&&(l[b]||(l[b]=new ab(a,b)),w&&l[b].isNew&&l[b].render(c,!0,.1),l[b].render(c))}),q&&a.min===0&&(l[-1]||(l[-1]=new ab(a,-1,null,!0)),l[-1].render(-1))),y&&p(i,function(b,c){c%2==0&&b<a.max&&(n[b]||(n[b]=new Q.PlotLineOrBand(a)),s=b+q,z=i[c+1]!==r?i[c+1]+q:a.max,n[b].options={from:g?ra(s):s,to:g?ra(z):z,color:y},n[b].render(),n[b].isActive=!0)}),a._addedPlotLB)||(p((f.plotLines||[]).concat(f.plotBands||[]),function(b){a.addPlotBandOrLine(b)}),a._addedPlotLB=!0)),p([l,m,n],function(a){var b,c,e=[],f=Ea?Ea.duration||500:0,g=function(){for(c=e.length;c--;)a[e[c]]&&!a[e[c]].isActive&&(a[e[c]].destroy(),delete a[e[c]])};for(b in a)a[b].isActive||(a[b].render(b,!1,0),a[b].isActive=!1,e.push(b));a===n||!d.hasRendered||!f?g():f&&setTimeout(g,f)}),qa&&(b=a.getLinePath(qa),a.axisLine?a.axisLine.animate({d:b}):a.axisLine=e.path(b).attr({stroke:f.lineColor,"stroke-width":qa,zIndex:7}).add(a.axisGroup),a.axisLine[v?"show":"hide"]()),k&&v&&(k[k.isNew?"attr":"animate"](a.getTitlePosition()),k.isNew=!1),o&&o.enabled&&a.renderStackTotals(),a.isDirty=!1},redraw:function(){this.render(),p(this.plotLinesAndBands,function(a){a.render()}),p(this.series,function(a){a.isDirty=!0})},destroy:function(a){var b=this,c=b.stacks,d,e=b.plotLinesAndBands;a||U(b);for(d in c)Ma(c[d]),c[d]=null;for(p([b.ticks,b.minorTicks,b.alternateBands],function(a){Ma(a)}),a=e.length;a--;)e[a].destroy();p("stackTotalGroup,axisLine,axisTitle,axisGroup,cross,gridGroup,labelGroup".split(","),function(a){b[a]&&(b[a]=b[a].destroy())}),this.cross&&this.cross.destroy()},drawCrosshair:function(a,b){if(this.crosshair)if((t(b)||!q(this.crosshair.snap,!0))===!1)this.hideCrosshair();else{var c,d=this.crosshair,e=d.animation;q(d.snap,!0)?t(b)&&(c=this.chart.inverted!=this.horiz?b.plotX:this.len-b.plotY):c=this.horiz?a.chartX-this.pos:this.len-a.chartY+this.pos,c=this.isRadial?this.getPlotLinePath(this.isXAxis?b.x:q(b.stackY,b.y)):this.getPlotLinePath(null,null,null,null,c),c===null?this.hideCrosshair():this.cross?this.cross.attr({visibility:"visible"})[e?"animate":"attr"]({d:c},e):(e={"stroke-width":d.width||1,stroke:d.color||"#C0C0C0",zIndex:d.zIndex||2},d.dashStyle&&(e.dashstyle=d.dashStyle),this.cross=this.chart.renderer.path(c).attr(e).add())}},hideCrosshair:function(){this.cross&&this.cross.hide()}},s(J.prototype,{getPlotBandPath:function(a,b){var c=this.getPlotLinePath(b),d=this.getPlotLinePath(a);return d&&c?d.push(c[4],c[5],c[1],c[2]):d=null,d},addPlotBand:function(a){return this.addPlotBandOrLine(a,"plotBands")},addPlotLine:function(a){return this.addPlotBandOrLine(a,"plotLines")},addPlotBandOrLine:function(a,b){var c=new Q.PlotLineOrBand(this,a).render(),d=this.userOptions;return c&&(b&&(d[b]=d[b]||[],d[b].push(a)),this.plotLinesAndBands.push(c)),c},removePlotBandOrLine:function(a){for(var b=this.plotLinesAndBands,c=this.options,d=this.userOptions,e=b.length;e--;)b[e].id===a&&b[e].destroy();p([c.plotLines||[],d.plotLines||[],c.plotBands||[],d.plotBands||[]],function(b){for(e=b.length;e--;)b[e].id===a&&sa(b,b[e])})}}),J.prototype.getTimeTicks=function(a,b,c,d){var e=[],f={},g=F.global.useUTC,h,i=new Date(b-Na),j=a.unitRange,k=a.count;if(t(b)){j>=H.second&&(i.setMilliseconds(0),i.setSeconds(j>=H.minute?0:k*V(i.getSeconds()/k))),j>=H.minute&&i[Mb](j>=H.hour?0:k*V(i[xb]()/k)),j>=H.hour&&i[Nb](j>=H.day?0:k*V(i[yb]()/k)),j>=H.day&&i[Ab](j>=H.month?1:k*V(i[Wa]()/k)),j>=H.month&&(i[Ob](j>=H.year?0:k*V(i[lb]()/k)),h=i[mb]()),j>=H.year&&(h-=h%k,i[Pb](h)),j===H.week&&i[Ab](i[Wa]()-i[zb]()+q(d,1)),b=1,Na&&(i=new Date(i.getTime()+Na)),h=i[mb]();for(var d=i.getTime(),l=i[lb](),m=i[Wa](),n=g?Na:(864e5+i.getTimezoneOffset()*6e4)%864e5;d<c;)e.push(d),j===H.year?d=kb(h+b*k,0):j===H.month?d=kb(h,l+b*k):!g&&(j===H.day||j===H.week)?d=kb(h,l,m+b*k*(j===H.day?1:7)):d+=j*k,b++;e.push(d),p(pb(e,function(a){return j<=H.hour&&a%H.day===n}),function(a){f[a]="day"})}return e.info=s(a,{higherRanks:f,totalRange:j*k}),e},J.prototype.normalizeTimeTickInterval=function(a,b){for(var c=b||[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,
30]],["hour",[1,2,3,4,6,8,12]],["day",[1,2]],["week",[1,2]],["month",[1,2,3,4,6]],["year",null]],d=c[c.length-1],e=H[d[0]],f=d[1],g=0;g<c.length;g++)if(d=c[g],e=H[d[0]],f=d[1],c[g+1]&&a<=(e*f[f.length-1]+H[c[g+1][0]])/2)break;return e===H.year&&a<5*e&&(f=[1,2,5]),c=vb(a/e,f,d[0]==="year"?v(ub(a/e),1):1),{unitRange:e,count:c,unitName:d[0]}},J.prototype.getLogTickPositions=function(a,b,c,d){var e=this.options,f=this.len,g=[],h,i,j,k,l;if(d||(this._minorAutoInterval=null),a>=.5)a=u(a),g=this.getLinearTickPositions(a,b,c);else if(a>=.08)for(f=V(b),e=a>.3?[1,2,4]:a>.15?[1,2,4,6,8]:[1,2,3,4,5,6,7,8,9];f<c+1&&!l;f++)for(i=e.length,h=0;h<i&&!l;h++)j=Ia(ra(f)*e[h]),j>b&&(!d||k<=c)&&k!==r&&g.push(k),k>c&&(l=!0),k=j;else(b=ra(b),c=ra(c),a=e[d?"minorTickInterval":"tickInterval"],a=q(a==="auto"?null:a,this._minorAutoInterval,(c-b)*(e.tickPixelInterval/(d?5:1))/((d?f/this.tickPositions.length:f)||1)),a=vb(a,null,ub(a)),g=za(this.getLinearTickPositions(a,b,c),Ia),d)||(this._minorAutoInterval=a/5);return d||(this.tickInterval=a),g},Ib=Q.Tooltip=function(){this.init.apply(this,arguments)},Ib.prototype={init:function(a,b){var c=b.borderWidth,d=b.style,e=G(d.padding);this.chart=a,this.options=b,this.crosshairs=[],this.now={x:0,y:0},this.isHidden=!0,this.label=a.renderer.label("",0,0,b.shape||"callout",null,null,b.useHTML,null,"tooltip").attr({padding:e,fill:b.backgroundColor,"stroke-width":c,r:b.borderRadius,zIndex:8}).css(d).css({padding:0}).add().attr({y:-9999}),ka||this.label.shadow(b.shadow),this.shared=b.shared},destroy:function(){this.label&&(this.label=this.label.destroy()),clearTimeout(this.hideTimer),clearTimeout(this.tooltipTimeout)},move:function(a,b,c,d){var e=this,f=e.now,g=e.options.animation!==!1&&!e.isHidden&&(P(a-f.x)>1||P(b-f.y)>1),h=e.followPointer||e.len>1;s(f,{x:g?(2*f.x+a)/3:a,y:g?(f.y+b)/2:b,anchorX:h?r:g?(2*f.anchorX+c)/3:c,anchorY:h?r:g?(f.anchorY+d)/2:d}),e.label.attr(f),g&&(clearTimeout(this.tooltipTimeout),this.tooltipTimeout=setTimeout(function(){e&&e.move(a,b,c,d)},32))},hide:function(){var a=this,b;clearTimeout(this.hideTimer),this.isHidden||(b=this.chart.hoverPoints,this.hideTimer=setTimeout(function(){a.label.fadeOut(),a.isHidden=!0},q(this.options.hideDelay,500)),b&&p(b,function(a){a.setState()}),this.chart.hoverPoints=null)},getAnchor:function(a,b){var c,d=this.chart,e=d.inverted,f=d.plotTop,g=0,h=0,i,a=na(a);return c=a[0].tooltipPos,this.followPointer&&b&&(b.chartX===r&&(b=d.pointer.normalize(b)),c=[b.chartX-d.plotLeft,b.chartY-f]),c||(p(a,function(a){i=a.series.yAxis,g+=a.plotX,h+=(a.plotLow?(a.plotLow+a.plotHigh)/2:a.plotY)+(!e&&i?i.top-f:0)}),g/=a.length,h/=a.length,c=[e?d.plotWidth-h:g,this.shared&&!e&&a.length>1&&b?b.chartY-f:e?d.plotHeight-g:h]),za(c,u)},getPosition:function(a,b,c){var d=this.chart,e=this.distance,f={},g,h=["y",d.chartHeight,b,c.plotY+d.plotTop],i=["x",d.chartWidth,a,c.plotX+d.plotLeft],j=c.ttBelow||d.inverted&&!c.negative||!d.inverted&&c.negative,k=function(a,b,c,d){var g=c<d-e,b=d+e+c<b,c=d-e-c;if(d+=e,j&&b)f[a]=d;else if(!j&&g)f[a]=c;else if(g)f[a]=c;else if(b)f[a]=d;else return!1},l=function(a,b,c,d){if(d<e||d>b-e)return!1;f[a]=d<c/2?1:d>b-c/2?b-c-2:d-c/2},m=function(a){var b=h;h=i,i=b,g=a},n=function(){k.apply(0,h)!==!1?l.apply(0,i)===!1&&!g&&(m(!0),n()):g?f.x=f.y=0:(m(!0),n())};return(d.inverted||this.len>1)&&m(),n(),f},defaultFormatter:function(a){var b=this.points||na(this),c=b[0].series,d;return d=[a.tooltipHeaderFormatter(b[0])],p(b,function(a){c=a.series,d.push(c.tooltipFormatter&&c.tooltipFormatter(a)||a.point.tooltipFormatter(c.tooltipOptions.pointFormat))}),d.push(a.options.footerFormat||""),d.join("")},refresh:function(a,b){var c=this.chart,d=this.label,e=this.options,f,g,h={},i,j=[],k,l;i=e.formatter||this.defaultFormatter,h=c.hoverPoints,l=this.shared,clearTimeout(this.hideTimer),this.followPointer=na(a)[0].series.tooltipOptions.followPointer,g=this.getAnchor(a,b),f=g[0],g=g[1],l&&(!a.series||!a.series.noSharedTooltip)?(c.hoverPoints=a,h&&p(h,function(a){a.setState()}),p(a,function(a){a.setState("hover"),j.push(a.getLabelConfig())}),h={x:a[0].category,y:a[0].y},h.points=j,this.len=j.length,a=a[0]):h=a.getLabelConfig(),i=i.call(h,this),h=a.series,this.distance=q(h.tooltipOptions.distance,16),i===!1?this.hide():(this.isHidden&&(gb(d),d.attr("opacity",1).show()),d.attr({text:i}),k=e.borderColor||a.color||h.color||"#606060",d.attr({stroke:k}),this.updatePosition({plotX:f,plotY:g,negative:a.negative,ttBelow:a.ttBelow}),this.isHidden=!1),N(c,"tooltipRefresh",{text:i,x:f+c.plotLeft,y:g+c.plotTop,borderColor:k})},updatePosition:function(a){var b=this.chart,c=this.label,c=(this.options.positioner||this.getPosition).call(this,c.width,c.height,a);this.move(u(c.x),u(c.y),a.plotX+b.plotLeft,a.plotY+b.plotTop)},tooltipHeaderFormatter:function(a){var b=a.series,c=b.tooltipOptions,d=c.dateTimeLabelFormats,e=c.xDateFormat,f=b.xAxis,g=f&&f.options.type==="datetime"&&ma(a.key),c=c.headerFormat,f=f&&f.closestPointRange,h;if(g&&!e){if(f){for(h in H)if(H[h]>=f||H[h]<=H.day&&a.key%H[h]>0){e=d[h];break}}else e=d.day;e=e||d.year}return g&&e&&(c=c.replace("{point.key}","{point.key:"+e+"}")),La(c,{point:a,series:b})}},cb=D.documentElement.ontouchstart!==r,Za=Q.Pointer=function(a,b){this.init(a,b)},Za.prototype={init:function(a,b){var c=b.chart,d=c.events,e=ka?"":c.zoomType,c=a.inverted,f;this.options=b,this.chart=a,this.zoomX=f=/x/.test(e),this.zoomY=e=/y/.test(e),this.zoomHor=f&&!c||e&&c,this.zoomVert=e&&!c||f&&c,this.hasZoom=f||e,this.runChartClick=d&&!!d.click,this.pinchDown=[],this.lastValidTouch={},Q.Tooltip&&b.tooltip.enabled&&(a.tooltip=new Ib(a,b.tooltip),this.followTouchMove=b.tooltip.followTouchMove),this.setDOMEvents()},normalize:function(a,b){var c,d,a=a||window.event,a=bc(a);return a.target||(a.target=a.srcElement),d=a.touches?a.touches.length?a.touches.item(0):a.changedTouches[0]:a,b||(this.chartPosition=b=ac(this.chart.container)),d.pageX===r?(c=v(a.x,a.clientX-b.left),d=a.y):(c=d.pageX-b.left,d=d.pageY-b.top),s(a,{chartX:u(c),chartY:u(d)})},getCoordinates:function(a){var b={xAxis:[],yAxis:[]};return p(this.chart.axes,function(c){b[c.isXAxis?"xAxis":"yAxis"].push({axis:c,value:c.toValue(a[c.horiz?"chartX":"chartY"])})}),b},getIndex:function(a){var b=this.chart;return b.inverted?b.plotHeight+b.plotTop-a.chartY:a.chartX-b.plotLeft},runPointActions:function(a){var b=this.chart,c=b.series,d=b.tooltip,e,f,g=b.hoverPoint,h=b.hoverSeries,i,j,k=b.chartWidth,l=this.getIndex(a);if(d&&this.options.tooltip.shared&&(!h||!h.noSharedTooltip)){for(f=[],i=c.length,j=0;j<i;j++)c[j].visible&&c[j].options.enableMouseTracking!==!1&&!c[j].noSharedTooltip&&c[j].singularTooltips!==!0&&c[j].tooltipPoints.length&&(e=c[j].tooltipPoints[l])&&e.series&&(e._dist=P(l-e.clientX),k=A(k,e._dist),f.push(e));for(i=f.length;i--;)f[i]._dist>k&&f.splice(i,1);f.length&&f[0].clientX!==this.hoverX&&(d.refresh(f,a),this.hoverX=f[0].clientX)}if(c=h&&h.tooltipOptions.followPointer,h&&h.tracker&&!c){if((e=h.tooltipPoints[l])&&e!==g)e.onMouseOver(a)}else d&&c&&!d.isHidden&&(h=d.getAnchor([{}],a),d.updatePosition({plotX:h[0],plotY:h[1]}));d&&!this._onDocumentMouseMove&&(this._onDocumentMouseMove=function(a){if(ba[ua])ba[ua].pointer.onDocumentMouseMove(a)},z(D,"mousemove",this._onDocumentMouseMove)),p(b.axes,function(b){b.drawCrosshair(a,q(e,g))})},reset:function(a){var b=this.chart,c=b.hoverSeries,d=b.hoverPoint,e=b.tooltip,f=e&&e.shared?b.hoverPoints:d;(a=a&&e&&f)&&na(f)[0].plotX===r&&(a=!1),a?(e.refresh(f),d&&d.setState(d.state,!0)):(d&&d.onMouseOut(),c&&c.onMouseOut(),e&&e.hide(),this._onDocumentMouseMove&&(U(D,"mousemove",this._onDocumentMouseMove),this._onDocumentMouseMove=null),p(b.axes,function(a){a.hideCrosshair()}),this.hoverX=null)},scaleGroups:function(a,b){var c=this.chart,d;p(c.series,function(e){d=a||e.getPlotBox(),e.xAxis&&e.xAxis.zoomEnabled&&(e.group.attr(d),e.markerGroup&&(e.markerGroup.attr(d),e.markerGroup.clip(b?c.clipRect:null)),e.dataLabelsGroup&&e.dataLabelsGroup.attr(d))}),c.clipRect.attr(b||c.clipBox)},dragStart:function(a){var b=this.chart;b.mouseIsDown=a.type,b.cancelClick=!1,b.mouseDownX=this.mouseDownX=a.chartX,b.mouseDownY=this.mouseDownY=a.chartY},drag:function(a){var b=this.chart,c=b.options.chart,d=a.chartX,e=a.chartY,f=this.zoomHor,g=this.zoomVert,h=b.plotLeft,i=b.plotTop,j=b.plotWidth,k=b.plotHeight,l,m=this.mouseDownX,n=this.mouseDownY,o=c.panKey&&a[c.panKey+"Key"];d<h?d=h:d>h+j&&(d=h+j),e<i?e=i:e>i+k&&(e=i+k),this.hasDragged=Math.sqrt(Math.pow(m-d,2)+Math.pow(n-e,2)),this.hasDragged>10&&(l=b.isInsidePlot(m-h,n-i),b.hasCartesianSeries&&(this.zoomX||this.zoomY)&&l&&!o&&!this.selectionMarker&&(this.selectionMarker=b.renderer.rect(h,i,f?1:j,g?1:k,0).attr({fill:c.selectionMarkerFill||"rgba(69,114,167,0.25)",zIndex:7}).add()),this.selectionMarker&&f&&(d-=m,this.selectionMarker.attr({width:P(d),x:(d>0?0:d)+m})),this.selectionMarker&&g&&(d=e-n,this.selectionMarker.attr({height:P(d),y:(d>0?0:d)+n})),l&&!this.selectionMarker&&c.panning&&b.pan(a,c.panning))},drop:function(a){var b=this.chart,c=this.hasPinched;if(this.selectionMarker){var d={xAxis:[],yAxis:[],originalEvent:a.originalEvent||a},e=this.selectionMarker,f=e.attr?e.attr("x"):e.x,g=e.attr?e.attr("y"):e.y,h=e.attr?e.attr("width"):e.width,i=e.attr?e.attr("height"):e.height,j;(this.hasDragged||c)&&(p(b.axes,function(b){if(b.zoomEnabled){var c=b.horiz,e=a.type==="touchend"?b.minPixelPadding:0,n=b.toValue((c?f:g)+e),c=b.toValue((c?f+h:g+i)-e);!isNaN(n)&&!isNaN(c)&&(d[b.coll].push({axis:b,min:A(n,c),max:v(n,c)}),j=!0)}}),j&&N(b,"selection",d,function(a){b.zoom(s(a,c?{animation:!1}:null))})),this.selectionMarker=this.selectionMarker.destroy(),c&&this.scaleGroups()}b&&(K(b.container,{cursor:b._cursor}),b.cancelClick=this.hasDragged>10,b.mouseIsDown=this.hasDragged=this.hasPinched=!1,this.pinchDown=[])},onContainerMouseDown:function(a){a=this.normalize(a),a.preventDefault&&a.preventDefault(),this.dragStart(a)},onDocumentMouseUp:function(a){ba[ua]&&ba[ua].pointer.drop(a)},onDocumentMouseMove:function(a){var
 b=this.chart,c=this.chartPosition,d=b.hoverSeries,a=this.normalize(a,c);c&&d&&!this.inClass(a.target,"highcharts-tracker")&&!b.isInsidePlot(a.chartX-b.plotLeft,a.chartY-b.plotTop)&&this.reset()},onContainerMouseLeave:function(){var a=ba[ua];a&&(a.pointer.reset(),a.pointer.chartPosition=null)},onContainerMouseMove:function(a){var b=this.chart;ua=b.index,a=this.normalize(a),a.returnValue=!1,b.mouseIsDown==="mousedown"&&this.drag(a),(this.inClass(a.target,"highcharts-tracker")||b.isInsidePlot(a.chartX-b.plotLeft,a.chartY-b.plotTop))&&!b.openMenu&&this.runPointActions(a)},inClass:function(a,b){for(var c;a;){if(c=Y(a,"class")){if(c.indexOf(b)!==-1)return!0;if(c.indexOf("highcharts-container")!==-1)return!1}a=a.parentNode}},onTrackerMouseOut:function(a){var b=this.chart.hoverSeries,c=(a=a.relatedTarget||a.toElement)&&a.point&&a.point.series;!b||b.options.stickyTracking||this.inClass(a,"highcharts-tooltip")||c===b||b.onMouseOut()},onContainerClick:function(a){var b=this.chart,c=b.hoverPoint,d=b.plotLeft,e=b.plotTop,a=this.normalize(a);a.cancelBubble=!0,b.cancelClick||(c&&this.inClass(a.target,"highcharts-tracker")?(N(c.series,"click",s(a,{point:c})),b.hoverPoint&&c.firePointEvent("click",a)):(s(a,this.getCoordinates(a)),b.isInsidePlot(a.chartX-d,a.chartY-e)&&N(b,"click",a)))},setDOMEvents:function(){var a=this,b=a.chart.container;b.onmousedown=function(b){a.onContainerMouseDown(b)},b.onmousemove=function(b){a.onContainerMouseMove(b)},b.onclick=function(b){a.onContainerClick(b)},z(b,"mouseleave",a.onContainerMouseLeave),fb===1&&z(D,"mouseup",a.onDocumentMouseUp),cb&&(b.ontouchstart=function(b){a.onContainerTouchStart(b)},b.ontouchmove=function(b){a.onContainerTouchMove(b)},fb===1&&z(D,"touchend",a.onDocumentTouchEnd))},destroy:function(){var a;U(this.chart.container,"mouseleave",this.onContainerMouseLeave),fb||(U(D,"mouseup",this.onDocumentMouseUp),U(D,"touchend",this.onDocumentTouchEnd)),clearInterval(this.tooltipTimeout);for(a in this)this[a]=null}},s(Q.Pointer.prototype,{pinchTranslate:function(a,b,c,d,e,f){(this.zoomHor||this.pinchHor)&&this.pinchTranslateDirection(!0,a,b,c,d,e,f),(this.zoomVert||this.pinchVert)&&this.pinchTranslateDirection(!1,a,b,c,d,e,f)},pinchTranslateDirection:function(a,b,c,d,e,f,g,h){var i=this.chart,j=a?"x":"y",k=a?"X":"Y",l="chart"+k,m=a?"width":"height",n=i["plot"+(a?"Left":"Top")],o,y,q=h||1,p=i.inverted,w=i.bounds[a?"h":"v"],r=b.length===1,u=b[0][l],s=c[0][l],v=!r&&b[1][l],t=!r&&c[1][l],x,c=function(){!r&&P(u-v)>20&&(q=h||P(s-t)/P(u-v)),y=(n-s)/q+u,o=i["plot"+(a?"Width":"Height")]/q};c(),b=y,b<w.min?(b=w.min,x=!0):b+o>w.max&&(b=w.max-o,x=!0),x?(s-=.8*(s-g[j][0]),r||(t-=.8*(t-g[j][1])),c()):g[j]=[s,t],p||(f[j]=y-n,f[m]=o),f=p?1/q:q,e[m]=o,e[j]=b,d[p?a?"scaleY":"scaleX":"scale"+k]=q,d["translate"+k]=f*n+(s-f*u)},pinch:function(a){var b=this,c=b.chart,d=b.pinchDown,e=b.followTouchMove,f=a.touches,g=f.length,h=b.lastValidTouch,i=b.hasZoom,j=b.selectionMarker,k={},l=g===1&&(b.inClass(a.target,"highcharts-tracker")&&c.runTrackerClick||c.runChartClick),m={};(i||e)&&!l&&a.preventDefault(),za(f,function(a){return b.normalize(a)}),a.type==="touchstart"?(p(f,function(a,b){d[b]={chartX:a.chartX,chartY:a.chartY}}),h.x=[d[0].chartX,d[1]&&d[1].chartX],h.y=[d[0].chartY,d[1]&&d[1].chartY],p(c.axes,function(a){if(a.zoomEnabled){var b=c.bounds[a.horiz?"h":"v"],d=a.minPixelPadding,e=a.toPixels(q(a.options.min,a.dataMin)),f=a.toPixels(q(a.options.max,a.dataMax)),g=A(e,f),e=v(e,f);b.min=A(a.pos,g-d),b.max=v(a.pos+a.len,e+d)}})):d.length&&(j||(b.selectionMarker=j=s({destroy:pa},c.plotBox)),b.pinchTranslate(d,f,k,j,m,h),b.hasPinched=i,b.scaleGroups(k,m),!i&&e&&g===1&&this.runPointActions(b.normalize(a)))},onContainerTouchStart:function(a){var b=this.chart;ua=b.index,a.touches.length===1?(a=this.normalize(a),b.isInsidePlot(a.chartX-b.plotLeft,a.chartY-b.plotTop)?(this.runPointActions(a),this.pinch(a)):this.reset()):a.touches.length===2&&this.pinch(a)},onContainerTouchMove:function(a){(a.touches.length===1||a.touches.length===2)&&this.pinch(a)},onDocumentTouchEnd:function(a){ba[ua]&&ba[ua].pointer.drop(a)}}),S.PointerEvent||S.MSPointerEvent){var Aa={},Jb=!!S.PointerEvent,fc=function(){var a,b=[];b.item=function(a){return this[a]};for(a in Aa)Aa.hasOwnProperty(a)&&b.push({pageX:Aa[a].pageX,pageY:Aa[a].pageY,target:Aa[a].target});return b},Kb=function(a,b,c,d){a=a.originalEvent||a,(a.pointerType==="touch"||a.pointerType===a.MSPOINTER_TYPE_TOUCH)&&ba[ua]&&(d(a),d=ba[ua].pointer,d[b]({type:c,target:a.currentTarget,preventDefault:pa,touches:fc()}))};s(Za.prototype,{onContainerPointerDown:function(a){Kb(a,"onContainerTouchStart","touchstart",function(a){Aa[a.pointerId]={pageX:a.pageX,pageY:a.pageY,target:a.currentTarget}})},onContainerPointerMove:function(a){Kb(a,"onContainerTouchMove","touchmove",function(a){Aa[a.pointerId]={pageX:a.pageX,pageY:a.pageY},Aa[a.pointerId].target||(Aa[a.pointerId].target=a.currentTarget)})},onDocumentPointerUp:function(a){Kb(a,"onContainerTouchEnd","touchend",function(a){delete Aa[a.pointerId]})},batchMSEvents:function(a){a(this.chart.container,Jb?"pointerdown":"MSPointerDown",this.onContainerPointerDown),a(this.chart.container,Jb?"pointermove":"MSPointerMove",this.onContainerPointerMove),a(D,Jb?"pointerup":"MSPointerUp",this.onDocumentPointerUp)}}),M(Za.prototype,"init",function(a,b,c){a.call(this,b,c),(this.hasZoom||this.followTouchMove)&&K(b.container,{"-ms-touch-action":$,"touch-action":$})}),M(Za.prototype,"setDOMEvents",function(a){a.apply(this),(this.hasZoom||this.followTouchMove)&&this.batchMSEvents(z)}),M(Za.prototype,"destroy",function(a){this.batchMSEvents(U),a.call(this)})}rb=Q.Legend=function(a,b){this.init(a,b)},rb.prototype={init:function(a,b){var c=this,d=b.itemStyle,e=q(b.padding,8),f=b.itemMarginTop||0;this.options=b,b.enabled&&(c.itemStyle=d,c.itemHiddenStyle=x(d,b.itemHiddenStyle),c.itemMarginTop=f,c.padding=e,c.initialItemX=e,c.initialItemY=e-5,c.maxItemWidth=0,c.chart=a,c.itemHeight=0,c.lastLineHeight=0,c.symbolWidth=q(b.symbolWidth,16),c.pages=[],c.render(),z(c.chart,"endResize",function(){c.positionCheckboxes()}))},colorizeItem:function(a,b){var c=this.options,d=a.legendItem,e=a.legendLine,f=a.legendSymbol,g=this.itemHiddenStyle.color,c=b?c.itemStyle.color:g,h=b?a.legendColor||a.color||"#CCC":g,g=a.options&&a.options.marker,i={fill:h},j;if(d&&d.css({fill:c,color:c}),e&&e.attr({stroke:h}),f){if(g&&f.isMarker)for(j in i.stroke=h,g=a.convertAttribs(g),g)d=g[j],d!==r&&(i[j]=d);f.attr(i)}},positionItem:function(a){var b=this.options,c=b.symbolPadding,b=!b.rtl,d=a._legendItemPos,e=d[0],d=d[1],f=a.checkbox;a.legendGroup&&a.legendGroup.translate(b?e:this.legendWidth-e-2*c-4,d),f&&(f.x=e,f.y=d)},destroyItem:function(a){var b=a.checkbox;p(["legendItem","legendLine","legendSymbol","legendGroup"],function(b){a[b]&&(a[b]=a[b].destroy())}),b&&Ua(a.checkbox)},destroy:function(){var a=this.group,b=this.box;b&&(this.box=b.destroy()),a&&(this.group=a.destroy())},positionCheckboxes:function(a){var b=this.group.alignAttr,c,d=this.clipHeight||this.legendHeight;b&&(c=b.translateY,p(this.allItems,function(e){var f=e.checkbox,g;f&&(g=c+f.y+(a||0)+3,K(f,{left:b.translateX+e.checkboxOffset+f.x-20+"px",top:g+"px",display:g>c-6&&g<c+d-6?"":$}))}))},renderTitle:function(){var a=this.padding,b=this.options.title,c=0;b.text&&(this.title||(this.title=this.chart.renderer.label(b.text,a-3,a-4,null,null,null,null,null,"legend-title").attr({zIndex:1}).css(b.style).add(this.group)),a=this.title.getBBox(),c=a.height,this.offsetWidth=a.width,this.contentGroup.attr({translateY:c})),this.titleHeight=c},renderItem:function(a){var b=this.chart,c=b.renderer,d=this.options,e=d.layout==="horizontal",f=this.symbolWidth,g=d.symbolPadding,h=this.itemStyle,i=this.itemHiddenStyle,j=this.padding,k=e?q(d.itemDistance,20):0,l=!d.rtl,m=d.width,n=d.itemMarginBottom||0,o=this.itemMarginTop,y=this.initialItemX,p=a.legendItem,r=a.series&&a.series.drawLegendSymbol?a.series:a,w=r.options,w=this.createCheckboxForItem&&w&&w.showCheckbox,s=d.useHTML;p||(a.legendGroup=c.g("legend-item").attr({zIndex:1}).add(this.scrollGroup),a.legendItem=p=c.text(d.labelFormat?La(d.labelFormat,a):d.labelFormatter.call(a),l?f+g:-g,this.baseline||0,s).css(x(a.visible?h:i)).attr({align:l?"left":"right",zIndex:2}).add(a.legendGroup),this.baseline||(this.baseline=c.fontMetrics(h.fontSize,p).f+3+o,p.attr("y",this.baseline)),r.drawLegendSymbol(this,a),this.setItemEvents&&this.setItemEvents(a,p,s,h,i),this.colorizeItem(a,a.visible),w&&this.createCheckboxForItem(a)),c=p.getBBox(),f=a.checkboxOffset=d.itemWidth||a.legendItemWidth||f+g+c.width+k+(w?20:0),this.itemHeight=g=u(a.legendItemHeight||c.height),e&&this.itemX-y+f>(m||b.chartWidth-2*j-y-d.x)&&(this.itemX=y,this.itemY+=o+this.lastLineHeight+n,this.lastLineHeight=0),this.maxItemWidth=v(this.maxItemWidth,f),this.lastItemY=o+this.itemY+n,this.lastLineHeight=v(g,this.lastLineHeight),a._legendItemPos=[this.itemX,this.itemY],e?this.itemX+=f:(this.itemY+=o+g+n,this.lastLineHeight=g),this.offsetWidth=m||v((e?this.itemX-y-k:f)+j,this.offsetWidth)},getAllItems:function(){var a=[];return p(this.chart.series,function(b){var c=b.options;q(c.showInLegend,t(c.linkedTo)?!1:r,!0)&&(a=a.concat(b.legendItems||(c.legendType==="point"?b.data:b)))}),a},render:function(){var a=this,b=a.chart,c=b.renderer,d=a.group,e,f,g,h,i=a.box,j=a.options,k=a.padding,l=j.borderWidth,m=j.backgroundColor;a.itemX=a.initialItemX,a.itemY=a.initialItemY,a.offsetWidth=0,a.lastItemY=0,d||(a.group=d=c.g("legend").attr({zIndex:7}).add(),a.contentGroup=c.g().attr({zIndex:1}).add(d),a.scrollGroup=c.g().add(a.contentGroup)),a.renderTitle(),e=a.getAllItems(),wb(e,function(a,b){return(a.options&&a.options.legendIndex||0)-(b.options&&b.options.legendIndex||0)}),j.reversed&&e.reverse(),a.allItems=e,a.display=f=!!e.length,p(e,function(b){a.renderItem(b)}),g=j.width||a.offsetWidth,h=a.lastItemY+a.lastLineHeight+a.titleHeight,h=a.handleOverflow(h),(l||m)&&(g+=k,h+=k,i?g>0&&h>0&&(i[i.isNew?"attr":"animate"](i.crisp({width:g,height:h})),i.isNew=!1):(a.b
ox=i=c.rect(0,0,g,h,j.borderRadius,l||0).attr({stroke:j.borderColor,"stroke-width":l||0,fill:m||$}).add(d).shadow(j.shadow),i.isNew=!0),i[f?"show":"hide"]()),a.legendWidth=g,a.legendHeight=h,p(e,function(b){a.positionItem(b)}),f&&d.align(s({width:g,height:h},j),!0,"spacingBox"),b.isResizing||this.positionCheckboxes()},handleOverflow:function(a){var b=this,c=this.chart,d=c.renderer,e=this.options,f=e.y,f=c.spacingBox.height+(e.verticalAlign==="top"?-f:f)-this.padding,g=e.maxHeight,h,i=this.clipRect,j=e.navigation,k=q(j.animation,!0),l=j.arrowSize||12,m=this.nav,n=this.pages,o,y=this.allItems;return e.layout==="horizontal"&&(f/=2),g&&(f=A(f,g)),n.length=0,a>f&&!e.useHTML?(this.clipHeight=h=v(f-20-this.titleHeight-this.padding,0),this.currentPage=q(this.currentPage,1),this.fullHeight=a,p(y,function(a,b){var c=a._legendItemPos[1],d=u(a.legendItem.getBBox().height),e=n.length;(!e||c-n[e-1]>h&&(o||c)!==n[e-1])&&(n.push(o||c),e++),b===y.length-1&&c+d-n[e-1]>h&&n.push(c),c!==o&&(o=c)}),i||(i=b.clipRect=d.clipRect(0,this.padding,9999,0),b.contentGroup.clip(i)),i.attr({height:h}),m||(this.nav=m=d.g().attr({zIndex:1}).add(this.group),this.up=d.symbol("triangle",0,0,l,l).on("click",function(){b.scroll(-1,k)}).add(m),this.pager=d.text("",15,10).css(j.style).add(m),this.down=d.symbol("triangle-down",0,0,l,l).on("click",function(){b.scroll(1,k)}).add(m)),b.scroll(0),a=f):m&&(i.attr({height:c.chartHeight}),m.hide(),this.scrollGroup.attr({translateY:1}),this.clipHeight=0),a},scroll:function(a,b){var c=this.pages,d=c.length,e=this.currentPage+a,f=this.clipHeight,g=this.options.navigation,h=g.activeColor,g=g.inactiveColor,i=this.pager,j=this.padding;e>d&&(e=d),e>0&&(b!==r&&$a(b,this.chart),this.nav.attr({translateX:j,translateY:f+this.padding+7+this.titleHeight,visibility:"visible"}),this.up.attr({fill:e===1?g:h}).css({cursor:e===1?"default":"pointer"}),i.attr({text:e+"/"+d}),this.down.attr({x:18+this.pager.getBBox().width,fill:e===d?g:h}).css({cursor:e===d?"default":"pointer"}),c=-c[e-1]+this.initialItemY,this.scrollGroup.animate({translateY:c}),this.currentPage=e,this.positionCheckboxes(c))}},T=Q.LegendSymbolMixin={drawRectangle:function(a,b){var c=a.options.symbolHeight||12;b.legendSymbol=this.chart.renderer.rect(0,a.baseline-5-c/2,a.symbolWidth,c,a.options.symbolRadius||0).attr({zIndex:3}).add(b.legendGroup)},drawLineMarker:function(a){var b=this.options,c=b.marker,d;d=a.symbolWidth;var e=this.chart.renderer,f=this.legendGroup,a=a.baseline-u(e.fontMetrics(a.options.itemStyle.fontSize,this.legendItem).b*.3),g;b.lineWidth&&(g={"stroke-width":b.lineWidth},b.dashStyle&&(g.dashstyle=b.dashStyle),this.legendLine=e.path(["M",0,a,"L",d,a]).attr(g).add(f)),c&&c.enabled!==!1&&(b=c.radius,this.legendSymbol=d=e.symbol(this.symbol,d/2-b,a-b,2*b,2*b).add(f),d.isMarker=!0)}},(/Trident\/7\.0/.test(Fa)||bb)&&M(rb.prototype,"positionItem",function(a,b){var c=this,d=function(){b._legendItemPos&&a.call(c,b)};d(),setTimeout(d)}),xa.prototype={init:function(a,b){var c,d=a.series,e,f,g;if(a.series=null,c=x(F,a),c.series=a.series=d,this.userOptions=a,d=c.chart,this.margin=this.splashArray("margin",d),this.spacing=this.splashArray("spacing",d),e=d.events,this.bounds={h:{},v:{}},this.callback=b,this.isResizing=0,this.options=c,this.axes=[],this.series=[],this.hasCartesianSeries=d.showAxes,f=this,f.index=ba.length,ba.push(f),fb++,d.reflow!==!1&&z(f,"load",function(){f.initReflow()}),e)for(g in e)z(f,g,e[g]);f.xAxis=[],f.yAxis=[],f.animation=ka?!1:q(d.animation,!0),f.pointCount=f.colorCounter=f.symbolCounter=0,f.firstRender()},initSeries:function(a){var b=this.options.chart;return(b=B[a.type||b.type||b.defaultSeriesType])||oa(17,!0),b=new b,b.init(this,a),b},isInsidePlot:function(a,b,c){var d=c?b:a,a=c?a:b;return d>=0&&d<=this.plotWidth&&a>=0&&a<=this.plotHeight},adjustTickAmounts:function(){this.options.chart.alignTicks!==!1&&p(this.axes,function(a){a.adjustTickAmount()}),this.maxTicks=null},redraw:function(a){var b=this.axes,c=this.series,d=this.pointer,e=this.legend,f=this.isDirtyLegend,g,h,i=this.hasCartesianSeries,j=this.isDirtyBox,k=c.length,l=k,m=this.renderer,n=m.isHidden(),o=[];for($a(a,this),n&&this.cloneRenderTo(),this.layOutTitles();l--;)if(a=c[l],a.options.stacking&&(g=!0,a.isDirty)){h=!0;break}if(h)for(l=k;l--;)(a=c[l],a.options.stacking)&&(a.isDirty=!0);p(c,function(a){a.isDirty&&a.options.legendType==="point"&&(f=!0)}),f&&e.options.enabled&&(e.render(),this.isDirtyLegend=!1),g&&this.getStacks(),i&&(this.isResizing||(this.maxTicks=null,p(b,function(a){a.setScale()})),this.adjustTickAmounts()),this.getMargins(),i&&(p(b,function(a){a.isDirty&&(j=!0)}),p(b,function(a){a.isDirtyExtremes&&(a.isDirtyExtremes=!1,o.push(function(){N(a,"afterSetExtremes",s(a.eventArgs,a.getExtremes())),delete a.eventArgs})),(j||g)&&a.redraw()})),j&&this.drawChartBox(),p(c,function(a){a.isDirty&&a.visible&&(!a.isCartesian||a.xAxis)&&a.redraw()}),d&&d.reset(!0),m.draw(),N(this,"redraw"),n&&this.cloneRenderTo(!0),p(o,function(a){a.call()})},get:function(a){for(var b=this.axes,c=this.series,e,d=0;d<b.length;d++)if(b[d].options.id===a)return b[d];for(d=0;d<c.length;d++)if(c[d].options.id===a)return c[d];for(d=0;d<c.length;d++)for(e=c[d].points||[],b=0;b<e.length;b++)if(e[b].id===a)return e[b];return null},getAxes:function(){var a=this,b=this.options,c=b.xAxis=na(b.xAxis||{}),b=b.yAxis=na(b.yAxis||{});p(c,function(a,b){a.index=b,a.isX=!0}),p(b,function(a,b){a.index=b}),c=c.concat(b),p(c,function(b){new J(a,b)}),a.adjustTickAmounts()},getSelectedPoints:function(){var a=[];return p(this.series,function(b){a=a.concat(pb(b.points||[],function(a){return a.selected}))}),a},getSelectedSeries:function(){return pb(this.series,function(a){return a.selected})},getStacks:function(){var a=this;p(a.yAxis,function(a){a.stacks&&a.hasVisibleSeries&&(a.oldStacks=a.stacks)}),p(a.series,function(b){b.options.stacking&&(b.visible===!0||a.options.chart.ignoreHiddenSeries===!1)&&(b.stackKey=b.type+q(b.options.stack,""))})},setTitle:function(a,b,c){var g,d=this,e=d.options,f;f=e.title=x(e.title,a),g=e.subtitle=x(e.subtitle,b),e=g,p([["title",a,f],["subtitle",b,e]],function(a){var b=a[0],c=d[b],e=a[1],a=a[2];c&&e&&(d[b]=c=c.destroy()),a&&a.text&&!c&&(d[b]=d.renderer.text(a.text,0,0,a.useHTML).attr({align:a.align,"class":"highcharts-"+b,zIndex:a.zIndex||4}).css(a.style).add())}),d.layOutTitles(c)},layOutTitles:function(a){var b=0,c=this.title,d=this.subtitle,e=this.options,f=e.title,e=e.subtitle,g=this.renderer,h=this.spacingBox.width-44;!c||(c.css({width:(f.width||h)+"px"}).align(s({y:g.fontMetrics(f.style.fontSize,c).b-3},f),!1,"spacingBox"),f.floating||f.verticalAlign)||(b=c.getBBox().height),d&&(d.css({width:(e.width||h)+"px"}).align(s({y:b+(f.margin-13)+g.fontMetrics(f.style.fontSize,d).b},e),!1,"spacingBox"),!e.floating&&!e.verticalAlign&&(b=Xa(b+d.getBBox().height))),c=this.titleOffset!==b,this.titleOffset=b,!this.isDirtyBox&&c&&(this.isDirtyBox=c,this.hasRendered&&q(a,!0)&&this.isDirtyBox&&this.redraw())},getChartSize:function(){var a=this.options.chart,b=a.width,a=a.height,c=this.renderToClone||this.renderTo;t(b)||(this.containerWidth=ob(c,"width")),t(a)||(this.containerHeight=ob(c,"height")),this.chartWidth=v(0,b||this.containerWidth||600),this.chartHeight=v(0,q(a,this.containerHeight>19?this.containerHeight:400))},cloneRenderTo:function(a){var b=this.renderToClone,c=this.container;a?b&&(this.renderTo.appendChild(c),Ua(b),delete this.renderToClone):(c&&c.parentNode===this.renderTo&&this.renderTo.removeChild(c),this.renderToClone=b=this.renderTo.cloneNode(0),K(b,{position:"absolute",top:"-9999px",display:"block"}),b.style.setProperty&&b.style.setProperty("display","block","important"),D.body.appendChild(b),c&&b.appendChild(c))},getContainer:function(){var a,b=this.options.chart,c,d,e;this.renderTo=a=b.renderTo,e="highcharts-"+Eb++,Qa(a)&&(this.renderTo=a=D.getElementById(a)),a||oa(13,!0),c=G(Y(a,"data-highcharts-chart")),!isNaN(c)&&ba[c]&&ba[c].hasRendered&&ba[c].destroy(),Y(a,"data-highcharts-chart",this.index),a.innerHTML="",!b.skipClone&&!a.offsetWidth&&this.cloneRenderTo(),this.getChartSize(),c=this.chartWidth,d=this.chartHeight,this.container=a=aa(Va,{className:"highcharts-container"+(b.className?" "+b.className:""),id:e},s({position:"relative",overflow:"hidden",width:c+"px",height:d+"px",textAlign:"left",lineHeight:"normal",zIndex:0,"-webkit-tap-highlight-color":"rgba(0,0,0,0)"},b.style),this.renderToClone||a),this._cursor=a.style.cursor,this.renderer=b.forExport?new la(a,c,d,b.style,!0):new Ya(a,c,d,b.style),ka&&this.renderer.create(this,a,c,d)},getMargins:function(){var a=this.spacing,b,c=this.legend,d=this.margin,e=this.options.legend,f=q(e.margin,20),g=e.x,h=e.y,i=e.align,j=e.verticalAlign,k=this.titleOffset;this.resetMargins(),b=this.axisOffset,k&&!t(d[0])&&(this.plotTop=v(this.plotTop,k+this.options.title.margin+a[0])),c.display&&!e.floating&&(i==="right"?t(d[1])||(this.marginRight=v(this.marginRight,c.legendWidth-g+f+a[1])):i==="left"?t(d[3])||(this.plotLeft=v(this.plotLeft,c.legendWidth+g+f+a[3])):j==="top"?t(d[0])||(this.plotTop=v(this.plotTop,c.legendHeight+h+f+a[0])):j!=="bottom"||t(d[2])||(this.marginBottom=v(this.marginBottom,c.legendHeight-h+f+a[2]))),this.extraBottomMargin&&(this.marginBottom+=this.extraBottomMargin),this.extraTopMargin&&(this.plotTop+=this.extraTopMargin),this.hasCartesianSeries&&p(this.axes,function(a){a.getOffset()}),t(d[3])||(this.plotLeft+=b[3]),t(d[0])||(this.plotTop+=b[0]),t(d[2])||(this.marginBottom+=b[2]),t(d[1])||(this.marginRight+=b[1]),this.setChartSize()},reflow:function(a){var b=this,c=b.options.chart,d=b.renderTo,e=c.width||ob(d,"width"),f=c.height||ob(d,"height"),c=a?a.target:S,d=function(){b.container&&(b.setSize(e,f,!1),b.hasUserSize=null)};!b.hasUserSize&&e&&f&&(c===S||c===D)&&((e!==b.containerWidth||f!==b.containerHeight)&&(clearTimeout(b.reflowTimeout),a?b.reflowTimeout=setTimeout(d,100):d()),b.containerWidth=e,b.containerHeight=f)},initReflow:function(){var
 a=this,b=function(b){a.reflow(b)};z(S,"resize",b),z(a,"destroy",function(){U(S,"resize",b)})},setSize:function(a,b,c){var d=this,e,f,g;d.isResizing+=1,g=function(){d&&N(d,"endResize",null,function(){d.isResizing-=1})},$a(c,d),d.oldChartHeight=d.chartHeight,d.oldChartWidth=d.chartWidth,t(a)&&(d.chartWidth=e=v(0,u(a)),d.hasUserSize=!!e),t(b)&&(d.chartHeight=f=v(0,u(b))),(Ea?qb:K)(d.container,{width:e+"px",height:f+"px"},Ea),d.setChartSize(!0),d.renderer.setSize(e,f,c),d.maxTicks=null,p(d.axes,function(a){a.isDirty=!0,a.setScale()}),p(d.series,function(a){a.isDirty=!0}),d.isDirtyLegend=!0,d.isDirtyBox=!0,d.layOutTitles(),d.getMargins(),d.redraw(c),d.oldChartHeight=null,N(d,"resize"),Ea===!1?g():setTimeout(g,Ea&&Ea.duration||500)},setChartSize:function(a){var b=this.inverted,c=this.renderer,d=this.chartWidth,e=this.chartHeight,f=this.options.chart,g=this.spacing,h=this.clipOffset,i,j,k,l;this.plotLeft=i=u(this.plotLeft),this.plotTop=j=u(this.plotTop),this.plotWidth=k=v(0,u(d-i-this.marginRight)),this.plotHeight=l=v(0,u(e-j-this.marginBottom)),this.plotSizeX=b?l:k,this.plotSizeY=b?k:l,this.plotBorderWidth=f.plotBorderWidth||0,this.spacingBox=c.spacingBox={x:g[3],y:g[0],width:d-g[3]-g[1],height:e-g[0]-g[2]},this.plotBox=c.plotBox={x:i,y:j,width:k,height:l},d=2*V(this.plotBorderWidth/2),b=Xa(v(d,h[3])/2),c=Xa(v(d,h[0])/2),this.clipBox={x:b,y:c,width:V(this.plotSizeX-v(d,h[1])/2-b),height:v(0,V(this.plotSizeY-v(d,h[2])/2-c))},a||p(this.axes,function(a){a.setAxisSize(),a.setAxisTranslation()})},resetMargins:function(){var a=this.spacing,b=this.margin;this.plotTop=q(b[0],a[0]),this.marginRight=q(b[1],a[1]),this.marginBottom=q(b[2],a[2]),this.plotLeft=q(b[3],a[3]),this.axisOffset=[0,0,0,0],this.clipOffset=[0,0,0,0]},drawChartBox:function(){var a=this.options.chart,b=this.renderer,c=this.chartWidth,d=this.chartHeight,e=this.chartBackground,f=this.plotBackground,g=this.plotBorder,h=this.plotBGImage,i=a.borderWidth||0,j=a.backgroundColor,k=a.plotBackgroundColor,l=a.plotBackgroundImage,m=a.plotBorderWidth||0,n,o=this.plotLeft,y=this.plotTop,q=this.plotWidth,p=this.plotHeight,w=this.plotBox,r=this.clipRect,u=this.clipBox;n=i+(a.shadow?8:0),(i||j)&&(e?e.animate(e.crisp({width:c-n,height:d-n})):(e={fill:j||$},i&&(e.stroke=a.borderColor,e["stroke-width"]=i),this.chartBackground=b.rect(n/2,n/2,c-n,d-n,a.borderRadius,i).attr(e).addClass("highcharts-background").add().shadow(a.shadow))),k&&(f?f.animate(w):this.plotBackground=b.rect(o,y,q,p,0).attr({fill:k}).add().shadow(a.plotShadow)),l&&(h?h.animate(w):this.plotBGImage=b.image(l,o,y,q,p).add()),r?r.animate({width:u.width,height:u.height}):this.clipRect=b.clipRect(u),m&&(g?g.animate(g.crisp({x:o,y:y,width:q,height:p})):this.plotBorder=b.rect(o,y,q,p,0,-m).attr({stroke:a.plotBorderColor,"stroke-width":m,fill:$,zIndex:1}).add()),this.isDirtyBox=!1},propFromSeries:function(){var a=this,b=a.options.chart,c,d=a.options.series,e,f;p(["inverted","angular","polar"],function(g){for(c=B[b.type||b.defaultSeriesType],f=a[g]||b[g]||c&&c.prototype[g],e=d&&d.length;!f&&e--;)(c=B[d[e].type])&&c.prototype[g]&&(f=!0);a[g]=f})},linkSeries:function(){var a=this,b=a.series;p(b,function(a){a.linkedSeries.length=0}),p(b,function(b){var d=b.options.linkedTo;Qa(d)&&(d=d===":previous"?a.series[b.index-1]:a.get(d))&&(d.linkedSeries.push(b),b.linkedParent=d)})},renderSeries:function(){p(this.series,function(a){a.translate(),a.setTooltipPoints&&a.setTooltipPoints(),a.render()})},renderLabels:function(){var a=this,b=a.options.labels;b.items&&p(b.items,function(c){var d=s(b.style,c.style),e=G(d.left)+a.plotLeft,f=G(d.top)+a.plotTop+12;delete d.left,delete d.top,a.renderer.text(c.html,e,f).attr({zIndex:2}).css(d).add()})},render:function(){var a=this.axes,b=this.renderer,c=this.options;this.setTitle(),this.legend=new rb(this,c.legend),this.getStacks(),p(a,function(a){a.setScale()}),this.getMargins(),this.maxTicks=null,p(a,function(a){a.setTickPositions(!0),a.setMaxTicks()}),this.adjustTickAmounts(),this.getMargins(),this.drawChartBox(),this.hasCartesianSeries&&p(a,function(a){a.render()}),this.seriesGroup||(this.seriesGroup=b.g("series-group").attr({zIndex:3}).add()),this.renderSeries(),this.renderLabels(),this.showCredits(c.credits),this.hasRendered=!0},showCredits:function(a){a.enabled&&!this.credits&&(this.credits=this.renderer.text(a.text,0,0).on("click",function(){a.href&&(location.href=a.href)}).attr({align:a.position.align,zIndex:8}).css(a.style).add().align(a.position))},destroy:function(){var a=this,b=a.axes,c=a.series,d=a.container,e,f=d&&d.parentNode;for(N(a,"destroy"),ba[a.index]=r,fb--,a.renderTo.removeAttribute("data-highcharts-chart"),U(a),e=b.length;e--;)b[e]=b[e].destroy();for(e=c.length;e--;)c[e]=c[e].destroy();p("title,subtitle,chartBackground,plotBackground,plotBGImage,plotBorder,seriesGroup,clipRect,credits,pointer,scroller,rangeSelector,legend,resetZoomButton,tooltip,renderer".split(","),function(b){var c=a[b];c&&c.destroy&&(a[b]=c.destroy())}),d&&(d.innerHTML="",U(d),f&&Ua(d));for(e in a)delete a[e]},isReadyToRender:function(){var a=this;return!da&&S==S.top&&D.readyState!=="complete"||ka&&!S.canvg?(ka?Ub.push(function(){a.firstRender()},a.options.global.canvasToolsURL):D.attachEvent("onreadystatechange",function(){D.detachEvent("onreadystatechange",a.firstRender),D.readyState==="complete"&&a.firstRender()}),!1):!0},firstRender:function(){var a=this,b=a.options,c=a.callback;a.isReadyToRender()&&(a.getContainer(),N(a,"init"),a.resetMargins(),a.setChartSize(),a.propFromSeries(),a.getAxes(),p(b.series||[],function(b){a.initSeries(b)}),a.linkSeries(),N(a,"beforeRender"),Q.Pointer&&(a.pointer=new Za(a,b)),a.render(),a.renderer.draw(),c&&c.apply(a,[a]),p(a.callbacks,function(b){b.apply(a,[a])}),a.cloneRenderTo(!0),N(a,"load"))},splashArray:function(a,b){var c=b[a],c=ga(c)?c:[c,c,c,c];return[q(b[a+"Top"],c[0]),q(b[a+"Right"],c[1]),q(b[a+"Bottom"],c[2]),q(b[a+"Left"],c[3])]}},xa.prototype.callbacks=[],fa=Q.CenteredSeriesMixin={getCenter:function(){var a=this.options,b=this.chart,c=2*(a.slicedOffset||0),d,e=b.plotWidth-2*c,f=b.plotHeight-2*c,b=a.center,a=[q(b[0],"50%"),q(b[1],"50%"),a.size||"100%",a.innerSize||0],g=A(e,f),h;return za(a,function(a,b){return h=/%$/.test(a),d=b<2||b===2&&h,(h?[e,f,g,g][b]*G(a)/100:a)+(d?c:0)})}},Ba=function(){},Ba.prototype={init:function(a,b,c){return this.series=a,this.applyOptions(b,c),this.pointAttr={},a.options.colorByPoint&&(b=a.options.colors||a.chart.options.colors,this.color=this.color||b[a.colorCounter++],a.colorCounter===b.length)&&(a.colorCounter=0),a.chart.pointCount++,this},applyOptions:function(a,b){var c=this.series,d=c.options.pointValKey||c.pointValKey,a=Ba.prototype.optionsToObject.call(this,a);return s(this,a),this.options=this.options?s(this.options,a):a,d&&(this.y=this[d]),this.x===r&&c&&(this.x=b===r?c.autoIncrement():b),this},optionsToObject:function(a){var b={},c=this.series,d=c.pointArrayMap||["y"],e=d.length,f=0,g=0;if(typeof a=="number"||a===null)b[d[0]]=a;else if(Ra(a))for(a.length>e&&(c=typeof a[0],c==="string"?b.name=a[0]:c==="number"&&(b.x=a[0]),f++);g<e;)b[d[g++]]=a[f++];else typeof a=="object"&&(b=a,a.dataLabels&&(c._hasPointLabels=!0),a.marker&&(c._hasPointMarkers=!0));return b},destroy:function(){var a=this.series.chart,b=a.hoverPoints,c;a.pointCount--,b&&(this.setState(),sa(b,this),!b.length)&&(a.hoverPoints=null),this===a.hoverPoint&&this.onMouseOut(),(this.graphic||this.dataLabel)&&(U(this),this.destroyElements()),this.legendItem&&a.legend.destroyItem(this);for(c in this)this[c]=null},destroyElements:function(){for(var a="graphic,dataLabel,dataLabelUpper,group,connector,shadowGroup".split(","),b,c=6;c--;)b=a[c],this[b]&&(this[b]=this[b].destroy())},getLabelConfig:function(){return{x:this.category,y:this.y,key:this.name||this.category,series:this.series,point:this,percentage:this.percentage,total:this.total||this.stackTotal}},tooltipFormatter:function(a){var b=this.series,c=b.tooltipOptions,d=q(c.valueDecimals,""),e=c.valuePrefix||"",f=c.valueSuffix||"";return p(b.pointArrayMap||["y"],function(b){b="{point."+b,(e||f)&&(a=a.replace(b+"}",e+b+"}"+f)),a=a.replace(b+"}",b+":,."+d+"f}")}),La(a,{point:this,series:this.series})},firePointEvent:function(a,b,c){var d=this,e=this.series.options;(e.point.events[a]||d.options&&d.options.events&&d.options.events[a])&&this.importEvents(),a==="click"&&e.allowPointSelect&&(c=function(a){d.select(null,a.ctrlKey||a.metaKey||a.shiftKey)}),N(this,a,b,c)}},L=function(){},L.prototype={isCartesian:!0,type:"line",pointClass:Ba,sorted:!0,requireSorting:!0,pointAttrToOptions:{stroke:"lineColor","stroke-width":"lineWidth",fill:"fillColor",r:"radius"},axisTypes:["xAxis","yAxis"],colorCounter:0,parallelArrays:["x","y"],init:function(a,b){var c=this,d,e,f=a.series,g=function(a,b){return q(a.options.index,a._i)-q(b.options.index,b._i)};c.chart=a,c.options=b=c.setOptions(b),c.linkedSeries=[],c.bindAxes(),s(c,{name:b.name,state:"",pointAttr:{},visible:b.visible!==!1,selected:b.selected===!0}),ka&&(b.animation=!1),e=b.events;for(d in e)z(c,d,e[d]);(e&&e.click||b.point&&b.point.events&&b.point.events.click||b.allowPointSelect)&&(a.runTrackerClick=!0),c.getColor(),c.getSymbol(),p(c.parallelArrays,function(a){c[a+"Data"]=[]}),c.setData(b.data,!1),c.isCartesian&&(a.hasCartesianSeries=!0),f.push(c),c._i=f.length-1,wb(f,g),this.yAxis&&wb(this.yAxis.series,g),p(f,function(a,b){a.index=b,a.name=a.name||"Series "+(b+1)})},bindAxes:function(){var a=this,b=a.options,c=a.chart,d;p(a.axisTypes||[],function(e){p(c[e],function(c){d=c.options,(b[e]===d.index||b[e]!==r&&b[e]===d.id||b[e]===r&&d.index===0)&&(c.series.push(a),a[e]=c,c.isDirty=!0)}),!a[e]&&a.optionalAxis!==e&&oa(18,!0)})},updateParallelArrays:function(a,b){var c=a.series,d=arguments;p(c.parallelArrays,typeof b=="number"?function(d){var f=d==="y"&&c.toYData?c.toYData(a):a[d];c[d+"Data"][b]=f}:function(a){Array.prototype[b].apply(c[a+"Data"],Array.prototype.slice.call(d,2))})},autoIncrement:function(){var
 a=this.options,b=this.xIncrement,b=q(b,a.pointStart,0);return this.pointInterval=q(this.pointInterval,a.pointInterval,1),this.xIncrement=b+this.pointInterval,b},getSegments:function(){var a=-1,b=[],c,d=this.points,e=d.length;if(e)if(this.options.connectNulls){for(c=e;c--;)d[c].y===null&&d.splice(c,1);d.length&&(b=[d])}else p(d,function(c,g){c.y===null?(g>a+1&&b.push(d.slice(a+1,g)),a=g):g===e-1&&b.push(d.slice(a+1,g+1))});this.segments=b},setOptions:function(a){var b=this.chart,c=b.options.plotOptions,b=b.userOptions||{},d=b.plotOptions||{},e=c[this.type];return this.userOptions=a,c=x(e,c.series,a),this.tooltipOptions=x(F.tooltip,F.plotOptions[this.type].tooltip,b.tooltip,d.series&&d.series.tooltip,d[this.type]&&d[this.type].tooltip,a.tooltip),e.marker===null&&delete c.marker,c},getCyclic:function(a,b,c){var d=this.userOptions,e="_"+a+"Index",f=a+"Counter";b||(t(d[e])?b=d[e]:(d[e]=b=this.chart[f]%c.length,this.chart[f]+=1),b=c[b]),this[a]=b},getColor:function(){this.options.colorByPoint||this.getCyclic("color",this.options.color||W[this.type].color,this.chart.options.colors)},getSymbol:function(){var a=this.options.marker;this.getCyclic("symbol",a.symbol,this.chart.options.symbols),/^url/.test(this.symbol)&&(a.radius=0)},drawLegendSymbol:T.drawLineMarker,setData:function(a,b,c,d){var e=this,f=e.points,g=f&&f.length||0,h,i=e.options,j=e.chart,k=null,l=e.xAxis,m=l&&!!l.categories,n=e.tooltipPoints,o=i.turboThreshold,y=this.xData,I=this.yData,u=(h=e.pointArrayMap)&&h.length,a=a||[];if(h=a.length,b=q(b,!0),d===!1||!h||g!==h||e.cropped||e.hasGroupedData){if(e.xIncrement=null,e.pointRange=m?1:i.pointRange,e.colorCounter=0,p(this.parallelArrays,function(a){e[a+"Data"].length=0}),o&&h>o){for(c=0;k===null&&c<h;)k=a[c],c++;if(ma(k)){for(m=q(i.pointStart,0),i=q(i.pointInterval,1),c=0;c<h;c++)y[c]=m,I[c]=a[c],m+=i;e.xIncrement=m}else if(Ra(k))if(u)for(c=0;c<h;c++)i=a[c],y[c]=i[0],I[c]=i.slice(1,u+1);else for(c=0;c<h;c++)i=a[c],y[c]=i[0],I[c]=i[1];else oa(12)}else for(c=0;c<h;c++)a[c]!==r&&(i={series:e},e.pointClass.prototype.applyOptions.apply(i,[a[c]]),e.updateParallelArrays(i,c),m&&i.name)&&(l.names[i.x]=i.name);for(Qa(I[0])&&oa(14,!0),e.data=[],e.options.data=a,c=g;c--;)f[c]&&f[c].destroy&&f[c].destroy();n&&(n.length=0),l&&(l.minRange=l.userMinRange),e.isDirty=e.isDirtyData=j.isDirtyBox=!0,c=!1}else p(a,function(a,b){f[b].update(a,!1)});b&&j.redraw(c)},processData:function(a){var b=this.xData,c=this.yData,d=b.length,e;e=0;var f,g,h=this.xAxis,i=this.options,j=i.cropThreshold,k=0,l=this.isCartesian,m,n;if(l&&!this.isDirty&&!h.isDirty&&!this.yAxis.isDirty&&!a)return!1;for(l&&this.sorted&&(!j||d>j||this.forceCrop)&&((m=h.getExtremes(),n=m.min,m=m.max,b[d-1]<n||b[0]>m)?(b=[],c=[]):(b[0]<n||b[d-1]>m)&&(e=this.cropData(this.xData,this.yData,n,m),b=e.xData,c=e.yData,e=e.start,f=!0,k=b.length)),a=b.length-1;a>=0;a--)d=b[a]-b[a-1],!f&&b[a]>n&&b[a]<m&&k++,d>0&&(g===r||d<g)?g=d:d<0&&this.requireSorting&&oa(15);this.cropped=f,this.cropStart=e,this.processedXData=b,this.processedYData=c,this.activePointCount=k,i.pointRange===null&&(this.pointRange=g||1),this.closestPointRange=g},cropData:function(a,b,c,d){for(var e=a.length,f=0,g=e,h=q(this.cropShoulder,1),i=0;i<e;i++)if(a[i]>=c){f=v(0,i-h);break}for(;i<e;i++)if(a[i]>d){g=i+h;break}return{xData:a.slice(f,g),yData:b.slice(f,g),start:f,end:g}},generatePoints:function(){var a=this.options.data,b=this.data,c,d=this.processedXData,e=this.processedYData,f=this.pointClass,g=d.length,h=this.cropStart||0,i,j=this.hasGroupedData,k,l=[],m;for(b||j||(b=[],b.length=a.length,b=this.data=b),m=0;m<g;m++)i=h+m,j?l[m]=(new f).init(this,[d[m]].concat(na(e[m]))):(b[i]?k=b[i]:a[i]!==r&&(b[i]=k=(new f).init(this,a[i],d[m])),l[m]=k);if(b&&(g!==(c=b.length)||j))for(m=0;m<c;m++)(m===h&&!j&&(m+=g),b[m])&&(b[m].destroyElements(),b[m].plotX=r);this.data=b,this.points=l},getExtremes:function(a){var b=this.yAxis,c=this.processedXData,d,e=[],f=0;d=this.xAxis.getExtremes();var g=d.min,h=d.max,i,j,k,l,a=a||this.stackedYData||this.processedYData;for(d=a.length,l=0;l<d;l++)if(j=c[l],k=a[l],i=k!==null&&k!==r&&(!b.isLog||k.length||k>0),j=this.getExtremesFromAll||this.cropped||(c[l+1]||j)>=g&&(c[l-1]||j)<=h,i&&j)if(i=k.length)for(;i--;)k[i]!==null&&(e[f++]=k[i]);else e[f++]=k;this.dataMin=q(void 0,Ta(e)),this.dataMax=q(void 0,Da(e))},translate:function(){this.processedXData||this.processData(),this.generatePoints();for(var a=this.options,b=a.stacking,c=this.xAxis,d=c.categories,e=this.yAxis,f=this.points,g=f.length,h=!!this.modifyValue,i=a.pointPlacement,j=i==="between"||ma(i),k=a.threshold,a=0;a<g;a++){var l=f[a],m=l.x,n=l.y,o=l.low,y=b&&e.stacks[(this.negStacks&&n<k?"-":"")+this.stackKey];e.isLog&&n<=0&&(l.y=n=null),l.plotX=c.translate(m,0,0,0,1,i,this.type==="flags"),b&&this.visible&&y&&y[m]&&(y=y[m],n=y.points[this.index+","+a],o=n[0],n=n[1],o===0&&(o=q(k,e.min)),e.isLog&&o<=0&&(o=null),l.total=l.stackTotal=y.total,l.percentage=y.total&&l.y/y.total*100,l.stackY=n,y.setOffset(this.pointXOffset||0,this.barW||0)),l.yBottom=t(o)?e.translate(o,0,1,0,1):null,h&&(n=this.modifyValue(n,l)),l.plotY=typeof n=="number"&&n!==Infinity?e.translate(n,0,1,0,1):r,l.clientX=j?c.translate(m,0,0,0,1):l.plotX,l.negative=l.y<(k||0),l.category=d&&d[l.x]!==r?d[l.x]:l.x}this.getSegments()},animate:function(a){var b=this.chart,c=b.renderer,d,e,f,g;d=this.options.animation,e=this.clipBox||b.clipBox,f=b.inverted,d&&!ga(d)&&(d=W[this.type].animation),g=["_sharedClip",d.duration,d.easing,e.height].join(","),a?(a=b[g],d=b[g+"m"],a||(b[g]=a=c.clipRect(s(e,{width:0})),b[g+"m"]=d=c.clipRect(-99,f?-b.plotLeft:-b.plotTop,99,f?b.chartWidth:b.chartHeight)),this.group.clip(a),this.markerGroup.clip(d),this.sharedClipKey=g):((a=b[g])&&a.animate({width:b.plotSizeX},d),b[g+"m"]&&b[g+"m"].animate({width:b.plotSizeX+99},d),this.animate=null)},afterAnimate:function(){var a=this.chart,b=this.sharedClipKey,c=this.group,d=this.clipBox;c&&this.options.clip!==!1&&(b&&d||c.clip(d?a.renderer.clipRect(d):a.clipRect),this.markerGroup.clip()),N(this,"afterAnimate"),setTimeout(function(){b&&a[b]&&(d||(a[b]=a[b].destroy()),a[b+"m"]&&(a[b+"m"]=a[b+"m"].destroy()))},100)},drawPoints:function(){var a,b=this.points,c=this.chart,d,e,f,g,h,i,j,k;d=this.options.marker;var l=this.pointAttr[""],m,n=this.markerGroup,o=q(d.enabled,this.activePointCount<.5*this.xAxis.len/d.radius);if(d.enabled!==!1||this._hasPointMarkers)for(f=b.length;f--;)(g=b[f],d=V(g.plotX),e=g.plotY,k=g.graphic,i=g.marker||{},a=o&&i.enabled===r||i.enabled,m=c.isInsidePlot(u(d),e,c.inverted),a&&e!==r&&!isNaN(e)&&g.y!==null)?(a=g.pointAttr[g.selected?"select":""]||l,h=a.r,i=q(i.symbol,this.symbol),j=i.indexOf("url")===0,k)?k[m?"show":"hide"](!0).animate(s({x:d-h,y:e-h},k.symbolName?{width:2*h,height:2*h}:{})):m&&(h>0||j)&&(g.graphic=c.renderer.symbol(i,d-h,e-h,2*h,2*h).attr(a).add(n)):k&&(g.graphic=k.destroy())},convertAttribs:function(a,b,c,d){var e=this.pointAttrToOptions,f,g,h={},a=a||{},b=b||{},c=c||{},d=d||{};for(f in e)g=e[f],h[f]=q(a[g],b[f],c[f],d[f]);return h},getAttribs:function(){var a=this,b=a.options,c=W[a.type].marker?b.marker:b,d=c.states,e=d.hover,f,g=a.color,q;f={stroke:g,fill:g};var h=a.points||[],i,j=[],k,l=a.pointAttrToOptions;k=a.hasPointSpecificOptions;var m=b.negativeColor,n=c.lineColor,o=c.fillColor;if(i=b.turboThreshold,b.marker?(e.radius=e.radius||c.radius+e.radiusPlus,e.lineWidth=e.lineWidth||c.lineWidth+e.lineWidthPlus):e.color=e.color||Ha(e.color||g).brighten(e.brightness).get(),j[""]=a.convertAttribs(c,f),p(["hover","select"],function(b){j[b]=a.convertAttribs(d[b],j[""])}),a.pointAttr=j,g=h.length,!i||g<i||k)for(;g--;){if(i=h[g],(c=i.options&&i.options.marker||i.options)&&c.enabled===!1&&(c.radius=0),i.negative&&m&&(i.color=i.fillColor=m),k=b.colorByPoint||i.color,i.options)for(q in l)t(c[l[q]])&&(k=!0);k?(c=c||{},k=[],d=c.states||{},f=d.hover=d.hover||{},b.marker||(f.color=f.color||!i.options.color&&e.color||Ha(i.color).brighten(f.brightness||e.brightness).get()),f={color:i.color},o||(f.fillColor=i.color),n||(f.lineColor=i.color),k[""]=a.convertAttribs(s(f,c),j[""]),k.hover=a.convertAttribs(d.hover,j.hover,k[""]),k.select=a.convertAttribs(d.select,j.select,k[""])):k=j,i.pointAttr=k}},destroy:function(){var a=this,b=a.chart,c=/AppleWebKit\/533/.test(Fa),d,e,f=a.data||[],g,h,i;for(N(a,"destroy"),U(a),p(a.axisTypes||[],function(b){(i=a[b])&&(sa(i.series,a),i.isDirty=i.forceRedraw=!0)}),a.legendItem&&a.chart.legend.destroyItem(a),e=f.length;e--;)(g=f[e])&&g.destroy&&g.destroy();a.points=null,clearTimeout(a.animationTimeout),p("area,graph,dataLabelsGroup,group,markerGroup,tracker,graphNeg,areaNeg,posClip,negClip".split(","),function(b){a[b]&&(d=c&&b==="group"?"hide":"destroy",a[b][d]())}),b.hoverSeries===a&&(b.hoverSeries=null),sa(b.series,a);for(h in a)delete a[h]},getSegmentPath:function(a){var b=this,c=[],d=b.options.step;return p(a,function(e,f){var g=e.plotX,h=e.plotY,i;b.getPointSpline?c.push.apply(c,b.getPointSpline(a,e,f)):(c.push(f?"L":"M"),d&&f&&(i=a[f-1],d==="right"?c.push(i.plotX,h):d==="center"?c.push((i.plotX+g)/2,i.plotY,(i.plotX+g)/2,h):c.push(g,i.plotY)),c.push(e.plotX,e.plotY))}),c},getGraphPath:function(){var a=this,b=[],c,d=[];return p(a.segments,function(e){c=a.getSegmentPath(e),e.length>1?b=b.concat(c):d.push(e[0])}),a.singlePoints=d,a.graphPath=b},drawGraph:function(){var a=this,b=this.options,c=[["graph",b.lineColor||this.color]],d=b.lineWidth,e=b.dashStyle,f=b.linecap!=="square",g=this.getGraphPath(),h=b.negativeColor;h&&c.push(["graphNeg",h]),p(c,function(c,h){var k=c[0],l=a[k];l?(gb(l),l.animate({d:g})):d&&g.length&&(l={stroke:c[1],"stroke-width":d,fill:$,zIndex:1},e?l.dashstyle=e:f&&(l["stroke-linecap"]=l["stroke-linejoin"]="round"),a[k]=a.chart.renderer.path(g).attr(l).add(a.group).shadow(!h&&b.shadow))})},clipNeg:function(){var a=this.options,b=this.chart,c=b.renderer,d=a.negativeColor||a.negativeFillColor,e,f=this.graph,g=this.area,h=this.posClip,i=this.negClip;e=b.chartWidth;var
 j=b.chartHeight,k=v(e,j),l=this.yAxis;d&&(f||g)&&(d=u(l.toPixels(a.threshold||0,!0)),d<0&&(k-=d),a={x:0,y:0,width:k,height:d},k={x:0,y:d,width:k,height:k},b.inverted&&(a.height=k.y=b.plotWidth-d,c.isVML&&(a={x:b.plotWidth-d-b.plotLeft,y:0,width:e,height:j},k={x:d+b.plotLeft-e,y:0,width:b.plotLeft+d,height:e})),l.reversed?(b=k,e=a):(b=a,e=k),h?(h.animate(b),i.animate(e)):(this.posClip=h=c.clipRect(b),this.negClip=i=c.clipRect(e),f&&this.graphNeg&&(f.clip(h),this.graphNeg.clip(i)),g&&(g.clip(h),this.areaNeg.clip(i))))},invertGroups:function(){function a(){var a={width:b.yAxis.len,height:b.xAxis.len};p(["group","markerGroup"],function(c){b[c]&&b[c].attr(a).invert()})}var b=this,c=b.chart;b.xAxis&&(z(c,"resize",a),z(b,"destroy",function(){U(c,"resize",a)}),a(),b.invertGroups=a)},plotGroup:function(a,b,c,d,e){var f=this[a],g=!f;return g&&(this[a]=f=this.chart.renderer.g(b).attr({visibility:c,zIndex:d||.1}).add(e)),f[g?"attr":"animate"](this.getPlotBox()),f},getPlotBox:function(){var a=this.chart,b=this.xAxis,c=this.yAxis;return a.inverted&&(b=c,c=this.xAxis),{translateX:b?b.left:a.plotLeft,translateY:c?c.top:a.plotTop,scaleX:1,scaleY:1}},render:function(){var a=this,b=a.chart,c,d=a.options,e=(c=d.animation)&&!!a.animate&&b.renderer.isSVG&&q(c.duration,500)||0,f=a.visible?"visible":"hidden",g=d.zIndex,h=a.hasRendered,i=b.seriesGroup;c=a.plotGroup("group","series",f,g,i),a.markerGroup=a.plotGroup("markerGroup","markers",f,g,i),e&&a.animate(!0),a.getAttribs(),c.inverted=a.isCartesian?b.inverted:!1,a.drawGraph&&(a.drawGraph(),a.clipNeg()),a.drawDataLabels&&a.drawDataLabels(),a.visible&&a.drawPoints(),a.drawTracker&&a.options.enableMouseTracking!==!1&&a.drawTracker(),b.inverted&&a.invertGroups(),d.clip!==!1&&!a.sharedClipKey&&!h&&c.clip(b.clipRect),e&&a.animate(),h||(e?a.animationTimeout=setTimeout(function(){a.afterAnimate()},e):a.afterAnimate()),a.isDirty=a.isDirtyData=!1,a.hasRendered=!0},redraw:function(){var a=this.chart,b=this.isDirtyData,c=this.group,d=this.xAxis,e=this.yAxis;c&&(a.inverted&&c.attr({width:a.plotWidth,height:a.plotHeight}),c.animate({translateX:q(d&&d.left,a.plotLeft),translateY:q(e&&e.top,a.plotTop)})),this.translate(),this.setTooltipPoints&&this.setTooltipPoints(!0),this.render(),b&&N(this,"updatedData")}},Qb.prototype={destroy:function(){Ma(this,this.axis)},render:function(a){var b=this.options,c=b.format,c=c?La(c,this):b.formatter.call(this);this.label?this.label.attr({text:c,visibility:"hidden"}):this.label=this.axis.chart.renderer.text(c,null,null,b.useHTML).css(b.style).attr({align:this.textAlign,rotation:b.rotation,visibility:"hidden"}).add(a)},setOffset:function(a,b){var c=this.axis,d=c.chart,e=d.inverted,f=this.isNegative,g=c.translate(c.usePercentage?100:this.total,0,0,0,1),c=c.translate(0),c=P(g-c),h=d.xAxis[0].translate(this.x)+a,i=d.plotHeight,f={x:e?f?g:g-c:h,y:e?i-h-b:f?i-g-c:i-g,width:e?c:b,height:e?b:c};(e=this.label)&&(e.align(this.alignOptions,null,f),f=e.alignAttr,e[this.options.crop===!1||d.isInsidePlot(f.x,f.y)?"show":"hide"](!0))}},J.prototype.buildStacks=function(){var a=this.series,b=q(this.options.reversedStacks,!0),c=a.length;if(!this.isXAxis){for(this.usePercentage=!1;c--;)a[b?c:a.length-c-1].setStackedPoints();if(this.usePercentage)for(c=0;c<a.length;c++)a[c].setPercentStacks()}},J.prototype.renderStackTotals=function(){var a=this.chart,b=a.renderer,c=this.stacks,d,e,f=this.stackTotalGroup;f||(this.stackTotalGroup=f=b.g("stack-labels").attr({visibility:"visible",zIndex:6}).add()),f.translate(a.plotLeft,a.plotTop);for(d in c)for(e in a=c[d],a)a[e].render(f)},L.prototype.setStackedPoints=function(){if(this.options.stacking&&!(this.visible!==!0&&this.chart.options.chart.ignoreHiddenSeries!==!1)){for(var a=this.processedXData,b=this.processedYData,c=[],d=b.length,e=this.options,f=e.threshold,g=e.stack,e=e.stacking,h=this.stackKey,i="-"+h,j=this.negStacks,k=this.yAxis,l=k.stacks,m=k.oldStacks,n,o,q,r,w,p=0;p<d;p++)r=a[p],w=b[p],q=this.index+","+p,o=(n=j&&w<f)?i:h,l[o]||(l[o]={}),l[o][r]||(m[o]&&m[o][r]?(l[o][r]=m[o][r],l[o][r].total=null):l[o][r]=new Qb(k,k.options.stackLabels,n,r,g)),o=l[o][r],o.points[q]=[o.cum||0],e==="percent"?(n=n?h:i,j&&l[n]&&l[n][r]?(n=l[n][r],o.total=n.total=v(n.total,o.total)+P(w)||0):o.total=ia(o.total+(P(w)||0))):o.total=ia(o.total+(w||0)),o.cum=(o.cum||0)+(w||0),o.points[q].push(o.cum),c[p]=o.cum;e==="percent"&&(k.usePercentage=!0),this.stackedYData=c,k.oldStacks={}}},L.prototype.setPercentStacks=function(){var a=this,b=a.stackKey,c=a.yAxis.stacks,d=a.processedXData;p([b,"-"+b],function(b){for(var e,g,h,f=d.length;f--;)(g=d[f],e=(h=c[b]&&c[b][g])&&h.points[a.index+","+f],g=e)&&(h=h.total?100/h.total:0,g[0]=ia(g[0]*h),g[1]=ia(g[1]*h),a.stackedYData[f]=g[1])})},s(xa.prototype,{addSeries:function(a,b,c){var d,e=this;return a&&(b=q(b,!0),N(e,"addSeries",{options:a},function(){d=e.initSeries(a),e.isDirtyLegend=!0,e.linkSeries(),b&&e.redraw(c)})),d},addAxis:function(a,b,c,d){var e=b?"xAxis":"yAxis",f=this.options;new J(this,x(a,{index:this[e].length,isX:b})),f[e]=na(f[e]||{}),f[e].push(a),q(c,!0)&&this.redraw(d)},showLoading:function(a){var b=this,c=b.options,d=b.loadingDiv,e=c.loading,f=function(){d&&K(d,{left:b.plotLeft+"px",top:b.plotTop+"px",width:b.plotWidth+"px",height:b.plotHeight+"px"})};d||(b.loadingDiv=d=aa(Va,{className:"highcharts-loading"},s(e.style,{zIndex:10,display:$}),b.container),b.loadingSpan=aa("span",null,e.labelStyle,d),z(b,"redraw",f)),b.loadingSpan.innerHTML=a||c.lang.loading,b.loadingShown||(K(d,{opacity:0,display:""}),qb(d,{opacity:e.style.opacity},{duration:e.showDuration||0}),b.loadingShown=!0),f()},hideLoading:function(){var a=this.options,b=this.loadingDiv;b&&qb(b,{opacity:0},{duration:a.loading.hideDuration||100,complete:function(){K(b,{display:$})}}),this.loadingShown=!1}}),s(Ba.prototype,{update:function(a,b,c){var d=this,e=d.series,f=d.graphic,g,h=e.data,i=e.chart,j=e.options,b=q(b,!0);d.firePointEvent("update",{options:a},function(){d.applyOptions(a),ga(a)&&(e.getAttribs(),f&&(a&&a.marker&&a.marker.symbol?d.graphic=f.destroy():f.attr(d.pointAttr[d.state||""])),a&&a.dataLabels&&d.dataLabel&&(d.dataLabel=d.dataLabel.destroy())),g=ya(d,h),e.updateParallelArrays(d,g),j.data[g]=d.options,e.isDirty=e.isDirtyData=!0,!e.fixedBox&&e.hasCartesianSeries&&(i.isDirtyBox=!0),j.legendType==="point"&&i.legend.destroyItem(d),b&&i.redraw(c)})},remove:function(a,b){var c=this,d=c.series,e=d.points,f=d.chart,g,h=d.data;$a(b,f),a=q(a,!0),c.firePointEvent("remove",null,function(){g=ya(c,h),h.length===e.length&&e.splice(g,1),h.splice(g,1),d.options.data.splice(g,1),d.updateParallelArrays(c,"splice",g,1),c.destroy(),d.isDirty=!0,d.isDirtyData=!0,a&&f.redraw()})}}),s(L.prototype,{addPoint:function(a,b,c,d){var e=this.options,f=this.data,g=this.graph,h=this.area,i=this.chart,j=this.xAxis&&this.xAxis.names,k=g&&g.shift||0,l=e.data,m,n=this.xData;if($a(d,i),c&&p([g,h,this.graphNeg,this.areaNeg],function(a){a&&(a.shift=k+1)}),h&&(h.isArea=!0),b=q(b,!0),d={series:this},this.pointClass.prototype.applyOptions.apply(d,[a]),g=d.x,h=n.length,this.requireSorting&&g<n[h-1])for(m=!0;h&&n[h-1]>g;)h--;this.updateParallelArrays(d,"splice",h,0,0),this.updateParallelArrays(d,h),j&&(j[g]=d.name),l.splice(h,0,a),m&&(this.data.splice(h,0,null),this.processData()),e.legendType==="point"&&this.generatePoints(),c&&(f[0]&&f[0].remove?f[0].remove(!1):(f.shift(),this.updateParallelArrays(d,"shift"),l.shift())),this.isDirtyData=this.isDirty=!0,b&&(this.getAttribs(),i.redraw())},remove:function(a,b){var c=this,d=c.chart,a=q(a,!0);c.isRemoving||(c.isRemoving=!0,N(c,"remove",null,function(){c.destroy(),d.isDirtyLegend=d.isDirtyBox=!0,d.linkSeries(),a&&d.redraw(b)})),c.isRemoving=!1},update:function(a,b){var c=this,d=this.chart,e=this.userOptions,f=this.type,g=B[f].prototype,h=["group","markerGroup","dataLabelsGroup"],i;p(h,function(a){h[a]=c[a],delete c[a]}),a=x(e,{animation:!1,index:this.index,pointStart:this.xData[0]},{data:this.options.data},a),this.remove(!1);for(i in g)g.hasOwnProperty(i)&&(this[i]=r);s(this,B[a.type||f].prototype),p(h,function(a){c[a]=h[a]}),this.init(d,a),d.linkSeries(),q(b,!0)&&d.redraw(!1)}}),s(J.prototype,{update:function(a,b){var c=this.chart,a=c.options[this.coll][this.options.index]=x(this.userOptions,a);this.destroy(!0),this._addedPlotLB=r,this.init(c,s(a,{events:r})),c.isDirtyBox=!0,q(b,!0)&&c.redraw()},remove:function(a){for(var b=this.chart,c=this.coll,d=this.series,e=d.length;e--;)d[e]&&d[e].remove(!1);sa(b.axes,this),sa(b[c],this),b.options[c].splice(this.options.index,1),p(b[c],function(a,b){a.options.index=b}),this.destroy(),b.isDirtyBox=!0,q(a,!0)&&b.redraw()},setTitle:function(a,b){this.update({title:a},b)},setCategories:function(a,b){this.update({categories:a},b)}}),Ca=ha(L),B.line=Ca,W.area=x(E,{threshold:0}),va=ha(L,{type:"area",getSegments:function(){var a=this,b=[],c=[],d=[],e=this.xAxis,f=this.yAxis,g=f.stacks[this.stackKey],h={},i,j,k=this.points,l=this.options.connectNulls,m,n;if(this.options.stacking&&!this.cropped){for(m=0;m<k.length;m++)h[k[m].x]=k[m];for(n in g)g[n].total!==null&&d.push(+n);d.sort(function(a,b){return a-b}),p(d,function(b){var d=0,k;if(!l||h[b]&&h[b].y!==null)if(h[b])c.push(h[b]);else{for(m=a.index;m<=f.series.length;m++)if(k=g[b].points[m+","+b]){d=k[1];break}i=e.translate(b),j=f.toPixels(d,!0),c.push({y:null,plotX:i,clientX:i,plotY:j,yBottom:j,onMouseOver:pa})}}),c.length&&b.push(c)}else L.prototype.getSegments.call(this),b=this.segments;this.segments=b},getSegmentPath:function(a){var b=L.prototype.getSegmentPath.call(this,a),c=[].concat(b),d,e=this.options,f,g;if(d=b.length,f=this.yAxis.getThreshold(e.threshold),d===3&&c.push("L",b[1],b[2]),e.stacking&&!this.closedStacks)for(d=a.length-1;d>=0;d--)g=q(a[d].yBottom,f),d<a.length-1&&e.step&&c.push(a[d+1].plotX,g),c.push(a[d].plotX,g);else this.closeSegment(c,a,f);return this.areaPath=this.areaPath.concat(c),b},closeSegment:function(a,b,c){a.push("L",b[b.length-1].plotX,c,"L",b[0].plotX,c)},drawGraph:function(){this.areaPath=[],L.prototype.drawGraph.a
pply(this);var a=this,b=this.areaPath,c=this.options,d=c.negativeColor,e=c.negativeFillColor,f=[["area",this.color,c.fillColor]];(d||e)&&f.push(["areaNeg",d,e]),p(f,function(d){var e=d[0],f=a[e];f?f.animate({d:b}):a[e]=a.chart.renderer.path(b).attr({fill:q(d[2],Ha(d[1]).setOpacity(q(c.fillOpacity,.75)).get()),zIndex:0}).add(a.group)})},drawLegendSymbol:T.drawRectangle}),B.area=va,W.spline=x(E),Ca=ha(L,{type:"spline",getPointSpline:function(a,b,c){var d=b.plotX,e=b.plotY,f=a[c-1],g=a[c+1],h,i,j,k,l;return f&&g&&(a=f.plotY,j=g.plotX,g=g.plotY,h=(1.5*d+f.plotX)/2.5,i=(1.5*e+a)/2.5,j=(1.5*d+j)/2.5,k=(1.5*e+g)/2.5,l=(k-i)*(j-d)/(j-h)+e-k,i+=l,k+=l,i>a&&i>e?(i=v(a,e),k=2*e-i):i<a&&i<e&&(i=A(a,e),k=2*e-i),k>g&&k>e?(k=v(g,e),i=2*e-k):k<g&&k<e&&(k=A(g,e),i=2*e-k),b.rightContX=j,b.rightContY=k),c?(b=["C",f.rightContX||f.plotX,f.rightContY||f.plotY,h||d,i||e,d,e],f.rightContX=f.rightContY=null):b=["M",d,e],b}}),B.spline=Ca,W.areaspline=x(W.area),va=va.prototype,Ca=ha(Ca,{type:"areaspline",closedStacks:!0,getSegmentPath:va.getSegmentPath,closeSegment:va.closeSegment,drawGraph:va.drawGraph,drawLegendSymbol:T.drawRectangle}),B.areaspline=Ca,W.column=x(E,{borderColor:"#FFFFFF",borderRadius:0,groupPadding:.2,marker:null,pointPadding:.1,minPointLength:0,cropThreshold:50,pointRange:null,states:{hover:{brightness:.1,shadow:!1,halo:!1},select:{color:"#C0C0C0",borderColor:"#000000",shadow:!1}},dataLabels:{align:null,verticalAlign:null,y:null},stickyTracking:!1,tooltip:{distance:6},threshold:0}),Ca=ha(L,{type:"column",pointAttrToOptions:{stroke:"borderColor",fill:"color",r:"borderRadius"},cropShoulder:0,trackerGroups:["group","dataLabelsGroup"],negStacks:!0,init:function(){L.prototype.init.apply(this,arguments);var a=this,b=a.chart;b.hasRendered&&p(b.series,function(b){b.type===a.type&&(b.isDirty=!0)})},getColumnMetrics:function(){var a=this,b=a.options,c=a.xAxis,d=a.yAxis,e=c.reversed,f,g={},h,i=0;b.grouping===!1?i=1:p(a.chart.series,function(b){var c=b.options,e=b.yAxis;b.type===a.type&&b.visible&&d.len===e.len&&d.pos===e.pos&&(c.stacking?(f=b.stackKey,g[f]===r&&(g[f]=i++),h=g[f]):c.grouping!==!1&&(h=i++),b.columnIndex=h)});var c=A(P(c.transA)*(c.ordinalSlope||b.pointRange||c.closestPointRange||c.tickInterval||1),c.len),j=c*b.groupPadding,k=(c-2*j)/i,l=b.pointWidth,b=t(l)?(k-l)/2:k*b.pointPadding,l=q(l,k-2*b);return a.columnMetrics={width:l,offset:b+(j+((e?i-(a.columnIndex||0):a.columnIndex)||0)*k-c/2)*(e?-1:1)}},translate:function(){var a=this,b=a.chart,c=a.options,d=a.borderWidth=q(c.borderWidth,a.activePointCount>.5*a.xAxis.len?0:1),e=a.yAxis,f=a.translatedThreshold=e.getThreshold(c.threshold),g=q(c.minPointLength,5),h=a.getColumnMetrics(),i=h.width,j=a.barW=v(i,1+2*d),k=a.pointXOffset=h.offset,l=-(d%2?.5:0),m=d%2?.5:1;b.renderer.isVML&&b.inverted&&(m+=1),c.pointPadding&&(j=Xa(j)),L.prototype.translate.apply(a),p(a.points,function(c){var d=q(c.yBottom,f),h=A(v(-999-d,c.plotY),e.len+999+d),p=c.plotX+k,r=j,w=A(h,d),s;s=v(h,d)-w,P(s)<g&&g&&(s=g,w=u(P(w-f)>g?d-g:f-(e.translate(c.y,0,1,0,1)<=f?g:0))),c.barX=p,c.pointWidth=i,c.tooltipPos=b.inverted?[e.len-h,a.xAxis.len-p-r/2]:[p+r/2,h],r=u(p+r)+l,p=u(p)+l,r-=p,d=P(w)<.5,s=u(w+s)+m,w=u(w)+m,s-=w,d&&(w-=1,s+=1),c.shapeType="rect",c.shapeArgs={x:p,y:w,width:r,height:s}})},getSymbol:pa,drawLegendSymbol:T.drawRectangle,drawGraph:pa,drawPoints:function(){var a=this,b=this.chart,c=a.options,d=b.renderer,e=c.animationLimit||250,f,g;p(a.points,function(h){var i=h.plotY,j=h.graphic;i===r||isNaN(i)||h.y===null?j&&(h.graphic=j.destroy()):(f=h.shapeArgs,i=t(a.borderWidth)?{"stroke-width":a.borderWidth}:{},g=h.pointAttr[h.selected?"select":""]||a.pointAttr[""],j?(gb(j),j.attr(i)[b.pointCount<e?"animate":"attr"](x(f))):h.graphic=d[h.shapeType](f).attr(g).attr(i).add(a.group).shadow(c.shadow,null,c.stacking&&!c.borderRadius))})},animate:function(a){var b=this.yAxis,c=this.options,d=this.chart.inverted,e={};da&&(a?(e.scaleY=.001,a=A(b.pos+b.len,v(b.pos,b.toPixels(c.threshold))),d?e.translateX=a-b.len:e.translateY=a,this.group.attr(e)):(e.scaleY=1,e[d?"translateX":"translateY"]=b.pos,this.group.animate(e,this.options.animation),this.animate=null))},remove:function(){var a=this,b=a.chart;b.hasRendered&&p(b.series,function(b){b.type===a.type&&(b.isDirty=!0)}),L.prototype.remove.apply(a,arguments)}}),B.column=Ca,W.bar=x(W.column),va=ha(Ca,{type:"bar",inverted:!0}),B.bar=va,W.scatter=x(E,{lineWidth:0,tooltip:{headerFormat:'<span style="color:{series.color}">●</span> <span style="font-size: 10px;"> {series.name}</span><br/>',pointFormat:"x: <b>{point.x}</b><br/>y: <b>{point.y}</b><br/>"},stickyTracking:!1}),va=ha(L,{type:"scatter",sorted:!1,requireSorting:!1,noSharedTooltip:!0,trackerGroups:["markerGroup","dataLabelsGroup"],takeOrdinalPosition:!1,singularTooltips:!0,drawGraph:function(){this.options.lineWidth&&L.prototype.drawGraph.call(this)}}),B.scatter=va,W.pie=x(E,{borderColor:"#FFFFFF",borderWidth:1,center:[null,null],clip:!1,colorByPoint:!0,dataLabels:{distance:30,enabled:!0,formatter:function(){return this.point.name}},ignoreHiddenPoint:!0,legendType:"point",marker:null,size:null,showInLegend:!1,slicedOffset:10,states:{hover:{brightness:.1,shadow:!1}},stickyTracking:!1,tooltip:{followPointer:!0}}),E={type:"pie",isCartesian:!1,pointClass:ha(Ba,{init:function(){Ba.prototype.init.apply(this,arguments);var a=this,b;return a.y<0&&(a.y=null),s(a,{visible:a.visible!==!1,name:q(a.name,"Slice")}),b=function(b){a.slice(b.type==="select")},z(a,"select",b),z(a,"unselect",b),a},setVisible:function(a){var b=this,c=b.series,d=c.chart;b.visible=b.options.visible=a=a===r?!b.visible:a,c.options.data[ya(b,c.data)]=b.options,p(["graphic","dataLabel","connector","shadowGroup"],function(c){b[c]&&b[c][a?"show":"hide"](!0)}),b.legendItem&&d.legend.colorizeItem(b,a),!c.isDirty&&c.options.ignoreHiddenPoint&&(c.isDirty=!0,d.redraw())},slice:function(a,b,c){var d=this.series;$a(c,d.chart),q(b,!0),this.sliced=this.options.sliced=a=t(a)?a:!this.sliced,d.options.data[ya(this,d.data)]=this.options,a=a?this.slicedTranslation:{translateX:0,translateY:0},this.graphic.animate(a),this.shadowGroup&&this.shadowGroup.animate(a)},haloPath:function(a){var b=this.shapeArgs,c=this.series.chart;return this.sliced||!this.visible?[]:this.series.chart.renderer.symbols.arc(c.plotLeft+b.x,c.plotTop+b.y,b.r+a,b.r+a,{innerR:this.shapeArgs.r,start:b.start,end:b.end})}}),requireSorting:!1,noSharedTooltip:!0,trackerGroups:["group","dataLabelsGroup"],axisTypes:[],pointAttrToOptions:{stroke:"borderColor","stroke-width":"borderWidth",fill:"color"},singularTooltips:!0,getColor:pa,animate:function(a){var b=this,c=b.points,d=b.startAngleRad;a||(p(c,function(a){var c=a.graphic,a=a.shapeArgs;c&&(c.attr({r:b.center[3]/2,start:d,end:d}),c.animate({r:a.r,start:a.start,end:a.end},b.options.animation))}),b.animate=null)},setData:function(a,b,c,d){L.prototype.setData.call(this,a,!1,c,d),this.processData(),this.generatePoints(),q(b,!0)&&this.chart.redraw(c)},generatePoints:function(){var a,b=0,c,d,e,f=this.options.ignoreHiddenPoint;for(L.prototype.generatePoints.call(this),c=this.points,d=c.length,a=0;a<d;a++)e=c[a],b+=f&&!e.visible?0:e.y;for(this.total=b,a=0;a<d;a++)e=c[a],e.percentage=b>0?e.y/b*100:0,e.total=b},translate:function(a){this.generatePoints();var b=0,c=this.options,d=c.slicedOffset,e=d+c.borderWidth,f,g,h,i=c.startAngle||0,j=this.startAngleRad=ta/180*(i-90),i=(this.endAngleRad=ta/180*(q(c.endAngle,i+360)-90))-j,k=this.points,l=c.dataLabels.distance,c=c.ignoreHiddenPoint,m,n=k.length,o;for(a||(this.center=a=this.getCenter()),this.getX=function(b,c){return h=X.asin(A((b-a[1])/(a[2]/2+l),1)),a[0]+(c?-1:1)*ea(h)*(a[2]/2+l)},m=0;m<n;m++)o=k[m],f=j+b*i,(!c||o.visible)&&(b+=o.percentage/100),g=j+b*i,o.shapeType="arc",o.shapeArgs={x:a[0],y:a[1],r:a[2]/2,innerR:a[3]/2,start:u(f*1e3)/1e3,end:u(g*1e3)/1e3},h=(g+f)/2,h>1.5*ta?h-=2*ta:h<-ta/2&&(h+=2*ta),o.slicedTranslation={translateX:u(ea(h)*d),translateY:u(ja(h)*d)},f=ea(h)*a[2]/2,g=ja(h)*a[2]/2,o.tooltipPos=[a[0]+f*.7,a[1]+g*.7],o.half=h<-ta/2||h>ta/2?1:0,o.angle=h,e=A(e,l/2),o.labelPos=[a[0]+f+ea(h)*l,a[1]+g+ja(h)*l,a[0]+f+ea(h)*e,a[1]+g+ja(h)*e,a[0]+f,a[1]+g,l<0?"center":o.half?"right":"left",h]},drawGraph:null,drawPoints:function(){var a=this,b=a.chart.renderer,c,d,e=a.options.shadow,f,g;e&&!a.shadowGroup&&(a.shadowGroup=b.g("shadow").add(a.group)),p(a.points,function(h){d=h.graphic,g=h.shapeArgs,f=h.shadowGroup,e&&!f&&(f=h.shadowGroup=b.g("shadow").add(a.shadowGroup)),c=h.sliced?h.slicedTranslation:{translateX:0,translateY:0},f&&f.attr(c),d?d.animate(s(g,c)):h.graphic=d=b[h.shapeType](g).setRadialReference(a.center).attr(h.pointAttr[h.selected?"select":""]).attr({"stroke-linejoin":"round"}).attr(c).add(a.group).shadow(e,f),h.visible!==void 0&&h.setVisible(h.visible)})},sortByAngle:function(a,b){a.sort(function(a,d){return a.angle!==void 0&&(d.angle-a.angle)*b})},drawLegendSymbol:T.drawRectangle,getCenter:fa.getCenter,getSymbol:pa},E=ha(L,E),B.pie=E,L.prototype.drawDataLabels=function(){var a=this,b=a.options,c=b.cursor,d=b.dataLabels,e=a.points,f,g,h,i;(d.enabled||a._hasPointLabels)&&(a.dlProcessOptions&&a.dlProcessOptions(d),i=a.plotGroup("dataLabelsGroup","data-labels",d.defer?"hidden":"visible",d.zIndex||6),!a.hasRendered&&q(d.defer,!0)&&(i.attr({opacity:0}),z(a,"afterAnimate",function(){a.visible&&i.show(),i[b.animation?"animate":"attr"]({opacity:1},{duration:200})})),g=d,p(e,function(b){var e,l=b.dataLabel,m,n,o=b.connector,p=!0;if(f=b.options&&b.options.dataLabels,e=q(f&&f.enabled,g.enabled),l&&!e)b.dataLabel=l.destroy();else if(e){if(d=x(g,f),e=d.rotation,m=b.getLabelConfig(),h=d.format?La(d.format,m):d.formatter.call(m,d),d.style.color=q(d.color,d.style.color,a.color,"black"),l)t(h)?(l.attr({text:h}),p=!1):(b.dataLabel=l=l.destroy(),o)&&(b.connector=o.destroy());else if(t(h)){l={fill:d.backgroundColor,stroke:d.borderColor,"stroke-width":d.borderWidth,r:d.borderRadius||0,rotation:e,padding:d.padding,zIndex:1};for(n
 in l)l[n]===r&&delete l[n];l=b.dataLabel=a.chart.renderer[e?"text":"label"](h,0,-999,null,null,null,d.useHTML).attr(l).css(s(d.style,c&&{cursor:c})).add(i).shadow(d.shadow)}l&&a.alignDataLabel(b,l,d,null,p)}}))},L.prototype.alignDataLabel=function(a,b,c,d,e){var f=this.chart,g=f.inverted,h=q(a.plotX,-999),i=q(a.plotY,-999),j=b.getBBox();(a=this.visible&&(a.series.forceDL||f.isInsidePlot(h,u(i),g)||d&&f.isInsidePlot(h,g?d.x+1:d.y+d.height-1,g)))&&(d=s({x:g?f.plotWidth-i:h,y:u(g?f.plotHeight-h:i),width:0,height:0},d),s(c,{width:j.width,height:j.height}),c.rotation?b[e?"attr":"animate"]({x:d.x+c.x+d.width/2,y:d.y+c.y+d.height/2}).attr({align:c.align}):(b.align(c,null,d),g=b.alignAttr,q(c.overflow,"justify")==="justify"?this.justifyDataLabel(b,c,g,j,d,e):q(c.crop,!0)&&(a=f.isInsidePlot(g.x,g.y)&&f.isInsidePlot(g.x+j.width,g.y+j.height)))),a||(b.attr({y:-999}),b.placed=!1)},L.prototype.justifyDataLabel=function(a,b,c,d,e,f){var g=this.chart,h=b.align,i=b.verticalAlign,j,k;j=c.x,j<0&&(h==="right"?b.align="left":b.x=-j,k=!0),j=c.x+d.width,j>g.plotWidth&&(h==="left"?b.align="right":b.x=g.plotWidth-j,k=!0),j=c.y,j<0&&(i==="bottom"?b.verticalAlign="top":b.y=-j,k=!0),j=c.y+d.height,j>g.plotHeight&&(i==="top"?b.verticalAlign="bottom":b.y=g.plotHeight-j,k=!0),k&&(a.placed=!f,a.align(b,null,e))},B.pie&&(B.pie.prototype.drawDataLabels=function(){var a=this,b=a.data,c,d=a.chart,e=a.options.dataLabels,f=q(e.connectorPadding,10),g=q(e.connectorWidth,1),h=d.plotWidth,i=d.plotHeight,j,k,l=q(e.softConnector,!0),m=e.distance,n=a.center,o=n[2]/2,y=n[1],r=m>0,s,w,t,x=[[],[]],z,O,D,G,C,R=[0,0,0,0],H=function(a,b){return b.y-a.y},N,M;if(a.visible&&(e.enabled||a._hasPointLabels)){for(L.prototype.drawDataLabels.apply(a),p(b,function(a){a.dataLabel&&a.visible&&x[a.half].push(a)}),G=2;G--;){var B=[],K=[],F=x[G],J=F.length,E;if(J){for(a.sortByAngle(F,G-.5),C=b=0;!b&&F[C];)b=F[C]&&F[C].dataLabel&&(F[C].dataLabel.getBBox().height||21),C++;if(m>0){for(w=A(y+o+m,d.plotHeight),C=v(0,y-o-m);C<=w;C+=b)B.push(C);if(w=B.length,J>w){for(c=[].concat(F),c.sort(H),C=J;C--;)c[C].rank=C;for(C=J;C--;)F[C].rank>=w&&F.splice(C,1);J=F.length}for(C=0;C<J;C++){for(c=F[C],t=c.labelPos,c=9999,M=0;M<w;M++)N=P(B[M]-t[1]),N<c&&(c=N,E=M);if(E<C&&B[C]!==null)E=C;else for(w<J-C+E&&B[C]!==null&&(E=w-J+C);B[E]===null;)E++;K.push({i:E,y:B[E]}),B[E]=null}K.sort(H)}for(C=0;C<J;C++)c=F[C],t=c.labelPos,s=c.dataLabel,D=c.visible===!1?"hidden":"visible",c=t[1],m>0?(w=K.pop(),E=w.i,O=w.y,c>O&&B[E+1]!==null||c<O&&B[E-1]!==null)&&(O=A(v(0,c),d.plotHeight)):O=c,z=e.justify?n[0]+(G?-1:1)*(o+m):a.getX(O===y-o-m||O===y+o+m?c:O,G),s._attr={visibility:D,align:t[6]},s._pos={x:z+e.x+({left:f,right:-f}[t[6]]||0),y:O+e.y-10},s.connX=z,s.connY=O,this.options.size===null&&(w=s.width,z-w<f?R[3]=v(u(w-z+f),R[3]):z+w>h-f&&(R[1]=v(u(z+w-h+f),R[1])),O-b/2<0?R[0]=v(u(-O+b/2),R[0]):O+b/2>i&&(R[2]=v(u(O+b/2-i),R[2])))}}(Da(R)===0||this.verifyDataLabelOverflow(R))&&(this.placeDataLabels(),r&&g&&p(this.points,function(b){j=b.connector,t=b.labelPos,(s=b.dataLabel)&&s._pos?(D=s._attr.visibility,z=s.connX,O=s.connY,k=l?["M",z+(t[6]==="left"?5:-5),O,"C",z,O,2*t[2]-t[4],2*t[3]-t[5],t[2],t[3],"L",t[4],t[5]]:["M",z+(t[6]==="left"?5:-5),O,"L",t[2],t[3],"L",t[4],t[5]],j?(j.animate({d:k}),j.attr("visibility",D)):b.connector=j=a.chart.renderer.path(k).attr({"stroke-width":g,stroke:e.connectorColor||b.color||"#606060",visibility:D}).add(a.dataLabelsGroup)):j&&(b.connector=j.destroy())}))}},B.pie.prototype.placeDataLabels=function(){p(this.points,function(a){var a=a.dataLabel,b;a&&((b=a._pos)?(a.attr(a._attr),a[a.moved?"animate":"attr"](b),a.moved=!0):a&&a.attr({y:-999}))})},B.pie.prototype.alignDataLabel=pa,B.pie.prototype.verifyDataLabelOverflow=function(a){var b=this.center,c=this.options,d=c.center,e=c=c.minSize||80,f;return d[0]!==null?e=v(b[2]-v(a[1],a[3]),c):(e=v(b[2]-a[1]-a[3],c),b[0]+=(a[3]-a[1])/2),d[1]!==null?e=v(A(e,b[2]-v(a[0],a[2])),c):(e=v(A(e,b[2]-a[0]-a[2]),c),b[1]+=(a[0]-a[2])/2),e<b[2]?(b[2]=e,this.translate(b),p(this.points,function(a){a.dataLabel&&(a.dataLabel._pos=null)}),this.drawDataLabels&&this.drawDataLabels()):f=!0,f}),B.column&&(B.column.prototype.alignDataLabel=function(a,b,c,d,e){var f=this.chart,g=f.inverted,h=a.dlBox||a.shapeArgs,i=a.below||a.plotY>q(this.translatedThreshold,f.plotSizeY),j=q(c.inside,!!this.options.stacking);h&&(d=x(h),g&&(d={x:f.plotWidth-d.y-d.height,y:f.plotHeight-d.x-d.width,width:d.height,height:d.width}),!j)&&(g?(d.x+=i?0:d.width,d.width=0):(d.y+=i?d.height:0,d.height=0)),c.align=q(c.align,!g||j?"center":i?"right":"left"),c.verticalAlign=q(c.verticalAlign,g||j?"middle":i?"top":"bottom"),L.prototype.alignDataLabel.call(this,a,b,c,d,e)}),ib=Q.TrackerMixin={drawTrackerPoint:function(){var a=this,b=a.chart,c=b.pointer,d=a.options.cursor,e=d&&{cursor:d},f=function(c){var d=c.target,e;for(b.hoverSeries!==a&&a.onMouseOver();d&&!e;)e=d.point,d=d.parentNode;if(e!==r&&e!==b.hoverPoint)e.onMouseOver(c)};p(a.points,function(a){a.graphic&&(a.graphic.element.point=a),a.dataLabel&&(a.dataLabel.element.point=a)}),a._hasTracking||(p(a.trackerGroups,function(b){if(a[b]&&(a[b].addClass("highcharts-tracker").on("mouseover",f).on("mouseout",function(a){c.onTrackerMouseOut(a)}).css(e),cb))a[b].on("touchstart",f)}),a._hasTracking=!0)},drawTrackerGraph:function(){var a=this,b=a.options,c=b.trackByArea,d=[].concat(c?a.areaPath:a.graphPath),e=d.length,f=a.chart,g=f.pointer,h=f.renderer,i=f.options.tooltip.snap,j=a.tracker,k=b.cursor,l=k&&{cursor:k},k=a.singlePoints,m,n=function(){f.hoverSeries!==a&&a.onMouseOver()},o="rgba(192,192,192,"+(da?.0001:.002)+")";if(e&&!c)for(m=e+1;m--;)d[m]==="M"&&d.splice(m+1,0,d[m+1]-i,d[m+2],"L"),(m&&d[m]==="M"||m===e)&&d.splice(m,0,"L",d[m-2]+i,d[m-1]);for(m=0;m<k.length;m++)e=k[m],d.push("M",e.plotX-i,e.plotY,"L",e.plotX+i,e.plotY);j?j.attr({d:d}):(a.tracker=h.path(d).attr({"stroke-linejoin":"round",visibility:a.visible?"visible":"hidden",stroke:o,fill:c?o:$,"stroke-width":b.lineWidth+(c?0:2*i),zIndex:2}).add(a.group),p([a.tracker,a.markerGroup],function(a){if(a.addClass("highcharts-tracker").on("mouseover",n).on("mouseout",function(a){g.onTrackerMouseOut(a)}).css(l),cb)a.on("touchstart",n)}))}},B.column&&(Ca.prototype.drawTracker=ib.drawTrackerPoint),B.pie&&(B.pie.prototype.drawTracker=ib.drawTrackerPoint),B.scatter&&(va.prototype.drawTracker=ib.drawTrackerPoint),s(rb.prototype,{setItemEvents:function(a,b,c,d,e){var f=this;(c?b:a.legendGroup).on("mouseover",function(){a.setState("hover"),b.css(f.options.itemHoverStyle)}).on("mouseout",function(){b.css(a.visible?d:e),a.setState()}).on("click",function(b){var c=function(){a.setVisible()},b={browserEvent:b};a.firePointEvent?a.firePointEvent("legendItemClick",b,c):N(a,"legendItemClick",b,c)})},createCheckboxForItem:function(a){a.checkbox=aa("input",{type:"checkbox",checked:a.selected,defaultChecked:a.selected},this.options.itemCheckboxStyle,this.chart.container),z(a.checkbox,"click",function(b){N(a,"checkboxClick",{checked:b.target.checked},function(){a.select()})})}}),F.legend.itemStyle.cursor="pointer",s(xa.prototype,{showResetZoom:function(){var a=this,b=F.lang,c=a.options.chart.resetZoomButton,d=c.theme,e=d.states,f=c.relativeTo==="chart"?null:"plotBox";this.resetZoomButton=a.renderer.button(b.resetZoom,null,null,function(){a.zoomOut()},d,e&&e.hover).attr({align:c.position.align,title:b.resetZoomTitle}).add().align(c.position,!1,f)},zoomOut:function(){var a=this;N(a,"selection",{resetSelection:!0},function(){a.zoom()})},zoom:function(a){var b,c=this.pointer,d=!1,e;!a||a.resetSelection?p(this.axes,function(a){b=a.zoom()}):p(a.xAxis.concat(a.yAxis),function(a){var e=a.axis,h=e.isXAxis;(c[h?"zoomX":"zoomY"]||c[h?"pinchX":"pinchY"])&&(b=e.zoom(a.min,a.max),e.displayBtn&&(d=!0))}),e=this.resetZoomButton,d&&!e?this.showResetZoom():!d&&ga(e)&&(this.resetZoomButton=e.destroy()),b&&this.redraw(q(this.options.chart.animation,a&&a.animation,this.pointCount<100))},pan:function(a,b){var c=this,d=c.hoverPoints,e;d&&p(d,function(a){a.setState()}),p(b==="xy"?[1,0]:[1],function(b){var d=a[b?"chartX":"chartY"],h=c[b?"xAxis":"yAxis"][0],i=c[b?"mouseDownX":"mouseDownY"],j=(h.pointRange||0)/2,k=h.getExtremes(),l=h.toValue(i-d,!0)+j,i=h.toValue(i+c[b?"plotWidth":"plotHeight"]-d,!0)-j;h.series.length&&l>A(k.dataMin,k.min)&&i<v(k.dataMax,k.max)&&(h.setExtremes(l,i,!1,!1,{trigger:"pan"}),e=!0),c[b?"mouseDownX":"mouseDownY"]=d}),e&&c.redraw(!1),K(c.container,{cursor:"move"})}}),s(Ba.prototype,{select:function(a,b){var c=this,d=c.series,e=d.chart,a=q(a,!c.selected);c.firePointEvent(a?"select":"unselect",{accumulate:b},function(){c.selected=c.options.selected=a,d.options.data[ya(c,d.data)]=c.options,c.setState(a&&"select"),b||p(e.getSelectedPoints(),function(a){a.selected&&a!==c&&(a.selected=a.options.selected=!1,d.options.data[ya(a,d.data)]=a.options,a.setState(""),a.firePointEvent("unselect"))})})},onMouseOver:function(a){var b=this.series,c=b.chart,d=c.tooltip,e=c.hoverPoint;e&&e!==this&&e.onMouseOut(),this.firePointEvent("mouseOver"),d&&(!d.shared||b.noSharedTooltip)&&d.refresh(this,a),this.setState("hover"),c.hoverPoint=this},onMouseOut:function(){var a=this.series.chart,b=a.hoverPoints;this.firePointEvent("mouseOut"),b&&ya(this,b)!==-1||(this.setState(),a.hoverPoint=null)},importEvents:function(){if(!this.hasImportedEvents){var a=x(this.series.options.point,this.options).events,b;this.events=a;for(b in a)z(this,b,a[b]);this.hasImportedEvents=!0}},setState:function(a,b){var c=this.plotX,d=this.plotY,e=this.series,f=e.options.states,g=W[e.type].marker&&e.options.marker,h=g&&!g.enabled,i=g&&g.states[a],j=i&&i.enabled===!1,k=e.stateMarkerGraphic,l=this.marker||{},m=e.chart,n=e.halo,o,a=a||"";o=this.pointAttr[a]||e.pointAttr[a],a===this.state&&!b||this.selected&&a!=="select"||f[a]&&f[a].enabled===!1||a&&(j||h&&i.enabled===!1)||a&&l.states&&l.states[a]&&l.states[a].enabled===!1||(this.graphic?(g=g&&this.graphic.symbolName&&o.r,this.graphic.attr(x(o,g?{x:c-g,y:d-g,width:2*g,height:2*g}:{})),k&&k.hide()):(a&&i&&((g=i.radius,l=l.s
ymbol||e.symbol,k&&k.currentSymbol!==l&&(k=k.destroy()),k)?k[b?"animate":"attr"]({x:c-g,y:d-g}):l&&(e.stateMarkerGraphic=k=m.renderer.symbol(l,c-g,d-g,2*g,2*g).attr(o).add(e.markerGroup),k.currentSymbol=l)),k&&k[a&&m.isInsidePlot(c,d,m.inverted)?"show":"hide"]()),(c=f[a]&&f[a].halo)&&c.size?(n||(e.halo=n=m.renderer.path().add(e.seriesGroup)),n.attr(s({fill:Ha(this.color||e.color).setOpacity(c.opacity).get()},c.attributes))[b?"animate":"attr"]({d:this.haloPath(c.size)})):n&&n.attr({d:[]}),this.state=a)},haloPath:function(a){var b=this.series,c=b.chart,d=b.getPlotBox(),e=c.inverted;return c.renderer.symbols.circle(d.translateX+(e?b.yAxis.len-this.plotY:this.plotX)-a,d.translateY+(e?b.xAxis.len-this.plotX:this.plotY)-a,a*2,a*2)}}),s(L.prototype,{onMouseOver:function(){var a=this.chart,b=a.hoverSeries;b&&b!==this&&b.onMouseOut(),this.options.events.mouseOver&&N(this,"mouseOver"),this.setState("hover"),a.hoverSeries=this},onMouseOut:function(){var a=this.options,b=this.chart,c=b.tooltip,d=b.hoverPoint;d&&d.onMouseOut(),this&&a.events.mouseOut&&N(this,"mouseOut"),c&&!a.stickyTracking&&(!c.shared||this.noSharedTooltip)&&c.hide(),this.setState(),b.hoverSeries=null},setState:function(a){var b=this.options,c=this.graph,d=this.graphNeg,e=b.states,b=b.lineWidth,a=a||"";this.state!==a&&(this.state=a,e[a]&&e[a].enabled===!1||(a&&(b=e[a].lineWidth||b+(e[a].lineWidthPlus||0)),c&&!c.dashstyle&&(a={"stroke-width":b},c.attr(a),d&&d.attr(a))))},setVisible:function(a,b){var c=this,d=c.chart,e=c.legendItem,f,g=d.options.chart.ignoreHiddenSeries,h=c.visible;f=(c.visible=a=c.userOptions.visible=a===r?!h:a)?"show":"hide",p(["group","dataLabelsGroup","markerGroup","tracker"],function(a){c[a]&&c[a][f]()}),d.hoverSeries===c&&c.onMouseOut(),e&&d.legend.colorizeItem(c,a),c.isDirty=!0,c.options.stacking&&p(d.series,function(a){a.options.stacking&&a.visible&&(a.isDirty=!0)}),p(c.linkedSeries,function(b){b.setVisible(a,!1)}),g&&(d.isDirtyBox=!0),b!==!1&&d.redraw(),N(c,f)},setTooltipPoints:function(a){var b=[],c,d,e=this.xAxis,f=e&&e.getExtremes(),g=e?e.tooltipLen||e.len:this.chart.plotSizeX,h,i,j=[];if(!(this.options.enableMouseTracking===!1||this.singularTooltips)){for(a&&(this.tooltipPoints=null),p(this.segments||this.points,function(a){b=b.concat(a)}),e&&e.reversed&&(b=b.reverse()),this.orderTooltipPoints&&this.orderTooltipPoints(b),a=b.length,i=0;i<a;i++)if(e=b[i],c=e.x,c>=f.min&&c<=f.max)for(h=b[i+1],c=d===r?0:d+1,d=b[i+1]?A(v(0,V((e.clientX+(h?h.wrappedClientX||h.clientX:g))/2)),g):g;c>=0&&c<=d;)j[c++]=e;this.tooltipPoints=j}},show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)},select:function(a){this.selected=a=a===r?!this.selected:a,this.checkbox&&(this.checkbox.checked=a),N(this,a?"select":"unselect")},drawTracker:ib.drawTrackerGraph}),M(L.prototype,"init",function(a){var b;a.apply(this,Array.prototype.slice.call(arguments,1)),(b=this.xAxis)&&b.options.ordinal&&z(this,"updatedData",function(){delete b.ordinalIndex})}),M(J.prototype,"getTimeTicks",function(a,b,c,d,e,f,g,h){var i=0,j=0,k,l={},m,n,o,p=[],q=-Number.MAX_VALUE,s=this.options.tickPixelInterval,h,w;if(!this.options.ordinal||!f||f.length<3||c===r)return a.call(this,b,c,d,e);for(n=f.length;j<n;j++){if(o=j&&f[j-1]>d,f[j]<c&&(i=j),j===n-1||f[j+1]-f[j]>g*5||o){if(f[j]>q){for(k=a.call(this,b,f[i],f[j],e);k.length&&k[0]<=q;)k.shift();k.length&&(q=k[k.length-1]),p=p.concat(k)}i=j+1}if(o)break}if(a=k.info,h&&a.unitRange<=H.hour){for(j=p.length-1,i=1;i<j;i++)new Date(p[i]-Na)[Wa]()!==new Date(p[i-1]-Na)[Wa]()&&(l[p[i]]="day",m=!0);m&&(l[p[0]]="day"),a.higherRanks=l}if(p.info=a,h&&t(s)){for(h=a=p.length,j=[],m=[];h--;)i=this.translate(p[h]),w&&(m[h]=w-i),j[h]=w=i;for(m.sort(),m=m[V(m.length/2)],m<s*.6&&(m=null),h=p[a-1]>d?a-1:a,w=void 0;h--;)i=j[h],d=w-i,w&&d<s*.8&&(m===null||d<m*.8)?(l[p[h]]&&!l[p[h+1]]?(d=h+1,w=i):d=h,p.splice(d,1)):w=i}return p}),s(J.prototype,{beforeSetTickPositions:function(){var a,b=[],c=!1,d,e=this.getExtremes(),f=e.min,e=e.max,g;if(this.options.ordinal){if(p(this.series,function(c,d){if(c.visible!==!1&&c.takeOrdinalPosition!==!1&&(b=b.concat(c.processedXData),a=b.length,b.sort(function(a,b){return a-b}),a))for(d=a-1;d--;)b[d]===b[d+1]&&b.splice(d,1)}),a=b.length,a>2){for(d=b[1]-b[0],g=a-1;g--&&!c;)b[g+1]-b[g]!==d&&(c=!0);!this.options.keepOrdinalPadding&&(b[0]-f>d||e-b[b.length-1]>d)&&(c=!0)}c?(this.ordinalPositions=b,c=this.val2lin(v(f,b[0]),!0),d=this.val2lin(A(e,b[b.length-1]),!0),this.ordinalSlope=e=(e-f)/(d-c),this.ordinalOffset=f-c*e):this.ordinalPositions=this.ordinalSlope=this.ordinalOffset=r}this.groupIntervalFactor=null},val2lin:function(a,b){var c=this.ordinalPositions,d,e,f;if(c){for(d=c.length,e=d;e--;)if(c[e]===a){f=e;break}for(e=d-1;e--;)if(a>c[e]||e===0){c=(a-c[e])/(c[e+1]-c[e]),f=e+c;break}return b?f:this.ordinalSlope*(f||0)+this.ordinalOffset}return a},lin2val:function(a,b){var c=this.ordinalPositions;if(c){var d=this.ordinalSlope,e=this.ordinalOffset,f=c.length-1,g,h;if(b)a<0?a=c[0]:a>f?a=c[f]:(f=V(a),h=a-f);else for(;f--;)if(g=d*f+e,a>=g){d=d*(f+1)+e,h=(a-g)/(d-g);break}return h!==r&&c[f]!==r?c[f]+(h?h*(c[f+1]-c[f]):0):a}return a},getExtendedPositions:function(){var a=this.chart,b=this.series[0].currentDataGrouping,c=this.ordinalIndex,d=b?b.count+b.unitName:"raw",e=this.getExtremes(),f,g;return c||(c=this.ordinalIndex={}),c[d]||(f={series:[],getExtremes:function(){return{min:e.dataMin,max:e.dataMax}},options:{ordinal:!0},val2lin:J.prototype.val2lin},p(this.series,function(c){g={xAxis:f,xData:c.xData,chart:a,destroyGroupedData:pa},g.options={dataGrouping:b?{enabled:!0,forced:!0,approximation:"open",units:[[b.unitName,[b.count]]]}:{enabled:!1}},c.processData.apply(g),f.series.push(g)}),this.beforeSetTickPositions.apply(f),c[d]=f.ordinalPositions),c[d]},getGroupIntervalFactor:function(a,b,c){var d=0,c=c.processedXData,e=c.length,f=[],g=this.groupIntervalFactor;if(!g){for(;d<e-1;d++)f[d]=c[d+1]-c[d];f.sort(function(a,b){return a-b}),d=f[V(e/2)],a=v(a,c[0]),b=A(b,c[e-1]),this.groupIntervalFactor=g=e*d/(b-a)}return g},postProcessTickInterval:function(a){var b=this.ordinalSlope;return b?a/(b/this.closestPointRange):a}}),M(xa.prototype,"pan",function(a,b){var c=this.xAxis[0],d=b.chartX,e=!1;if(c.options.ordinal&&c.series.length){var f=this.mouseDownX,g=c.getExtremes(),h=g.dataMax,i=g.min,j=g.max,k=this.hoverPoints,l=c.closestPointRange,f=(f-d)/(c.translationSlope*(c.ordinalSlope||l)),m={ordinalPositions:c.getExtendedPositions()},l=c.lin2val,n=c.val2lin,o;m.ordinalPositions?P(f)>1&&(k&&p(k,function(a){a.setState()}),f<0?(k=m,o=c.ordinalPositions?c:m):(k=c.ordinalPositions?c:m,o=m),m=o.ordinalPositions,h>m[m.length-1]&&m.push(h),this.fixedRange=j-i,f=c.toFixedRange(null,null,l.apply(k,[n.apply(k,[i,!0])+f,!0]),l.apply(o,[n.apply(o,[j,!0])+f,!0])),f.min>=A(g.dataMin,i)&&f.max<=v(h,j)&&c.setExtremes(f.min,f.max,!0,!1,{trigger:"pan"}),this.mouseDownX=d,K(this.container,{cursor:"move"})):e=!0}else e=!0;e&&a.apply(this,Array.prototype.slice.call(arguments,1))}),M(L.prototype,"getSegments",function(a){var b,c=this.options.gapSize,d=this.xAxis;a.apply(this,Array.prototype.slice.call(arguments,1)),c&&(b=this.segments,p(b,function(a,f){for(var g=a.length-1;g--;)a[g+1].x-a[g].x>d.closestPointRange*c&&b.splice(f+1,0,a.splice(g+1,a.length-g))}))});var ca=L.prototype,E=Ib.prototype,gc=ca.processData,hc=ca.generatePoints,ic=ca.destroy,jc=E.tooltipHeaderFormatter,kc={approximation:"average",groupPixelWidth:2,dateTimeLabelFormats:{millisecond:["%A, %b %e, %H:%M:%S.%L","%A, %b %e, %H:%M:%S.%L","-%H:%M:%S.%L"],second:["%A, %b %e, %H:%M:%S","%A, %b %e, %H:%M:%S","-%H:%M:%S"],minute:["%A, %b %e, %H:%M","%A, %b %e, %H:%M","-%H:%M"],hour:["%A, %b %e, %H:%M","%A, %b %e, %H:%M","-%H:%M"],day:["%A, %b %e, %Y","%A, %b %e","-%A, %b %e, %Y"],week:["Week from %A, %b %e, %Y","%A, %b %e","-%A, %b %e, %Y"],month:["%B %Y","%B","-%B %Y"],year:["%Y","%Y","-%Y"]}},Vb={line:{},spline:{},area:{},areaspline:{},column:{approximation:"sum",groupPixelWidth:10},arearange:{approximation:"range"},areasplinerange:{approximation:"range"},columnrange:{approximation:"range",groupPixelWidth:10},candlestick:{approximation:"ohlc",groupPixelWidth:10},ohlc:{approximation:"ohlc",groupPixelWidth:5}},Wb=[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1]],["week",[1]],["month",[1,3,6]],["year",null]],Pa={sum:function(a){var b=a.length,c;if(!b&&a.hasNulls)c=null;else if(b)for(c=0;b--;)c+=a[b];return c},average:function(a){var b=a.length,a=Pa.sum(a);return typeof a=="number"&&b&&(a/=b),a},open:function(a){return a.length?a[0]:a.hasNulls?null:r},high:function(a){return a.length?Da(a):a.hasNulls?null:r},low:function(a){return a.length?Ta(a):a.hasNulls?null:r},close:function(a){return a.length?a[a.length-1]:a.hasNulls?null:r},ohlc:function(a,b,c,d){return a=Pa.open(a),b=Pa.high(b),c=Pa.low(c),d=Pa.close(d),typeof a=="number"||typeof b=="number"||typeof c=="number"||typeof d=="number"?[a,b,c,d]:void 0},range:function(a,b){return a=Pa.low(a),b=Pa.high(b),typeof a=="number"||typeof b=="number"?[a,b]:void 0}};ca.groupData=function(a,b,c,d){for(var e=this.data,f=this.options.data,g=[],h=[],i=a.length,j,k,l=!!b,m=[[],[],[],[]],d=typeof d=="function"?d:Pa[d],n=this.pointArrayMap,o=n&&n.length,q,p=0;p<=i;p++)if(a[p]>=c[0])break;for(;p<=i;p++){for(;c[1]!==r&&a[p]>=c[1]||p===i;)if(j=c.shift(),k=d.apply(0,m),k!==r&&(g.push(j),h.push(k)),m[0]=[],m[1]=[],m[2]=[],m[3]=[],p===i)break;if(p===i)break;if(n)for(j=this.cropStart+p,j=e&&e[j]||this.pointClass.prototype.applyOptions.apply({series:this},[f[j]]),k=0;k<o;k++)(q=j[n[k]],typeof q=="number")?m[k].push(q):q===null&&(m[k].hasNulls=!0);else(j=l?b[p]:null,typeof j=="number")?m[0].push(j):j===null&&(m[0].hasNulls=!0)}return[g,h]},ca.processData=function(){var a=this.chart,b=this.options,c=b.dataGrouping,d=this.allowDG!==!1&&c&&q(c.enabled,a.options._stock),e;if(this.forceCrop=d,this.groupPixelWidth=null,this.hasProcessed=!0,gc.apply(this,arguments)!==!1&&d){this.dest
royGroupedData();var f=this.processedXData,g=this.processedYData,h=a.plotSizeX,a=this.xAxis,i=a.options.ordinal,j=this.groupPixelWidth=a.getGroupPixelWidth&&a.getGroupPixelWidth(),d=this.pointRange;if(j){e=!0,this.points=null;var k=a.getExtremes(),d=k.min,k=k.max,i=i&&a.getGroupIntervalFactor(d,k,this)||1,h=j*(k-d)/h*i,j=a.getTimeTicks(a.normalizeTimeTickInterval(h,c.units||Wb),d,k,null,f,this.closestPointRange),g=ca.groupData.apply(this,[f,g,j,c.approximation]),f=g[0],g=g[1];if(c.smoothed){for(c=f.length-1,f[c]=k;c--&&c>0;)f[c]+=h/2;f[0]=d}this.currentDataGrouping=j.info,b.pointRange===null&&(this.pointRange=j.info.totalRange),this.closestPointRange=j.info.totalRange,t(f[0])&&f[0]<a.dataMin&&(a.dataMin=f[0]),this.processedXData=f,this.processedYData=g}else this.currentDataGrouping=null,this.pointRange=d;this.hasGroupedData=e}},ca.destroyGroupedData=function(){var a=this.groupedData;p(a||[],function(b,c){b&&(a[c]=b.destroy?b.destroy():null)}),this.groupedData=null},ca.generatePoints=function(){hc.apply(this),this.destroyGroupedData(),this.groupedData=this.hasGroupedData?this.points:null},E.tooltipHeaderFormatter=function(a){var b=a.series,c=b.tooltipOptions,d=b.options.dataGrouping,e=c.xDateFormat,f,g=b.xAxis,h;if(g&&g.options.type==="datetime"&&d&&ma(a.key)){if(b=b.currentDataGrouping,d=d.dateTimeLabelFormats,b)g=d[b.unitName],b.count===1?e=g[0]:(e=g[1],f=g[2]);else if(!e&&d)for(h in H)if(H[h]>=g.closestPointRange||H[h]<=H.day&&a.key%H[h]>0){e=d[h][0];break}e=wa(e,a.key),f&&(e+=wa(f,a.key+b.totalRange-1)),a=c.headerFormat.replace("{point.key}",e)}else a=jc.call(this,a);return a},ca.destroy=function(){for(var a=this.groupedData||[],b=a.length;b--;)a[b]&&a[b].destroy();ic.apply(this)},M(ca,"setOptions",function(a,b){var c=a.call(this,b),d=this.type,e=this.chart.options.plotOptions,f=W[d].dataGrouping;return Vb[d]&&(f||(f=x(kc,Vb[d])),c.dataGrouping=x(f,e.series&&e.series.dataGrouping,e[d].dataGrouping,b.dataGrouping)),this.chart.options._stock&&(this.requireSorting=!0),c}),M(J.prototype,"setScale",function(a){a.call(this),p(this.series,function(a){a.hasProcessed=!1})}),J.prototype.getGroupPixelWidth=function(){for(var a=this.series,b=a.length,d=0,e=!1,f,c=b;c--;)(f=a[c].options.dataGrouping)&&(d=v(d,f.groupPixelWidth));for(c=b;c--;)(f=a[c].options.dataGrouping)&&a[c].hasProcessed&&(b=(a[c].processedXData||a[c].data).length,a[c].groupPixelWidth||b>this.chart.plotSizeX/d||b&&f.forced)&&(e=!0);return e?d:0},W.ohlc=x(W.column,{lineWidth:1,tooltip:{pointFormat:'<span style="color:{series.color}">●</span> <b> {series.name}</b><br/>Open: {point.open}<br/>High: {point.high}<br/>Low: {point.low}<br/>Close: {point.close}<br/>'},states:{hover:{lineWidth:3}},threshold:null}),E=ha(B.column,{type:"ohlc",pointArrayMap:["open","high","low","close"],toYData:function(a){return[a.open,a.high,a.low,a.close]},pointValKey:"high",pointAttrToOptions:{stroke:"color","stroke-width":"lineWidth"},upColorProp:"stroke",getAttribs:function(){B.column.prototype.getAttribs.apply(this,arguments);var a=this.options,b=a.states,a=a.upColor||this.color,c=x(this.pointAttr),d=this.upColorProp;c[""][d]=a,c.hover[d]=b.hover.upColor||a,c.select[d]=b.select.upColor||a,p(this.points,function(a){a.open<a.close&&(a.pointAttr=c)})},translate:function(){var a=this.yAxis;B.column.prototype.translate.apply(this),p(this.points,function(b){b.open!==null&&(b.plotOpen=a.translate(b.open,0,1,0,1)),b.close!==null&&(b.plotClose=a.translate(b.close,0,1,0,1))})},drawPoints:function(){var a=this,b=a.chart,c,d,e,f,g,h,i,j;p(a.points,function(k){k.plotY!==r&&(i=k.graphic,c=k.pointAttr[k.selected?"selected":""]||a.pointAttr[""],f=c["stroke-width"]%2/2,j=u(k.plotX)-f,g=u(k.shapeArgs.width/2),h=["M",j,u(k.yBottom),"L",j,u(k.plotY)],k.open!==null&&(d=u(k.plotOpen)+f,h.push("M",j,d,"L",j-g,d)),k.close!==null&&(e=u(k.plotClose)+f,h.push("M",j,e,"L",j+g,e)),i?i.animate({d:h}):k.graphic=b.renderer.path(h).attr(c).add(a.group))})},animate:null}),B.ohlc=E,W.candlestick=x(W.column,{lineColor:"black",lineWidth:1,states:{hover:{lineWidth:2}},tooltip:W.ohlc.tooltip,threshold:null,upColor:"white"}),E=ha(E,{type:"candlestick",pointAttrToOptions:{fill:"color",stroke:"lineColor","stroke-width":"lineWidth"},upColorProp:"fill",getAttribs:function(){B.ohlc.prototype.getAttribs.apply(this,arguments);var a=this.options,b=a.states,c=a.upLineColor||a.lineColor,d=b.hover.upLineColor||c,e=b.select.upLineColor||c;p(this.points,function(a){a.open<a.close&&(a.pointAttr[""].stroke=c,a.pointAttr.hover.stroke=d,a.pointAttr.select.stroke=e)})},drawPoints:function(){var a=this,b=a.chart,c,d=a.pointAttr[""],e,f,g,h,i,j,k,l,m,n,o;p(a.points,function(p){m=p.graphic,p.plotY!==r&&(c=p.pointAttr[p.selected?"selected":""]||d,k=c["stroke-width"]%2/2,l=u(p.plotX)-k,e=p.plotOpen,f=p.plotClose,g=X.min(e,f),h=X.max(e,f),o=u(p.shapeArgs.width/2),i=u(g)!==u(p.plotY),j=h!==p.yBottom,g=u(g)+k,h=u(h)+k,n=["M",l-o,h,"L",l-o,g,"L",l+o,g,"L",l+o,h,"Z","M",l,g,"L",l,i?u(p.plotY):g,"M",l,h,"L",l,j?u(p.yBottom):h],m?m.animate({d:n}):p.graphic=b.renderer.path(n).attr(c).add(a.group).shadow(a.options.shadow))})}}),B.candlestick=E,sb=la.prototype.symbols,W.flags=x(W.column,{fillColor:"white",lineWidth:1,pointRange:0,shape:"flag",stackDistance:12,states:{hover:{lineColor:"black",fillColor:"#FCFFC5"}},style:{fontSize:"11px",fontWeight:"bold",textAlign:"center"},tooltip:{pointFormat:"{point.text}<br/>"},threshold:null,y:-30}),B.flags=ha(B.column,{type:"flags",sorted:!1,noSharedTooltip:!0,allowDG:!1,takeOrdinalPosition:!1,trackerGroups:["markerGroup"],forceCrop:!0,init:L.prototype.init,pointAttrToOptions:{fill:"fillColor",stroke:"color","stroke-width":"lineWidth",r:"radius"},translate:function(){B.column.prototype.translate.apply(this);var a=this.chart,b=this.points,c=b.length-1,d,e,f=this.options.onSeries,f=(d=f&&a.get(f))&&d.options.step,g=d&&d.points,h=g&&g.length,i=this.xAxis,j=i.getExtremes(),k,l,m;if(d&&d.visible&&h)for(d=d.currentDataGrouping,l=g[h-1].x+(d?d.totalRange:0),b.sort(function(a,b){return a.x-b.x});h--&&b[c];)if((d=b[c],k=g[h],k.x<=d.x&&k.plotY!==r)&&(d.x<=l&&(d.plotY=k.plotY,k.x<d.x&&!f&&(m=g[h+1])&&m.plotY!==r&&(d.plotY+=(d.x-k.x)/(m.x-k.x)*(m.plotY-k.plotY))),c--,h++,c<0))break;p(b,function(c,d){c.plotY===r&&(c.x>=j.min&&c.x<=j.max?c.plotY=a.chartHeight-i.bottom-(i.opposite?i.height:0)+i.offset-a.plotTop:c.shapeArgs={}),(e=b[d-1])&&e.plotX===c.plotX&&(e.stackIndex===r&&(e.stackIndex=0),c.stackIndex=e.stackIndex+1)})},drawPoints:function(){for(var a,b=this.pointAttr[""],c=this.points,d=this.chart.renderer,e,f,g=this.options,h=g.y,i,k,l,m=g.lineWidth%2/2,n,o,j=c.length;j--;)(k=c[j],a=k.plotX>this.xAxis.len,e=k.plotX+(a?m:-m),l=k.stackIndex,i=k.options.shape||g.shape,f=k.plotY,f!==r&&(f=k.plotY+h+m-(l!==r&&l*g.stackDistance)),n=l?r:k.plotX+m,o=l?r:k.plotY,l=k.graphic,f!==r&&e>=0&&!a)?(a=k.pointAttr[k.selected?"select":""]||b,l?l.attr({x:e,y:f,r:a.r,anchorX:n,anchorY:o}):k.graphic=d.label(k.options.title||g.title||"A",e,f,i,n,o,g.useHTML).css(x(g.style,k.style)).attr(a).attr({align:i==="flag"?"left":"center",width:g.width,height:g.height}).add(this.markerGroup).shadow(g.shadow),k.tooltipPos=[e,f]):l&&(k.graphic=l.destroy())},drawTracker:function(){var a=this.points;ib.drawTrackerPoint.apply(this),p(a,function(b){var c=b.graphic;c&&z(c.element,"mouseover",function(){b.stackIndex>0&&!b.raised&&(b._y=c.y,c.attr({y:b._y-8}),b.raised=!0),p(a,function(a){a!==b&&a.raised&&a.graphic&&(a.graphic.attr({y:a._y}),a.raised=!1)})})})},animate:pa}),sb.flag=function(a,b,c,d,e){var f=e&&e.anchorX||a,e=e&&e.anchorY||b;return["M",f,e,"L",a,b+d,a,b,a+c,b,a+c,b+d,a,b+d,"M",f,e,"Z"]},p(["circle","square"],function(a){sb[a+"pin"]=function(b,c,d,e,f){var g=f&&f.anchorX,f=f&&f.anchorY,b=sb[a](b,c,d,e);return g&&f&&b.push("M",g,c>f?c:c+e,"L",g,f),b}}),Ya===Q.VMLRenderer&&p(["flag","circlepin","squarepin"],function(a){hb.prototype.symbols[a]=sb[a]}),E=[].concat(Wb),tb=function(a){return Math[a].apply(0,pb(arguments,function(a){return typeof a=="number"}))},E[4]=["day",[1,2,3,4]],E[5]=["week",[1,2,3]],s(F,{navigator:{handles:{backgroundColor:"#ebe7e8",borderColor:"#b2b1b6"},height:40,margin:25,maskFill:"rgba(128,179,236,0.3)",maskInside:!0,outlineColor:"#b2b1b6",outlineWidth:1,series:{type:B.areaspline===r?"line":"areaspline",color:"#4572A7",compare:null,fillOpacity:.05,dataGrouping:{approximation:"average",enabled:!0,groupPixelWidth:2,smoothed:!0,units:E},dataLabels:{enabled:!1,zIndex:2},id:"highcharts-navigator-series",lineColor:"#4572A7",lineWidth:1,marker:{enabled:!1},pointRange:0,shadow:!1,threshold:null},xAxis:{tickWidth:0,lineWidth:0,gridLineColor:"#EEE",gridLineWidth:1,tickPixelInterval:200,labels:{align:"left",style:{color:"#888"},x:3,y:-4},crosshair:!1},yAxis:{gridLineWidth:0,startOnTick:!1,endOnTick:!1,minPadding:.1,maxPadding:.1,labels:{enabled:!1},crosshair:!1,title:{text:null},tickWidth:0}},scrollbar:{height:eb?20:14,barBackgroundColor:"#bfc8d1",barBorderRadius:0,barBorderWidth:1,barBorderColor:"#bfc8d1",buttonArrowColor:"#666",buttonBackgroundColor:"#ebe7e8",buttonBorderColor:"#bbb",buttonBorderRadius:0,buttonBorderWidth:1,minWidth:6,rifleColor:"#666",trackBackgroundColor:"#eeeeee",trackBorderColor:"#eeeeee",trackBorderWidth:1,liveRedraw:da&&!eb}}),Bb.prototype={drawHandle:function(a,b){var c=this.chart,d=c.renderer,e=this.elementsToDestroy,f=this.handles,g=this.navigatorOptions.handles,g={fill:g.backgroundColor,stroke:g.borderColor,"stroke-width":1},h;this.rendered||(f[b]=d.g("navigator-handle-"+["left","right"][b]).css({cursor:"e-resize"}).attr({zIndex:4-b}).add(),h=d.rect(-4.5,0,9,16,0,1).attr(g).add(f[b]),e.push(h),h=d.path(["M",-1.5,4,"L",-1.5,12,"M",.5,4,"L",.5,12]).attr(g).add(f[b]),e.push(h)),f[b][c.isResizing?"animate":"attr"]({translateX:this.scrollerLeft+this.scrollbarHeight+parseInt(a,10),translateY:this.top+this.height/2-8})},drawScrollbarButton:function(a){var b=this.chart.renderer,c=this.elementsToDestroy,d=this.scrollbarButtons,e=this.scrollbarHeight,f=this.scrollbarOptions,g;this.rendered||(d[a]=b.g().add(this.scr
ollbarGroup),g=b.rect(-.5,-.5,e+1,e+1,f.buttonBorderRadius,f.buttonBorderWidth).attr({stroke:f.buttonBorderColor,"stroke-width":f.buttonBorderWidth,fill:f.buttonBackgroundColor}).add(d[a]),c.push(g),g=b.path(["M",e/2+(a?-1:1),e/2-3,"L",e/2+(a?-1:1),e/2+3,e/2+(a?2:-2),e/2]).attr({fill:f.buttonArrowColor}).add(d[a]),c.push(g)),a&&d[a].attr({translateX:this.scrollerWidth-e})},render:function(a,b,c,d){var e=this.chart,f=e.renderer,g,h,i,j,k=this.scrollbarGroup,l=this.navigatorGroup,m=this.scrollbar,l=this.xAxis,n=this.scrollbarTrack,o=this.scrollbarHeight,p=this.scrollbarEnabled,r=this.navigatorOptions,s=this.scrollbarOptions,w=s.minWidth,t=this.height,x=this.top,z=this.navigatorEnabled,O=r.outlineWidth,B=O/2,D=0,C=this.outlineHeight,G=s.barBorderRadius,F=s.barBorderWidth,E=x+B,H;isNaN(a)||(this.navigatorLeft=g=q(l.left,e.plotLeft+o),this.navigatorWidth=h=q(l.len,e.plotWidth-2*o),this.scrollerLeft=i=g-o,this.scrollerWidth=j=j=h+2*o,l.getExtremes&&(H=this.getUnionExtremes(!0))&&(H.dataMin!==l.min||H.dataMax!==l.max)&&l.setExtremes(H.dataMin,H.dataMax,!0,!1),c=q(c,l.translate(a)),d=q(d,l.translate(b)),(isNaN(c)||P(c)===Infinity)&&(c=0,d=j),l.translate(d,!0)-l.translate(c,!0)<e.xAxis[0].minRange||(this.zoomedMax=A(v(c,d),h),this.zoomedMin=v(this.fixedWidth?this.zoomedMax-this.fixedWidth:A(c,d),0),this.range=this.zoomedMax-this.zoomedMin,c=u(this.zoomedMax),b=u(this.zoomedMin),a=c-b,this.rendered||(z&&(this.navigatorGroup=l=f.g("navigator").attr({zIndex:3}).add(),this.leftShade=f.rect().attr({fill:r.maskFill}).add(l),r.maskInside||(this.rightShade=f.rect().attr({fill:r.maskFill}).add(l)),this.outline=f.path().attr({"stroke-width":O,stroke:r.outlineColor}).add(l)),p&&(this.scrollbarGroup=k=f.g("scrollbar").add(),m=s.trackBorderWidth,this.scrollbarTrack=n=f.rect().attr({x:0,y:-m%2/2,fill:s.trackBackgroundColor,stroke:s.trackBorderColor,"stroke-width":m,r:s.trackBorderRadius||0,height:o}).add(k),this.scrollbar=m=f.rect().attr({y:-F%2/2,height:o,fill:s.barBackgroundColor,stroke:s.barBorderColor,"stroke-width":F,r:G}).add(k),this.scrollbarRifles=f.path().attr({stroke:s.rifleColor,"stroke-width":1}).add(k))),e=e.isResizing?"animate":"attr",z&&(this.leftShade[e](r.maskInside?{x:g+b,y:x,width:c-b,height:t}:{x:g,y:x,width:b,height:t}),this.rightShade&&this.rightShade[e]({x:g+c,y:x,width:h-c,height:t}),this.outline[e]({d:["M",i,E,"L",g+b+B,E,g+b+B,E+C,"L",g+c-B,E+C,"L",g+c-B,E,i+j,E].concat(r.maskInside?["M",g+b+B,E,"L",g+c-B,E]:[])}),this.drawHandle(b+B,0),this.drawHandle(c+B,1)),p&&k&&(this.drawScrollbarButton(0),this.drawScrollbarButton(1),k[e]({translateX:i,translateY:u(E+t)}),n[e]({width:j}),g=o+b,h=a-F,h<w&&(D=(w-h)/2,h=w,g-=D),this.scrollbarPad=D,m[e]({x:V(g)+F%2/2,width:h}),w=o+b+a/2-.5,this.scrollbarRifles.attr({visibility:a>12?"visible":"hidden"})[e]({d:["M",w-3,o/4,"L",w-3,2*o/3,"M",w,o/4,"L",w,2*o/3,"M",w+3,o/4,"L",w+3,2*o/3]})),this.scrollbarPad=D,this.rendered=!0))},addEvents:function(){var a=this.chart.container,b=this.mouseDownHandler,c=this.mouseMoveHandler,d=this.mouseUpHandler,e;e=[[a,"mousedown",b],[a,"mousemove",c],[document,"mouseup",d]],cb&&e.push([a,"touchstart",b],[a,"touchmove",c],[document,"touchend",d]),p(e,function(a){z.apply(null,a)}),this._events=e},removeEvents:function(){p(this._events,function(a){U.apply(null,a)}),this._events=r,this.navigatorEnabled&&this.baseSeries&&U(this.baseSeries,"updatedData",this.updatedDataHandler)},init:function(){var a=this,b=a.chart,c,d,e=a.scrollbarHeight,f=a.navigatorOptions,g=a.height,h=a.top,i,j,k=document.body.style,l,m=a.baseSeries,n,o;a.mouseDownHandler=function(d){var d=b.pointer.normalize(d),e=a.zoomedMin,f=a.zoomedMax,h=a.top,j=a.scrollbarHeight,m=a.scrollerLeft,n=a.scrollerWidth,o=a.navigatorLeft,p=a.navigatorWidth,q=a.scrollbarPad,r=a.range,s=d.chartX,t=d.chartY,d=b.xAxis[0],u,v=eb?10:7;t>h&&t<h+g+j&&((h=!a.scrollbarEnabled||t<h+g)&&X.abs(s-e-o)<v?(a.grabbedLeft=!0,a.otherHandlePos=f,a.fixedExtreme=d.max,b.fixedRange=null):h&&X.abs(s-f-o)<v?(a.grabbedRight=!0,a.otherHandlePos=e,a.fixedExtreme=d.min,b.fixedRange=null):s>o+e-q&&s<o+f+q?(a.grabbedCenter=s,a.fixedWidth=r,b.renderer.isSVG&&(l=k.cursor,k.cursor="ew-resize"),i=s-e):s>m&&s<m+n&&(f=h?s-o-r/2:s<o?e-r*.2:s>m+n-j?e+r*.2:s<o+e?e-r:f,f<0?f=0:f+r>=p&&(f=p-r,u=c.dataMax),f!==e&&(a.fixedWidth=r,e=c.toFixedRange(f,f+r,null,u),d.setExtremes(e.min,e.max,!0,!1,{trigger:"navigator"}))))},a.mouseMoveHandler=function(c){var d=a.scrollbarHeight,e=a.navigatorLeft,f=a.navigatorWidth,g=a.scrollerLeft,h=a.scrollerWidth,k=a.range,l;c.pageX!==0&&(c=b.pointer.normalize(c),l=c.chartX,l<e?l=e:l>g+h-d&&(l=g+h-d),a.grabbedLeft?(j=!0,a.render(0,0,l-e,a.otherHandlePos)):a.grabbedRight?(j=!0,a.render(0,0,a.otherHandlePos,l-e)):a.grabbedCenter&&(j=!0,l<i?l=i:l>f+i-k&&(l=f+i-k),a.render(0,0,l-i,l-i+k)),j&&a.scrollbarOptions.liveRedraw&&setTimeout(function(){a.mouseUpHandler(c)},0))},a.mouseUpHandler=function(d){var e,f;j&&(a.zoomedMin===a.otherHandlePos?e=a.fixedExtreme:a.zoomedMax===a.otherHandlePos&&(f=a.fixedExtreme),e=c.toFixedRange(a.zoomedMin,a.zoomedMax,e,f),b.xAxis[0].setExtremes(e.min,e.max,!0,!1,{trigger:"navigator",triggerOp:"navigator-drag",DOMEvent:d})),d.type!=="mousemove"&&(a.grabbedLeft=a.grabbedRight=a.grabbedCenter=a.fixedWidth=a.fixedExtreme=a.otherHandlePos=j=i=null,k.cursor=l||"")},n=b.xAxis.length,o=b.yAxis.length,b.extraBottomMargin=a.outlineHeight+f.margin,a.navigatorEnabled?(a.xAxis=c=new J(b,x({ordinal:m&&m.xAxis.options.ordinal},f.xAxis,{id:"navigator-x-axis",isX:!0,type:"datetime",index:n,height:g,offset:0,offsetLeft:e,offsetRight:-e,keepOrdinalPadding:!0,startOnTick:!1,endOnTick:!1,minPadding:0,maxPadding:0,zoomEnabled:!1})),a.yAxis=d=new J(b,x(f.yAxis,{id:"navigator-y-axis",alignTicks:!1,height:g,offset:0,index:o,zoomEnabled:!1})),m||f.series.data?a.addBaseSeries():b.series.length===0&&M(b,"redraw",function(c,d){b.series.length>0&&!a.series&&(a.setBaseSeries(),b.redraw=c),c.call(b,d)})):a.xAxis=c={translate:function(a,c){var d=b.xAxis[0],f=d.getExtremes(),g=b.plotWidth-2*e,h=tb("min",d.options.min,f.dataMin),d=tb("max",d.options.max,f.dataMax)-h;return c?a*d/g+h:g*(a-h)/d},toFixedRange:J.prototype.toFixedRange},M(b,"getMargins",function(b){var e=this.legend,f=e.options;b.call(this),a.top=h=a.navigatorOptions.top||this.chartHeight-a.height-a.scrollbarHeight-this.spacing[2]-(f.verticalAlign==="bottom"&&f.enabled&&!f.floating?e.legendHeight+q(f.margin,10):0),c&&d&&(c.options.top=d.options.top=h,c.setAxisSize(),d.setAxisSize())}),a.addEvents()},getUnionExtremes:function(a){var b=this.chart.xAxis[0],c=this.xAxis,d=c.options,e=b.options;if(!a||b.dataMin!==null)return{dataMin:tb("min",d&&d.min,e.min,b.dataMin,c.dataMin),dataMax:tb("max",d&&d.max,e.max,b.dataMax,c.dataMax)}},setBaseSeries:function(a){var b=this.chart,a=a||b.options.navigator.baseSeries;this.series&&this.series.remove(),this.baseSeries=b.series[a]||typeof a=="string"&&b.get(a)||b.series[0],this.xAxis&&this.addBaseSeries()},addBaseSeries:function(){var a=this.baseSeries,b=a?a.options:{},c=b.data,d=this.navigatorOptions.series,e;e=d.data,this.hasNavigatorData=!!e,b=x(b,d,{enableMouseTracking:!1,group:"nav",padXAxis:!1,xAxis:"navigator-x-axis",yAxis:"navigator-y-axis",name:"Navigator",showInLegend:!1,isInternal:!0,visible:!0}),b.data=e||c,this.series=this.chart.initSeries(b),a&&this.navigatorOptions.adaptToUpdatedData!==!1&&(z(a,"updatedData",this.updatedDataHandler),a.userOptions.events=s(a.userOptions.event,{updatedData:this.updatedDataHandler}))},updatedDataHandler:function(){var a=this.chart.scroller,b=a.baseSeries,c=b.xAxis,d=c.getExtremes(),e=d.min,f=d.max,g=d.dataMin,d=d.dataMax,h=f-e,i,j,k,l,m,n=a.series,o;i=n.xData,o=!!c.setExtremes,j=f>=i[i.length-1]-(this.closestPointRange||0),i=e<=g,a.hasNavigatorData||(n.options.pointStart=b.xData[0],n.setData(b.options.data,!1),m=!0),i&&(l=g,k=l+h),j&&(k=d,i||(l=v(k-h,n.xData[0]))),o&&(i||j)?isNaN(l)||c.setExtremes(l,k,!0,!1,{trigger:"updatedData"}):(m&&this.chart.redraw(!1),a.render(v(e,g),A(f,d)))},destroy:function(){this.removeEvents(),p([this.xAxis,this.yAxis,this.leftShade,this.rightShade,this.outline,this.scrollbarTrack,this.scrollbarRifles,this.scrollbarGroup,this.scrollbar],function(a){a&&a.destroy&&a.destroy()}),this.xAxis=this.yAxis=this.leftShade=this.rightShade=this.outline=this.scrollbarTrack=this.scrollbarRifles=this.scrollbarGroup=this.scrollbar=null,p([this.scrollbarButtons,this.handles,this.elementsToDestroy],function(a){Ma(a)})}},Q.Scroller=Bb,M(J.prototype,"zoom",function(a,b,c){var d=this.chart,e=d.options,f=e.chart.zoomType,g=e.navigator,e=e.rangeSelector,h;return this.isXAxis&&(g&&g.enabled||e&&e.enabled)&&(f==="x"?d.resetZoomButton="blocked":f==="y"?h=!1:f==="xy"&&(d=this.previousZoom,t(b)?this.previousZoom=[this.min,this.max]:d&&(b=d[0],c=d[1],delete this.previousZoom))),h!==r?h:a.call(this,b,c)}),M(xa.prototype,"init",function(a,b,c){z(this,"beforeRender",function(){var a=this.options;(a.navigator.enabled||a.scrollbar.enabled)&&(this.scroller=new Bb(this))}),a.call(this,b,c)}),M(L.prototype,"addPoint",function(a,b,c,d,e){var f=this.options.turboThreshold;f&&this.xData.length>f&&ga(b)&&!Ra(b)&&this.chart.scroller&&oa(20,!0),a.call(this,b,c,d,e)}),s(F,{rangeSelector:{buttonTheme:{width:28,height:18,fill:"#f7f7f7",padding:2,r:0,"stroke-width":0,style:{color:"#444",cursor:"pointer",fontWeight:"normal"},zIndex:7,states:{hover:{fill:"#e7e7e7"},select:{fill:"#e7f0f9",style:{color:"black",fontWeight:"bold"}}}},inputPosition:{align:"right"},labelStyle:{color:"#666"}}}),F.lang=x(F.lang,{rangeSelectorZoom:"Zoom",rangeSelectorFrom:"From",rangeSelectorTo:"To"}),Cb.prototype={clickButton:function(a,b){var c=this,d=c.selected,e=c.chart,f=c.buttons,g=c.buttonOptions[a],h=e.xAxis[0],i=e.scroller&&e.scroller.getUnionExtremes()||h||{},j=i.dataMin,k=i.dataMax,l,m=h&&u(A(h.max,q(k,h.max))),n=new Date(m),o=g.type,s=g.count,i=g._range,t;if(!(j===null||k===null||a===c.selected)){if(o==="month"||o==="year")l={month:"Month",year:"FullYear"}[o],n["set"+l](n["get"+l]()-s),l=n.getTime(),j=q(j,Numbe
r.MIN_VALUE),isNaN(l)||l<j?(l=j,m=A(l+i,k)):i=m-l;else if(i)l=v(m-i,j),m=A(l+i,k);else if(o==="ytd")if(h)k===r&&(j=Number.MAX_VALUE,k=Number.MIN_VALUE,p(e.series,function(a){a=a.xData,j=A(a[0],j),k=v(a[a.length-1],k)}),b=!1),m=new Date(k),t=m.getFullYear(),l=t=v(j||0,Date.UTC(t,0,1)),m=m.getTime(),m=A(k||m,m);else{z(e,"beforeRender",function(){c.clickButton(a)});return}else o==="all"&&h&&(l=j,m=k);f[d]&&f[d].setState(0),f[a]&&f[a].setState(2),e.fixedRange=i,h?h.setExtremes(l,m,q(b,1),0,{trigger:"rangeSelectorButton",rangeSelectorButton:g}):(d=e.options.xAxis,d[0]=x(d[0],{range:i,min:t})),c.setSelected(a)}},setSelected:function(a){this.selected=this.options.selected=a},defaultButtons:[{type:"month",count:1,text:"1m"},{type:"month",count:3,text:"3m"},{type:"month",count:6,text:"6m"},{type:"ytd",text:"YTD"},{type:"year",count:1,text:"1y"},{type:"all",text:"All"}],init:function(a){var b=this,c=a.options.rangeSelector,d=c.buttons||[].concat(b.defaultButtons),e=c.selected,f=b.blurInputs=function(){var a=b.minInput,c=b.maxInput;a&&a.blur(),c&&c.blur()};b.chart=a,b.options=c,b.buttons=[],a.extraTopMargin=35,b.buttonOptions=d,z(a.container,"mousedown",f),z(a,"resize",f),p(d,b.computeButtonRange),e!==r&&d[e]&&this.clickButton(e,!1),z(a,"load",function(){z(a.xAxis[0],"afterSetExtremes",function(){b.updateButtonStates(!0)})})},updateButtonStates:function(a){var b=this,c=this.chart,d=c.xAxis[0],e=c.scroller&&c.scroller.getUnionExtremes()||d,f=e.dataMin,g=e.dataMax,h=b.selected,i=b.options.allButtonsEnabled,j=b.buttons;a&&c.fixedRange!==u(d.max-d.min)&&(j[h]&&j[h].setState(0),b.setSelected(null)),p(b.buttonOptions,function(a,c){var e=a._range,n=e>g-f,o=e<d.minRange,p=a.type==="all"&&d.max-d.min>=g-f&&j[c].state!==2,q=a.type==="ytd"&&wa("%Y",f)===wa("%Y",g);e===u(d.max-d.min)&&c!==h?(b.setSelected(c),j[c].setState(2)):!i&&(n||o||p||q)?j[c].setState(3):j[c].state===3&&j[c].setState(0)})},computeButtonRange:function(a){var b=a.type,c=a.count||1,d={millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5};d[b]?a._range=d[b]*c:(b==="month"||b==="year")&&(a._range={month:30,year:365}[b]*864e5*c)},setInputValue:function(a,b){var c=this.chart.options.rangeSelector;t(b)&&(this[a+"Input"].HCTime=b),this[a+"Input"].value=wa(c.inputEditDateFormat||"%Y-%m-%d",this[a+"Input"].HCTime),this[a+"DateBox"].attr({text:wa(c.inputDateFormat||"%b %e, %Y",this[a+"Input"].HCTime)})},drawInput:function(a){var b=this,c=b.chart,d=c.renderer.style,e=c.renderer,f=c.options.rangeSelector,g=b.div,h=a==="min",i,j,k,l=this.inputGroup;this[a+"Label"]=j=e.label(F.lang[h?"rangeSelectorFrom":"rangeSelectorTo"],this.inputGroup.offset).attr({padding:2}).css(x(d,f.labelStyle)).add(l),l.offset+=j.width+5,this[a+"DateBox"]=k=e.label("",l.offset).attr({padding:2,width:f.inputBoxWidth||90,height:f.inputBoxHeight||17,stroke:f.inputBoxBorderColor||"silver","stroke-width":1}).css(x({textAlign:"center",color:"#444"},d,f.inputStyle)).on("click",function(){b[a+"Input"].focus()}).add(l),l.offset+=k.width+(h?10:0),this[a+"Input"]=i=aa("input",{name:a,className:"highcharts-range-selector",type:"text"},s({position:"absolute",border:0,width:"1px",height:"1px",padding:0,textAlign:"center",fontSize:d.fontSize,fontFamily:d.fontFamily,top:c.plotTop+"px"},f.inputStyle),g),i.onfocus=function(){K(this,{left:l.translateX+k.x+"px",top:l.translateY+"px",width:k.width-2+"px",height:k.height-2+"px",border:"2px solid silver"})},i.onblur=function(){K(this,{border:0,width:"1px",height:"1px"}),b.setInputValue(a)},i.onchange=function(){var a=i.value,d=(f.inputDateParser||Date.parse)(a),e=c.xAxis[0],g=e.dataMin,j=e.dataMax;isNaN(d)&&(d=a.split("-"),d=Date.UTC(G(d[0]),G(d[1])-1,G(d[2]))),isNaN(d)||(F.global.useUTC||(d+=(new Date).getTimezoneOffset()*6e4),h?d>b.maxInput.HCTime?d=r:d<g&&(d=g):d<b.minInput.HCTime?d=r:d>j&&(d=j),d!==r&&c.xAxis[0].setExtremes(h?d:e.min,h?e.max:d,r,r,{trigger:"rangeSelectorInput"}))}},render:function(a,b){var c=this,d=c.chart,e=d.renderer,f=d.container,g=d.options,h=g.exporting&&g.navigation&&g.navigation.buttonOptions,i=g.rangeSelector,j=c.buttons,g=F.lang,k=c.div,k=c.inputGroup,l=i.buttonTheme,m=i.inputEnabled!==!1,n=l&&l.states,o=d.plotLeft,r;!c.rendered&&(c.zoomText=e.text(g.rangeSelectorZoom,o,d.plotTop-20).css(i.labelStyle).add(),r=o+c.zoomText.getBBox().width+5,p(c.buttonOptions,function(a,b){j[b]=e.button(a.text,r,d.plotTop-35,function(){c.clickButton(b),c.isActive=!0},l,n&&n.hover,n&&n.select).css({textAlign:"center"}).add(),r+=j[b].width+q(i.buttonSpacing,5),c.selected===b&&j[b].setState(2)}),c.updateButtonStates(),m)&&(c.div=k=aa("div",null,{position:"relative",height:0,zIndex:1}),f.parentNode.insertBefore(k,f),c.inputGroup=k=e.g("input-group").add(),k.offset=0,c.drawInput("min"),c.drawInput("max")),m&&(f=d.plotTop-45,k.align(s({y:f,width:k.offset,x:h&&f<(h.y||0)+h.height-d.spacing[0]?-40:0},i.inputPosition),!0,d.spacingBox),c.setInputValue("min",a),c.setInputValue("max",b)),c.rendered=!0},destroy:function(){var a=this.minInput,b=this.maxInput,c=this.chart,d=this.blurInputs,e;U(c.container,"mousedown",d),U(c,"resize",d),Ma(this.buttons),a&&(a.onfocus=a.onblur=a.onchange=null),b&&(b.onfocus=b.onblur=b.onchange=null);for(e in this)this[e]&&e!=="chart"&&(this[e].destroy?this[e].destroy():this[e].nodeType&&Ua(this[e])),this[e]=null}},J.prototype.toFixedRange=function(a,b,c,d){var e=this.chart&&this.chart.fixedRange,a=q(c,this.translate(a,!0)),b=q(d,this.translate(b,!0)),c=e&&(b-a)/e;return c>.7&&c<1.3&&(d?a=b-e:b=a+e),{min:a,max:b}},M(xa.prototype,"init",function(a,b,c){z(this,"init",function(){this.options.rangeSelector.enabled&&(this.rangeSelector=new Cb(this))}),a.call(this,b,c)}),Q.RangeSelector=Cb,xa.prototype.callbacks.push(function(a){function b(){f=a.xAxis[0].getExtremes(),g.render(f.min,f.max)}function c(){f=a.xAxis[0].getExtremes(),isNaN(f.min)||h.render(f.min,f.max)}function d(a){a.triggerOp!=="navigator-drag"&&g.render(a.min,a.max)}function e(a){h.render(a.min,a.max)}var f,g=a.scroller,h=a.rangeSelector;g&&(z(a.xAxis[0],"afterSetExtremes",d),M(a,"drawChartBox",function(a){var c=this.isDirtyBox;a.call(this),c&&b()}),b()),h&&(z(a.xAxis[0],"afterSetExtremes",e),z(a,"resize",c),c()),z(a,"destroy",function(){g&&U(a.xAxis[0],"afterSetExtremes",d),h&&(U(a,"resize",c),U(a.xAxis[0],"afterSetExtremes",e))})}),Q.StockChart=function(a,b){var c=a.series,d,e=q(a.navigator&&a.navigator.enabled,!0)?{startOnTick:!1,endOnTick:!1}:null,f={marker:{enabled:!1,radius:2},states:{hover:{lineWidth:2}}},g={shadow:!1,borderWidth:0};return a.xAxis=za(na(a.xAxis||{}),function(a){return x({minPadding:0,maxPadding:0,ordinal:!0,title:{text:null},labels:{overflow:"justify"},showLastLabel:!0},a,{type:"datetime",categories:null},e)}),a.yAxis=za(na(a.yAxis||{}),function(a){return d=q(a.opposite,!0),x({labels:{y:-2},opposite:d,showLastLabel:!1,title:{text:null}},a)}),a.series=null,a=x({chart:{panning:!0,pinchType:"x"},navigator:{enabled:!0},scrollbar:{enabled:!0},rangeSelector:{enabled:!0},title:{text:null,style:{fontSize:"16px"}},tooltip:{shared:!0,crosshairs:!0},legend:{enabled:!1},plotOptions:{line:f,spline:f,area:f,areaspline:f,arearange:f,areasplinerange:f,column:g,columnrange:g,candlestick:g,ohlc:g}},a,{_stock:!0,chart:{inverted:!1}}),a.series=c,new xa(a,b)},M(Za.prototype,"init",function(a,b,c){var d=c.chart.pinchType||"";a.call(this,b,c),this.pinchX=this.pinchHor=d.indexOf("x")!==-1,this.pinchY=this.pinchVert=d.indexOf("y")!==-1,this.hasZoom=this.hasZoom||this.pinchHor||this.pinchVert}),M(J.prototype,"autoLabelAlign",function(a){return this.chart.options._stock&&this.coll==="yAxis"&&ya(this,this.chart.yAxis)===0?(this.options.labels.x===15&&(this.options.labels.x=0),"right"):a.call(this,[].slice.call(arguments,1))}),J.prototype.getPlotLinePath=function(a,b,c,d,e){var f=this,g=this.isLinked&&!this.series?this.linkedParent.series:this.series,h=f.chart,i=h.renderer,j=f.left,k=f.top,l,m,n,o,r=[],s,v;return s=f.isXAxis?t(f.options.yAxis)?[h.yAxis[f.options.yAxis]]:za(g,function(a){return a.yAxis}):t(f.options.xAxis)?[h.xAxis[f.options.xAxis]]:za(g,function(a){return a.xAxis}),p(f.isXAxis?h.yAxis:h.xAxis,function(a){if(t(a.options.id)?a.options.id.indexOf("navigator")===-1:1){var b=a.isXAxis?"yAxis":"xAxis",b=t(a.options[b])?h[b][a.options[b]]:h[b][0];f===b&&s.push(a)}}),v=s.length?[]:[f],p(s,function(a){ya(a,v)===-1&&v.push(a)}),e=q(e,f.translate(a,null,null,c)),isNaN(e)||(f.horiz?p(v,function(a){m=a.top,o=m+a.len,l=n=u(e+f.transB),(l>=j&&l<=j+f.width||d)&&r.push("M",l,m,"L",n,o)}):p(v,function(a){l=a.left,n=l+a.width,m=o=u(k+f.height-e),(m>=k&&m<=k+f.height||d)&&r.push("M",l,m,"L",n,o)})),r.length>0?i.crispPolyLine(r,b||1):void 0},J.prototype.getPlotBandPath=function(a,b){var c=this.getPlotLinePath(b),d=this.getPlotLinePath(a),e=[],f;if(d&&c)for(f=0;f<d.length;f+=6)e.push("M",d[f+1],d[f+2],"L",d[f+4],d[f+5],c[f+4],c[f+5],c[f+1],c[f+2]);else e=null;return e},la.prototype.crispPolyLine=function(a,b){for(var c=0;c<a.length;c+=6)a[c+1]===a[c+4]&&(a[c+1]=a[c+4]=u(a[c+1])-b%2/2),a[c+2]===a[c+5]&&(a[c+2]=a[c+5]=u(a[c+2])+b%2/2);return a},Ya===Q.VMLRenderer&&(hb.prototype.crispPolyLine=la.prototype.crispPolyLine),M(J.prototype,"hideCrosshair",function(a,b){a.call(this,b),t(this.crossLabelArray)&&(t(b)?this.crossLabelArray[b]&&this.crossLabelArray[b].hide():p(this.crossLabelArray,function(a){a.hide()}))}),M(J.prototype,"drawCrosshair",function(a,b,c){var d,e;if(a.call(this,b,c),t(this.crosshair.label)&&this.crosshair.label.enabled&&t(c)){var a=this.chart,f=this.options.crosshair.label,g=this.isXAxis?"x":"y",b=this.horiz,h=this.opposite,i=this.left,j=this.top,k=this.crossLabel,l,m,n=f.format,o="";k||(k=this.crossLabel=a.renderer.label().attr({align:f.align||(b?"center":h?this.labelAlign==="right"?"right":"left":this.labelAlign==="left"?"left":"center"),zIndex:12,height:b?16:r,fill:f.backgroundColor||this.series[0]&&this.series[0].color||"gray",padding:q(f.padding,2),stroke:f.borderColor||null,"stroke-width":f.borderWidth||0}).css(s({color:"white",fontWeight:"normal",fontSize:"11px
",textAlign:"center"},f.style)).add()),b?(l=c.plotX+i,m=j+(h?0:this.height)):(l=h?this.width+i:0,m=c.plotY+j),m<j||m>j+this.height?this.hideCrosshair():(!n&&!f.formatter&&(this.isDatetimeAxis&&(o="%b %d, %Y"),n="{value"+(o?":"+o:"")+"}"),k.attr({text:n?La(n,{value:c[g]}):f.formatter.call(this,c[g]),x:l,y:m,visibility:"visible"}),c=k.getBBox(),b?(this.options.tickPosition==="inside"&&!h||this.options.tickPosition!=="inside"&&h)&&(m=k.y-c.height):m=k.y-c.height/2,b?(d=i-c.x,e=i+this.width-c.x):(d=this.labelAlign==="left"?i:0,e=this.labelAlign==="right"?i+this.width:a.chartWidth),k.translateX<d&&(l+=d-k.translateX),k.translateX+c.width>=e&&(l-=k.translateX+c.width-e),k.attr({x:l,y:m,visibility:"visible"}))}});var lc=ca.init,mc=ca.processData,nc=Ba.prototype.tooltipFormatter;ca.init=function(){lc.apply(this,arguments),this.setCompare(this.options.compare)},ca.setCompare=function(a){this.modifyValue=a==="value"||a==="percent"?function(b,c){var d=this.compareValue;return b!==r&&(b=a==="value"?b-d:b=100*(b/d)-100,c)&&(c.change=b),b}:null,this.chart.hasRendered&&(this.isDirty=!0)},ca.processData=function(){var a=0,b,c,d;if(mc.apply(this,arguments),this.xAxis&&this.processedYData)for(b=this.processedXData,c=this.processedYData,d=c.length;a<d;a++)if(typeof c[a]=="number"&&b[a]>=this.xAxis.min){this.compareValue=c[a];break}},M(ca,"getExtremes",function(a){a.apply(this,[].slice.call(arguments,1)),this.modifyValue&&(this.dataMax=this.modifyValue(this.dataMax),this.dataMin=this.modifyValue(this.dataMin))}),J.prototype.setCompare=function(a,b){this.isXAxis||(p(this.series,function(b){b.setCompare(a)}),q(b,!0)&&this.chart.redraw())},Ba.prototype.tooltipFormatter=function(a){return a=a.replace("{point.change}",(this.change>0?"+":"")+Ka(this.change,q(this.series.tooltipOptions.changeDecimals,2))),nc.apply(this,[a])},M(L.prototype,"render",function(a){this.chart.options._stock&&(!this.clipBox&&this.animate&&this.animate.toString().indexOf("sharedClip")!==-1?(this.clipBox=x(this.chart.clipBox),this.clipBox.width=this.xAxis.len,this.clipBox.height=this.yAxis.len):this.chart[this.sharedClipKey]&&this.chart[this.sharedClipKey].attr({width:this.xAxis.len,height:this.yAxis.len})),a.call(this)}),s(Q,{Axis:J,Chart:xa,Color:Ha,Point:Ba,Tick:ab,Renderer:Ya,Series:L,SVGElement:Z,SVGRenderer:la,arrayMin:Ta,arrayMax:Da,charts:ba,dateFormat:wa,format:La,pathAnim:Fb,getOptions:function(){return F},hasBidiBug:Xb,isTouchDevice:eb,numberFormat:Ka,seriesTypes:B,setOptions:function(a){return F=x(!0,F,a),Lb(),F},addEvent:z,removeEvent:U,createElement:aa,discardElement:Ua,css:K,each:p,extend:s,map:za,merge:x,pick:q,splat:na,extendClass:ha,pInt:G,wrap:M,svg:da,canvas:ka,vml:!da&&!ka,product:"Highstock",version:"2.0.3"})})();
(function(a){function b(a,b,c){switch(arguments.length){case 2:return null!=a?a:b;case 3:return null!=a?a:null!=b?b:c;default:throw new Error("Implement me");}}function c(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function d(a){rb.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+a)}function e(a,b){var c=!0;return l(function(){return c&&(d(a),c=!1),b.apply(this,arguments)},b)}function f(a,b){nc[a]||(d(b),nc[a]=!0)}function g(a,b){return function(c){return o(a.call(this,c),b)}}function h(a,b){return function(c){return this.localeData().ordinal(a.call(this,c),b)}}function i(){}function j(a,b){b!==!1&&E(a),m(this,a),this._d=new Date(+a._d)}function k(a){var b=x(a),c=b.year||0,d=b.quarter||0,e=b.month||0,f=b.week||0,g=b.day||0,h=b.hour||0,i=b.minute||0,j=b.second||0,k=b.millisecond||0;this._milliseconds=+k+1e3*j+6e4*i+36e5*h,this._days=+g+7*f,this._months=+e+3*d+12*c,this._data={},this._locale=rb.localeData(),this._bubble()}function l(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return b.hasOwnProperty("toString")&&(a.toString=b.toString),b.hasOwnProperty("valueOf")&&(a.valueOf=b.valueOf),a}function m(a,b){var c,d,e;if("undefined"!=typeof b._isAMomentObject&&(a._isAMomentObject=b._isAMomentObject),"undefined"!=typeof b._i&&(a._i=b._i),"undefined"!=typeof b._f&&(a._f=b._f),"undefined"!=typeof b._l&&(a._l=b._l),"undefined"!=typeof b._strict&&(a._strict=b._strict),"undefined"!=typeof b._tzm&&(a._tzm=b._tzm),"undefined"!=typeof b._isUTC&&(a._isUTC=b._isUTC),"undefined"!=typeof b._offset&&(a._offset=b._offset),"undefined"!=typeof b._pf&&(a._pf=b._pf),"undefined"!=typeof b._locale&&(a._locale=b._locale),Fb.length>0)for(c in Fb)d=Fb[c],e=b[d],"undefined"!=typeof e&&(a[d]=e);return a}function n(a){return 0>a?Math.ceil(a):Math.floor(a)}function o(a,b,c){for(var d=""+Math.abs(a),e=a>=0;d.length<b;)d="0"+d;return(e?c?"+":"":"-")+d}function p(a,b){var c={milliseconds:0,months:0};return c.months=b.month()-a.month()+12*(b.year()-a.year()),a.clone().add(c.months,"M").isAfter(b)&&--c.months,c.milliseconds=+b-+a.clone().add(c.months,"M"),c}function q(a,b){var c;return b=J(b,a),a.isBefore(b)?c=p(a,b):(c=p(b,a),c.milliseconds=-c.milliseconds,c.months=-c.months),c}function r(a,b){return function(c,d){var e,g;return null===d||isNaN(+d)||(f(b,"moment()."+b+"(period, number) is deprecated. Please use moment()."+b+"(number, period)."),g=c,c=d,d=g),c="string"==typeof c?+c:c,e=rb.duration(c,d),s(this,e,a),this}}function s(a,b,c,d){var e=b._milliseconds,f=b._days,g=b._months;d=null==d?!0:d,e&&a._d.setTime(+a._d+e*c),f&&lb(a,"Date",kb(a,"Date")+f*c),g&&jb(a,kb(a,"Month")+g*c),d&&rb.updateOffset(a,f||g)}function t(a){return"[object Array]"===Object.prototype.toString.call(a)}function u(a){return"[object Date]"===Object.prototype.toString.call(a)||a instanceof Date}function v(a,b,c){for(var e=Math.min(a.length,b.length),f=Math.abs(a.length-b.length),g=0,d=0;e>d;d++)(c&&a[d]!==b[d]||!c&&z(a[d])!==z(b[d]))&&g++;return g+f}function w(a){if(a){var b=a.toLowerCase().replace(/(.)s$/,"$1");a=gc[a]||hc[b]||b}return a}function x(a){var b,c,d={};for(c in a)a.hasOwnProperty(c)&&(b=w(c),b&&(d[b]=a[c]));return d}function y(b){var c,d;if(0===b.indexOf("week"))c=7,d="day";else{if(0!==b.indexOf("month"))return;c=12,d="month"}rb[b]=function(e,f){var g,h,i=rb._locale[b],j=[];if("number"==typeof e&&(f=e,e=a),h=function(a){var b=rb().utc().set(d,a);return i.call(rb._locale,b,e||"")},null!=f)return h(f);for(g=0;c>g;g++)j.push(h(g));return j}}function z(a){var b=+a,c=0;return 0!==b&&isFinite(b)&&(c=b>=0?Math.floor(b):Math.ceil(b)),c}function A(a,b){return new Date(Date.UTC(a,b+1,0)).getUTCDate()}function B(a,b,c){return fb(rb([a,11,31+b-c]),b,c).week}function C(a){return D(a)?366:365}function D(a){return a%4==0&&a%100!=0||a%400==0}function E(a){var b;a._a&&-2===a._pf.overflow&&(b=a._a[yb]<0||a._a[yb]>11?yb:a._a[zb]<1||a._a[zb]>A(a._a[xb],a._a[yb])?zb:a._a[Ab]<0||a._a[Ab]>23?Ab:a._a[Bb]<0||a._a[Bb]>59?Bb:a._a[Cb]<0||a._a[Cb]>59?Cb:a._a[Db]<0||a._a[Db]>999?Db:-1,a._pf._overflowDayOfYear&&(xb>b||b>zb)&&(b=zb),a._pf.overflow=b)}function F(a){return null==a._isValid&&(a._isValid=!isNaN(a._d.getTime())&&a._pf.overflow<0&&!a._pf.empty&&!a._pf.invalidMonth&&!a._pf.nullInput&&!a._pf.invalidFormat&&!a._pf.userInvalidated,a._strict&&(a._isValid=a._isValid&&0===a._pf.charsLeftOver&&0===a._pf.unusedTokens.length)),a._isValid}function G(a){return a?a.toLowerCase().replace("_","-"):a}function H(a){for(var b,c,d,e,f=0;f<a.length;){for(e=G(a[f]).split("-"),b=e.length,c=G(a[f+1]),c=c?c.split("-"):null;b>0;){if(d=I(e.slice(0,b).join("-")))return d;if(c&&c.length>=b&&v(e,c,!0)>=b-1)break;b--}f++}return null}function I(a){var b=null;if(!Eb[a]&&Gb)try{b=rb.locale(),require("./locale/"+a),rb.locale(b)}catch(c){}return Eb[a]}function J(a,b){return b._isUTC?rb(a).zone(b._offset||0):rb(a).local()}function K(a){return a.match(/\[[\s\S]/)?a.replace(/^\[|\]$/g,""):a.replace(/\\/g,"")}function L(a){for(var d=a.match(Kb),b=0,c=d.length;c>b;b++)d[b]=mc[d[b]]?mc[d[b]]:K(d[b]);return function(e){var f="";for(b=0;c>b;b++)f+=d[b]instanceof Function?d[b].call(e,a):d[b];return f}}function M(a,b){return a.isValid()?(b=N(b,a.localeData()),ic[b]||(ic[b]=L(b)),ic[b](a)):a.localeData().invalidDate()}function N(a,b){function c(a){return b.longDateFormat(a)||a}var d=5;for(Lb.lastIndex=0;d>=0&&Lb.test(a);)a=a.replace(Lb,c),Lb.lastIndex=0,d-=1;return a}function O(a,b){var c,d=b._strict;switch(a){case"Q":return Wb;case"DDDD":return Yb;case"YYYY":case"GGGG":case"gggg":return d?Zb:Ob;case"Y":case"G":case"g":return _b;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return d?$b:Pb;case"S":if(d)return Wb;case"SS":if(d)return Xb;case"SSS":if(d)return Yb;case"DDD":return Nb;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return Rb;case"a":case"A":return b._locale._meridiemParse;case"X":return Ub;case"Z":case"ZZ":return Sb;case"T":return Tb;case"SSSS":return Qb;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return d?Xb:Mb;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return Mb;case"Do":return Vb;default:return c=new RegExp(X(W(a.replace("\\","")),"i"))}}function P(a){a=a||"";var b=a.match(Sb)||[],c=b[b.length-1]||[],d=(c+"").match(ec)||["-",0,0],e=+(60*d[1])+z(d[2]);return"+"===d[0]?-e:e}function Q(a,b,c){var d,e=c._a;switch(a){case"Q":null!=b&&(e[yb]=3*(z(b)-1));break;case"M":case"MM":null!=b&&(e[yb]=z(b)-1);break;case"MMM":case"MMMM":d=c._locale.monthsParse(b),null!=d?e[yb]=d:c._pf.invalidMonth=b;break;case"D":case"DD":null!=b&&(e[zb]=z(b));break;case"Do":null!=b&&(e[zb]=z(parseInt(b,10)));break;case"DDD":case"DDDD":null!=b&&(c._dayOfYear=z(b));break;case"YY":e[xb]=rb.parseTwoDigitYear(b);break;case"YYYY":case"YYYYY":case"YYYYYY":e[xb]=z(b);break;case"a":case"A":c._isPm=c._locale.isPM(b);break;case"H":case"HH":case"h":case"hh":e[Ab]=z(b);break;case"m":case"mm":e[Bb]=z(b);break;case"s":case"ss":e[Cb]=z(b);break;case"S":case"SS":case"SSS":case"SSSS":e[Db]=z(1e3*("0."+b));break;case"X":c._d=new Date(1e3*parseFloat(b));break;case"Z":case"ZZ":c._useUTC=!0,c._tzm=P(b);break;case"dd":case"ddd":case"dddd":d=c._locale.weekdaysParse(b),null!=d?(c._w=c._w||{},c._w.d=d):c._pf.invalidWeekday=b;break;case"w":case"ww":case"W":case"WW":case"d":case"e":case"E":a=a.substr(0,1);case"gggg":case"GGGG":case"GGGGG":a=a.substr(0,2),b&&(c._w=c._w||{},c._w[a]=z(b));break;case"gg":case"GG":c._w=c._w||{},c._w[a]=rb.parseTwoDigitYear(b)}}function R(a){var c,d,e,f,g,h,i;c=a._w,null!=c.GG||null!=c.W||null!=c.E?(g=1,h=4,d=b(c.GG,a._a[xb],fb(rb(),1,4).year),e=b(c.W,1),f=b(c.E,1)):(g=a._locale._week.dow,h=a._locale._week.doy,d=b(c.gg,a._a[xb],fb(rb(),g,h).year),e=b(c.w,1),null!=c.d?(f=c.d,g>f&&++e):f=null!=c.e?c.e+g:g),i=gb(d,e,f,h,g),a._a[xb]=i.year,a._dayOfYear=i.dayOfYear}function S(a){var c,d,e,f,g=[];if(!a._d){for(e=U(a),a._w&&null==a._a[zb]&&null==a._a[yb]&&R(a),a._dayOfYear&&(f=b(a._a[xb],e[xb]),a._dayOfYear>C(f)&&(a._pf._overflowDayOfYear=!0),d=bb(f,0,a._dayOfYear),a._a[yb]=d.getUTCMonth(),a._a[zb]=d.getUTCDate()),c=0;3>c&&null==a._a[c];++c)a._a[c]=g[c]=e[c];for(;7>c;c++)a._a[c]=g[c]=null==a._a[c]?2===c?1:0:a._a[c];a._d=(a._useUTC?bb:ab).apply(null,g),null!=a._tzm&&a._d.setUTCMinutes(a._d.getUTCMinutes()+a._tzm)}}function T(a){var b;a._d||(b=x(a._i),a._a=[b.year,b.month,b.day,b.hour,b.minute,b.second,b.millisecond],S(a))}function U(a){var b=new Date;return a._useUTC?[b.getUTCFullYear(),b.getUTCMonth(),b.getUTCDate()]:[b.getFullYear(),b.getMonth(),b.getDate()]}function V(a){if(a._f===rb.ISO_8601)return void Z(a);a._a=[],a._pf.empty=!0;for(var c,e,f,g=""+a._i,h=g.length,i=0,d=N(a._f,a._locale).match(Kb)||[],b=0;b<d.length;b++)e=d[b],c=(g.match(O(e,a))||[])[0],c&&(f=g.substr(0,g.indexOf(c)),f.length>0&&a._pf.unusedInput.push(f),g=g.slice(g.indexOf(c)+c.length),i+=c.length),mc[e]?(c?a._pf.empty=!1:a._pf.unusedTokens.push(e),Q(e,c,a)):a._strict&&!c&&a._pf.unusedTokens.push(e);a._pf.charsLeftOver=h-i,g.length>0&&a._pf.unusedInput.push(g),a._isPm&&a._a[Ab]<12&&(a._a[Ab]+=12),a._isPm===!1&&12===a._a[Ab]&&(a._a[Ab]=0),S(a),E(a)}function W(a){return a.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(a,b,c,d,e){return b||c||d||e})}function X(a){return a.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Y(a){var b,d,e,f,g;if(0===a._f.length)return a._pf.invalidFormat=!0,void(a._d=new Date(NaN));for(f=0;f<a._f.length;f++)g=0,b=m({},a),b._pf=c(),b._f=a._f[f],V(b),F(b)&&(g+=b._pf.charsLeftOver,g+=10*b._pf.unusedTokens.length,b._pf.score=g,(null==e||e>g)&&(e=g,d=b));l(a,d||b)}function Z(a){var b,c,d=a._i,e=ac.exec(d);if(e){for(a._pf.iso=!0,b=0,c=cc.length;c>b;b++)if(cc[b][1].exec(d)){a._f=cc[b][0]+(e[6]||" ");break}for(b=0,c=dc.length;c>b;b++)if(dc[b][1].exec(d)){a._f+=dc[b][0];break}d.match(Sb)&&(a._f+="Z"),V(a)}else
 a._isValid=!1}function $(a){Z(a),a._isValid===!1&&(delete a._isValid,rb.createFromInputFallback(a))}function _(b){var c,d=b._i;d===a?b._d=new Date:u(d)?b._d=new Date(+d):null!==(c=Hb.exec(d))?b._d=new Date(+c[1]):"string"==typeof d?$(b):t(d)?(b._a=d.slice(0),S(b)):"object"==typeof d?T(b):"number"==typeof d?b._d=new Date(d):rb.createFromInputFallback(b)}function ab(a,b,c,d,e,f,g){var h=new Date(a,b,c,d,e,f,g);return 1970>a&&h.setFullYear(a),h}function bb(a){var b=new Date(Date.UTC.apply(null,arguments));return 1970>a&&b.setUTCFullYear(a),b}function cb(a,b){if("string"==typeof a)if(isNaN(a)){if(a=b.weekdaysParse(a),"number"!=typeof a)return null}else a=parseInt(a,10);return a}function db(a,b,c,d,e){return e.relativeTime(b||1,!!c,a,d)}function eb(a,b,c){var d=rb.duration(a).abs(),e=wb(d.as("s")),f=wb(d.as("m")),g=wb(d.as("h")),h=wb(d.as("d")),i=wb(d.as("M")),j=wb(d.as("y")),k=e<jc.s&&["s",e]||1===f&&["m"]||f<jc.m&&["mm",f]||1===g&&["h"]||g<jc.h&&["hh",g]||1===h&&["d"]||h<jc.d&&["dd",h]||1===i&&["M"]||i<jc.M&&["MM",i]||1===j&&["y"]||["yy",j];return k[2]=b,k[3]=+a>0,k[4]=c,db.apply({},k)}function fb(a,b,c){var d,e=c-b,f=c-a.day();return f>e&&(f-=7),e-7>f&&(f+=7),d=rb(a).add(f,"d"),{week:Math.ceil(d.dayOfYear()/7),year:d.year()}}function gb(a,b,c,d,e){var f,g,h=bb(a,0,1).getUTCDay();return h=0===h?7:h,c=null!=c?c:e,f=e-h+(h>d?7:0)-(e>h?7:0),g=7*(b-1)+(c-e)+f+1,{year:g>0?a:a-1,dayOfYear:g>0?g:C(a-1)+g}}function hb(b){var c=b._i,d=b._f;return b._locale=b._locale||rb.localeData(b._l),null===c||d===a&&""===c?rb.invalid({nullInput:!0}):("string"==typeof c&&(b._i=c=b._locale.preparse(c)),rb.isMoment(c)?new j(c,!0):(d?t(d)?Y(b):V(b):_(b),new j(b)))}function ib(a,b){var c,d;if(1===b.length&&t(b[0])&&(b=b[0]),!b.length)return rb();for(c=b[0],d=1;d<b.length;++d)b[d][a](c)&&(c=b[d]);return c}function jb(a,b){var c;return"string"==typeof b&&(b=a.localeData().monthsParse(b),"number"!=typeof b)?a:(c=Math.min(a.date(),A(a.year(),b)),a._d["set"+(a._isUTC?"UTC":"")+"Month"](b,c),a)}function kb(a,b){return a._d["get"+(a._isUTC?"UTC":"")+b]()}function lb(a,b,c){return"Month"===b?jb(a,c):a._d["set"+(a._isUTC?"UTC":"")+b](c)}function mb(a,b){return function(c){return null!=c?(lb(this,a,c),rb.updateOffset(this,b),this):kb(this,a)}}function nb(a){return 400*a/146097}function ob(a){return 146097*a/400}function pb(a){rb.duration.fn[a]=function(){return this._data[a]}}function qb(a){"undefined"==typeof ender&&(sb=vb.moment,vb.moment=a?e("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.",rb):rb)}for(var rb,sb,tb,ub="2.8.1",vb="undefined"!=typeof global?global:this,wb=Math.round,xb=0,yb=1,zb=2,Ab=3,Bb=4,Cb=5,Db=6,Eb={},Fb=[],Gb="undefined"!=typeof module&&module.exports,Hb=/^\/?Date\((\-?\d+)/i,Ib=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,Jb=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,Kb=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,Lb=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,Mb=/\d\d?/,Nb=/\d{1,3}/,Ob=/\d{1,4}/,Pb=/[+\-]?\d{1,6}/,Qb=/\d+/,Rb=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Sb=/Z|[\+\-]\d\d:?\d\d/gi,Tb=/T/i,Ub=/[\+\-]?\d+(\.\d{1,3})?/,Vb=/\d{1,2}/,Wb=/\d/,Xb=/\d\d/,Yb=/\d{3}/,Zb=/\d{4}/,$b=/[+-]?\d{6}/,_b=/[+-]?\d+/,ac=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,bc="YYYY-MM-DDTHH:mm:ssZ",cc=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],dc=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],ec=/([\+\-]|\d\d)/gi,fc=("Date|Hours|Minutes|Seconds|Milliseconds".split("|"),{Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6}),gc={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",Q:"quarter",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},hc={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},ic={},jc={s:45,m:45,h:22,d:26,M:11},kc="DDD w W M D d".split(" "),lc="M D H h m s w W".split(" "),mc={M:function(){return this.month()+1},MMM:function(a){return this.localeData().monthsShort(this,a)},MMMM:function(a){return this.localeData().months(this,a)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(a){return this.localeData().weekdaysMin(this,a)},ddd:function(a){return this.localeData().weekdaysShort(this,a)},dddd:function(a){return this.localeData().weekdays(this,a)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return o(this.year()%100,2)},YYYY:function(){return o(this.year(),4)},YYYYY:function(){return o(this.year(),5)},YYYYYY:function(){var a=this.year(),b=a>=0?"+":"-";return b+o(Math.abs(a),6)},gg:function(){return o(this.weekYear()%100,2)},gggg:function(){return o(this.weekYear(),4)},ggggg:function(){return o(this.weekYear(),5)},GG:function(){return o(this.isoWeekYear()%100,2)},GGGG:function(){return o(this.isoWeekYear(),4)},GGGGG:function(){return o(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return z(this.milliseconds()/100)},SS:function(){return o(z(this.milliseconds()/10),2)},SSS:function(){return o(this.milliseconds(),3)},SSSS:function(){return o(this.milliseconds(),3)},Z:function(){var a=-this.zone(),b="+";return 0>a&&(a=-a,b="-"),b+o(z(a/60),2)+":"+o(z(a)%60,2)},ZZ:function(){var a=-this.zone(),b="+";return 0>a&&(a=-a,b="-"),b+o(z(a/60),2)+o(z(a)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()},Q:function(){return this.quarter()}},nc={},oc=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];kc.length;)tb=kc.pop(),mc[tb+"o"]=h(mc[tb],tb);for(;lc.length;)tb=lc.pop(),mc[tb+tb]=g(mc[tb],2);for(mc.DDDD=g(mc.DDD,3),l(i.prototype,{set:function(a){var b,c;for(c in a)b=a[c],"function"==typeof b?this[c]=b:this["_"+c]=b},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(a){return this._months[a.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(a){return this._monthsShort[a.month()]},monthsParse:function(a){var b,c,d;for(this._monthsParse||(this._monthsParse=[]),b=0;12>b;b++)if(this._monthsParse[b]||(c=rb.utc([2e3,b]),d="^"+this.months(c,"")+"|^"+this.monthsShort(c,""),this._monthsParse[b]=new RegExp(d.replace(".",""),"i")),this._monthsParse[b].test(a))return b},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(a){return this._weekdays[a.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(a){return this._weekdaysShort[a.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(a){return this._weekdaysMin[a.day()]},weekdaysParse:function(a){var b,c,d;for(this._weekdaysParse||(this._weekdaysParse=[]),b=0;7>b;b++)if(this._weekdaysParse[b]||(c=rb([2e3,1]).day(b),d="^"+this.weekdays(c,"")+"|^"+this.weekdaysShort(c,"")+"|^"+this.weekdaysMin(c,""),this._weekdaysParse[b]=new RegExp(d.replace(".",""),"i")),this._weekdaysParse[b].test(a))return b},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY LT",LLLL:"dddd, MMMM D, YYYY LT"},longDateFormat:function(a){var b=this._longDateFormat[a];return!b&&this._longDateFormat[a.toUpperCase()]&&(b=this._longDateFormat[a.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(a){return a.slice(1)}),this._longDateFormat[a]=b),b},isPM:function(a){return"p"===(a+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(a,b,c){return a>11?c?"pm":"PM":c?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(a,b){var c=this._calendar[a];return"function"==typeof c?c.apply(b):c},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(a,b,c,d){var e=this._relativeTime[c];return"function"==typeof e?e(a,b,c,d):e.replace(/%d/i,a)},pastFuture:function(a,b){var c=this._relativeTime[a>0?"future":"past"];return"function"==typeof c?c(b):c.replace(/%s/i,b)},ordinal:function(a){return this._ordinal.replace("%d",a)},_ordinal:"%d",preparse:function(a){return a},postformat:function(a){return a},week:function(a){return fb(a,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),rb=function(b,d,e,f){var g;return"boolean"==typeof e&&(f=e,e=a),g={},g._isAMomentObject=!0,g._i=b,g._f=d,g._l=e,g._strict=f,g._isUTC=!1,g._pf=c(),hb(g)},rb.suppressDeprecationWarnings=!1,rb.createFromInputFallback=e("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407
 for more info.",function(a){a._d=new Date(a._i)}),rb.min=function(){var a=[].slice.call(arguments,0);return ib("isBefore",a)},rb.max=function(){var a=[].slice.call(arguments,0);return ib("isAfter",a)},rb.utc=function(b,d,e,f){var g;return"boolean"==typeof e&&(f=e,e=a),g={},g._isAMomentObject=!0,g._useUTC=!0,g._isUTC=!0,g._l=e,g._i=b,g._f=d,g._strict=f,g._pf=c(),hb(g).utc()},rb.unix=function(a){return rb(1e3*a)},rb.duration=function(a,b){var c,d,e,f,g=a,h=null;return rb.isDuration(a)?g={ms:a._milliseconds,d:a._days,M:a._months}:"number"==typeof a?(g={},b?g[b]=a:g.milliseconds=a):(h=Ib.exec(a))?(c="-"===h[1]?-1:1,g={y:0,d:z(h[zb])*c,h:z(h[Ab])*c,m:z(h[Bb])*c,s:z(h[Cb])*c,ms:z(h[Db])*c}):(h=Jb.exec(a))?(c="-"===h[1]?-1:1,e=function(a){var b=a&&parseFloat(a.replace(",","."));return(isNaN(b)?0:b)*c},g={y:e(h[2]),M:e(h[3]),d:e(h[4]),h:e(h[5]),m:e(h[6]),s:e(h[7]),w:e(h[8])}):"object"==typeof g&&("from"in g||"to"in g)&&(f=q(rb(g.from),rb(g.to)),g={},g.ms=f.milliseconds,g.M=f.months),d=new k(g),rb.isDuration(a)&&a.hasOwnProperty("_locale")&&(d._locale=a._locale),d},rb.version=ub,rb.defaultFormat=bc,rb.ISO_8601=function(){},rb.momentProperties=Fb,rb.updateOffset=function(){},rb.relativeTimeThreshold=function(b,c){return jc[b]===a?!1:c===a?jc[b]:(jc[b]=c,!0)},rb.lang=e("moment.lang is deprecated. Use moment.locale instead.",function(a,b){return rb.locale(a,b)}),rb.locale=function(a,b){var c;return a&&(c="undefined"!=typeof b?rb.defineLocale(a,b):rb.localeData(a),c&&(rb.duration._locale=rb._locale=c)),rb._locale._abbr},rb.defineLocale=function(a,b){return null!==b?(b.abbr=a,Eb[a]||(Eb[a]=new i),Eb[a].set(b),rb.locale(a),Eb[a]):(delete Eb[a],null)},rb.langData=e("moment.langData is deprecated. Use moment.localeData instead.",function(a){return rb.localeData(a)}),rb.localeData=function(a){var b;if(a&&a._locale&&a._locale._abbr&&(a=a._locale._abbr),!a)return rb._locale;if(!t(a)){if(b=I(a))return b;a=[a]}return H(a)},rb.isMoment=function(a){return a instanceof j||null!=a&&a.hasOwnProperty("_isAMomentObject")},rb.isDuration=function(a){return a instanceof k},tb=oc.length-1;tb>=0;--tb)y(oc[tb]);rb.normalizeUnits=function(a){return w(a)},rb.invalid=function(a){var b=rb.utc(NaN);return null!=a?l(b._pf,a):b._pf.userInvalidated=!0,b},rb.parseZone=function(){return rb.apply(null,arguments).parseZone()},rb.parseTwoDigitYear=function(a){return z(a)+(z(a)>68?1900:2e3)},l(rb.fn=j.prototype,{clone:function(){return rb(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var a=rb(this).utc();return 0<a.year()&&a.year()<=9999?M(a,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):M(a,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var a=this;return[a.year(),a.month(),a.date(),a.hours(),a.minutes(),a.seconds(),a.milliseconds()]},isValid:function(){return F(this)},isDSTShifted:function(){return this._a?this.isValid()&&v(this._a,(this._isUTC?rb.utc(this._a):rb(this._a)).toArray())>0:!1},parsingFlags:function(){return l({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(a){return this.zone(0,a)},local:function(a){return this._isUTC&&(this.zone(0,a),this._isUTC=!1,a&&this.add(this._d.getTimezoneOffset(),"m")),this},format:function(a){var b=M(this,a||rb.defaultFormat);return this.localeData().postformat(b)},add:r(1,"add"),subtract:r(-1,"subtract"),diff:function(a,b,c){var d,e,f=J(a,this),g=6e4*(this.zone()-f.zone());return b=w(b),"year"===b||"month"===b?(d=432e5*(this.daysInMonth()+f.daysInMonth()),e=12*(this.year()-f.year())+(this.month()-f.month()),e+=(this-rb(this).startOf("month")-(f-rb(f).startOf("month")))/d,e-=6e4*(this.zone()-rb(this).startOf("month").zone()-(f.zone()-rb(f).startOf("month").zone()))/d,"year"===b&&(e/=12)):(d=this-f,e="second"===b?d/1e3:"minute"===b?d/6e4:"hour"===b?d/36e5:"day"===b?(d-g)/864e5:"week"===b?(d-g)/6048e5:d),c?e:n(e)},from:function(a,b){return rb.duration({to:this,from:a}).locale(this.locale()).humanize(!b)},fromNow:function(a){return this.from(rb(),a)},calendar:function(a){var b=a||rb(),c=J(b,this).startOf("day"),d=this.diff(c,"days",!0),e=-6>d?"sameElse":-1>d?"lastWeek":0>d?"lastDay":1>d?"sameDay":2>d?"nextDay":7>d?"nextWeek":"sameElse";return this.format(this.localeData().calendar(e,this))},isLeapYear:function(){return D(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(a){var b=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=a?(a=cb(a,this.localeData()),this.add(a-b,"d")):b},month:mb("Month",!0),startOf:function(a){switch(a=w(a)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===a?this.weekday(0):"isoWeek"===a&&this.isoWeekday(1),"quarter"===a&&this.month(3*Math.floor(this.month()/3)),this},endOf:function(a){return a=w(a),this.startOf(a).add(1,"isoWeek"===a?"week":a).subtract(1,"ms")},isAfter:function(a,b){return b="undefined"!=typeof b?b:"millisecond",+this.clone().startOf(b)>+rb(a).startOf(b)},isBefore:function(a,b){return b="undefined"!=typeof b?b:"millisecond",+this.clone().startOf(b)<+rb(a).startOf(b)},isSame:function(a,b){return b=b||"ms",+this.clone().startOf(b)==+J(a,this).startOf(b)},min:e("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(a){return a=rb.apply(null,arguments),this>a?this:a}),max:e("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(a){return a=rb.apply(null,arguments),a>this?this:a}),zone:function(a,b){var c,d=this._offset||0;return null==a?this._isUTC?d:this._d.getTimezoneOffset():("string"==typeof a&&(a=P(a)),Math.abs(a)<16&&(a=60*a),!this._isUTC&&b&&(c=this._d.getTimezoneOffset()),this._offset=a,this._isUTC=!0,null!=c&&this.subtract(c,"m"),d!==a&&(!b||this._changeInProgress?s(this,rb.duration(d-a,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,rb.updateOffset(this,!0),this._changeInProgress=null)),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return this._tzm?this.zone(this._tzm):"string"==typeof this._i&&this.zone(this._i),this},hasAlignedHourOffset:function(a){return a=a?rb(a).zone():0,(this.zone()-a)%60==0},daysInMonth:function(){return A(this.year(),this.month())},dayOfYear:function(a){var b=wb((rb(this).startOf("day")-rb(this).startOf("year"))/864e5)+1;return null==a?b:this.add(a-b,"d")},quarter:function(a){return null==a?Math.ceil((this.month()+1)/3):this.month(3*(a-1)+this.month()%3)},weekYear:function(a){var b=fb(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return null==a?b:this.add(a-b,"y")},isoWeekYear:function(a){var b=fb(this,1,4).year;return null==a?b:this.add(a-b,"y")},week:function(a){var b=this.localeData().week(this);return null==a?b:this.add(7*(a-b),"d")},isoWeek:function(a){var b=fb(this,1,4).week;return null==a?b:this.add(7*(a-b),"d")},weekday:function(a){var b=(this.day()+7-this.localeData()._week.dow)%7;return null==a?b:this.add(a-b,"d")},isoWeekday:function(a){return null==a?this.day()||7:this.day(this.day()%7?a:a-7)},isoWeeksInYear:function(){return B(this.year(),1,4)},weeksInYear:function(){var a=this.localeData()._week;return B(this.year(),a.dow,a.doy)},get:function(a){return a=w(a),this[a]()},set:function(a,b){return a=w(a),"function"==typeof this[a]&&this[a](b),this},locale:function(b){return b===a?this._locale._abbr:(this._locale=rb.localeData(b),this)},lang:e("moment().lang() is deprecated. Use moment().localeData() instead.",function(b){return b===a?this.localeData():(this._locale=rb.localeData(b),this)}),localeData:function(){return this._locale}}),rb.fn.millisecond=rb.fn.milliseconds=mb("Milliseconds",!1),rb.fn.second=rb.fn.seconds=mb("Seconds",!1),rb.fn.minute=rb.fn.minutes=mb("Minutes",!1),rb.fn.hour=rb.fn.hours=mb("Hours",!0),rb.fn.date=mb("Date",!0),rb.fn.dates=e("dates accessor is deprecated. Use date instead.",mb("Date",!0)),rb.fn.year=mb("FullYear",!0),rb.fn.years=e("years accessor is deprecated. Use year instead.",mb("FullYear",!0)),rb.fn.days=rb.fn.day,rb.fn.months=rb.fn.month,rb.fn.weeks=rb.fn.week,rb.fn.isoWeeks=rb.fn.isoWeek,rb.fn.quarters=rb.fn.quarter,rb.fn.toJSON=rb.fn.toISOString,l(rb.duration.fn=k.prototype,{_bubble:function(){var a,b,c,d=this._milliseconds,e=this._days,f=this._months,g=this._data,h=0;g.milliseconds=d%1e3,a=n(d/1e3),g.seconds=a%60,b=n(a/60),g.minutes=b%60,c=n(b/60),g.hours=c%24,e+=n(c/24),h=n(nb(e)),e-=n(ob(h)),f+=n(e/30),e%=30,h+=n(f/12),f%=12,g.days=e,g.months=f,g.years=h},abs:function(){return this._milliseconds=Math.abs(this._milliseconds),this._days=Math.abs(this._days),this._months=Math.abs(this._months),this._data.milliseconds=Math.abs(this._data.milliseconds),this._data.seconds=Math.abs(this._data.seconds),this._data.minutes=Math.abs(this._data.minutes),this._data.hours=Math.abs(this._data.hours),this._data.months=Math.abs(this._data.months),this._data.years=Math.abs(this._data.years),this},weeks:function(){return n(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*z(this._months/12)},humanize:function(a){var b=eb(this,!a,this.localeData());return a&&(b=this.localeData().pastFuture(+this,b)),this.localeData().postformat(b)},add:function(a,b){var c=rb.duration(a,b);return this._milliseconds+=c._milliseconds,this._days+=c._days,this._months+=c._months,this._bubble(),this},subtract:function(a,b){var c=rb.duration(a,b);return this._milliseconds-=c._milliseconds,this._days-=c._days,this._months-=c._months,this._bubble(),this},get:function(a){return
 a=w(a),this[a.toLowerCase()+"s"]()},as:function(a){var b,c;if(a=w(a),b=this._days+this._milliseconds/864e5,"month"===a||"year"===a)return c=this._months+12*nb(b),"month"===a?c:c/12;switch(b+=ob(this._months/12),a){case"week":return b/7;case"day":return b;case"hour":return 24*b;case"minute":return 1440*b;case"second":return 86400*b;case"millisecond":return 864e5*b;default:throw new Error("Unknown unit "+a);}},lang:rb.fn.lang,locale:rb.fn.locale,toIsoString:e("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",function(){return this.toISOString()}),toISOString:function(){var a=Math.abs(this.years()),b=Math.abs(this.months()),c=Math.abs(this.days()),d=Math.abs(this.hours()),e=Math.abs(this.minutes()),f=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(a?a+"Y":"")+(b?b+"M":"")+(c?c+"D":"")+(d||e||f?"T":"")+(d?d+"H":"")+(e?e+"M":"")+(f?f+"S":""):"P0D"},localeData:function(){return this._locale}});for(tb in fc)fc.hasOwnProperty(tb)&&pb(tb.toLowerCase());rb.duration.fn.asMilliseconds=function(){return this.as("ms")},rb.duration.fn.asSeconds=function(){return this.as("s")},rb.duration.fn.asMinutes=function(){return this.as("m")},rb.duration.fn.asHours=function(){return this.as("h")},rb.duration.fn.asDays=function(){return this.as("d")},rb.duration.fn.asWeeks=function(){return this.as("weeks")},rb.duration.fn.asMonths=function(){return this.as("M")},rb.duration.fn.asYears=function(){return this.as("y")},rb.locale("en",{ordinal:function(a){var b=a%10,c=1===z(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+c}}),Gb?module.exports=rb:"function"==typeof define&&define.amd?(define("moment",function(a,b,c){return c.config&&c.config()&&c.config().noGlobal===!0&&(vb.moment=sb),rb}),qb(!0)):qb()}).call(this);
(function($){$.fn.listnav=function(options){var opts=$.extend({},$.fn.listnav.defaults,options),letters=["_","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","-"],firstClick=!1;return opts.prefixes=$.map(opts.prefixes,function(n){return n.toLowerCase()}),this.each(function(){function init(){var cookieLetter,i;if($wrapper.append(createLettersHtml()),$letters=$(".ln-letters",$wrapper).slice(0,1),opts.showCounts&&($letterCount=$(".ln-letter-count",$wrapper).slice(0,1)),addClasses(),addNoMatchLI(),opts.flagDisabled&&addDisabledClass(),bindHandlers(),opts.includeAll||$list.show(),opts.includeAll||$(".all",$letters).remove(),opts.includeNums||$("._",$letters).remove(),opts.includeOther||$(".-",$letters).remove(),$(":last",$letters).addClass("ln-last"),$.cookie&&opts.cookieName!=null&&(cookieLetter=$.cookie(opts.cookieName),cookieLetter!=null&&(opts.initLetter=cookieLetter)),opts.initLetter!="")firstClick=!0,$("."+opts.initLetter.toLowerCase(),$letters).slice(0,1).click();else if(opts.includeAll)$(".all",$letters).addClass("ln-selected");else for(i=opts.includeNums?0:1;i<letters.length;i++)if(counts[letters[i]]>0){firstClick=!0,$("."+letters[i],$letters).slice(0,1).click();break}}function setLetterCountTop(){$letterCount.css({top:$(".a",$letters).slice(0,1).offset({margin:!1,border:!0}).top-$letterCount.outerHeight({margin:!0})})}function addClasses(){var str,firstChar,firstWord,spl,$this,hasPrefixes=opts.prefixes.length>0;$($list).children().each(function(){$this=$(this),firstChar="",str=$.trim($this.text()).toLowerCase(),str!=""&&(hasPrefixes&&(spl=str.split(" "),spl.length>1&&$.inArray(spl[0],opts.prefixes)>-1&&(firstChar=spl[1].charAt(0),addLetterClass(firstChar,$this,!0))),firstChar=str.charAt(0),addLetterClass(firstChar,$this))})}function addLetterClass(firstChar,$el,isPrefix){/\W/.test(firstChar)&&(firstChar="-"),isNaN(firstChar)||(firstChar="_"),$el.addClass("ln-"+firstChar),counts[firstChar]==undefined&&(counts[firstChar]=0),counts[firstChar]++,isPrefix||allCount++}function addDisabledClass(){for(var i=0;i<letters.length;i++)counts[letters[i]]==undefined&&$("."+letters[i],$letters).addClass("ln-disabled")}function addNoMatchLI(){$list.append('<li class="ln-no-match" style="display:none">'+opts.noMatchText+"</li>")}function getLetterCount(el){if($(el).hasClass("all"))return allCount;var count=counts[$(el).attr("class").split(" ")[0]];return count!=undefined?count:0}function bindHandlers(){opts.showCounts&&$wrapper.mouseover(function(){setLetterCountTop()}),opts.showCounts&&($("a",$letters).mouseover(function(){var left=$(this).position().left,width=$(this).outerWidth({margin:!0})-1+"px",count=getLetterCount(this);$letterCount.css({left:left,width:width}).text(count).show()}),$("a",$letters).mouseout(function(){$letterCount.hide()})),$("a",$letters).click(function(){var letter,count;if($("a.ln-selected",$letters).removeClass("ln-selected"),letter=$(this).attr("class").split(" ")[0],letter=="all"?($list.children().show(),$list.children(".ln-no-match").hide(),isAll=!0):(isAll?($list.children().hide(),isAll=!1):prevLetter!=""&&$list.children(".ln-"+prevLetter).hide(),count=getLetterCount(this),count>0?($list.children(".ln-no-match").hide(),$list.children(".ln-"+letter).show()):$list.children(".ln-no-match").show(),prevLetter=letter),$.cookie&&opts.cookieName!=null&&$.cookie(opts.cookieName,letter),$(this).addClass("ln-selected"),$(this).blur(),firstClick||opts.onClick==null)firstClick=!1;else opts.onClick(letter);return!1})}function createLettersHtml(){for(var html=[],i=1;i<letters.length;i++)html.length==0&&html.push('<a class="all" href="#">ALL</a><a class="_" href="#">0-9</a>'),html.push('<a class="'+letters[i]+'" href="#">'+(letters[i]=="-"?"...":letters[i].toUpperCase())+"</a>");return'<div class="ln-letters">'+html.join("")+"</div>"+(opts.showCounts?'<div class="ln-letter-count" style="display:none; position:absolute; top:0; left:0; width:20px;">0</div>':"")}var $wrapper,list,$list,$letters,$letterCount,id;id=this.id,$wrapper=$("#"+id+"-nav"),$list=$(this);var counts={},allCount=0,isAll=!0,numCount=0,prevLetter="";init()})},$.fn.listnav.defaults={initLetter:"",includeAll:!0,incudeOther:!1,includeNums:!0,flagDisabled:!0,noMatchText:"No matching entries",showCounts:!0,cookieName:null,onClick:null,prefixes:[]}})(jQuery);
(function($,wc){function isString(s){return Object.prototype.toString.call(s)=="[object String]"}function executeMethod(method,content,options,cb){if(arguments.length==0)return proxyMethods.call(this);var m=methods[method];return method=="load"?load.call(this,content,options,cb):(m||error(method),doEach.call(this,content,options,m))}function proxyMethods(){function F(){var _this=this,sanitizing=!1;this[PROXIED]=!0,$.each(methods,function(method){var _super=jq[method];_super&&(_this[method]=function(content,options,cb){if(!sanitizing&&isString(content))try{return sanitizing=!0,executeMethod.call(_this,method,content,options,cb)}finally{sanitizing=!1}return _super.apply(_this,arguments)})}),this.pushStack=function(){return proxyMethods.call(jq.pushStack.apply(_this,arguments))},this.endCapture=function(){return jq}}if(this[PROXIED])return this;var jq=this;return F.prototype=jq,new F}function doEach(content,options,action){var done,self=this;return options&&options.done?(done=options.done,delete options.done):$.isFunction(options)&&(done=options,options=null),wc.sanitizeSerial($.map(this,function(el){return{html:content,options:options,action:function(text){action.call(el,text)}}}),done&&function(){done.call(self)}||done),this}function html(safe){$(this).html(safe)}function makeMethod(method){return function(safe){$(this)[method](safe)}}function load(url,options,callback){var self=this,selector,off=url.indexOf(" ");return off>=0&&(selector=url.slice(off,url.length),url=url.slice(0,off)),$.isFunction(callback)&&(options=options||{},options.done=callback),$.ajax({url:url,type:options&&options.type||"GET",dataType:"html",data:options&&options.params,complete:loadCallback(self,options,selector)})}function loadCallback(self,options,selector){return function(res,status){if(status=="success"||status=="notmodified"){var text=getText(res.responseText,selector);doEach.call(self,text,options,html)}}}function getText(text,selector){if(!selector||!text)return text;var id=0,scripts={};return $("<div/>").append(text.replace(/<script(.|\s)*?\/script>/g,function(s){return scripts[id]=s,"jquery-writeCapture-script-placeholder-"+id+++"-wc"})).find(selector).html().replace(PLACEHOLDER,function(all,id){return scripts[id]})}function error(method){throw"invalid method parameter "+method;}var methods={html:html},PROXIED,PLACEHOLDER;$.each(["append","prepend","after","before","wrap","wrapAll","replaceWith","wrapInner"],function(){methods[this]=makeMethod(this)}),$.fn.writeCapture=executeMethod,PROXIED="__writeCaptureJsProxied-fghebd__",PLACEHOLDER=/jquery-writeCapture-script-placeholder-(\d+)-wc/g,$.writeCapture=wc})(jQuery,writeCapture.noConflict());
Agility.RegisterNamespace("BNN.Modules.MarketMonitor"),function(MarketMonitor){var indexes,defaults={Container:{}},_properties=null,reutersData=[],selectedQuote=null,type="1year";MarketMonitor.OnInit=function(p){var tsxsectors,sptsxSymbol,periods,marketData,processed,data;for(_properties=$.extend({},defaults,p||{}),indexes=eval("("+_properties.Indexes+")"),tsxsectors=eval("("+_properties.TSXSectors+")"),sptsxSymbol=_properties.SPTSXSymbol,marketData=[],processed=0,i=0;i<indexes.length;i++)$.getJSON(MarketDataServiceUrl+"/GetStockQuote?symbol="+indexes[i].Symbol+"",function(result){if(result!=undefined&&result.NetChange!=null){result.Ticker==".GSPTSE"&&(BNN.Controls.TimeSeriesChart.StockDetailsChart("#MarketMonitor .PriceChart",result,type,!1),selectedQuote=result);var change=result.NetChange;change=change.indexOf(".")==0?"+0"+change:change.indexOf("-.")==0?"-0"+change.substring(1):change.indexOf("+.")==0?"+0"+change.substring(1):change.indexOf("+")!=0&&change.indexOf("-")!=0?"+"+change:change,marketData.push({Ticker:result.Ticker,Order:_getOrderFromMarketSymbols(result.Ticker),Name:_getMarketNameFromTicker(result.Ticker),NetChange:change,Price:_addCommas(result.Last),CssClass:result.NetChange==undefined||result.NetChange==""?"Neutral":result.NetChange.indexOf("-")==0?"Negative":"Positive"}),processed++}marketData.length==indexes.length&&(marketData.sort(function(a,b){return a.Order<b.Order?-1:1}),_processMarketTemplate(marketData),$("#MarketMonitor .Indexes div.Market:first-child").addClass("Selected")),reutersData.splice(_getOrderFromMarketSymbols(result.Ticker),0,result)});for($.getJSON(MarketDataServiceUrl+"/GetStockQuote?symbol="+sptsxSymbol+"",function(result){var marketData=[],cssClass,percentChange,container;result!=undefined&&(result.Last!=undefined&&(cssClass="Neutral",marketData.push({Name:_properties.LastLabel,Value:_addCommas(result.Last),CssClass:cssClass})),result.NetChange!=undefined&&(cssClass=_getCssClass(result.NetChange),marketData.push({Name:_properties.NetChangeLabel,Value:result.NetChange,CssClass:cssClass})),result.PercentChange!=undefined&&(cssClass=_getCssClass(result.PercentChange),percentChange=_keepTwoDecimals(_addZero(result.PercentChange)),marketData.push({Name:_properties.PercentChangeLabel,Value:percentChange,CssClass:cssClass})),result.Volume!=undefined&&(cssClass="Neutral",marketData.push({Name:_properties.VolumeLabel,Value:_addCommas(result.Volume),CssClass:cssClass})),result.W52High!=undefined&&(cssClass="Neutral",marketData.push({Name:_properties.High52WeekLabel,Value:_addCommas(result.W52High),CssClass:cssClass})),result.W52Low!=undefined&&(cssClass="Neutral",marketData.push({Name:_properties.Low52WeekLabel,Value:_addCommas(result.W52Low),CssClass:cssClass})),container=$("#SPTSXTable"),container.hasTemplate()||container.setTemplateURL(Agility.ResolveUrl("~/ClientTemplates/MarketMonitorSPTSX.htm")),container.processTemplate(marketData))}),data=[],processed=0,i=0;i<tsxsectors.length;i++)$.getJSON(MarketDataServiceUrl+"/GetStockQuote?symbol="+tsxsectors[i].Symbol+"",function(result){var container;if(result!=undefined){var value=result.PercentChange,cssClass=_getCssClass(value),order=_getOrderFromTSXSector(tsxsectors,result.Ticker),name=order<99?tsxsectors[order].Name:result.CompanyName;value=_formatCurrency(value),value=_keepTwoDecimals(value),data.push({Order:order,Name:name,Value:value,CssClass:cssClass})}processed++,processed>=tsxsectors.length-1&&(data.sort(function(a,b){return a.Order<b.Order?-1:1}),container=$("#TSXSectorsTable"),container.hasTemplate()||container.setTemplateURL(Agility.ResolveUrl("~/ClientTemplates/MarketMonitorTSXSectors.htm")),container.processTemplate(data))});$("#MarketMonitor .ChartNavContainer button").click(function(event){event.preventDefault(),type=$(this).attr("id"),$(this).addClass("Selected"),$.each($("#MarketMonitor .ChartNavContainer button").not($(this)),function(){$(this).removeClass("Selected")}),BNN.Controls.TimeSeriesChart.StockDetailsChart("#MarketMonitor .PriceChart",selectedQuote,type,!1)})},_getCssClass=function(val){var positive=val!=null&&val!=""&&val.indexOf("-")!=0;return val=="0"||val==""?"Neutral":positive?"Positive":"Negative"},_addCommas=function(val){for(var regEx=/(\d+)(\d{3})/;regEx.test(val);)val=val.replace(regEx,"$1,$2");return val},_keepTwoDecimals=function(val){var tmpFloat=Math.round(100*parseFloat(val))/100;return tmpFloat.toString()},_addZero=function(val){return val.indexOf(".")==0?"0"+val:val.indexOf("-.")==0?"-0"+val.substring(1):val.indexOf("+.")==0?"+0"+val.substring(1):val},_getOrderFromTSXSector=function(tsxsectors,ticker){for(var i=0;i<tsxsectors.length;i++)if(tsxsectors[i].Symbol==ticker)return i;return 99},_formatCurrency=function(data){var tmp=data;return tmp.indexOf("-")==0&&(tmp=tmp.substring(1)),tmp.indexOf(".")==0&&(tmp="0"+tmp),tmp},_processMarketTemplate=function(data){var container=$("#MarketMonitor .Indexes");container.hasTemplate()||container.setTemplateURL(Agility.ResolveUrl("~/ClientTemplates/MarketMonitor.htm")),container.processTemplate(data)},_getOrderFromMarketSymbols=function(ticker){for(var i=0;i<indexes.length;i++)if(indexes[i].Symbol.indexOf(ticker)==0)return i},_getMarketNameFromTicker=function(ticker){for(var i=0;i<indexes.length;i++)if(indexes[i].Symbol.indexOf(ticker)==0)return indexes[i].Name},_marketDivClick=function(event){var obj=event.currentTarget!=undefined?event.currentTarget:event.srcElement!=undefined?event.srcElement:event.target,parentObj=obj.parentNode,symbol,i;for($(parentObj).is(".Market")&&(obj=parentObj),$("#MarketMonitor .Indexes div").each(function(index,item){$(item).removeClass("Selected")}),$(obj).addClass("Selected"),symbol=$(obj).attr("data"),i=0;i<reutersData.length;i++)reutersData[i].Ticker.indexOf(symbol)==0&&(selectedQuote=reutersData[i]);BNN.Controls.TimeSeriesChart.StockDetailsChart("#MarketMonitor .PriceChart",selectedQuote,type,!1),$("#MarketMonitor  .ChartFilterContainer .ChartFilterItem:first-child").addClass("Selected"),$.each($("#MarketMonitor  .ChartFilterContainer .ChartFilterItem").not($("#MarketMonitor  .ChartFilterContainer .ChartFilterItem:first-child")),function(){$(this).removeClass("Selected")})}}(BNN.Modules.MarketMonitor);
Agility.RegisterNamespace("BNN.NewsBySector"),function(NewsBySector){NewsBySector.OnInit=function(p){var client=$("#"+p.ClientID);$.ajax({url:AjaxWebserviceSvcUrl+"/GetNewsBySector?newsBySectorToShow="+p.NewsBySectorToShow,contentType:"application/json",dataType:"json",success:function(jsonResponse){if(jsonResponse!=undefined&&jsonResponse!=null){var html="";$.each(jsonResponse,function(i,newsBySector){$.each(newsBySector.Stories,function(ii,story){html+="<li><a href='"+story.Url+"'>"+story.Headline+"</a></li>"}),$(html).insertAfter(client.find("li[data-id="+newsBySector.Category.ContentID+"]")),html=""})}}})}}(BNN.NewsBySector);
Agility.RegisterNamespace("BNN.NewsBySectorArchive"),function(NewsBySectorArchive){function renderTip(){$(".archiveTip").tooltip({effect:"slide",position:"bottom right",offset:[-20,0]}),$("ul.tabs").tabs2("div.panes > div")}function isVideo(video){return video!=null?'&nbsp;<img class="icon-align" src=/Images/Icons/icn_video_small.png  />':"&nbsp;"}NewsBySectorArchive.OnInit=function(p){var client=$("#"+p.ClientID);$.ajax({url:AjaxWebserviceSvcUrl+"/GetNewsBySector?newsBySectorToShow="+p.NewsBySectorToShow,contentType:"application/json",dataType:"json",success:function(jsonResponse){if(jsonResponse!=undefined&&jsonResponse!=null){var html="";$.each(jsonResponse,function(i,newsBySector){$.each(newsBySector.Stories,function(ii,story){html+="<li><a href='"+story.Url+"'>"+story.Headline+"</a>"+isVideo(story.Video)+"</li>"}),$(html).insertAfter(client.find("li[data-id="+newsBySector.Category.ContentID+"]")),html=""})}}}),renderTip()}}(BNN.NewsBySectorArchive);
Agility.RegisterNamespace("BNN.Polls"),function(Polls){function submitAnswer(){var selectedRadioButton=$(".Polls input:checked"),selectedAnswer=0;selectedRadioButton.length>0&&(selectedAnswer=selectedRadioButton.val()),selectedAnswer>0?$.ajax({type:"POST",url:AjaxWebserviceUrlNoCache+"/SubmitPoll",data:"{'pollId':"+pollID+",'answerId':"+selectedAnswer+"}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(result){result.d!=undefined&&result.d!=null&&(setPollCookie(selectedAnswer),BNN.Polls.ShowResults())},complete:function(){}}):alert("You must select an answer first.")}function getPollCookie(){return BNN.Cookie.Get("BNN_PollCookie_"+pollID)}function setPollCookie(answerID){var currentDate=new Date,minutes=(23-currentDate.getHours())*60+(60-currentDate.getMinutes());BNN.Cookie.Set("BNN_PollCookie_"+pollID,answerID,minutes)}function formatTwoDecimalPlaces(number){return Math.round(number*100)/100}var pollID=0,pnlPollID="",Question="",Answers=[];Polls.OnInit=function(pnlpollID,argPollID,ResultsOnly,question,answers){pnlPollID=pnlpollID,pollID=argPollID,Question=question,Answers=answers;var cookie=getPollCookie();cookie!=null&&cookie.length>0||ResultsOnly?BNN.Polls.ShowResults():$("#PollVoteContainer").show(),$("#btnPollVote").bind("click",submitAnswer)},Polls.ShowResults=function(){$.ajax({type:"POST",url:AjaxWebserviceUrlMinCache+"/GetPollResults",data:"{'pollId':"+pollID+"}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(result){var answerTotals,total,html,runningPercentage,i,key,j,percentage,width,cookie;if(result.d!=undefined&&result.d!=null){for(answerTotals={},i=0;i<Answers.length;i++)key=Answers[i].AnswerID.toString(),answerTotals[key]=0;for(total=0,i=0;i<result.d.length;i++)(key=result.d[i].AnswerID.toString(),typeof answerTotals[key]!="undefined")&&(total+=result.d[i].AnswerCount);for(html="",runningPercentage=0,i=0;i<Answers.length;i++){for(key=Answers[i].AnswerID.toString(),j=0;j<result.d.length;j++)Answers[i].AnswerID==result.d[j].AnswerID&&(answerTotals[key]+=result.d[j].AnswerCount);percentage=formatTwoDecimalPlaces(answerTotals[key]/total*100),i==Answers.length-1&&(percentage=formatTwoDecimalPlaces(100-runningPercentage)),runningPercentage+=percentage,width=230/100*percentage,html+='<div class="PollResult"><div class="Answer">'+Answers[i].Answer+':</div><div class="Bar"><img src="/Images/Backgrounds/new-poll-bar.png" height="25px" width="'+width+'px" /></div><div class="Percentage">'+percentage+'%</div></div><div class="Clear"></div>'}$("#PollResultsContainer").html(html),$("#PollVoteContainer").show(),$("#PollAnswerContainer").hide(),$("#btnPollVote").hide(),$("#PollResultsLink").hide(),$("#PollResultsContainer").show(),$("#PollResultsLabel").show(),cookie=getPollCookie(),(cookie==null||cookie.length==0)&&$("#PollVoteLink").show()}},complete:function(){}})},Polls.ShowVote=function(){$("#PollResultsContainer").html(""),$("#PollAnswerContainer").show(),$("#btnPollVote").show(),$("#PollResultsLink").show(),$("#PollResultsContainer").hide(),$("#PollResultsLabel").hide(),$("#PollVoteLink").hide()}}(BNN.Polls);
Agility.RegisterNamespace("BNN.SearchResults"),function(SearchResults){function searchInStocks(searchFor,pageSize,pageNo){var wsURL=MarketDataServiceUrl+"/GetReutersSearch?text="+searchFor+"&PageSize=10&PageNo="+pageNo+"",container=$("tbody.SearchResultsInStocks");$(".Loading",container).css("height","185px"),$(".Loading",container).show(),$(container).html('<tr class="Loading"><td colspan="6" style="text-align:center"></td></tr>'),$(".Loading",container).css("height","185px"),$.getJSON(wsURL,function(result){var templateUrl,stockTotal;result!=undefined&&result.Results!=null&&result.Results.length>0?(templateUrl=Agility.ResolveUrl("~/ClientTemplates/SearchResultsInStocks.htm"),container.setTemplateURL(templateUrl),container.setParam("formatNumber",formatNumber),container.processTemplate(result.Results),stockTotal=parseInt(result.TotalResults),PagerRender($("div.SearchResultsInStocksPager"),stockTotal,10,pageNo+1),calculateCombinedTotal(parseInt(result.TotalResults))):pageNo>0?(pageNo=pageNo-1,container.data("paginationIssueMode",!0),searchInStocks(searchFor,pageSize,pageNo)):($(".Loading",container).hide(),$(".StockSearch",container).show(),container.parent().find("thead").remove(),container.parent().next().hide(),calculateCombinedTotal(0))})}function searchInPicks(searchFor,pageSize,pageNo){var total=0;$.ajax({url:AjaxWebserviceSvcUrl+"/SearchNewShowGuestPicks_Search?query="+searchFor+"&pageNum="+pageNo+"&pageSize="+pageSize,contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var result={d:jsonResponse},container=$("ul.SearchResultsInGuestPicks"),templateUrl,paginationIssueMode;result.d!=undefined&&result.d!=null&&result.d.TotalCount>0?(templateUrl=Agility.ResolveUrl("~/ClientTemplates/SearchResultsInGuestPicks.htm"),container.setTemplateURL(templateUrl),container.processTemplate(result.d.NewGuestAppearances),$.each(result.d.NewGuestAppearances,function(i,l){l.PickDescription!=""&&($(".SearchResults ul li#Guest_"+l.ContentID).addClass("HasOptions"),$(".SearchResults ul li#Guest_"+l.ContentID).tooltip({effect:"slide",position:"center right",offset:[0,-50]}))}),total=estimatedTotalResults(container,parseInt(result.d.TotalCount),pageNo*PageSize,result.d.NewGuestAppearances.length,PageSize),paginationIssueMode=eval(container.data("paginationIssueMode")),paginationIssueMode?(pageNo=Math.floor(total/pageSize),searchInPicks(searchFor,pageSize,pageNo)):PagerRender($("div.SearchResultsInGuestPicksPager"),total,pageSize,pageNo+1)):pageNo>0?(pageNo=pageNo-1,container.data("paginationIssueMode",!0),searchInPicks(searchFor,pageSize,pageNo)):(container.html($("#divNoResultsMessage").html()),container.next().hide())},complete:function(){calculateCombinedTotal(total)}})}function searchInGoogle(searchFor,pageSize,pageNo,contentType){var total=0;contentType!=undefined&&contentType!=""&&$.ajax({url:AjaxWebserviceSvcUrl+"/Search?query="+escape(searchFor)+"&PageSize="+pageSize+"&PageNo="+pageNo+"&PageType="+contentType+"s",contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var result={d:jsonResponse},container=$("ul.SearchResultsIn"+contentType+"s"),templateUrl,paginationIssueMode;result.d!=undefined&&result.d!=null&&result.d.Results.length>0?(templateUrl=Agility.ResolveUrl("~/ClientTemplates/SearchResultsIn"+contentType+"s.htm"),container.setTemplateURL(templateUrl),container.setParam("HTMLDecode",decodeHTML),contentType=="Video"?container.setParam("ContinueReadingLabel",ContinueViewingLabel):container.setParam("ContinueReadingLabel",ContinueReadingLabel),container.processTemplate(result.d.Results),total=estimatedTotalResults(container,parseInt(result.d.TotalResults),pageNo*PageSize,result.d.Results.length,PageSize),paginationIssueMode=eval(container.data("paginationIssueMode")),paginationIssueMode?(pageNo=Math.floor(total/pageSize),searchInGoogle(searchFor,pageSize,pageNo,contentType)):PagerRender($("div.SearchResultsIn"+contentType+"sPager"),total,pageSize,pageNo+1)):pageNo>0?(pageNo=pageNo-1,_log("google - paginationIssueMode:"+pageNo),container.data("paginationIssueMode",!0),searchInGoogle(searchFor,pageSize,pageNo,contentType)):(container.html($("#divNoResultsMessage").html()),container.next().hide())},complete:function(){calculateCombinedTotal(total)}})}function searchInAxis(searchFor,pageSize,pageNo){var total=0,axisSearch;axisSearch=searchFor.indexOf(".")!=-1?searchFor.substr(0,searchFor.indexOf(".")):searchFor,$.ajaxSetup({cache:!0}),$.ajax({url:AxisShowServiceURL+"/contents?$inlinecount=true&$include=["+fieldNames+"]&$page="+pageNo+"&$top="+PageSize+"&$sort=BroadcastDate&$order=desc&$search="+escape(axisSearch),contentType:"application/json;",dataType:"jsonp",jsonpCallback:"getJsonFromCAPI_SearchResutls_searchInAxis",cache:!0,success:function(jsonResponse){var result=jsonResponse,container=$("ul.SearchResultsInVideos"),templateUrl;result.Count>0?(templateUrl=Agility.ResolveUrl("~/ClientTemplates/SearchResultsInVideos.htm"),container.setTemplateURL(templateUrl),container.setParam("HTMLDecode",decodeHTML),container.setParam("ContinueReadingLabel",ContinueViewingLabel),container.processTemplate(result.Items),pageNo=pageNo==0||pageNo==1?1:pageNo,total=result.Count,PagerRender($("div.SearchResultsInVideosPager"),total,pageSize,pageNo)):(container.html($("#divNoResultsMessage").html()),container.next().hide())},complete:function(){calculateCombinedTotal(total)}})}function decodeHTML(encodedHTML){return $("<div/>").html(encodedHTML).text()}function estimatedTotalResults(container,total,start,resultLength,pagesize){var paginationIssueMode=eval(container.data("paginationIssueMode")),maxTotal=parseInt(container.data("maxTotal")),newStart;if(paginationIssueMode)start+resultLength<total&&(total=start+resultLength),total<maxTotal&&(maxTotal=total),maxTotal>0&&(total=maxTotal),container.data("paginationIssueMode",!1);else if(start>0&&resultLength<pagesize&&start+resultLength<total&&(total=start+resultLength),(maxTotal==0||total<maxTotal)&&(maxTotal=total),maxTotal>0&&(total=maxTotal),start>0&&total<start+1){for(newStart=start-pagesize>0?start-pagesize:0;newStart>=total;)newStart=newStart-pagesize>0?newStart-pagesize:0;return container.data("paginationIssueMode",!0),newStart}return total}function calculateCombinedTotal(total){combinedTotal+=total,count+=1,count==6&&(Tracking.setSiteSection("search"),Tracking.setSubSections("search","",""),Tracking.trackSearch(SearchFor,combinedTotal),Tracking.track())}function searchInContext(sender){var a=$(sender);if(a.parent().parent().is(".SearchResultsInStocksPager")||a.parent().is(".SearchResultsInStocksPager")){searchInStocks(SearchFor,PageSize,parseInt(a.data("page"))-1);return}if(a.parent().parent().is(".SearchResultsInVideosPager")||a.parent().is(".SearchResultsInVideosPager")){_log($(sender).text()),searchInAxis(SearchFor,PageSize,parseInt(a.data("page")));return}if(a.parent().parent().is(".SearchResultsInNewsPager")||a.parent().is(".SearchResultsInNewsPager")){_log($(sender).text()),searchInGoogle(SearchFor,PageSize,parseInt(a.data("page"))-1,"New");return}if(a.parent().parent().is(".SearchResultsInBlogsPager")||a.parent().is(".SearchResultsInBlogsPager")){searchInGoogle(SearchFor,PageSize,parseInt(a.data("page"))-1,"Blog");return}if(a.parent().parent().is(".SearchResultsInOthersPager")||a.parent().is(".SearchResultsInOthersPager")){searchInGoogle(SearchFor,PageSize,parseInt(a.data("page"))-1,"Other");return}if(a.parent().parent().is(".SearchResultsInGuestPicksPager")||a.parent().is(".SearchResultsInGuestPicksPager")){searchInPicks(SearchFor,PageSize,parseInt(a.data("page"))-1);return}}function formatNumber(number,decimals){if(number!=null)try{var n=eval(number);return formatNumberAddCommas(n.toFixed(decimals).toString()).replace("-","")}catch(e){return number}}function formatNumberAddCommas(nStr){nStr+="",x=nStr.split("."),x1=x[0],x2=x.length>1?"."+x[1]:"";for(var rgx=/(\d+)(\d{3})/;rgx.test(x1);)x1=x1.replace(rgx,"$1,$2");return x1+x2}function bindPageFn($p,num){return $p.unbind("click").bind("click",function(){return _log("bindPage: "+num),searchInContext(this),!1}),$p}function pageLink(pageNum,pageText,currentPage){if(pageNum!=currentPage){var $page=$('<a class="Page" href="javascript:;"></a>').text(pageText);return $page.data("page",pageNum),bindPageFn($page,pageNum)}return $('<a class="CurrentPage"></a>').text(pageNum)}function PagerRender($pager,numItems,postsPerPage,currentPage){var i;if($pager.show(),$pager.prev().is(".SearchResultsInVideos")){currentPage=currentPage==0||currentPage==1?1:currentPage;var numPages=Math.ceil(numItems/postsPerPage),links=$('<span class="Links"></span>'),$previousBtn=$pager.find("a.Previous"),$nextBtn=$pager.find("a.Next");if(numItems==0||numPages<1){$pager.hide();return}for(currentPage<2?$previousBtn.hide():($previousBtn.data("page",currentPage-1).show(),bindPageFn($previousBtn,currentPage-1)),currentPage>=numPages?$nextBtn.hide():($nextBtn.data("page",currentPage+1).show(),bindPageFn($nextBtn,currentPage+1)),links.append(pageLink(1,1,currentPage)),currentPage>4&&links.append($("<span>...</span>")),i=Math.max(2,currentPage-2);i<=Math.min(numPages-1,currentPage+2);i++)links.append(pageLink(i,i,currentPage));currentPage<numPages-3&&links.append($("<span>...</span>")),links.append(pageLink(numPages,"Last",currentPage)),$(".Links",$pager).replaceWith(links).show()}else{var numPages=Math.ceil(numItems/postsPerPage),links=$('<span class="Links"></span>'),$previousBtn=$pager.find("a.Previous"),$nextBtn=$pager.find("a.Next");if(numItems==0||numPages<=1){$pager.hide();return}for(currentPage<=1?$previousBtn.hide():($previousBtn.data("page",currentPage-1).show(),bindPageFn($previousBtn,currentPage-1)),currentPage>=numPages?$nextBtn.hide():($nextBtn.data("page",currentPage+1).show(),bindPageFn($nextBtn,currentPage+1)),links.append(pageLink(1,1,currentPage)),currentPage>4&&links.append($("<span>...</span>")),i=Math.max(2,currentPage-2);i<=Math.min(numPages-1,currentPage+2);i++)li
nks.append(pageLink(i,i,currentPage));currentPage<numPages-3&&links.append($("<span>...</span>")),links.append(pageLink(numPages,"Last",currentPage)),$(".Links",$pager).replaceWith(links).show()}}var ContinueReadingLabel="",ContinueViewingLabel="",SearchFor="",combinedTotal=0,count=0,fieldNames="Images,Desc,BroadcastDate,BroadcastDateTime,ContentPackages,Media,Keywords,Tags";SearchResults.Init=function(p){var container;ContinueReadingLabel=p.ContinueReadingLabel,ContinueViewingLabel=p.ContinueViewingLabel,SearchFor=p.SearchFor,PageSize=p.PageSize,SearchFor!=""&&SearchFor!=null&&(searchInStocks(SearchFor,PageSize,0),container=$("ul.SearchResultsInVideos"),container.data("paginationIssueMode",!1),container.data("maxTotal",0),searchInAxis(SearchFor,PageSize,0),container=$("ul.SearchResultsInNews"),container.data("paginationIssueMode",!1),container.data("maxTotal",0),searchInGoogle(SearchFor,PageSize,0,"New"),container=$("ul.SearchResultsInBlogs"),container.data("paginationIssueMode",!1),container.data("maxTotal",0),searchInGoogle(SearchFor,PageSize,0,"Blog"),container=$("ul.SearchResultsInOthers"),container.data("paginationIssueMode",!1),container.data("maxTotal",0),searchInGoogle(SearchFor,PageSize,0,"Other"),container=$("ul.SearchResultsInGuestPicks"),container.data("paginationIssueMode",!1),container.data("maxTotal",0),searchInPicks(SearchFor,PageSize,0))},SearchResults.ProcessPicks=function(StockList,GuestName){var html="",stockLabel="",symbolLabel="",searchstring=properties.SearchFor,i;if(StockList){for(i=0;i<StockList.length;i++)stockLabel=StockList[i].isShort?"(SHORT) "+StockList[i].name:StockList[i].name,symbolLabel=StockList[i].symbol.replace("*",""),searchstring?GuestName.toLowerCase().indexOf(searchstring.toLowerCase())>=0?html+=SearchResults.addPickHTML(StockList[i],stockLabel,symbolLabel):(StockList[i].symbol.toLowerCase().indexOf(searchstring.toLowerCase())>=0||StockList[i].name.toLowerCase().indexOf(searchstring.toLowerCase())>=0)&&(html+=SearchResults.addPickHTML(StockList[i],stockLabel,symbolLabel)):html+=SearchResults.addPickHTML(StockList[i].isNotStock,stockLabel,symbolLabel);return html}return""},SearchResults.ProcessToolTip=function(GuestID,PickDescription){var pdhtml=$("<div />").html(PickDescription).text();return'<div class="tooltip">'+pdhtml+"</div>"},SearchResults.addPickHTML=function(isNotStock,nameLabel,symLabel){return isNotStock?nameLabel+"<br/>":'<a href="/Stock.aspx?pi_symbol='+symLabel+'">'+nameLabel+"&nbsp;<b>("+symLabel+")</b></a><br/>"}}(BNN.SearchResults);
Agility.RegisterNamespace("BNN.Modules.ShowGuestPicks"),function(ShowGuestPicks){function DateDeserialize(dateStr){return eval("new"+dateStr.replace(/\//g," "))}var properties=null,container=null,searchDefault="Enter Guest Name, Stock Ticker or Company Name",_isOverGuestPickSearchMenu=!1,ajaxUrl,tmplateName,numRes=5;ShowGuestPicks.OnInit=function(p){properties=p,container=$("#"+properties.ContainerID),$.each(eval(properties.FirstPageRecords),function(i,l){l.PickDescription!=""&&($(".ShowGuestPicks ul li#Guest_"+l.ContentID).addClass("HasOptions"),$(".ShowGuestPicks ul li#Guest_"+l.ContentID).tooltip({effect:"slide",position:"center right",offset:[0,-50]}))});var searchBtn=$("#btn_submit"),searchBox=$("#txtSearchTerm"),clearBtn=$("#btn_clear"),guestPickSearchMenu=$("#GuestPicks_Search");clearBtn.bind("click",function(){window.location=Agility.ResolveUrl(window.location.pathname)}),searchBox.bind("focus",function(){searchBox.val()==searchDefault&&searchBox.val("")}),searchBtn.bind("click",function(){var searchBox=$("#txtSearchTerm"),query=searchBox.val(),ck_name=/^[A-Za-z0-9 ]{3,20}$/,iChars,i;if(query!=""){for(iChars='!@#$%^&*()+=[]\\;,/{}|":<>?',i=0;i<query.length;i++)if(iChars.indexOf(query.charAt(i))!=-1)return alert("Your search term has special characters. \nThese are not allowed.\n Please remove them and try again."),!1;window.location=Agility.ResolveUrl(window.location.pathname)+"?Query="+escape(query)}else alert("You must enter a search term to continue!");return!1})},ShowGuestPicks.LoadPicks=function(){var pageNum=BNN.Controls.PicksPager.CurrentPage;$.ajax({url:AjaxWebserviceSvcUrl+"/GetNewShowGuestPicks?showID="+properties.ShowID+"&pageNum="+pageNum+"&pageSize="+properties.PostsPerPage+"&picksAge="+properties.PicksAgeInMonths,contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var res={d:jsonResponse},$container;res.d!=undefined&&res.d!=null&&($container=container.find("ul"),$container.html(""),$container.hasTemplate()||$container.setTemplateURL(Agility.ResolveUrl("~/ClientTemplates/ShowGuestPicks.htm")),$container.processTemplate(res),$.each(res.d,function(i,l){l.PickDescription!=""&&($(".ShowGuestPicks ul li#Guest_"+l.ContentID).addClass("HasOptions"),$(".ShowGuestPicks ul li#Guest_"+l.ContentID).tooltip({effect:"slide",position:"center right",offset:[0,-50]}))}),BNN.Controls.PicksPager.Render(properties.TotalCount))}}),BNN.Controls.DynamicStockQuotes.OnLoad()},ShowGuestPicks.SearchPicks=function(){var pageNum=BNN.Controls.PicksPager.CurrentPage;$.ajax({url:AjaxWebserviceSvcUrl+"/SearchNewShowGuestPicks?query="+properties.SearchFor+"&pageNum="+pageNum+"&pageSize="+properties.PostsPerPage,contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var res={d:jsonResponse},$container;res.d!=undefined&&res.d!=null&&($container=container.find("ul"),$container.html(""),$container.hasTemplate()||$container.setTemplateURL(Agility.ResolveUrl("~/ClientTemplates/ShowGuestPicks.htm")),$container.processTemplate(res),$.each(res.d,function(i,l){l.PickDescription!=""&&($(".ShowGuestPicks ul li#Guest_"+l.ContentID).addClass("HasOptions"),$(".ShowGuestPicks ul li#Guest_"+l.ContentID).tooltip({effect:"slide",position:"center right",offset:[0,-50]}))}),BNN.Controls.PicksPager.Render(properties.TotalCount))},complete:function(){}})},ShowGuestPicks.GetDate=function(dateStr){try{var date=DateDeserialize(dateStr);return dateFormat(date,"mmmm d, yyyy")}catch(error){return error}},ShowGuestPicks.GuestTitle=function(guest){if(guest==null)return"";var title=guest.Title!=null?guest.Title:"",company=guest.Company!=null?guest.Company:"";return title+(title.length<1||company.length<1?"":", ")+company},ShowGuestPicks.ProcessPicks=function(StockList,GuestName){var html="",stockLabel="",symbolLabel="",searchstring=properties.SearchFor,i;if(StockList){for(i=0;i<StockList.length;i++)stockLabel=StockList[i].isShort?"(SHORT) "+StockList[i].name:StockList[i].name,symbolLabel=StockList[i].symbol.replace("*",""),searchstring?GuestName.toLowerCase().indexOf(searchstring.toLowerCase())>=0?html+=ShowGuestPicks.addPickHTML(StockList[i].isNotStock,stockLabel,symbolLabel):(StockList[i].symbol.toLowerCase().indexOf(searchstring.toLowerCase())>=0||StockList[i].name.toLowerCase().indexOf(searchstring.toLowerCase())>=0)&&(html+=ShowGuestPicks.addPickHTML(StockList[i].isNotStock,stockLabel,symbolLabel)):html+=ShowGuestPicks.addPickHTML(StockList[i].isNotStock,stockLabel,symbolLabel);return html}return""},ShowGuestPicks.ProcessToolTip=function(GuestID,PickDescription){var pdhtml=$("<div />").html(PickDescription).text();return'<div class="tooltip">'+pdhtml+"</div>"},ShowGuestPicks.addPickHTML=function(isNotStock,nameLabel,symLabel){return isNotStock?nameLabel+"<br/>":'<a href="/Stock.aspx?pi_symbol='+symLabel+'">'+nameLabel+"&nbsp;<b>("+symLabel+")</b></a><br/>"},ShowGuestPicks.FormatURL=function(searchQuery){if(searchQuery==null||searchQuery=="null")return"";return Agility.ResolveUrl(window.location.pathname)+"?Query="+escape(searchQuery)},ShowGuestPicks.ShowSymbolIfNotNull=function(str){return str==null||str=="null"?"":"("+str+")"},_updateStockSearchPosition=function(searchBoxElement,stockSearchMenuElement){if(searchBoxElement.length>0&&stockSearchMenuElement.length>0){var x=searchBoxElement.offset().left-3,y=searchBoxElement.offset().top+searchBoxElement.height();stockSearchMenuElement.css("left",x+"px"),stockSearchMenuElement.css("top",y+"px")}}}(BNN.Modules.ShowGuestPicks);
Agility.RegisterNamespace("BNN.StoryDetails"),function(StoryDetails){function StoryDetailsBindPageFn($p,num){return $p.unbind("click").bind("click",function(){var id,ins;return id=$p.is(".Next")||$p.is(".Previous")?$p.parent().attr("id"):$p.parent().parent().attr("id"),ins=id.substring(id.indexOf("_")+1),StoryDetails.LoadContentByPage(num),!1}),$p}function StoryDetailsPageLink(pageNum,pageText,currentPage){var $lastBtn,$page;if(pageNum!=currentPage){if(pageText=="Last"){$lastBtn=$("#Pager").find("a.Last"),StoryDetailsBindPageFn($lastBtn,pageNum);return}return $page=$('<a class="Page" href="javascript:;"></a>').text(pageText),$page.data("page",pageNum),StoryDetailsBindPageFn($page,pageNum)}return $('<a class="CurrentPage"></a>').text(pageNum)}function GetRelatedStories(relatedStories){var container=$("#NewsStoryRelatedLinks .relatedStoryList .relatedStoryContainer"),templateUrl=Agility.ResolveUrl("~/ClientTemplates/StoryDetailsRelatedStories.htm"),numScrollPages,i;if(container.setTemplateURL(templateUrl),container.processTemplate(relatedStories),numScrollPages=Math.ceil(relatedStories.length/itemsToShow),relatedStories.length>itemsToShow){for(i=0;i<numScrollPages;i++)i==0?$("#NewsStoryRelatedLinks .relatedPages").append("<div class='relatedPage Selected' data-index='"+i+"'></div>"):$("#NewsStoryRelatedLinks .relatedPages").append("<div class='relatedPage' data-index='"+i+"'></div>");$("#NewsStoryRelatedLinks div.relatedStoryNavContainer div.relatedPages div.relatedPage").bind("click",function(){var pageNum,target;$.each($("#NewsStoryRelatedLinks div.relatedStoryNavContainer div.relatedPages div.relatedPage"),function(){$(this).removeClass("Selected")}),$(this).addClass("Selected"),pageNum=$(this).attr("data-index"),_currentItem=pageNum*itemsToShow,target=$("#NewsStoryRelatedLinks").find(".Item"+_currentItem),$("#NewsStoryRelatedLinks .relatedStoryList").scrollTo(target,_scrollSettings)}),$("#NewsStoryRelatedLinks .navLeft").bind("click",function(){if(_currentItem>0){_currentItem=_currentItem-itemsToShow,$.each($("#NewsStoryRelatedLinks div.relatedStoryNavContainer div.relatedPages div.relatedPage"),function(){$(this).removeClass("Selected"),$(this).attr("data-index")==_currentItem/itemsToShow&&$(this).addClass("Selected")});var target=$("#NewsStoryRelatedLinks").find(".Item"+_currentItem);$("#NewsStoryRelatedLinks .relatedStoryList").scrollTo(target,_scrollSettings)}}),$("#NewsStoryRelatedLinks .navRight").bind("click",function(){if(_currentItem<relatedStories.length-itemsToShow){_currentItem=_currentItem+itemsToShow,$.each($("#NewsStoryRelatedLinks div.relatedStoryNavContainer div.relatedPages div.relatedPage"),function(){$(this).removeClass("Selected"),$(this).attr("data-index")==_currentItem/itemsToShow&&$(this).addClass("Selected")});var target=$("#NewsStoryRelatedLinks").find(".Item"+_currentItem);$("#NewsStoryRelatedLinks .relatedStoryList").scrollTo(target,_scrollSettings)}})}else $("#NewsStoryRelatedLinks .relatedStoryNavContainer").hide();$("#NewsStoryRelatedLinks div.relatedItem").hover(function(){var $play=$(this).find(".play");$play.length>0&&$play.hasClass("play")&&$play.toggleClass("play-on")})}var _parameters=null,contentId,width,height,zone="",playerObjList={},flashPlaylistObj={},player={},videoAr,media,nextID,ids,globalCurrentPage,globalTotalCount,numPages,currentId,playerDiv,VideosPerPage=3,pageNum=1,sortedResult=[],_currentItem=0,_scrollSettings={duration:1e3},itemsToShow=4,quoteArray=[],symbolList;StoryDetails.OnInit=function(parameters){var i,headline,height,NewsSlideShow,slideShowItemCount;if(Array.prototype.filter||(Array.prototype.filter=function(fun){"use strict";var t,len,res,thisArg,i,val;if(this===void 0||this===null)throw new TypeError;if(t=Object(this),len=t.length>>>0,typeof fun!="function")throw new TypeError;for(res=[],thisArg=arguments.length>=2?arguments[1]:void 0,i=0;i<len;i++)i in t&&(val=t[i],fun.call(thisArg,val,i,t)&&res.push(val));return res}),_parameters=parameters,_parameters.RelatedStories.length>0?GetRelatedStories(_parameters.RelatedStories):$("#NewsStoryRelatedLinks").hide(),_parameters.StoryChartingSymbols!=""||_parameters.StoryChartingSymbols==null)for(symbolList=_parameters.StoryChartingSymbols.split(","),i=0;i<symbolList.length;i++)symbolList[i]=$.trim(symbolList[i]),$.getJSON(MarketDataServiceUrl+"/GetStockQuote?symbol="+symbolList[i]+"",function(){}).done(function(result){result!=undefined&&StoryDetails.doChartQuote(result)});_parameters.AxisVideoID!=""?(videoAr=_parameters.AxisVideoID.split(","),currentId=contentId=videoAr[0],StoryDetails.GetVideoMeta(contentId,videoAr),videoAr.length<=1?($("#inPageVideoMeta").hide(),$("#inPageClear").hide(),$("#inPageVideoScroll").hide(),$("#ctl00_MainContent_TopHeaderZone.TopMediaZone").hide(),playerDiv="oneClip_mediaplayerdiv",$(document).ready(function(){$(document).on("onready.etsapi",{lv:contentId},function(event){StoryDetails.LaunchPlayer(event.data.lv);var likeResultContainer=$("#StoryDetailFeedback .Stats .Like .likeResult"),dislikeResultContainer=$("#StoryDetailFeedback .Stats .DisLike .likeResult");StoryDetails.GetFeedBackCount(parameters.StoryID,!0,parameters.ContentReferenceName,likeResultContainer),StoryDetails.GetFeedBackCount(parameters.StoryID,!1,parameters.ContentReferenceName,dislikeResultContainer),$("#StoryDetailFeedback .Stats .Like").bind("click",function(){$.cookie("BNNStoryApproval_"+parameters.StoryID)||StoryDetails.AddFeedback(parameters.StoryID,!0,likeResultContainer,parameters.ContentReferenceName)}),$("#StoryDetailFeedback .Stats .DisLike").bind("click",function(){$.cookie("BNNStoryApproval_"+parameters.StoryID)||StoryDetails.AddFeedback(parameters.StoryID,!1,dislikeResultContainer,parameters.ContentReferenceName)})});player.ajaxCrossDomainCors(AxisApiInterfaceURL)})):(playerDiv="inPage_mediaplayerdiv",headline=$("#StoryDetails h1.NewsHeadline").text(),$("#StoryDetails h1.NewsHeadline").hide(),$("#ctl00_MainContent_TopHeaderZone.TopMediaZone h1.NewsHeadline").text(headline),$("#ctl00_MainContent_TopHeaderZone.TopMediaZone h1.NewsHeadline").show(),$("#NewsDetailsTemplate .TopMediaZone").show(),$("#inPageVideoMeta").show(),$("#inPageVideoScroll").show(),height=$("#inPageVideoScroll div.Items").height(),$("#inPageVideoScroll div.Items").html('<div class="VideoLoading">'),$("#inPageVideoScroll div.Items .VideoLoading").css("height",height+"px"),ids=videoAr.toString(),$.ajaxSetup({cache:!0}),$.ajax({url:AxisShowServiceURL+"/contents/?id=["+ids+"]&$include=["+fieldNames+"]&$sort=BroadcastDate&$order=DESC&$inlinecount=&Images.Type=thumbnail",contentType:"application/json;",dataType:"jsonp",jsonpCallback:"getJsonFromCAPI_StoryDetail_GetVideoMetaForScroll",cache:!0,success:function(jsonResponse){var result=jsonResponse;result.Count>0||result.Items.length>0?(globalTotalCount=result.Count,$.each(videoAr,function(i,id){sortedResult=sortedResult.concat(result.Items.filter(function(i){return i.Id==id}))}),StoryDetails.ProcessVideos(sortedResult.slice(0,3)),StoryDetails.SetStatus(),StoryDetails.PagerRender($("#Pager"),result.Count,VideosPerPage,1),globalCurrentPage=1,$("#inPageVideoScroll div.Items .VideoLoading").hide()):($("#Pager").hide(),$("#inPageVideoScroll div.Items .VideoLoading").hide())}}),$(document).ready(function(){$(document).on("onready.etsapi",{lv:contentId},function(event){StoryDetails.LaunchPlayer(event.data.lv);var likeResultContainer=$("#StoryDetailFeedback .Stats .Like .likeResult"),dislikeResultContainer=$("#StoryDetailFeedback .Stats .DisLike .likeResult");StoryDetails.GetFeedBackCount(parameters.StoryID,!0,parameters.ContentReferenceName,likeResultContainer),StoryDetails.GetFeedBackCount(parameters.StoryID,!1,parameters.ContentReferenceName,dislikeResultContainer),$("#StoryDetailFeedback .Stats .Like").bind("click",function(){$.cookie("BNNStoryApproval_"+parameters.StoryID)||StoryDetails.AddFeedback(parameters.StoryID,!0,likeResultContainer,parameters.ContentReferenceName)}),$("#StoryDetailFeedback .Stats .DisLike").bind("click",function(){$.cookie("BNNStoryApproval_"+parameters.StoryID)||StoryDetails.AddFeedback(parameters.StoryID,!1,dislikeResultContainer,parameters.ContentReferenceName)})});player.ajaxCrossDomainCors(AxisApiInterfaceURL)}))):($("#NewsDetailsTemplate .TopMediaZone").hide(),$(function(){var likeResultContainer=$("#StoryDetailFeedback .Stats .Like .likeResult"),dislikeResultContainer=$("#StoryDetailFeedback .Stats .DisLike .likeResult");StoryDetails.GetFeedBackCount(parameters.StoryID,!0,parameters.ContentReferenceName,likeResultContainer),StoryDetails.GetFeedBackCount(parameters.StoryID,!1,parameters.ContentReferenceName,dislikeResultContainer),$("#StoryDetailFeedback .Stats .Like").bind("click",function(){$.cookie("BNNStoryApproval_"+parameters.StoryID)||StoryDetails.AddFeedback(parameters.StoryID,!0,likeResultContainer,parameters.ContentReferenceName)}),$("#StoryDetailFeedback .Stats .DisLike").bind("click",function(){$.cookie("BNNStoryApproval_"+parameters.StoryID)||StoryDetails.AddFeedback(parameters.StoryID,!1,dislikeResultContainer,parameters.ContentReferenceName)})})),$("#StoryDetailFeedback .Stock-Comments .help").tooltip2({track:!0,delay:1,showURL:!1,fixPNG:!0,top:-20,left:10,showBody:" - ",extraClass:"tooltip_2"}),$("#StoryDetailFeedback .Stats .Like .help").tooltip2({track:!0,delay:1,showURL:!1,fixPNG:!0,top:-20,left:10,showBody:" - ",extraClass:"tooltip_2"}),$("#StoryDetailFeedback .Stats .DisLike .help").tooltip2({track:!0,delay:1,showURL:!1,fixPNG:!0,top:-20,left:10,showBody:" - ",extraClass:"tooltip_2"}),_parameters.EnableComments=="False"&&($("#StoryDetails .Stats .Stock-Comments").attr("style","display:none;"),$("#StoryDetailFeedback .Stock-Comments").attr("style","display:none;")),NewsSlideShow=$("#NewsSlideShow"),slideShowItemCount=NewsSlideShow.find(".Images ul li").length,slideShowItemCount>0?(NewsSlideShow.find(".Images ul li a").lightBox(),NewsSlideShow.find(".Images").easySlider({numeric:!0,numericId:"SlideShowControls",itemMargin:30,showNextA
ndPrevious:!0,prevId:"SlideShowPrevious",nextId:"SlideShowNext"}),slideShowItemCount<=3&&NewsSlideShow.find(".Controls").hide()):NewsSlideShow.hide(),$("#NewsStoryControlPanel .Smaller").bind("click",function(){$(".NewsStoryText").css("font-size","12px")}),$("#NewsStoryControlPanel .Larger").bind("click",function(){$(".NewsStoryText").css("font-size","20px")}),$("#NewsStoryControlPanel .Print").bind("click",function(){window.print()}),$("#NewsStoryControlPanel .Email").bind("click",function(){}),$("span.Quote").each(function(){var parent=$(this).parent(),parentTag=parent.get(0).tagName,p;parentTag.toLowerCase()=="p"?parent.addClass("Quote"):(p=$("<p></p>").addClass("Quote"),$(this).wrap(p))}),$("p.Quote").each(function(){var child=$(this).children("span.Quote"),span;child.length==0&&(span=$("<span></span>").addClass("Quote").html($(this).html()),$(this).empty().append(span))}),$("span.QuoteAuthor").each(function(){var parent=$(this).parent(),parentTag=parent.get(0).tagName,p;parentTag.toLowerCase()=="p"?parent.addClass("QuoteAuthor"):(p=$("<p></p>").addClass("QuoteAuthor"),$(this).wrap(p))}),$("p.QuoteAuthor").each(function(){var child=$(this).children("span.QuoteAuthor"),span;child.length==0&&(span=$("<span></span>").addClass("QuoteAuthor").html($(this).html()),$(this).empty().append(span))})},StoryDetails.GetFeedBackCount=function(id,isPositive,RecordTypeName,container){var approveSearch=new Agility.UGC.API.FeedbackSearchArg;approveSearch.ReferenceName=RecordTypeName,approveSearch.ContentType=Agility.UGC.API.FeedbackContentType.WCM,approveSearch.SubmissionType=Agility.UGC.API.FeedbackSubmissionType.ApproveDisapprove,approveSearch.RelatedContentIDs=[id],approveSearch.IsPositive=isPositive,approveSearch.Action=Agility.UGC.API.AggregateTypes.Count,Agility.UGC.API.GetFeedbackAggregate(approveSearch,function(data){if(data.ResponseType==0){var tmp=data.ResponseData.length>0?data.ResponseData[0].Result:"0";$(container).html(" "+tmp+" ")}else _log(data)})},StoryDetails.AddFeedback=function(id,isPositive,element,RecordTypeName){var ApprovalFeedback=new Agility.UGC.API.BooleanFeedback;ApprovalFeedback.ReferenceName=RecordTypeName,ApprovalFeedback.ContentType=Agility.UGC.API.FeedbackContentType.WCM,ApprovalFeedback.RelatedContentID=id,Agility.UGC.API.SaveApproveDisapprove(ApprovalFeedback,isPositive,function(data){if(data.ResponseType==Agility.UGC.API.ResponseType.OK){var currentLabel=$(element).html(),currentCount=Number(currentLabel);$(element).html(" "+(currentCount+1)+" "),$.cookie("BNNStoryApproval_"+id,!0)}})},StoryDetails.LaunchPlayer=function(id){var adrule,mainApp,playlistObj,mpFlashVars,zone;contentId=id,adrule=GetQuerystring("adrule","generic"),mpFlashVars={},mpFlashVars.enablelog=AxisEnableLog,mpFlashVars.loginterval=AxisLogInterval,mpFlashVars.cms="fortytwo",mainApp=etsapi.embedPlayer("inpagePlayer",playerDiv,640,360,globalDestination,"",{flashVars:mpFlashVars,adRule:adrule}),mainApp.registerEvent(MediaPlayerControllerEvent.PLAYER_READY,this,StoryDetails.onPlayerReady),mainApp.registerEvent(MediaPlayerControllerEvent.VIDEO_STARTED,this,StoryDetails.onVideoStarted),mainApp.registerEvent(MediaPlayerControllerEvent.CONTENT_COMPLETE,this,StoryDetails.onVideoCompleted),mainApp.registerEvent(MediaPlayerControllerEvent.VIDEO_ENDED,this,StoryDetails.onVideoEnded),mainApp.registerEvent(MediaPlayerControllerEvent.ERROR,this,StoryDetails.onVideoError),playerObjList.inpagePlayer=mainApp,zone="shows/"+media,etsapi.setAdZone("inpagePlayer",zone),etsapi.setMetricsVideoPlayerName("inPagePlayer")},StoryDetails.GetVideoMeta=function(id){$.ajaxSetup({cache:!0}),$.ajax({url:AxisShowServiceURL+"/contents/"+id+"/?$include=[Media]",contentType:"application/json;",dataType:"jsonp",jsonpCallback:"getJsonFromCAPI_StoryDetail_GetVideoMeta_"+id,cache:!0,success:function(jsonResponse){var result=jsonResponse;media=result!=null?result.Media.Name.toLowerCase().replace(" ","").replace(" ","").replace(" ",""):""}})},StoryDetails.PlayerReady=function(){var initParms={destinationCode:globalDestination,platformCode:globalPlatform,autoPlay:1,resourceId:"BNN"},item={id:contentId};playerObjList.inpagePlayer.playMediaItem(item,initParms)},StoryDetails.onPlayerReady=function(){_log("player ready"),StoryDetails.PlayerReady()},StoryDetails.onVideoEnded=function(){_log("player ended")},StoryDetails.onVideoCompleted=function(){if(nextID!=null){setTimeout(function(){contentId=nextID;var initParms={destinationCode:globalDestination,platformCode:globalPlatform,autoPlay:1,resourceId:"BNN"},item={id:contentId};return playerObjList.inpagePlayer.playMediaItem(item,initParms),!1},500);var $nowPlayingItem=$("#inPageVideoScroll div.Items div#clip_"+contentId),nextObj=StoryDetails.findVideoObj(contentId,!0),isLast=nextObj==undefined||nextObj=="undefined"?!0:!1;$nowPlayingItem.attr("data-index")==2&&globalCurrentPage<numPages?StoryDetails.LoadContentByPage(globalCurrentPage+1):globalCurrentPage==numPages&&isLast&&StoryDetails.LoadContentByPage(1)}},StoryDetails.onVideoStarted=function(infoObj){if(currentId=infoObj.contentId,StoryDetails.SetStatus(),infoObj.index==0&&infoObj.category=="content"){var pflowPath=window.location.pathname,pflowUrl="http://data.publishflow.com/pflowlog.gif?a=ctv.ca&h=bnn.ca&p="+encodeURI(pflowPath)+"&t="+escape(infoObj.title)+"&v=/video/player.aspx?vid="+infoObj.contentId+"&pt="+escape($.trim($(document).find("title").text()))+"&ts="+ +new Date,image=new Image;image.src=pflowUrl}},StoryDetails.onVideoError=function(){_error("player error")},player.ajaxCrossDomainCors=function(serviceURL){try{player.JqueryCallBack=function(){_log("api loading success ");return};var ajaxPars={url:serviceURL,cache:!0,contentType:"application/json",jsonpCallback:"player.JqueryCallBack",error:function(XMLHttpRequest,textStatus){textStatus=="parsererror"}};ajaxPars.type="GET",ajaxPars.dataType="jsonp",ajaxPars.jsonp="callback",$.ajax(ajaxPars)}catch(err){throw err;}},StoryDetails.ProcessVideos=function(contentItems){(contentItems.length>0||!contentItems)&&StoryDetails.updateContentContainer(contentItems)},StoryDetails.updateContentContainer=function(content){var templateContainer=$("#inPageVideoScroll .Items"),templateUrl=Agility.ResolveUrl("~/ClientTemplates/StoryDetailsPlaylist.htm");templateContainer.html(""),templateContainer.setTemplateURL(templateUrl),templateContainer.processTemplate(content),$("#inPageVideoScroll div.Items div.Item div.Left .hubThumb").hover(function(){$(this).next().toggleClass("play-on")})},StoryDetails.ProcessThumbnail=function(imageObj){if(imageObj.length>0&&imageObj[0].Type=="thumbnail")return imageObj[0].Url+"?height=49&width=87"},StoryDetails.PlayElement=function(clipId){currentId=contentId=clipId;var initParms={destinationCode:globalDestination,platformCode:globalPlatform,autoPlay:1,resourceId:"BNN"},item={id:contentId};playerObjList.inpagePlayer.playMediaItem(item,initParms)},StoryDetails.SetStatus=function(){var $nowPlayingItem=$("#inPageVideoScroll div.Items div#clip_"+currentId),nextObj,$nextPlayingItem;$nowPlayingItem.find(".Status").html("Now Playing").show(),nextObj=StoryDetails.findVideoObj(currentId,!0),nextID=nextObj==undefined||nextObj=="undefined"?sortedResult[0].Id:nextObj.Id,$nextPlayingItem=$("#inPageVideoScroll div.Items div#clip_"+nextID),$nextPlayingItem.find(".Status").html("Up Next").show(),$.each($("#inPageVideoScroll div.Items .Item").not($("#clip_"+currentId+",#clip_"+nextID)),function(){$(this).find(".Status").html("STATUS").hide()})},StoryDetails.LoadContentByPage=function(PageNum){var height;globalCurrentPage=PageNum,height=$("#inPageVideoScroll div.Items").height(),$("#inPageVideoScroll div.Items").html('<div class="VideoLoading">'),$("#inPageVideoScroll div.Items .VideoLoading").css("height",height+"px");var startIndex=PageNum*VideosPerPage-VideosPerPage,endIndex=startIndex+VideosPerPage,items=sortedResult.slice(startIndex,endIndex);items.length>0?(StoryDetails.ProcessVideos(items),StoryDetails.PagerRender($("#Pager"),globalTotalCount,VideosPerPage,PageNum),$("#inPageVideoScroll div.Items .VideoLoading").hide(),StoryDetails.SetStatus()):($("#Pager").hide(),$("#inPageVideoScroll div.Items .VideoLoading").hide())},StoryDetails.PagerRender=function($pager,numItems,postsPerPage,currentPage){var i,$lastBtn;$pager.show(),numPages=Math.ceil(numItems/postsPerPage);var links=$('<span class="Links"></span>'),$previousBtn=$pager.find("a.Previous"),$nextBtn=$pager.find("a.Next"),$firstBtn=$pager.find("a.First");if(numItems==0||numPages<=1){$pager.hide();return}for(currentPage<=1?($previousBtn.hide(),$firstBtn.hide()):($previousBtn.data("page",currentPage-1).show(),StoryDetailsBindPageFn($previousBtn,currentPage-1),$firstBtn.data("page",1).show(),StoryDetailsBindPageFn($firstBtn,1)),links.append(StoryDetailsPageLink(1,1,currentPage)),i=Math.max(2,currentPage-2);i<=Math.min(numPages-1,currentPage+2);i++)links.append(StoryDetailsPageLink(i,i,currentPage));links.append(StoryDetailsPageLink(numPages,"Last",currentPage)),$lastBtn=$pager.find("a.Last"),currentPage==numPages?($nextBtn.hide(),$lastBtn.hide()):($nextBtn.data("page",currentPage+1).show(),StoryDetailsBindPageFn($nextBtn,currentPage+1),$lastBtn.show()),$(".Links",$pager).replaceWith(links).show()},StoryDetails.DisplayIcon=function(news){if(news!=null&&!!news.AxisVideoID&&news.AxisVideos.length>0)return"<div class='play'></div>"},StoryDetails.findVideoObj=function(value,getNext){for(var i=0;i<sortedResult.length;i++)if(getNext){if(sortedResult[i].Id==value)return sortedResult[i+1]}else if(sortedResult[i].Id==value)return sortedResult[i];return null},StoryDetails.GetStoryVideoThumbnail=function(news){if(!!news.AxisVideoID&&news.AxisVideos.length>0)return news.AxisVideos[0].ThumbnailUrl+"?width=200&height=113"},StoryDetails.GetStoryImageThumbnail=function(news,ThumbnailType){if(news.Image)return news.ThumbImages[ThumbnailType]!=null?news.ThumbImages[ThumbnailType]:"/Images/storydetail_ph.gif"},StoryDetails.DisplayIcon=function(news){if(news.AxisVideoID)retu
rn"<div class='play' />"},StoryDetails.FormatRelatedStoryDate=function(relatedDate){if(!!relatedDate){var d=Date.parse(relatedDate);return d.format("mmmm d, yyyy")}},StoryDetails.doChartQuote=function(quote){var cssClass,chartType;!quote||(quoteArray[$.inArray(quote.Ticker,symbolList)]=quote,quoteArray.length==symbolList.length&&$.trim(symbolList[0])==quoteArray[0].Ticker&&(cssClass=_getCssClass(quoteArray[0].NetChange),$("#storyQuoteContainer .Title").html(quoteArray[0].CompanyName+"<span>Stock data delayed up to 20 minutes</span>"),$("#storyQuoteContainer .Last").text("$"+_formatPriceInfo(quoteArray[0].Last)),$("#storyQuoteContainer .DollarChange").addClass(cssClass).text("$"+_formatPriceInfo(quoteArray[0].NetChange)),$("#storyQuoteContainer .PercentChange").addClass(cssClass).text(_formatPriceInfo(quoteArray[0].PercentChange)+"%"),chartType="",symbolList.length==1?BNN.Controls.TimeSeriesChart.StoryDetailStockChart("#storyChartContainer",quoteArray[0],_parameters.StoryChartingInterval,!1):symbolList.length>1&&(BNN.Controls.TimeSeriesChart.StoryDetailStockChartCompare("#storyChartContainer",quoteArray,_parameters.StoryChartingInterval,symbolList.toString()),chartType=", Comparative"),$("#chartType").html("<span>chart type: "+_parameters.StoryChartingInterval+chartType+"</span>"),$("#quoteLink").html("<a href='"+StockPageUrl+quoteArray[0].Ticker+"'><span>See Full Stock Page »</span></a>")))}}(BNN.StoryDetails);
var _currentFacebookUser;Agility.RegisterNamespace("BNN.Modules.StockFeedback"),function(StockFeedback){var properties=null,recordID=null,_rating=null,_feedbackFlag=null,searchDefault="",_isOverStockSearchMenu=!1;StockFeedback.OnInit=function(p,arg,sd){var argObj,searchBox,stockSearchMenu;properties=p,searchDefault=sd,argObj={PageSize:arg.PageSize,RecordOffset:0,SortedField:"CreatedOn",SortDirection:"asc",Columns:["Name","Comment","ParentRecordID","RelatedContentID","FacebookID"],onSubmitComment:BNN.Modules.NewComments.SubmitComment,onEmptyComments:BNN.Modules.NewComments.onEmptyComments,onFlagOffensive:BNN.Modules.NewComments.onFlagOffensive,onCommentSubmitComplete:BNN.Modules.NewComments.onCommentSubmitComplete,CommentContainer:arg.CommentContainer,CommentCountContainer:arg.CommentCountContainer},$.extend(argObj,arg),StockFeedback.SearchStockSymbol(_trimSymbol(properties.Symbol),"n/a",argObj),_renderTip(),searchBox=$("#StockSymbolSearch_Feedback .SearchBox"),stockSearchMenu=$("#StockSymbolSearch_Feedback_Drop"),stockSearchMenu.bind("mouseenter",function(){_isOverStockSearchMenu=!0}),stockSearchMenu.bind("mouseleave",function(){_isOverStockSearchMenu=!1}),searchBox.bind("focus",function(){(searchBox.val()==searchDefault||searchDefault=="")&&searchBox.val("")}).bind("keyup",function(){if(searchBox.val()==""){stockSearchMenu.hide();return}var container=$("#StockSymbolSearch_Feedback_Drop .Results");$.getJSON(MarketDataServiceUrl+"/GetTopNStocks?symbolBeginsWith="+searchBox.val()+"&n=5",function(result){var templateUrl,moreUrl,newMoreUrl;result!=undefined&&result.length>0?(templateUrl=Agility.ResolveUrl("~/ClientTemplates/StockSearchResults.htm"),container.setTemplateURL(templateUrl),container.processTemplate(result),_updateStockSearchPosition(searchBox,stockSearchMenu),stockSearchMenu.show(),moreUrl=$(".MoreResults a",stockSearchMenu).attr("href"),newMoreUrl=moreUrl.substring(0,moreUrl.indexOf("Search.aspx")+11)+"?query="+searchBox.val(),$(".MoreResults a",stockSearchMenu).attr("href",newMoreUrl),container.children(".DataItem").bind("mouseenter",function(){$(this).addClass("Hover")}),container.children(".DataItem").bind("mouseleave",function(){$(this).removeClass("Hover")})):stockSearchMenu.hide()})}).bind("blur",function(){searchBox.val()==""&&searchBox.val(searchDefault),_isOverStockSearchMenu?stockSearchMenu.bind("mouseleave",function(){stockSearchMenu.hide()}):stockSearchMenu.hide()}).bind("keydown",function(event){(event.which||event.keyCode)&&(event.which==13||event.keyCode==13)&&$(this).next().trigger("click")}),$("#btnStockSymbolSearch_Feedback").bind("click",function(){var query=searchBox.val();return query!=""&&query!=searchDefault&&(window.location=Agility.ResolveUrl("~/Stock.aspx")+"?pi_symbol="+escape(query)),!1})},StockFeedback.SearchStockSymbol=function(s,cname,argObj){var cachekey="stock_cache_key_"+s,searchQuery="Symbol = '"+s+"'",searchArg={RecordTypeName:"StockFeedback",Search:searchQuery,CacheKey:cachekey,State:Agility.UGC.API.RecordState.Published};Agility.UGC.API.SearchRecords(searchArg,function(data){var exist,records,enableComments,enableFeedback;data.ResponseType==Agility.UGC.API.ResponseType.OK&&(exist=data.ResponseData!=null&&data.ResponseData.TotalRecords>0,exist?(records=data.ResponseData.Records,data.ResponseData.TotalRecords==1&&(recordID=records[0].ID,enableComments=records[0].EnableComments,enableFeedback=records[0].EnableFeedback,argObj.RelatedContentID=recordID,argObj.EnableComments=enableComments,enableFeedback=="True"?(StockFeedback.LoadRatings(recordID),$(".Stats .StatsContainer").show("fast"),$(".Stats .Loading-Stock-UGC").hide("fast")):$(".Stats .Loading-Stock-UGC").hide("fast"),enableComments&&BNN.Modules.NewComments.LoadComments(argObj))):StockFeedback.AddStockSymbol(s,cname,cachekey,argObj))},cachekey)},StockFeedback.AddStockSymbol=function(s,cname,cachekey,argObj){var record={ID:-1,RecordTypeName:"StockFeedback",Symbol:s.toUpperCase(),CompanyName:cname,EnableComments:!0,EnableFeedback:!0};Agility.UGC.API.SaveRecord(record,function(data){if(data.ResponseType==Agility.UGC.API.ResponseType.OK){var recordID=data.ResponseData;StockFeedback.LoadRatings(recordID),argObj.RelatedContentID=recordID,argObj.EnableComments="True",BNN.Modules.NewComments.LoadComments(argObj),$(".Stats .StatsContainer").show("fast"),$(".Stats .Loading-Stock-UGC").hide("fast")}},cachekey)},StockFeedback.LoadRatings=function(id){StockFeedback.UpdateRatings(id),$(".Stats .StatsContainer .Rate #ratingSlider").slider({min:0,max:10,value:0,animate:!0,stop:function(){var rating,ratingFeedback;$.cookie("BNNStockRating_"+id)?($(".Stats .StatsContainer .Rate .Blocks").show("fast"),$(".Stats .StatsContainer .Rate .sliderContainer #ratingSlider").hide("fast")):(rating=$(".Stats .StatsContainer .Rate .sliderContainer  #ratingSlider").slider("value"),$(".Stats .StatsContainer .Rate .Blocks").show("fast"),$(".Stats .StatsContainer .Rate .sliderContainer #ratingSlider").hide("fast"),ratingFeedback=new Agility.UGC.API.RatingFeedback,ratingFeedback.ReferenceName="StockFeedback",ratingFeedback.ContentType=Agility.UGC.API.FeedbackContentType.UGC,ratingFeedback.RelatedContentID=id,ratingFeedback.RatingValue=rating,Agility.UGC.API.SaveRating(ratingFeedback,function(data){data.ResponseType==0&&(StockFeedback.UpdateRatings(id),$(".Stats .StatsContainer .Rate .sliderContainer #ratingSlider").slider("value",0),$.cookie("BNNStockRating_"+id,!0),$(".Stats .StatsContainer .Rate .Label").html("YOU RATED: "+Math.round(Number(rating*10))+"%"),$(".Stats .StatsContainer .Rate .Label").attr("style","cursor:default"))}))}}),$(".Stats .StatsContainer .Rate .Label").click(function(){$.cookie("BNNStockRating_"+id)||($(".Stats .StatsContainer .Rate .Blocks").hide("fast"),$(".Stats .StatsContainer .Rate .sliderContainer #ratingSlider").show("fast"))}),$(".Stats .StatsContainer .Rate .Blocks").click(function(){$.cookie("BNNStockRating_"+id)||($(".Stats .StatsContainer .Rate .Blocks").hide("fast"),$(".Stats .StatsContainer .Rate .sliderContainer #ratingSlider").show("fast"))}),$(".Stats .StatsContainer .Loading-Stock-UGC").hide("fast"),$(".Stats .StatsContainer .Rate .Filter .All").addClass("Selected"),$(".Stats .StatsContainer .Rate .Filter .Today").click(function(){var edate=new Date,sdate=new Date;sdate.setHours(0,0,0,0),edate.setHours(23,59,59,0),StockFeedback.SearchRatingFeedback(id,sdate,edate),_feedbackFlag="Today",$(this).addClass("Selected"),_removeFilterSelected($(this))}),$(".Stats .StatsContainer .Rate .Filter .OneMonth").click(function(){var edate=new Date,sdate=new Date;sdate.setMonth(sdate.getMonth()-1),sdate.setHours(0,0,0,0),edate.setHours(23,59,59,0),StockFeedback.SearchRatingFeedback(id,sdate,edate),_feedbackFlag="OneMonth",$(this).addClass("Selected"),_removeFilterSelected($(this))}),$(".Stats .StatsContainer .Rate .Filter .SixMonths").click(function(){var edate=new Date,sdate=new Date;sdate.setMonth(sdate.getMonth()-6),sdate.setHours(0,0,0,0),edate.setHours(23,59,59,0),StockFeedback.SearchRatingFeedback(id,sdate,edate),_feedbackFlag="SixMonths",$(this).addClass("Selected"),_removeFilterSelected($(this))}),$(".Stats .StatsContainer .Rate .Filter .All").click(function(){StockFeedback.SearchRatingFeedback(id,null,null),_feedbackFlag="All",$(this).addClass("Selected"),_removeFilterSelected($(this))})},StockFeedback.UpdateRatings=function(id){$.cookie("BNNStockRating_"+id)?($(".Stats .StatsContainer .Rate .Label").html("&nbsp;"),$(".Stats .StatsContainer .Rate .Label").attr("style","cursor:default")):$(".Stats .StatsContainer .Rate .Label").html(properties.RatingLabel);var edate=new Date,sdate=new Date;switch(_feedbackFlag){case"Today":sdate.setHours(0,0,0,0),edate.setHours(23,59,59,0),StockFeedback.SearchRatingFeedback(id,sdate,edate);break;case"OneMonth":sdate.setMonth(sdate.getMonth()-1),sdate.setHours(0,0,0,0),edate.setHours(23,59,59,0),StockFeedback.SearchRatingFeedback(id,sdate,edate);break;case"SixMonths":sdate.setMonth(sdate.getMonth()-6),sdate.setHours(0,0,0,0),edate.setHours(23,59,59,0),StockFeedback.SearchRatingFeedback(id,sdate,edate);break;case"All":StockFeedback.SearchRatingFeedback(id,null,null);break;default:StockFeedback.SearchRatingFeedback(id,null,null)}},StockFeedback.SearchRatingFeedback=function(id,sdate,edate){var $blk,ratingsSearch;_rating=0,$blk=$(".Stats .StatsContainer .Rate #blockIn"),$blk.hide("fast"),ratingsSearch=new Agility.UGC.API.FeedbackSearchArg,ratingsSearch.ReferenceName="StockFeedback",ratingsSearch.ContentType=Agility.UGC.API.FeedbackContentType.UGC,ratingsSearch.SubmissionType=Agility.UGC.API.FeedbackSubmissionType.Rating,ratingsSearch.RelatedContentIDs=[id],ratingsSearch.StartDate=sdate?"/Date("+Date.UTC(sdate.getFullYear(),sdate.getMonth(),sdate.getDate(),sdate.getHours(),sdate.getMinutes(),sdate.getSeconds(),0)+")/":null,ratingsSearch.EndDate=edate?"/Date("+Date.UTC(edate.getFullYear(),edate.getMonth(),edate.getDate(),edate.getHours(),edate.getMinutes(),edate.getSeconds(),0)+")/":null,ratingsSearch.Action=Agility.UGC.API.AggregateTypes.Average,Agility.UGC.API.GetFeedbackAggregate(ratingsSearch,function(data){if(data.ResponseType==0){var result=data.ResponseData.length>0?data.ResponseData[0].Result:0;_rating=Math.round(Number(result*10)),_rating==0?($blk.attr("style","width:100%;background-image:none;"),$blk.click(function(){$.cookie("BNNStockRating_"+id)||($(".Stats .StatsContainer .Rate .Blocks").hide("fast"),$(".Stats .StatsContainer .Rate .sliderContainer #ratingSlider").show("fast"))})):($blk.attr("style","height:100%; width: 1%"),$blk.animate({width:+_rating+"%"},800))}})},_updateShowsMenuPosition=function(linkElement,menuElement){if(linkElement.length>0&&menuElement.length>0){var x=linkElement.offset().left+linkElement.width()/2-menuElement.width()/2,y=linkElement.offset().top+linkElement.height()+8;menuElement.css("left",x+"px"),menuElement.css("top",y+"px")}},_removeFilterSelected=function(elem){$.each($(".Stats
 .StatsContainer .Rate .Filter div").not(elem),function(){$(this).removeClass("Selected")})},_renderTip=function(){$(".Stats .StatsContainer .Rate .help").tooltip({effect:"slide",position:"bottom right",offset:[-20,0]}),$(".Stats .Stock-Comments .help").tooltip({effect:"slide",position:"bottom right",offset:[-20,0]})},_trimSymbol=function(str){return str.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}}(BNN.Modules.StockFeedback);
Agility.RegisterNamespace("BNN.Modules.NewsListing"),function(NewsListing){function getDate(dateStr){return new Date(parseInt(dateStr.substr(6)))}function cancelTimer(){closetimer&&(window.clearTimeout(closetimer),closetimer=null)}function removeHTMLTags(htmlString){if(htmlString){var mydiv=document.createElement("div");return mydiv.innerHTML=htmlString,document.all?mydiv.innerText:mydiv.textContent}}function StopAtWordBreak(str){return str.indexOf(" ")?str.substring(0,str.lastIndexOf(" ")):str}var properties=null,container=null,timeout=500,closetimer=0,menuItem=null;NewsListing.OnInit=function(p){properties=p,container=$("#"+properties.ContainerID),$(".MenuSectors .Content a:last",container).css("border-bottom","none"),NewsListing.OnMenuInit(),$("#News > div.NewsStory > div.Thumbnail").hover(function(){$(this).find(".play").toggleClass("play-on")})},NewsListing.LoadNews=function(){var pageNum=BNN.Controls.Pager.CurrentPage,height=$("#News").height();$("#News").html('<div class="Loading">'),$("#News .Loading").css("height",height+"px"),$.ajax({url:AjaxWebserviceSvcUrl+"/GetNews?pageNum="+pageNum+"&pageSize="+properties.PostsPerPage+"&year=0&month=0&day=1&category="+properties.Sector,contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var res={d:jsonResponse},$container;res.d!=undefined&&res.d!=null&&($container=container.find(".News").eq(0),$container.html(""),$container.hasTemplate()||$container.setTemplateURL(Agility.ResolveUrl("~/ClientTemplates/NewsListing.htm")),$container.processTemplate(res),BNN.Controls.Pager.Render(properties.TotalCount),$("#News .Loading").hide(),$("#News > div.NewsStory > div.Thumbnail").hover(function(){$(this).find(".play").toggleClass("play-on")}))}})},NewsListing.OnMenuInit=function(){var config={over:BNN.Modules.NewsListing.OnMenuOpen,out:BNN.Modules.NewsListing.OnMenuTimer,timeout:10},lis;$(".ViewBy > a",container).each(function(){var subMenuID=$(this).attr("menuclass");$(this).append($("."+subMenuID,container))}),lis=$(".ViewBy > a",container),lis.hoverIntent(config)},NewsListing.OnMenuOpen=function(){cancelTimer(),BNN.Modules.NewsListing.OnMenuClose();var subMenu=$(this).attr("menuclass");$("."+subMenu,container).show()},NewsListing.OnMenuClose=function(){$(".SubMenu",container).hide()},NewsListing.OnMenuTimer=function(){closetimer=window.setTimeout("BNN.Modules.NewsListing.OnMenuClose()",timeout)},NewsListing.GetDateTimeSection=function(news){if(news.IsReuters)return"";var date=getDate(news.CreatedOn);return"Posted on "+dateFormat(date,"m-d-yyyy")+" at "+dateFormat(date,"h:MM TT")},NewsListing.StripHTMLandTrim=function(text){var tmp=removeHTMLTags(text);if(tmp)return tmp=tmp.replace(/<\/?[^>]+>/gi,""),tmp<=190?tmp:(tmp=tmp.substr(0,190),tmp=StopAtWordBreak(tmp),tmp+"...")},NewsListing.GetStoryThumbnail=function(news){return!!news.AxisVideoID&&news.AxisVideos.length>0?news.AxisVideos[0].ThumbnailUrl+"?width=200&height=113":!news.Image.URL?void 0:news.ThumbImages[1].Value},NewsListing.DisplayIcon=function(news){if(news.AxisVideoID)return"<div class='play' />"},NewsListing.DisplaySponsoredCategoryIcon=function(news){return news.SponsoredCategories.length>0?'<div class="Advertisement"><span>Advertisement</span></div>':""}}(BNN.Modules.NewsListing);
Agility.RegisterNamespace("BNN.Modules.NewsListingArchive"),function(NewsListingArchive){function getDate(dateStr){return new Date(parseInt(dateStr.substr(6)))}function cancelTimer(){closetimer&&(window.clearTimeout(closetimer),closetimer=null)}function removeHTMLTags(htmlString){if(htmlString){var mydiv=document.createElement("div");return mydiv.innerHTML=htmlString,document.all?mydiv.innerText:mydiv.textContent}}function StopAtWordBreak(str){return str.indexOf(" ")?str.substring(0,str.lastIndexOf(" ")):str}var properties=null,container=null,timeout=500,closetimer=0,menuItem=null,Year=0,Month=0,Day=0;NewsListingArchive.OnInit=function(p){properties=p,container=$("#"+properties.ContainerID),$(".MenuSectors .Content a:last",container).css("border-bottom","none"),$(".MenuMonths .Content a:last",container).css("border-bottom","none"),$(".MenuYears .Content a:last",container).css("border-bottom","none"),NewsListingArchive.OnMenuInit(),NewsListingArchive.OnMonthMenuInit(),NewsListingArchive.OnYearMenuInit(),$(".News .ArchiveItem").bind("mouseenter",function(){$(this).addClass("Hover")}),$(".News .ArchiveItem").bind("mouseleave",function(){$(this).removeClass("Hover")})},NewsListingArchive.LoadArchivedNews=function(){var pageNum=BNN.Controls.Pager.CurrentPage,height=$("#News").height();$("#News").html('<div class="Loading">'),$("#News .Loading").css("height",height+"px"),$.ajax({url:AjaxWebserviceSvcUrl+"/GetNews?pageNum="+pageNum+"&pageSize="+properties.PostsPerPage+"&year="+properties.Year+"&month="+properties.Month+"&day="+properties.Day+"&category="+properties.Sector,contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var res={d:jsonResponse},$container;res.d!=undefined&&res.d!=null&&($container=container.find(".News").eq(0),$container.html(""),$container.hasTemplate()||$container.setTemplateURL(Agility.ResolveUrl("~/ClientTemplates/NewsListingArchive.htm")),$container.processTemplate(res),BNN.Controls.Pager.Render(properties.TotalCount),$(".News .ArchiveItem").bind("mouseenter",function(){$(this).addClass("Hover")}),$(".News .ArchiveItem").bind("mouseleave",function(){$(this).removeClass("Hover")}),$("#News .Loading").hide())}})},NewsListingArchive.OnMenuInit=function(){var config={over:BNN.Modules.NewsListingArchive.OnMenuOpen,out:BNN.Modules.NewsListingArchive.OnMenuTimer,timeout:10},lis;$(".ViewBy > a",container).each(function(){var subMenuID=$(this).attr("menuclass");$(this).append($("."+subMenuID,container))}),lis=$(".ViewBy > a",container),lis.hoverIntent(config)},NewsListingArchive.OnMenuOpen=function(){cancelTimer(),BNN.Modules.NewsListingArchive.OnMenuClose(),NewsListingArchive.OnMonthMenuClose(),NewsListingArchive.OnYearMenuClose();var subMenu=$(this).attr("menuclass");$("."+subMenu,container).show()},NewsListingArchive.OnMenuClose=function(){$(".SubMenu",container).hide()},NewsListingArchive.OnMenuTimer=function(){closetimer=window.setTimeout("BNN.Modules.NewsListingArchive.OnMenuClose()",timeout)},NewsListingArchive.OnMonthMenuInit=function(){var mconfig={over:BNN.Modules.NewsListingArchive.OnMonthMenuOpen,out:BNN.Modules.NewsListingArchive.OnMonthMenuTimer,timeout:10},lis;$(".ViewByMonth > a",container).each(function(){var subMenuID=$(this).attr("menuclass");$(this).append($("."+subMenuID,container))}),lis=$(".ViewByMonth > a",container),lis.hoverIntent(mconfig)},NewsListingArchive.OnMonthMenuOpen=function(){cancelTimer(),BNN.Modules.NewsListingArchive.OnMonthMenuClose(),NewsListingArchive.OnMenuClose(),NewsListingArchive.OnYearMenuClose();var SubMenu2=$(this).attr("menuclass");$("."+SubMenu2,container).show()},NewsListingArchive.OnMonthMenuClose=function(){$(".SubMenu2",container).hide()},NewsListingArchive.OnMonthMenuTimer=function(){closetimer=window.setTimeout("BNN.Modules.NewsListingArchive.OnMonthMenuClose()",timeout)},NewsListingArchive.OnYearMenuInit=function(){var yconfig={over:BNN.Modules.NewsListingArchive.OnYearMenuOpen,out:BNN.Modules.NewsListingArchive.OnYearMenuTimer,timeout:10},lis;$(".ViewByYear > a",container).each(function(){var subMenuID=$(this).attr("menuclass");$(this).append($("."+subMenuID,container))}),lis=$(".ViewByYear > a",container),lis.hoverIntent(yconfig)},NewsListingArchive.OnYearMenuOpen=function(){cancelTimer(),BNN.Modules.NewsListingArchive.OnYearMenuClose(),NewsListingArchive.OnMenuClose(),NewsListingArchive.OnMonthMenuClose();var SubMenu3=$(this).attr("menuclass");$("."+SubMenu3,container).show()},NewsListingArchive.OnYearMenuClose=function(){$(".SubMenu3",container).hide()},NewsListingArchive.OnYearMenuTimer=function(){closetimer=window.setTimeout("BNN.Modules.NewsListingArchive.OnYearMenuClose()",timeout)},NewsListingArchive.GetDateTimeSection=function(news){if(news.IsReuters)return"";var date=getDate(news.CreatedOn);return"Posted on "+dateFormat(date,"m-d-yyyy")+" at "+dateFormat(date,"h:MM TT")},NewsListingArchive.StripHTMLandTrim=function(text){var tmp=removeHTMLTags(text);return tmp=tmp.replace(/<\/?[^>]+>/gi,""),tmp<=200?tmp:(tmp=tmp.substr(0,200),tmp=StopAtWordBreak(tmp),tmp+"...")}}(BNN.Modules.NewsListingArchive);
Agility.RegisterNamespace("BNN.Modules.NewsListingTags"),function(NewsListingTags){function getDate(dateStr){return new Date(parseInt(dateStr.substr(6)))}function removeHTMLTags(htmlString){if(htmlString){var mydiv=document.createElement("div");return mydiv.innerHTML=htmlString,document.all?mydiv.innerText:mydiv.textContent}}function StopAtWordBreak(str){return str.indexOf(" ")?str.substring(0,str.lastIndexOf(" ")):str}var properties=null,container=null;NewsListingTags.OnInit=function(p){properties=p,container=$("#"+properties.ContainerID),$("#News > div.NewsStory > div.Thumbnail").hover(function(){$(this).find(".play").toggleClass("play-on")})},NewsListingTags.LoadNews=function(){var pageNum=BNN.Controls.Pager.CurrentPage,height=$("#News").height();$("#News").html('<div class="Loading">'),$("#News .Loading").css("height",height+"px"),$.ajax({url:AjaxWebserviceSvcUrl+"/GetNewsByTag?pageNum="+pageNum+"&pageSize="+properties.PostsPerPage+"&tag="+properties.Tag,contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var res={d:jsonResponse},$container;res.d!=undefined&&res.d!=null&&($container=container.find(".News").eq(0),$container.html(""),$container.hasTemplate()||$container.setTemplateURL(Agility.ResolveUrl("~/ClientTemplates/NewsListingTags.htm")),$container.processTemplate(res),BNN.Controls.Pager.Render(properties.TotalCount),$("#News > div.NewsStory > div.Thumbnail").hover(function(){$(this).find(".play").toggleClass("play-on")}),$("#News .Loading").hide())}})},NewsListingTags.GetDateTimeSection=function(news){if(news.IsReuters)return"";var date=getDate(news.CreatedOn);return"Posted on "+dateFormat(date,"m-d-yyyy")+" at "+dateFormat(date,"h:MM TT")},NewsListingTags.StripHTMLandTrim=function(text){var tmp=removeHTMLTags(text);return tmp=tmp.replace(/<\/?[^>]+>/gi,""),tmp<=200?tmp:(tmp=tmp.substr(0,200),tmp=StopAtWordBreak(tmp),tmp+"...")},NewsListingTags.GetTags=function(news){var tags,i;if(!news.TagTitles)return"";for(tags="",i=0;i<news.TagTitles.length;i++)tags+="<a href="+Agility.ResolveUrl("~/News/News-Listing-Tags.aspx?tag="+news.TagTitles[i].replace(" ","-"))+">"+news.TagTitles[i]+"</a>, ";return"Tagged: "+tags.substring(0,tags.length-2)}}(BNN.Modules.NewsListingTags);
Agility.RegisterNamespace("BNN.Modules.NewsListingTagsSelectable"),function(NewsListingTagsSelectable){function getDate(dateStr){return new Date(parseInt(dateStr.substr(6)))}function removeHTMLTags(htmlString){if(htmlString){var mydiv=document.createElement("div");return mydiv.innerHTML=htmlString,document.all?mydiv.innerText:mydiv.textContent}}function StopAtWordBreak(str){return str.indexOf(" ")?str.substring(0,str.lastIndexOf(" ")):str}var properties=null,container=null;NewsListingTagsSelectable.OnInit=function(p){properties=p,container=$("#"+properties.ContainerID),$(".News .ArchiveItem").bind("mouseenter",function(){$(this).addClass("Hover")}),$(".News .ArchiveItem").bind("mouseleave",function(){$(this).removeClass("Hover")})},NewsListingTagsSelectable.LoadNews=function(){var pageNum=BNN.Controls.Pager.CurrentPage,height=$("#News").height();$("#News").html('<div class="Loading">'),$("#News .Loading").css("height",height+"px"),$.ajax({url:AjaxWebserviceSvcUrl+"/GetNewsByTags?pageNum="+pageNum+"&pageSize="+properties.PostsPerPage+"&tags="+properties.Tags,contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var res={d:jsonResponse},$container;res.d!=undefined&&res.d!=null&&($container=container.find(".News").eq(0),$container.html(""),$container.hasTemplate()||$container.setTemplateURL(Agility.ResolveUrl("~/ClientTemplates/NewsListingTagsSelectable.htm")),$container.processTemplate(res),BNN.Controls.Pager.Render(properties.TotalCount),$(".News .ArchiveItem").bind("mouseenter",function(){$(this).addClass("Hover")}),$(".News .ArchiveItem").bind("mouseleave",function(){$(this).removeClass("Hover")}),$("#News .Loading").hide())}})},NewsListingTagsSelectable.GetDateTimeSection=function(news){if(news.IsReuters)return"";var date=getDate(news.CreatedOn);return"Posted on "+dateFormat(date,"m-d-yyyy")+" at "+dateFormat(date,"h:MM TT")},NewsListingTagsSelectable.GetTags=function(news){var tags,i;if(!news.TagTitles)return"";for(tags="",i=0;i<news.TagTitles.length;i++)tags+="<a href="+Agility.ResolveUrl("~/News/News-Listing-Tags.aspx?tag="+news.TagTitles[i].replace(" ","-"))+">"+news.TagTitles[i]+"</a>, ";return"Tagged: "+tags.substring(0,tags.length-2)},NewsListingTagsSelectable.StripHTMLandTrim=function(text){var tmp=removeHTMLTags(text);return tmp=tmp.replace(/<\/?[^>]+>/gi,""),tmp<=200?tmp:(tmp=tmp.substr(0,200),tmp=StopAtWordBreak(tmp),tmp+"...")}}(BNN.Modules.NewsListingTagsSelectable);
Agility.RegisterNamespace("BNN.Modules.TodaysGuests"),function(TodaysGuests){var _currentItem=0,_scrollSettings={duration:1e3};TodaysGuests.OnInit=function(ClientID,guestsToShow){var client=$("#"+ClientID);$.ajax({url:AjaxWebserviceSvcUrl+"/GetNewTodaysGuests",contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var result={d:jsonResponse},now,i,theDate,target;if(result.d!=undefined&&result.d!=null&&result.d.length>0){var _data=result.d,container=client.find(".ItemContainer"),templateUrl=Agility.ResolveUrl("~/ClientTemplates/TodaysGuests.htm"),settings={f_escapeString:function(string){return string}};for(container.setTemplateURL(templateUrl,null,settings),container.processTemplate(_data),client.find(".ScrollLeft").bind("click",function(){if(_currentItem>0){_currentItem=_currentItem-1;var target=client.find(".Guest"+_currentItem);client.find(".GuestList").scrollTo(target,_scrollSettings),$(target).next().css("background-image","none")}}),client.find(".ScrollRight").bind("click",function(){if(_currentItem<_data.length-guestsToShow){_currentItem=_currentItem+1;var target=client.find(".Guest"+_currentItem);client.find(".GuestList").scrollTo(target,_scrollSettings),$(target).css("background-image",'url("../../Images/Backgrounds/bkg_todays_guests.png")'),$(target).next().css("background-image","none")}}),_currentItem=_data.length-1,now=new Date,i=0;i<_data.length;i++)if(theDate=new Date(parseInt(_data[i].Date.substr(6))),theDate.getHours()>now.getHours()||theDate.getHours()==now.getHours()&&theDate.getMinutes()>now.getMinutes()){_currentItem=i;break}_currentItem=Math.min(_currentItem,_data.length-guestsToShow),_currentItem=Math.max(_currentItem,0),target=client.find(".Guest"+_currentItem),client.find(".GuestList").scrollTo(target,_scrollSettings),$(target).css("background-image",'url("../../Images/Backgrounds/bkg_todays_guests.png")'),$(target).next().css("background-image","none");return}client.remove()},complete:function(){}})},TodaysGuests.GetTitle=function(guest){if(guest==null)return"";var title=guest.Title!=null?guest.Title:"",company=guest.Company!=null?guest.Company:"";return title+(title.length<1||company.length<1?"":", ")+company},TodaysGuests.GetGuest=function(guest){return guest==null?"":guest.Name}}(BNN.Modules.TodaysGuests);
Agility.RegisterNamespace("BNN.TopStories"),function(TopStories){function IsNullOrEmpty(str){return str==undefined||str==null||str==""}function GetStoryThumbnail(story,width,height,isDetail){return IsNullOrEmpty(story.Video)?IsNullOrEmpty(story.Image.URL)?"<img src='"+Agility.ResolveUrl("~/Images/spacer.gif")+"' alt='"+story.Headline+"' title='"+story.Headline+"'/>":isDetail?"<img src='"+story.ThumbImages[0].Value+"' alt='"+story.Headline+"' title='"+story.Headline+"'/>":"<img src='"+story.ThumbImages[3].Value+"' alt='"+story.Headline+"' title='"+story.Headline+"'/>":isDetail?"<img src='"+GetVideoThumbnailUrl(story.Video,width,height,1)+"' alt='"+story.VideoDescription+"' title='"+story.VideoDescription+"' class='thumbDetail' />"+TopStories.DisplayIcon(story):"<img src='"+GetVideoThumbnailUrl(story.Video,width,height,1)+"' alt='"+story.VideoDescription+"' title='"+story.VideoDescription+"'  />"}function GetVideoThumbnailUrl(clipID,width,height,mode){return IsNullOrEmpty(clipID)?Agility.ResolveUrl("~/Images/spacer.gif"):Agility.ResolveUrl("~/Handlers/VideoThumb.ashx")+"?Clip="+clipID+","+width+","+height+","+mode}TopStories.OnInit=function(clientID){var client=$("#"+clientID);$.ajax({url:AjaxWebserviceSvcUrl+"/GetTopStories",contentType:"application/json",dataType:"json",success:function(jsonResponse){var result={d:jsonResponse},html,stories;result.d!=undefined&&result.d!=null&&(html="",$.each(jsonResponse,function(i,story){html+="<a class='Story' href='"+story.Url+"'vid-id='"+story.Video+"' data-id='"+story.ContentID+"' pos-index='"+i+"'><div class='Headline'>"+story.Headline+"</div>",html+="<div class='Thumbnail'>"+GetStoryThumbnail(story,130,73)+"</div></a>"}),client.html(html)),stories=$("#TopStories .Story"),stories.click(function(e){return e.stopPropagation(),TopStories.Select(this,$(this).attr("data-id"),$(this).attr("vid-id")),!1}),stories.length>0&&stories.eq(0).click(),$("#TopStories .Story").bind("mouseenter",function(){$(this).addClass("Hover")}),$("#TopStories .Story").bind("mouseleave",function(){$(this).removeClass("Hover")})}})},TopStories.DisplayIcon=function(news){if(news.Video)return"<img class='overlay' src='/Images/Icons/icn_video_thumb_new.png' alt='play' width='300px' height='168px' onclick='BNN.TopStories.IERedirect(\""+news.Url.toString()+"\")' />"},TopStories.IERedirect=function(url){window.location=Agility.ResolveUrl("~"+url)},TopStories.Select=function(sender,contentId){$("#TopStories .Story").each(function(){$(this).removeClass("Selected")}),$(sender).addClass("Selected");var topStoryDetailHeadline=$("#TopStoryDetailHeadline a"),topStoryDetailMain=$("#TopStoryDetailMain");topStoryDetailHeadline.length>0&&topStoryDetailMain.length>0&&$.ajax({url:AjaxWebserviceSvcUrl+"/GetStoryById?contentId="+contentId,contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var result={d:jsonResponse},img,container,extendedCoverageTitle;result.d!=undefined&&result.d!=null&&(topStoryDetailHeadline.html(result.d.Headline),topStoryDetailHeadline.attr("href",result.d.Url),topStoryDetailMain.find("div.Teaser").html(result.d.Teaser),topStoryDetailMain.find("div.FullStoryLink a").attr("href",result.d.Url),$("#TopStoryDetailMain a").attr("href",result.d.Url),img=GetStoryThumbnail(result.d,300,169,!0),$("#TopStoryDetailVideo").html(img).show(),container=$("#TopStoryDetailMain .ExtendedCoverage"),container.html(""),extendedCoverageTitle=$("#TopStoryDetailMain .ExtendedCoverageTitle"),result.d.ExtendedCoverage!=null&&result.d.ExtendedCoverage.length>0?(container.hasTemplate()||container.setTemplateURL(Agility.ResolveUrl("~/ClientTemplates/TopStoryExtendedCoverage.htm")),container.processTemplate(result.d.ExtendedCoverage),extendedCoverageTitle.show(),container.show()):extendedCoverageTitle.hide())},complete:function(){}})},TopStories.GetItemHtml=function(item){var div=$("<div></div>").html(item.ItemHtml);return div.text()}}(BNN.TopStories);
Agility.RegisterNamespace("BNN.Modules.Comments"),function(Comments){function bindEvents(){$(".Submission .SubmitButton",_container).bind("click",function(){$(".Submission .Validation",_container).hide();var emailRegex=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i;$email.val()!=""&&$email.val()!=$email.next().text()&&$username.val()!=""&&$username.val()!=$username.next().text()&&$comment.val()!=""?$email.val().match(emailRegex)?Comments.SubmitComment():$(".Submission .InvalidEmail",_container).show():$(".Submission .Required",_container).show()}),$(".ThankYou .Another",_container).bind("click",function(){clearFields(),$(".ThankYou",_container).hide(),$(".Submission",_container).show()})}function clearFields(){$(".Submission .Validation",_container).hide(),$comment.val(""),$email.val($email.next().text()).watermark(),$username.val($username.next().text()).watermark()}var _properties=null,_container=null,_numToShow=3,_reportedIDs=[],$email,$username,$comment;Comments.OnInit=function(p){_properties=p,_container=$("#"+_properties.ContainerID),_numToShow=_properties.CommentsPerPage,$email=$("#"+_properties.EmailID,_container),$username=$("#"+_properties.UserNameID,_container),$comment=$("#"+_properties.CommentID,_container),bindEvents(),Comments.ConfigureLayout(),Comments.LoadComments()},Comments.LoadComments=function(){var pageNum=_properties.HidePager?1:BNN.Controls.Pager.CurrentPage,searchQuery=_properties.ContentID>1?"ContentID = "+_properties.ContentID:"URL = '"+location.pathname+"'",searchArg={RecordTypeName:_properties.ContentReferenceName,RecordOffset:(pageNum-1)*_numToShow,PageSize:_numToShow,Search:searchQuery,SortedField:"CreatedOn",SortDirection:"DESC",State:Agility.UGC.API.RecordState.Published},cookieValue=decodeURIComponent(BNN.Cookie.GetCommentAbuseCookie());_reportedIDs=cookieValue.split(","),Agility.UGC.API.SearchRecords(searchArg,function(data){var exist,$container;data.ResponseType==Agility.UGC.API.ResponseType.OK&&(exist=data.ResponseData!=null&&data.ResponseData.TotalRecords>0,exist&&($container=_container.find(".Content").eq(0),$container.html(""),$container.hasTemplate()||$container.setTemplateURL(Agility.ResolveUrl("~/ClientTemplates/Comments.htm")),$container.processTemplate(data.ResponseData),$(".Report",$container).bind("click",function(){var me=$(this),recordID=parseInt($(this).parent().attr("commentid")),flag="Abuse";Agility.UGC.API.SetRecordFlag(recordID,"Abuse","",function(){me.text("Reported as Abuse").unbind("click").css("cursor","default");var IDs=BNN.Cookie.GetCommentAbuseCookie();IDs+=","+recordID,BNN.Cookie.SetCommentAbuseCookie(IDs)})}),_properties.HidePager||BNN.Controls.Pager.Render(data.ResponseData.TotalRecords)))})},Comments.ConfigureLayout=function(){$email.watermark($email.next().text()),$username.watermark($username.next().text())},Comments.SubmitComment=function(){var record={ID:-1,RecordTypeName:_properties.ContentReferenceName,ContentID:_properties.ContentID,ContentTitle:_properties.ContentTitle,Comment:$("#"+_properties.CommentID,_container).val(),UserName:$("#"+_properties.UserNameID,_container).val(),Email:$("#"+_properties.EmailID,_container).val(),URL:window.location.pathname};Agility.UGC.API.SaveRecord(record,function(){$(".Submission",_container).hide(),$(".ThankYou",_container).show()})},Comments.GetReportAbuseText=function(commentID){return $.inArray(commentID,_reportedIDs)==-1?_properties.ReportAbuseLabel:_properties.ReportedAbuseLabel},Comments.GetPostedByHtml=function(r){var date=Date.parse(r.CreatedOn);return"Posted by: <b>"+r.UserName+"</b> on "+dateFormat(date,"mmmm d, yyyy h:MM:stt")+" ET"}}(BNN.Modules.Comments);
Agility.RegisterNamespace("BNN.Modules.TwitterFeeds"),function(TwitterFeeds){function searchInContext(p,sender){var a=$(sender);BNN.Modules.TwitterFeeds.Load({ContainerID:p.ContainerID,TwitterAccounts:p.TwitterAccounts,TwittsPerPage:p.TwittsPerPage,PageNo:parseInt(a.data("page"))-1,TweetsAge:p.TweetsAge})}function bindPageFn(p,$p){return $p.unbind("click").bind("click",function(){return searchInContext(p,this),!1}),$p}function pageLink(p,pageNum,currentPage){if(pageNum!=currentPage){var $page=$('<a class="Page" href="javascript:;"></a>').text(pageNum);return $page.data("page",pageNum),bindPageFn(p,$page,pageNum)}return $('<a class="CurrentPage"></a>').text(pageNum)}function PagerRender(p,$pager,numItems,postsPerPage,currentPage){var i;$pager.show();var numPages=Math.ceil(numItems/postsPerPage),links=$('<span class="Links"></span>'),$previousBtn=$pager.find("a.Previous"),$nextBtn=$pager.find("a.Next");if(numItems==0||numPages<=1){$pager.hide();return}for(currentPage<=1?$previousBtn.hide():($previousBtn.data("page",currentPage-1).show(),bindPageFn(p,$previousBtn,currentPage-1)),currentPage>=numPages?$nextBtn.hide():($nextBtn.data("page",currentPage+1).show(),bindPageFn(p,$nextBtn,currentPage+1)),links.append(pageLink(p,1,currentPage)),currentPage>4&&links.append($("<span>...</span>")),i=Math.max(2,currentPage-2);i<=Math.min(numPages-1,currentPage+2);i++)links.append(pageLink(p,i,currentPage));currentPage<numPages-3&&links.append($("<span>...</span>")),links.append(pageLink(p,numPages,currentPage)),$(".Links",$pager).replaceWith(links).show()}TwitterFeeds.MenuInit=function(p){var container=$("#"+p.ContainerID),config,lis,lisa;container.find("a.SectorView").size()!=0&&(config={over:function(){var c=$("#"+p.ContainerID),closetimer=c.data("closetimer"),subMenu;closetimer&&(window.clearTimeout(closetimer),closetimer=null),$(".SubMenu",c).hide(),subMenu=$(this).attr("menuclass"),$("."+subMenu,c).show()},out:function(){var c=$("#"+p.ContainerID);c.data("closetimer",window.setTimeout(function(){$(".SubMenu",c).hide()},500))},timeout:10},lis=container.find("a.SectorView"),lis.each(function(){var subMenuID=$(this).attr("menuclass");$(this).append($("."+subMenuID,container))}),lisa=lis.find("a"),lisa.each(function(idx){idx==0?$(this).bind("click",function(){return lisa.removeClass("Selected"),$(this).addClass("Selected"),BNN.Modules.TwitterFeeds.Load({ContainerID:p.ContainerID,TwitterAccounts:p.TwitterAccounts,TwittsPerPage:p.TwittsPerPage,PageNo:0,TweetsAge:p.TweetsAge}),!1}):$(this).bind("click",function(){lisa.removeClass("Selected"),$(this).addClass("Selected");var ref=this.href,i=ref.indexOf("#");return i>=0&&(ref=ref.substring(i+1).replace(/@/gi,""),BNN.Modules.TwitterFeeds.Load({ContainerID:p.ContainerID,TwitterAccounts:"'"+ref+"'",TwittsPerPage:p.TwittsPerPage,PageNo:0,TweetsAge:p.TweetsAge})),!1})}),lis.hoverIntent(config))},TwitterFeeds.Load=function(p){p.TwitterAccounts.length>0&&$.ajax({type:"POST",url:Agility.ResolveUrl("~/WebServices/Cache/TwitterService.asmx")+"/GetUsersTimelines",contentType:"application/json",data:"{screenNames:["+p.TwitterAccounts+"],count:"+p.TwittsPerPage+",page:"+p.PageNo+",tweetsAge:"+p.TweetsAge+"}",dataType:"json",success:function(result){var container=$("#"+p.ContainerID+" div.Feeds"),templateUrl;result.d!=undefined&&result.d!=null&&result.d.Results!=null&&(templateUrl=Agility.ResolveUrl("~/ClientTemplates/Twitter.htm"),container.setTemplateURL(templateUrl),container.processTemplate(result.d.Results),PagerRender(p,container.parent().find("div.Pager"),result.d.TotalResults,p.TwittsPerPage,p.PageNo+1))},complete:function(){}})},TwitterFeeds.H=function(time_value){var values=time_value.split(" ");time_value=values[1]+" "+values[2]+", "+values[5]+" "+values[3];var parsed_date=Date.parse(time_value),relative_to=arguments.length>1?arguments[1]:new Date,delta=parseInt((relative_to.getTime()-parsed_date)/1e3);return delta=delta+relative_to.getTimezoneOffset()*60,delta<60?"less than a minute ago":delta<120?"about a minute ago":delta<3600?parseInt(delta/60).toString()+" minutes ago":delta<7200?"about an hour ago":delta<86400?"about "+parseInt(delta/3600).toString()+" hours ago":delta<172800?"1 day ago":parseInt(delta/86400).toString()+" days ago"},TwitterFeeds.L=function(what){str=what,out="",url="",i=0;do url=str.match(/(((ht|f)tps?:\/\/)?([a-z\-]+\.)*[\-\w]+(\.[a-z]{2,4})+(\/[\w\_\-\?\=\&\.]*)*(?![a-z]))/i),url!=null?(href=url[0],href.substr(0,7)!="http://"&&(href="http://"+href),where=str.indexOf(url[0]),out+=str.substr(0,where),out+='<a href="'+href+'" target="_blank">'+url[0]+"</a>",str=str.substr(where+url[0].length)):(out+=str,str="");while(str.length>0);return out.replace(/\B@([_a-z0-9]+)/ig,'<a target="_blank" href="http://twitter.com/$1">@$1</a>')}}(BNN.Modules.TwitterFeeds);
Agility.RegisterNamespace("BNN.Modules.TwitterWidget"),function(TwitterWidget){TwitterWidget.OnInit=function(p){new TWTR.Widget({version:2,type:"search",search:p.Search,interval:3e4,title:p.Title,subject:p.Subject,width:"auto",height:300,rpp:p.NumberOfTweets,id:p.ContainerID,theme:{shell:{background:"#8ec1da",color:"#ffffff"},tweets:{background:"#ffffff",color:"#444444",links:"#1985b5"}},features:{scrollbar:p.DisplayScrollbar=="True"?!0:!1,loop:p.LoopResults=="True"?!0:!1,live:!0,behavior:"default"}}).render().start()}}(BNN.Modules.TwitterWidget);
Agility.RegisterNamespace("BNN.FeaturedVideo"),function(FeaturedVideo){function onVideoStart(){outputLog("onVideoStart")}function onPlayerReady(){outputLog("__NewAdRuleInPlace____"),outputLog("onPlayerReady")}function outputLog(str){try{console.log("[ ETS ]="+str)}catch(e){}}function onVideoCoAd(infoObj){var contentDiv,i;if(outputLog("inside coad handler"),contentDiv="",infoObj.ads!=undefined)for(i=0;i<infoObj.ads.length;i++)contentDiv=infoObj.ads[i].content,infoObj.dartTemplate=="js"&&contentDiv!=""?contentDiv='<script language="JavaScript" src="'+infoObj.ads[i].content+'"   type="text/javascript"><\/script>':infoObj.dartTemplate=="vast"&&contentDiv!=""?(outputLog("vast coad is: "+infoObj.ads[i].content),contentDiv=infoObj.ads[i].content):outputLog("no js no vast"),outputLog(infoObj.dartTemplate+" contentDiv is "+contentDiv),writeIntoCompanionDiv(contentDiv,infoObj.ads[i].size)}function writeIntoCompanionDiv(content,size){content!=""&&(outputLog(content),$("#AdModule_"+size).writeCapture().html(content))}var _mode=1,playerObjList={},flashPlaylistObj={};FeaturedVideo.OnInit=function(latestFeaturedVideos){var mainApp,playlistObj,mpFlashVars,i;console.log("featured init"+latestFeaturedVideos[0].Id),mpFlashVars={},mpFlashVars.vid=latestFeaturedVideos[0].Id,mpFlashVars.autoplay=0,mpFlashVars.zone="_default",mpFlashVars.dartkey="envr=test;",mainApp=etsapi.embedPlayer("vplayer","mediaplayerdiv",300,168,"bnn","300x168/",{flashVars:mpFlashVars}),mainApp.registerEvent(MediaPlayerControllerEvent.PLAYER_READY,this,onPlayerReady),mainApp.registerEvent(MediaPlayerControllerEvent.VIDEO_STARTED,this,onVideoStart),playerObjList.vplayer=mainApp;for(i in playerObjList)playerObjList[i].registerEvent(MediaPlayerControllerEvent.VIDEO_COAD,this,onVideoCoAd)}}(BNN.FeaturedVideo);
Agility.RegisterNamespace("BNN.Modules.UpcomingGuests"),function(UpcomingGuests){var _currentItem=0,_scrollSettings={duration:1e3};UpcomingGuests.OnInit=function(ClientID,guestsToShow,ShowID){$.ajax({url:AjaxWebserviceSvcUrl+"/GetNewUpcomingGuests?showID="+ShowID,contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var result={d:jsonResponse},client=$("#"+ClientID),now,i,theDate,target;if(result.d!=undefined&&result.d!=null&&result.d.length>0){var _data=result.d,container=client.find(".ItemContainer"),templateUrl=Agility.ResolveUrl("~/ClientTemplates/UpcomingGuests.htm"),settings={f_escapeString:function(string){return string}};for(container.setTemplateURL(templateUrl,null,settings),container.processTemplate(_data),client.find(".ScrollLeft").bind("click",function(){_currentItem=_currentItem-1;var target=client.find("#UGuestDetails"+_currentItem);client.find(".GuestList").scrollTo(target,_scrollSettings),$(target).next().css("background-image","none")}),client.find(".ScrollRight").bind("click",function(){_currentItem=_currentItem+1;var target=client.find("#UGuestDetails"+_currentItem);client.find(".GuestList").scrollTo(target,_scrollSettings),$(target).css("background-image",'url("../../Images/Backgrounds/bkg_todays_guests.png")'),$(target).next().css("background-image","none")}),now=new Date,i=0;i<_data.length;i++)if(theDate=new Date(parseInt(_data[i].Date.substr(6))),theDate.getHours()>now.getHours()||theDate.getHours()==now.getHours()&&theDate.getMinutes()>now.getMinutes()){_currentItem=i;break}_currentItem=Math.min(_currentItem,_data.length-guestsToShow),_currentItem=Math.max(_currentItem,0),target=client.find("#UGuestDetails"+_currentItem),$(target).css("background-image",'url("../../Images/Backgrounds/bkg_todays_guests.png")'),$(target).next().css("background-image","none")}},complete:function(){}})},UpcomingGuests.GetDayOfWeek=function(date){var theDate=new Date(parseInt(date.substr(6))),days=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];return days[theDate.getDay()]},UpcomingGuests.GetTitle=function(guest){if(guest==null)return"";var title=guest.Title!=null?guest.Title:"",company=guest.Company!=null?guest.Company:"";return title+(title.length<1||company.length<1?"":", ")+company},UpcomingGuests.GetDate=function(date){var theDate=new Date(parseInt(date.substr(6))),currentTime=new Date(parseInt(date.substr(6))),month=currentTime.getMonth()+1,day=currentTime.getDate(),year=currentTime.getFullYear();return month+"/"+day+"/"+year}}(BNN.Modules.UpcomingGuests);
Agility.RegisterNamespace("BNN.Modules.VideoHighlights"),function(Video){function decodeHTML(encodedHTML){return $("<div/>").html(encodedHTML).text()}var properties=null,container=null;Video.OnInit=function(p){properties=p,container=$("#"+properties.ContainerID)},Video.LoadVideos=function(){var pageNum=BNN.Controls.Pager.CurrentPage;$.ajax({url:AjaxWebserviceSvcUrl+"/GetVideoHighlights?contentReferenceName="+properties.ContentReferenceName+"&pageNum="+pageNum+"&pageSize="+properties.PostsPerPage,contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var res={d:jsonResponse},$container;res.d!=undefined&&res.d!=null&&($container=container.find(".Clips").eq(0),$container.html(""),$container.hasTemplate()||$container.setTemplateURL(Agility.ResolveUrl("~/ClientTemplates/VideoHighlights.htm")),$container.setParam("HTMLDecode",decodeHTML),$container.processTemplate(res),BNN.Controls.Pager.Render(properties.TotalCount))}})}}(BNN.Modules.VideoHighlights);
Agility.RegisterNamespace("BNN.Modules.DiscussionQuestionArchive"),function(DQA){var _pageSize,_contentReferenceName,_totalCount;DQA.OnInit=function(pageSize,contentReferenceName,totalCount){_pageSize=pageSize,_contentReferenceName=contentReferenceName,_totalCount=totalCount},DQA.LoadQuestions=function(){var pageNum=BNN.Controls.Pager.CurrentPage;$.ajax({url:AjaxWebserviceSvcUrl+"/GetDiscussionQuestions?pageNum="+pageNum+"&pageSize="+_pageSize+"&contentReferenceName="+_contentReferenceName,contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var res={d:jsonResponse},container;res.d!=undefined&&res.d!=null&&(container=$("#DiscussionQuestionArchive .DiscussionQuestions"),container.html(""),container.hasTemplate()||container.setTemplateURL(Agility.ResolveUrl("~/ClientTemplates/DiscussionQuestionArchive.htm")),container.processTemplate(res.d),BNN.Controls.Pager.Render(_totalCount))}})}}(BNN.Modules.DiscussionQuestionArchive);
Agility.RegisterNamespace("BNN.Modules.MarketMovers"),function(MarketMovers){function MarketMoversBindPageFn($p,num,container,type){return $p.unbind("click").bind("click",function(){var id,ins;return id=$p.is(".Next")||$p.is(".Previous")?$p.parent().attr("id"):$p.parent().parent().attr("id"),ins=id.substring(id.indexOf("_")+1),container=="CanadianStocks"?type=="Gainers"?MarketMovers.LoadTSXGainers(num-1,container):type=="Losers"?MarketMovers.LoadTSXLosers(num-1,container):type=="MostActive"&&MarketMovers.LoadTSXMostActive(num-1,"CanadianStocks"):container=="USStocks"&&(type=="Gainers"?MarketMovers.LoadUSGainers(num-1,container):type=="Losers"?MarketMovers.LoadUSLosers(num-1,container):type=="MostActive"&&MarketMovers.LoadUSMostActive(num-1,container)),!1}),$p}function MarketMoversPageLink(pageNum,pageText,currentPage,container,type){if(pageNum!=currentPage){var $page=$('<a class="Page" href="javascript:;"></a>').text(pageText);return $page.data("page",pageNum),MarketMoversBindPageFn($page,pageNum,container,type)}return $('<a class="CurrentPage"></a>').text(pageNum)}var host,count=10,resultsPerPage=10,defaults={Container:{}},_properties=null;MarketMovers.OnInit=function(p){_properties=$.extend({},defaults,p||{}),host=_properties.Host,MarketMovers.LoadTSXGainers(0,"CanadianStocks"),MarketMovers.LoadUSGainers(0,"USStocks"),MarketMovers.TabClick("CanadianTabs","Gainers","CanadianStocks"),MarketMovers.TabClick("CanadianTabs","Losers","CanadianStocks"),MarketMovers.TabClick("CanadianTabs","MostActive","CanadianStocks"),MarketMovers.TabClick("USTabs","Gainers","USStocks"),MarketMovers.TabClick("USTabs","Losers","USStocks"),MarketMovers.TabClick("USTabs","MostActive","USStocks")},MarketMovers.LoadTSXGainers=function(pageNum,container){$("#MarketMovers .CanadianTabs .Gainers").addClass("Selected"),$.each($("#MarketMovers .CanadianTabs .Tab").not($("#MarketMovers .CanadianTabs .Gainers")),function(){$(this).removeClass("Selected")});var height=320;$("#CanadianStocks").html('<tr class="VideoLoading"><td colspan="5"></td></tr>'),$("#CanadianStocks .VideoLoading").css("height",height+"px"),$.getJSON(MarketDataServiceUrl+"/GetReutersTSXGainersList?pageNo="+pageNum+"&resultsPerPage="+resultsPerPage+"",function(result){result!=undefined&&(MarketMovers.PagerRender($("#Pager"),50,resultsPerPage,pageNum+1,container,"Gainers"),MarketMovers.ProcessVideos(result,container),$("#CanadianStocks .VideoLoading").hide())})},MarketMovers.LoadTSXLosers=function(pageNum,container){$("#MarketMovers .CanadianTabs .Losers").addClass("Selected"),$.each($("#MarketMovers .CanadianTabs .Tab").not($("#MarketMovers .CanadianTabs .Losers")),function(){$(this).removeClass("Selected")});var height=320;$("#CanadianStocks").html('<tr class="VideoLoading"><td colspan="5"></td></tr>'),$("#CanadianStocks .VideoLoading").css("height",height+"px"),$.getJSON(MarketDataServiceUrl+"/GetReutersTSXLosersList?pageNo="+pageNum+"&resultsPerPage="+resultsPerPage+"",function(result){result!=undefined&&(MarketMovers.PagerRender($("#Pager"),50,resultsPerPage,pageNum+1,container,"Losers"),MarketMovers.ProcessVideos(result,container),$("#CanadianStocks .VideoLoading").hide())})},MarketMovers.LoadTSXMostActive=function(pageNum,container){$("#MarketMovers .CanadianTabs .MostActive").addClass("Selected"),$.each($("#MarketMovers .CanadianTabs .Tab").not($("#MarketMovers .CanadianTabs .MostActive")),function(){$(this).removeClass("Selected")});var height=320;$("#CanadianStocks").html('<tr class="VideoLoading"><td colspan="5"></td></tr>'),$("#CanadianStocks .VideoLoading").css("height",height+"px"),$.getJSON(MarketDataServiceUrl+"/GetReutersTSXMostActiveList?pageNo="+pageNum+"&resultsPerPage="+resultsPerPage+"",function(result){result!=undefined&&(MarketMovers.PagerRender($("#Pager"),50,resultsPerPage,pageNum+1,container,"MostActive"),MarketMovers.ProcessVideos(result,container),$("#CanadianStocks .VideoLoading").hide())})},MarketMovers.LoadUSGainers=function(pageNum,container){$("#MarketMovers .USTabs .Gainers").addClass("Selected"),$.each($("#MarketMovers .USTabs .Tab").not($("#MarketMovers .USTabs .Gainers")),function(){$(this).removeClass("Selected")});var height=320;$("#USStocks").html('<tr class="VideoLoading"><td colspan="5"></td></tr>'),$("#USStocks .VideoLoading").css("height",height+"px"),$.getJSON(MarketDataServiceUrl+"/GetReutersUSGainersList?pageNo="+pageNum+"&resultsPerPage="+resultsPerPage+"",function(result){result!=undefined&&(MarketMovers.PagerRender($("#USPager"),50,resultsPerPage,pageNum+1,container,"Gainers"),MarketMovers.ProcessVideos(result,container),$("#USStocks .VideoLoading").hide())})},MarketMovers.LoadUSLosers=function(pageNum,container){$("#MarketMovers .USTabs .Losers").addClass("Selected"),$.each($("#MarketMovers .USTabs .Tab").not($("#MarketMovers .USTabs .Losers")),function(){$(this).removeClass("Selected")});var height=320;$("#USStocks").html('<tr class="VideoLoading"><td colspan="5"></td></tr>'),$("#USStocks .VideoLoading").css("height",height+"px"),$.getJSON(MarketDataServiceUrl+"/GetReutersUSLosersList?pageNo="+pageNum+"&resultsPerPage="+resultsPerPage+"",function(result){result!=undefined&&(MarketMovers.PagerRender($("#USPager"),50,resultsPerPage,pageNum+1,container,"Losers"),MarketMovers.ProcessVideos(result,container),$("#USStocks .VideoLoading").hide())})},MarketMovers.LoadUSMostActive=function(pageNum,container){$("#MarketMovers .USTabs .MostActive").addClass("Selected"),$.each($("#MarketMovers .USTabs .Tab").not($("#MarketMovers .USTabs .MostActive")),function(){$(this).removeClass("Selected")});var height=320;$("#USStocks").html('<tr class="VideoLoading"><td colspan="5"></td></tr>'),$("#USStocks .VideoLoading").css("height",height+"px"),$.getJSON(MarketDataServiceUrl+"/GetReutersUSMostActiveList?pageNo="+pageNum+"&resultsPerPage="+resultsPerPage+"",function(result){result!=undefined&&(MarketMovers.PagerRender($("#USPager"),50,resultsPerPage,pageNum+1,container,"MostActive"),MarketMovers.ProcessVideos(result,container),$("#USStocks .VideoLoading").hide())})},MarketMovers.ProcessVideos=function(contentItems,container){(contentItems.length>0||!contentItems)&&MarketMovers.UpdateMoverTemplate(contentItems,container)},MarketMovers.UpdateMoverTemplate=function(content,container){var container=$("#"+container),templateUrl=Agility.ResolveUrl("~/ClientTemplates/MarketMover_ReutersMovers.htm");container.setTemplateURL(templateUrl),container.processTemplate(content)},MarketMovers.TabClick=function(tabsClassName,tabClassName,container){$("#MarketMovers ."+tabsClassName+" ."+tabClassName).bind("click",function(){container=="CanadianStocks"?tabClassName=="Gainers"?MarketMovers.LoadTSXGainers(0,container):tabClassName=="Losers"?MarketMovers.LoadTSXLosers(0,container):tabClassName=="MostActive"&&MarketMovers.LoadTSXMostActive(0,container):container=="USStocks"&&(tabClassName=="Gainers"?MarketMovers.LoadUSGainers(0,container):tabClassName=="Losers"?MarketMovers.LoadUSLosers(0,container):tabClassName=="MostActive"&&MarketMovers.LoadUSMostActive(0,container))})},MarketMovers.PagerRender=function($pager,numItems,postsPerPage,currentPage,container,type){var i;$pager.show();var numPages=Math.ceil(numItems/postsPerPage),links=$('<span class="Links"></span>'),$previousBtn=$pager.find("a.Previous"),$nextBtn=$pager.find("a.Next");if(numItems==0||numPages<=1){$pager.hide();return}for(currentPage<=1?$previousBtn.hide():($previousBtn.data("page",currentPage-1).show(),MarketMoversBindPageFn($previousBtn,currentPage-1,container,type)),currentPage>=numPages?$nextBtn.hide():($nextBtn.data("page",currentPage+1).show(),MarketMoversBindPageFn($nextBtn,currentPage+1,container,type)),links.append(MarketMoversPageLink(1,1,currentPage,container,type)),currentPage>4&&links.append($("<span>...</span>")),i=Math.max(2,currentPage-2);i<=Math.min(numPages-1,currentPage+2);i++)links.append(MarketMoversPageLink(i,i,currentPage,container,type));currentPage<numPages-3&&links.append($("<span>...</span>")),links.append(MarketMoversPageLink(numPages,"Last",currentPage,container,type)),$(".Links",$pager).replaceWith(links).show()},MarketMovers.getCssClass=function(val){var positive=val!=null&&val!=""&&val.indexOf("-")!=0;return val=="0"||val==""?"Neutral":positive?"Positive":"Negative"},MarketMovers.formatPriceInfo=function(val){return val!=null&&val!=""?_addCommas(_keepTwoDecimals(_addZero(_removeSign(val)))):val},_removeSign=function(val){return val.indexOf("-")==0?val.substring(1):val.indexOf("+")==0?val.substring(1):val},_addCommas=function(val){for(var regEx=/(\d+)(\d{3})/;regEx.test(val);)val=val.replace(regEx,"$1,$2");return val},_keepTwoDecimals=function(val){var tmpFloat=Math.round(100*parseFloat(val))/100;return tmpFloat.toString()},_bindPageIndexClick=function(){$("#MarketMovers .Pager .CanadianPrevLink a").bind("click",_prevCanadianPageIndex),$("#MarketMovers .Pager .CanadianNextLink a").bind("click",_nextCanadianPageIndex),$("#MarketMovers .Pager .USPrevLink a").bind("click",_prevUSPageIndex),$("#MarketMovers .Pager .USNextLink a").bind("click",_nextUSPageIndex)},_initializeMarketMovers=function(){$("#MarketMovers .CanadianTabs .Gainers").click(),$("#MarketMovers .USTabs .Gainers").click()},_bindClickToPopulateMarketMoverTable=function(tabsClassName,tabClassName,pagerId,jsonpMethod,containerId,sort){$("#MarketMovers ."+tabsClassName+" ."+tabClassName).bind("click",function(){_populateMarketMoverPager("GetRowCountForCanadianFinancialTable","CanadianPager","g"),_populateMarketMoverPager("GetRowCountForUSFinancialTable","USPager","g"),_populateMarketMoverTable(tabsClassName,tabClassName,pagerId,jsonpMethod,containerId,0,sort)})},_populateMarketMoverTable=function(tabsClassName,tabClassName,pagerId,jsonpMethod,containerId,start,sort){$("#MarketMovers ."+tabsClassName+" .Tab").each(function(index,item){$(item).removeClass("Selected")});var pageIndex=Math.floor(start/count)+1;$(".PageIndex",$("#"+pagerId)).each(function(index,item){$(item).removeClass("Selected")}),$(":nth-child(
"+pageIndex+")",$("#"+pagerId)).addClass("Selected"),$("#MarketMovers ."+tabsClassName+" ."+tabClassName).addClass("Selected"),$.getJSON(MarketDataServiceUrl+"/"+jsonpMethod+"?start="+start+"&count="+count+"&host="+host+"&sort="+sort+"",function(result){var container=$("#"+containerId);container.html(result),$("tr",container).each(function(index,item){var netChange,percentChange;$(":nth-child(2)",$(item)).css("font-weight","normal"),netChange=$(":nth-child(4)",$(item)).html(),netChange.indexOf('<font color="green">')==0?($(":nth-child(4)",$(item)).html('<font color="#009F45">'+netChange.substring(20)),$(":nth-child(3)",$(item)).html('<font color="#009F45">'+$(":nth-child(3)",$(item)).html()+"</font>"),percentChange=$(":nth-child(5)",$(item)).html(),$(":nth-child(5)",$(item)).html('<font color="#009F45">'+percentChange.substring(20))):netChange.indexOf('<font color="red">')==0&&($(":nth-child(4)",$(item)).html('<font color="#EC2024">'+netChange.substring(18)),$(":nth-child(3)",$(item)).html('<font color="#EC2024">'+$(":nth-child(3)",$(item)).html()+"</font>"),percentChange=$(":nth-child(5)",$(item)).html(),$(":nth-child(5)",$(item)).html('<font color="#EC2024">'+percentChange.substring(18)))}),container.find("a").each(function(){this.href="http://"+location.host+this.href.split("bnn.ca")[1]})})},_populateMarketMoverPager=function(jsonMethod,pagerId,sort){$.getJSON(MarketDataServiceUrl+"/"+jsonMethod+"?host="+host+"&sort="+sort+"",function(result){var data,i,container,templateUrl;if(result!=undefined){for(data=[],i=1;i<=Math.ceil(result/10);i++)data[data.length]={PageIndex:i};container=$("#"+pagerId),templateUrl=Agility.ResolveUrl("~/ClientTemplates/MarketMoverPager.htm"),container.setTemplateURL(templateUrl),container.processTemplate(data),$(":nth-child(1)","#"+pagerId).addClass("Selected")}})},_prevCanadianPageIndex=function(){var currentPageIndex=$.trim($("#MarketMovers .Pager #CanadianPager .Selected").text()),currentIndex,newPageIndex;if(currentPageIndex!=undefined&&currentPageIndex!=""){if(currentIndex=parseInt(currentPageIndex),currentIndex==1)return!1;newPageIndex=(currentIndex-1).toString(),$("#MarketMovers .Pager #CanadianPager div:nth-child("+newPageIndex+")").click()}},_prevUSPageIndex=function(){var currentPageIndex=$.trim($("#MarketMovers .Pager #USPager .Selected").text()),currentIndex,newPageIndex;if(currentPageIndex!=undefined&&currentPageIndex!=""){if(currentIndex=parseInt(currentPageIndex),currentIndex==1)return!1;newPageIndex=(currentIndex-1).toString(),$("#MarketMovers .Pager #USPager div:nth-child("+newPageIndex+")").click()}},_nextCanadianPageIndex=function(){var currentPageIndex=$.trim($("#MarketMovers .Pager #CanadianPager .Selected").text());if(currentPageIndex!=undefined&&currentPageIndex!=""){var currentIndex=parseInt(currentPageIndex),newPageIndex=(currentIndex+1).toString(),newIdx=$("#MarketMovers .Pager #CanadianPager div:nth-child("+newPageIndex+")");newIdx!=undefined&&newIdx.click()}},_nextUSPageIndex=function(){var currentPageIndex=$.trim($("#MarketMovers .Pager #USPager .Selected").text());if(currentPageIndex!=undefined&&currentPageIndex!=""){var currentIndex=parseInt(currentPageIndex),newPageIndex=(currentIndex+1).toString(),newIdx=$("#MarketMovers .Pager #USPager div:nth-child("+newPageIndex+")");newIdx!=undefined&&newIdx.click()}},_pageIndexClick=function(event){var obj=event.srcElement!=undefined?event.srcElement:event.originalTarget!=undefined?event.originalTarget:event.target,index,start;if($(".PageIndex",$(obj.parentNode)).each(function(index,item){$(item).removeClass("Selected")}),$(obj).addClass("Selected"),index=parseInt($.trim($(obj).text())),start=(index-1)*count,$(obj.parentNode).attr("id")=="CanadianPager"){var tabsClassName="CanadianTabs",pagerId="CanadianPager",jsonpMethod="GetCanadianMarketMoversTable",containerId="CanadianStocks",tabsClassName="CanadianTabs",tabClassName="Gainers",sort="g";$("#MarketMovers ."+tabsClassName+" .Tab").each(function(index,item){$(item).hasClass("Selected")&&(sort=$(item).attr("data"),sort=="g"?tabClassName="Gainers":sort=="l"?tabClassName="Losers":sort=="a"&&(tabClassName="MostActive"))}),_populateMarketMoverTable(tabsClassName,tabClassName,pagerId,jsonpMethod,containerId,start,sort)}else if($(obj.parentNode).attr("id")=="USPager"){var tabsClassName="USTabs",pagerId="USPager",jsonpMethod="GetUSMarketMoversTable",containerId="USStocks",tabsClassName="USTabs",tabClassName="Gainers",sort="g";$("#MarketMovers ."+tabsClassName+" .Tab").each(function(index,item){$(item).hasClass("Selected")&&(sort=$(item).attr("data"),sort=="g"?tabClassName="Gainers":sort=="l"?tabClassName="Losers":sort=="a"&&(tabClassName="MostActive"))}),_populateMarketMoverTable(tabsClassName,tabClassName,pagerId,jsonpMethod,containerId,start,sort)}}}(BNN.Modules.MarketMovers);
jQuery.fn.extend({BNNContest:function(arg){$(this).each(function(){var argObj={onSubmitComment:BNN.Modules.BNNContest.SubmitComment,onCommentSubmitComplete:BNN.Modules.BNNContest.onCommentSubmitComplete};$.extend(argObj,arg),BNN.Modules.BNNContest.LoadContest(argObj)})}}),Agility.RegisterNamespace("BNN.Modules.BNNContest"),function(BNNContest){function _buildContestInputForm(argObj){var html="";return html+="<div class='ContestSubmission'>",html+="<div class='ContestErrorSummary'><ul></ul></div>",html+='<form id="commentForm">',html+="<h2 class='Red'>"+argObj.EntryFormTitleLabel+"</h2>",html+="<div class='Field'><label>"+argObj.FirstNameLabel+"</label><input type='text' id='txtContestPluginFirstName' name='txtContestPluginFirstName' class='required'/></div>",html+="<div class='Field'><label>"+argObj.LastNameLabel+"</label><input type='text' id='txtContestPluginLastName' name='txtContestPluginLastName' class='required' /></div>",html+="<div class='EmailAddress'><label>"+argObj.EmailLabel+"</label><input type='text' id='txtContestPluginEmailAddress' name='txtContestPluginEmailAddress' class='EmailAddressInput required email'/></div>",html+="<div class='AddressField'><label>"+argObj.AddressLabel+"</label><input type='text' id='txtContestPluginAddress' name='txtContestPluginAddress' class='AddressInput required'/></div>",html+="<div class='Field'><label>"+argObj.CityLabel+"</label><input type='text' id='txtContestPluginCity' name ='txtContestPluginCity' class='NameInput required'/></div>",html+="<div class='Field' style='width:76px'><label>"+argObj.ProvinceLabel+"</label><select id='ddlProvinces' name='ddlProvinces' class='NameInput required' style='width:76px'>"+argObj.Provinces+"</select></div>",html+="<div class='Field'><label>"+argObj.CountryLabel+"</label><select id='ddlCountry' name='ddlCountry' class='required'><option value=''></option><option value='Canada'>Canada</option><option value='U.S.'>U.S.</option><option value='Other'>Other</option></select></div>",html+="<div class='Field'><label>"+argObj.PostalCodeLabel+"</label><input type='text' id='txtContestPluginPostalCode' name='txtContestPluginPostalCode' class='NameInput required'/></div>",html+="<div class='Field'><label>"+argObj.TelephoneLabel+"</label><input type='text' id='txtContestPluginTelephone' class='NameInput required' name='txtContestPluginTelephone'/></div>",html+="<div class='Answer'><label>"+argObj.AnswerLabel+"</label><textarea id='txtContestPluginAnswer' class='CommentInput required' name='txtContestPluginAnswer' rows='4'></textarea></div>",html+="<div class='Submit'><input id='Submit' name='Submit' style='border-width: 0px; margin-right:12px; width:64px;'  type='image' src='"+argObj.SubmitButtonImageUrl+"' alt='Submit' /></div>",html+="<div class='Reset'><img id='btnReset' class='Reset' src='"+argObj.ResetButtonImageUrl+"' /></div>",html+="</div>",html+="<div class='ContestErrorMessage'>",html+="<div class='ErrFirstName'>"+argObj.FirstNameError+"</div>",html+="<div class='ErrLastName'>"+argObj.LastNameError+"</div>",html+="<div class='ErrEmail'>"+argObj.EmailError+"</div>",html+="<div class='InvalidEmail'>"+argObj.EmailInvalidError+"</div>",html+="<div class='ErrCountry'>"+argObj.CountryError+"</div>",html+="<div class='ErrProvince'>"+argObj.ProvinceError+"</div>",html+="<div class='ErrAddress'>"+argObj.AddressError+"</div>",html+="<div class='ErrCity'>"+argObj.CityError+"</div>",html+="<div class='ErrPostal'>"+argObj.CityError+"</div>",html+="<div class='InvalidPostal'>"+argObj.PostalCodeInvalidError+"</div>",html+="<div class='ErrPhone'>"+argObj.TelephoneError+"</div>",html+="<div class='InvalidPhone'>"+argObj.TelephoneInvalidError+"</div>",html+="<div class='ErrAnswer'>"+argObj.AnswerError+"</div>",html+="</div>",html+="<div class='ThankYou'>",html+="<div class='Message'>"+argObj.ThankyouMessage+"</div>",html+="</form>",html+="</div>"}var properties=null;BNNContest.LoadContest=function(argObj){var ContestContainer,html;$.ajax({url:AjaxWebserviceSvcUrl+"/GetBNNContest?ID="+argObj.RelatedContentID,contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var res={d:jsonResponse};res.d!=undefined&&res.d!=null&&($("#BNNContest .Title").html(res.d.Title),$("#BNNContest .Description").html(res.d.Description),$("#BNNContest .Question").html(res.d.Question.Question))}}),ContestContainer=$("#ContestContainer"),_currentArgs=argObj,html="<div class='ContestPlugin'>",html+=_buildContestInputForm(argObj),html+="</div>",ContestContainer.html(html),$("#btnReset",container).bind("click",function(){BNNContest.ResetCommentForm(ContestContainer)}),$.cookie("BNNContest_"+argObj.RelatedContentID)?BNNContest.DisplayThankYou(ContestContainer):BNNContest.HideThankYou(ContestContainer);var $fname=$.trim($("#txtContestPluginFirstName").val()),$lname=$.trim($("#txtContestPluginLastName").val()),$emailAddress=$.trim($("#txtContestPluginEmailAddress").val()),$address=$.trim($("#txtContestPluginAddress").val()),$city=$.trim($("#txtContestPluginCity").val()),$province=$("#ddlProvinces option:selected").text(),$country=$("#ddlCountry option:selected").val(),$postalcode=$.trim($("#txtContestPluginPostalCode").val()),$telephone=$.trim($("#txtContestPluginTelephone").val()),$answer=$.trim($("#txtContestPluginAnswer").val()),container="#ContestContainer .ContestPlugin .ContestSubmission",errorMsgs=$("#ContestContainer .ContestPlugin .ContestErrorMessage");$("#commentForm").validate({invalidHandler:function(e,validator){var errors=validator.numberOfInvalids();errors>0?$(".ContestErrorSummary",container).show():$(".ContestErrorSummary",container).hide()},submitHandler:function(){argObj.onSubmitComment(ContestContainer,argObj.RecordTypeName,argObj.RelatedContentID)},rules:{txtContestPluginPostalCode:{required:function(){return $("#ddlCountry option:selected").val()!="Other"}},ddlProvinces:{required:function(){return $("#ddlProvinces option:selected").val()!="other"}},txtContestPluginPostalCode:{postalcode:!0},txtContestPluginTelephone:{telephone:!0}},messages:{txtContestPluginFirstName:$(".ErrFirstName",errorMsgs).text(),txtContestPluginLastName:$(".ErrLastName",errorMsgs).text(),txtContestPluginEmailAddress:{required:$(".ErrEmail",errorMsgs).text(),email:$(".InvalidEmail",errorMsgs).text()},ddlCountry:$(".ErrCountry",errorMsgs).text(),ddlProvinces:$(".ErrProvince",errorMsgs).text(),txtContestPluginAddress:$(".ErrAddress",errorMsgs).text(),txtContestPluginCity:$(".ErrCity",errorMsgs).text(),txtContestPluginPostalCode:{required:$(".ErrPostal",errorMsgs).text(),postalcode:$(".InvalidPostal",errorMsgs).text()},txtContestPluginTelephone:{required:$(".ErrPhone",errorMsgs).text(),telephone:$(".InvalidPhone",errorMsgs).text()},txtContestPluginAnswer:$(".ErrAnswer",errorMsgs).text()},errorLabelContainer:".ContestErrorSummary ul",wrapper:"li"}),$.validator.addMethod("telephone",function(phone_number,element){return phone_number=phone_number.replace(/\s+/g,""),this.optional(element)||phone_number.length>9&&phone_number.match(/^\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$/)},"Please specify a valid phone number"),$.validator.addMethod("postalcode",function(postalcode,element){return this.optional(element)||postalcode.match(/^((\d{5})|(([ABCEGHJKLMNPRSTVXY]|[abceghjklmnprstvxy])\d([ABCEGHJKLMNPRSTVWXYZ]|[abceghjklmnprstvwxyz])(\s|)\d([ABCEGHJKLMNPRSTVWXYZ]|[abceghjklmnprstvwxyz])\d))$/)},"Please specify a valid postal/zip code")},BNNContest.ResetCommentForm=function(elem){$(".ContestErrorSummary",elem).hide(),$("#txtContestPluginFirstName").val(""),$("#txtContestPluginLastName").val(""),$("#txtContestPluginEmailAddress").val(""),$("#txtContestPluginAddress").val(""),$("#txtContestPluginCity").val(""),$("#txtContestPluginPostalCode").val(""),$("#txtContestPluginTelephone").val(""),$("#txtContestPluginAnswer").val(""),$("#commentForm :input").each(function(){$(this).removeClass("error")})},BNNContest.DisplayThankYou=function(elem){$(".ContestSubmission",elem).hide(),$(".ThankYou",elem).show()},BNNContest.HideThankYou=function(elem){$(".ContestSubmission",elem).show(),$(".ThankYou",elem).hide()},BNNContest.SubmitComment=function(elem,RecordTypeName,RelatedContentID){var fname=$.trim($("#txtContestPluginFirstName").val()),lname=$.trim($("#txtContestPluginLastName").val()),emailAddress=$.trim($("#txtContestPluginEmailAddress").val()),address=$.trim($("#txtContestPluginAddress").val()),city=$.trim($("#txtContestPluginCity").val()),province=$("#ddlProvinces option:selected").text(),country=$("#ddlCountry option:selected").val(),postalcode=$.trim($("#txtContestPluginPostalCode").val()),telephone=$.trim($("#txtContestPluginTelephone").val()),answer=$.trim($("#txtContestPluginAnswer").val()),comment;$("#commentForm").valid()&&(comment={ID:-1,RecordTypeName:RecordTypeName,RelatedContentID:RelatedContentID,Name:fname+" "+lname,FirstName:fname,LastName:lname,Address:answer,City:city,Province:province,Country:country,PostalCode:postalcode,Telephone:telephone,Email:emailAddress,Comment:answer},Agility.UGC.API.SaveRecord(comment,function(data){_currentArgs.onCommentSubmitComplete(data);$.cookie("BNNContest_"+RelatedContentID,!0)}))},BNNContest.onCommentSubmitComplete=function(data){data.ResponseType==Agility.UGC.API.ResponseType.OK?(BNNContest.ResetCommentForm(),BNNContest.DisplayThankYou()):alert("There was an error entering the contest:"+data.Message)}}(BNN.Modules.BNNContest);
Agility.RegisterNamespace("BNN.Modules.MarketCallUpcomingGuests"),function(MarketCallUpcomingGuests){var _currentItem=0,_scrollSettings={duration:1e3};MarketCallUpcomingGuests.OnInit=function(ClientID,ShowID,NumDays){var guestsToShow;$.ajax({url:AjaxWebserviceSvcUrl+"/GetNewMarketCallUpcomingGuests?showID="+ShowID+"&numDays="+NumDays,contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var result={d:jsonResponse},client=$("#"+ClientID),_data,now,i,theDate,target;if(result.d!=undefined&&result.d!=null&&result.d.length>0){_data=result.d,guestsToShow=2;var container=client.find(".ItemContainer"),templateUrl=Agility.ResolveUrl("~/ClientTemplates/MarketCallUpcomingGuests.htm"),settings={f_escapeString:function(string){return string}};for(container.setTemplateURL(templateUrl,null,settings),container.processTemplate(_data),client.find(".ScrollLeft").bind("click",function(){if(_currentItem>0){_currentItem=_currentItem-1;var target=client.find(".Guest"+_currentItem);client.find(".GuestList").scrollTo(target,_scrollSettings),$(target).next().css("background-image","none")}}),client.find(".ScrollRight").bind("click",function(){if(_currentItem<_data.length-guestsToShow){_currentItem=_currentItem+1;var target=client.find(".Guest"+_currentItem);client.find(".GuestList").scrollTo(target,_scrollSettings),$(target).css("background-image",'url("../../Images/Backgrounds/bkg_todays_guests.png")'),$(target).next().css("background-image","none")}}),now=new Date,i=0;i<_data.length;i++)if(theDate=new Date(parseInt(_data[i].Date.substr(6))),theDate.getHours()>now.getHours()||theDate.getHours()==now.getHours()&&theDate.getMinutes()>now.getMinutes()){_currentItem=i;break}target=client.find(".Guest0"),$(target).css("background-image",'url("../../Images/Backgrounds/bkg_todays_guests.png")'),$(target).next().css("background-image","none")}},complete:function(){}})},MarketCallUpcomingGuests.GetDayOfWeek=function(date){var theDate=new Date(parseInt(date.substr(6))),days=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];return days[theDate.getDay()]},MarketCallUpcomingGuests.GetDate=function(date){var theDate=new Date(parseInt(date.substr(6))),currentTime=new Date(parseInt(date.substr(6))),month=currentTime.getMonth()+1,day=currentTime.getDate(),year=currentTime.getFullYear();return month+"/"+day+"/"+year},MarketCallUpcomingGuests.GetTitle=function(guest){if(guest==null)return"";var title=guest.Title!=null?guest.Title:"",company=guest.Company!=null?guest.Company:"";return title+(title.length<1||company.length<1?"":", ")+company},MarketCallUpcomingGuests.ProcessUrl=function(guestName){return guestName==null?"":Agility.ResolveUrl(window.location.pathname)+"?Query="+escape(guestName)}}(BNN.Modules.MarketCallUpcomingGuests);
Agility.RegisterNamespace("BNN.Modules.PitchPanelistListing"),function(PitchPanelistListing){var properties=null,container=null;PitchPanelistListing.OnInit=function(){PitchPanelistListing.LoadPanelists()},PitchPanelistListing.LoadPanelists=function(){$.ajax({url:AjaxWebserviceSvcUrl+"/GetShowOnPagePitchPersonalities",contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var res={d:jsonResponse};res.d!=undefined&&res.d!=null&&($container=$("#panelistlist"),$container.hasTemplate()||$container.setTemplateURL(Agility.ResolveUrl("~/ClientTemplates/PitchPanelistListing.htm")),$container.processTemplate(res))},complete:function(){$("#panelistlist").listnav({includeNums:!1,showCounts:!0})}})},PitchPanelistListing.GetCompany=function(name){return name==null?"":name}}(BNN.Modules.PitchPanelistListing);
Agility.RegisterNamespace("BNN.CustomAdModule"),function(CustomAdModule){function getAuthorQueryString(variable){for(var query=window.location.search.substring(1),vars=query.split("&"),pair,i=0;i<vars.length;i++)if(pair=vars[i].split("="),pair[0]==variable||pair[0]==variable.toLowerCase())return unescape(pair[1].replace(/-/g,"").toLowerCase())}function getSectorForZone(variable){for(var query=window.location.search.substring(1),vars=query.split("&"),pair,i=0;i<vars.length;i++)if(pair=vars[i].split("="),pair[0]==variable||pair[0]==variable.toLowerCase())return unescape(pair[1].replace(/-/g,"").toLowerCase());return"news_index"}function Trim(value){var rvalue=value,firstChar,lastChar;return typeof value!="undefined"&&value!==null&&value.length>0&&(firstChar=rvalue.charAt(0),firstChar=="/"&&(rvalue=rvalue.substring(1,rvalue.length)),lastChar=rvalue.charAt(rvalue.length-1),lastChar=="/"&&(rvalue=rvalue.substring(0,rvalue.length-1)),rvalue.length>0&&(firstChar=rvalue.charAt(0),isNaN(firstChar)==!1&&(rvalue="x"+rvalue))),rvalue}function parseUri(str){for(var o=parseUri.options,m=o.parser[o.strictMode?"strict":"loose"].exec(str),uri={},i=14;i--;)uri[o.key[i]]=m[i]||"";return uri[o.q.name]={},uri[o.key[12]].replace(o.q.parser,function($0,$1,$2){$1&&(uri[o.q.name][$1]=$2)}),uri}CustomAdModule.Render=function(path,interstitials,tile,size){var site="ctv.bnn",Environment="",Zone="",Keywords=[],PageId="",Section="",sector,meta,Size,Path,Site,istCode,renderTile,zone,adPage,subPath,pageId,section,subSection,contentSection,envr,keywords,adCode;if(Zone==""){var pUri=BNN.AdModule.parseUri(window.location),directoryPath=pUri.directory.toLowerCase().split("/"),domain=pUri.authority.toLowerCase();Environment=domain=="bnn.local"||domain=="stage-origin.bnn.ca"||domain=="localhost:61087"?"dev":"prod",Environment=Environment,directoryPath[1]=="news"?(sector=getSectorForZone("Sector"),Zone=sector,Section=sector):directoryPath[1]=="blogs"?(Zone="blogs",getAuthorQueryString("author"),meta=$.map($('meta[name="author"]'),function(metaEl){return metaEl.content.split(",")}),Section=meta[0].replace(" ","")):directoryPath[1]=="personalities"?(Zone="personalities",Section=pUri.file.toLowerCase().replace(".aspx","").replace("-","")):directoryPath[1]=="special-coverage"?zone="specialcoverage":directoryPath[1]=="shows"&&directoryPath.length>3?Zone=directoryPath[3].replace("-",""):directoryPath[1]=="test2636176"?zone="hpto_test/":pUri.directory.length>0&&pUri.file.length>0?(directoryPath[1]=="shows"&&(Zone="shows/",Zone+=pUri.file.toLowerCase().replace(".aspx","").replace("-","").replace("-","")),pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="blogs"&&(Zone="blogs",Section=getAuthorQueryString("author")),(pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="aboutbnn"||pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="channelguide"||pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="community"||pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="contactus"||pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="faq"||pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="search"||pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="sitemap"||pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="subscribe")&&(Section=pUri.file.toLowerCase().replace(".aspx","").replace("-",""),Zone="default"),(pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="bnnmobile"||pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="mobiletv"||pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="home")&&(Section=pUri.file.toLowerCase().replace(".aspx","").replace("-",""),Zone="home"),(pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="markets"||pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="stock"||pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="commentingrules-and-regulations")&&(Section=pUri.file.toLowerCase().replace(".aspx","").replace("-",""),Zone="markets"),(pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="schedule"||pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="weeklyschedule")&&(Section=pUri.file.toLowerCase().replace(".aspx","").replace("-",""),Zone="schedule")):(Zone="home",Section="home")}if(Size=size,Path="",typeof path!="undefined"&&path!==null&&(Path=Trim(path),Path=Path.toLowerCase()),Path==""&&(Path="index"),Site="",typeof site!==undefined&&site!==null&&(Site=Trim(site),Site=Site.toLowerCase()),istCode="",this.ShouldDisplayInterstitials==!0&&CtvAd.__NumberOfAdsDisplayed==0&&(istCode="dcopt=ist;"),renderTile="",tile>0&&(renderTile="tile="+tile+";"),site="",Site&&(site=Site+"/"),zone="",Zone&&(zone=Zone,path!=""&&(zone=zone+"/")),adPage="",this.AdPage&&(adPage="adpg="+this.AdPage+";"),subPath="",this.SubPath&&(subPath=";subpath="+this.SubPath),pageId="",PageId&&(pageId=";pageid="+PageId),section="",Section&&(section=";section="+Section),subSection="",this.SubSection&&(subSection=";subsection="+this.SubSection),contentSection="",this.ContentSection&&(contentSection=";contentsection="+this.ContentSection),envr="",Environment&&(envr=";envr="+Environment),keywords="",Keywords.length>0)for(i=0;i<Keywords.length;i++)keywords=keywords+";keyword"+i+"="+Keywords[i];adCode='<script language="JavaScript" src="http://ad.doubleclick.net/N5479/adj/'+site+zone+Path+pageId+envr+section+subSection+contentSection+";"+istCode+renderTile+adPage+"sz="+Size+subPath+keywords+";coad=;ord="+CtvAd.__OrdinalString+'" type="text/javascript"><\/script>',document.write(adCode)},CustomAdModule.SetSection=function(section){typeof section!="undefined"&&section!==null&&(Section=Trim(section),Section=Section.toLowerCase())},parseUri.options={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}}}(BNN.CustomAdModule);
function Accordion(jId){var self=this;this.id=jId,this.accordion,this.accordionItems,this.accordionItemsText,this.minImage,this.maxImage,this.Init=function(){this.accordion=$(jId),this.accordionItems=this.accordion.find(".Item").each(function(){$(this).css("visibility","hidden")}),this.accordionItemsText=this.accordion.find(".Item .Text"),this.minImage=Agility.ResolveUrl("~/Images/Buttons/Arrow-Down.png"),this.maxImage=Agility.ResolveUrl("~/Images/Buttons/Arrow-Right.png"),this.accordionItems.each(function(){var title=$.trim($(this).find(".Title").text());$(this).attr("name",TitleToFriendlyUrl(title))}),this.accordion.find("img.AccordionToggle").css("cursor","pointer").attr("src",self.maxImage).bind("click",function(){var img=$(this),isOpen=img.attr("src").indexOf("Down")>-1,text=$(".Text",img.parent().parent()),title=$(".Title",text.parent());return isOpen?(img.attr("src",self.maxImage),text.length>0&&(text.slideUp(),title.removeClass("TitleOpen"))):(self.Collapse(),img.attr("src",self.minImage),text.length>0&&text.slideDown("normal",function(){title.addClass("TitleOpen")})),!1}),this.Show()},this.Collapse=function(){this.accordionItemsText.length<=0||this.accordionItemsText.each(function(){$(this).is(":visible")&&($(this).slideUp(),$("img",$(this).parent().parent()).attr("src",self.maxImage))})},this.Show=function(){this.accordionItems.css("visibility","visible")},this.Stripe=function(cssClass){this.accordion.each(function(){$(".Item:odd",$(this)).addClass(cssClass)})},this.OnSelected=function(fn){this.accordionItems.each(function(){$(this).find(".AccordionToggle").eq(0).bind("click",{item:$(this)},fn)})},this.EnableClickByTitle=function(){this.accordion.find(".Item .Title").css("cursor","pointer").bind("click",function(){var img=$(this).parent().find(".Toggle img"),isOpen=img.attr("src").indexOf("Down")>-1,text=$(".Text",$(this).parent()),title=$(".Title",text.parent());isOpen?(img.attr("src",self.maxImage),text.length>0&&text.slideUp(),title.removeClass("TitleOpen")):(self.Collapse(),img.attr("src",self.minImage),title.addClass("TitleOpen"),text.length>0&&text.slideDown("normal"))})},this.OpenItemUsingFriendlyTitle=function(friendlyTitle){this.accordion.find(".Item .Title").each(function(){var url=TitleToFriendlyUrl($.trim($(this).text())),itemBox;url==friendlyTitle&&(itemBox=$(this).parent(),itemBox.find(".Toggle img").attr("src",self.minImage),itemBox.find(".Text").slideDown())})},this.SetHash=function(text){window.location.hash=text==undefined||text==null||text==""?"#":"#"+TitleToFriendlyUrl($.trim(text))},this.Init()}function TitleToFriendlyUrl(title){return title.replace(/ /gi,"-").replace(/[^a-z0-9-]/gi,"").replace(/-+/g,"-")}
Agility.RegisterNamespace("BNN.Modules.AuthorsBlogRoll"),function(BlogRoll){function getDate(dateStr){return new Date(parseInt(dateStr.substr(6)))}var _properties=null,_container=null,_numToShow=4,_currentItem=0,_data=[],_scrollSettings={duration:1e3};BlogRoll.OnInit=function(p){_properties=p,_container=$("#"+_properties.ContainerID),_numToShow=3,$.ajax({url:AjaxWebserviceSvcUrl+"/GetBlogPostsByAuthor?authorID="+_properties.AuthorID+"&count="+_properties.NumItemsToShow+"&currentPost="+p.CurrentBlogPost+"",contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var result={d:jsonResponse},target;if(result.d!=undefined&&result.d!=null){_data=result.d,_numToShow=Math.min(_numToShow,_data.length);var jtContainer=$("#BlogsContainer",_container),templateUrl=Agility.ResolveUrl("~/ClientTemplates/AuthorsBlogRoll.htm"),height=_numToShow*72-2;jtContainer.css("height",height+"px"),jtContainer.css("max-height",height+"px"),jtContainer.setTemplateURL(templateUrl),jtContainer.processTemplate(_data),$(".ScrollUp",_container).bind("click",BNN.Modules.AuthorsBlogRoll.ScrollUp),$(".ScrollDown",_container).bind("click",BNN.Modules.AuthorsBlogRoll.ScrollDown),_currentItem=0,target=$("#BlogPost"+_currentItem),$("#BlogsContainer").scrollTo(target,_scrollSettings)}},complete:function(){}})},BlogRoll.ScrollUp=function(){if(_currentItem>0){_currentItem=_currentItem-1;var target=$("#BlogPost"+_currentItem);$("#BlogsContainer",_container).scrollTo(target,_scrollSettings)}},BlogRoll.ScrollDown=function(){if(_currentItem<_data.length-_numToShow){_currentItem=_currentItem+1;var target=$("#BlogPost"+_currentItem);$("#BlogsContainer",_container).scrollTo(target,_scrollSettings)}},BlogRoll.GetDate=function(dateStr){var date=getDate(dateStr);return dateFormat(date,"mmmm d, yyyy")},BlogRoll.GetBlogEntryUrl=function(entry){var date=getDate(entry.Date);return Agility.ResolveUrl("~/Blogs/"+dateFormat(date,"yyyy/mm/d/")+entry.FriendlyName.URL+".aspx")}}(BNN.Modules.AuthorsBlogRoll);
Agility.RegisterNamespace("BNN.Modules.BlogArchive"),function(BlogArchive){function renderYearFilter(){if(properties.YearItems!=null&&properties.YearItems.length!=0){var filter=$("#"+properties.YearFilterID);yearDropdown=filter.WSelectBox({DefaultText:properties.SelectDefaultText,KeyFieldName:"Text",ValueFieldName:"Value",Items:properties.YearItems,SelectedValue:parseInt(properties.SelectDefaultText),SelectImage:properties.SelectBoxArrowSrc,Horizontal:!0,onSelectedChange:function(selValue){if(yearSelected=0,selValue>0)for(var i=0;i<properties.YearItems.length;i++)if(parseInt(properties.YearItems[i].Value)==selValue){yearSelected=selValue;break}yearSelected==0&&(yearSelected=(new Date).getFullYear()),populateMonths(yearSelected)}})}}function populateMonths(selYr){var months=["January","February","March","April","May","June","July","August","September","October","November","December"];$.ajax({url:AjaxWebserviceSvcUrl+"/GetRelevantBlogMonthsByYear?year="+selYr,contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var res={d:jsonResponse},html,totalItems,i,url,text;if(res.d!=undefined&&res.d!=null){for(html="",totalItems=res.d.length,i=0;i<6;i++)i<totalItems&&(url=Agility.ResolveUrl("~/Blogs/"+selYr+"/"+res.d[i]),text=months[res.d[i]-1]+" "+selYr,html+='<a href="'+url+'" class="Odd">'+text+"</a>"),i+6<totalItems&&(url=Agility.ResolveUrl("~/Blogs/"+selYr+"/"+res.d[i+6]),text=months[res.d[i+6]-1]+" "+selYr,html+='<a href="'+url+'">'+text+"</a>"),html+='<div class="Clear"></div>';$(".Months").html(html),$(".Months a").show()}}})}var properties=null,container=null,yearDropdown=null,yearSelected=0;BlogArchive.OnInit=function(p){properties=p,container=$("#"+properties.ContainerID),renderYearFilter()}}(BNN.Modules.BlogArchive);
Agility.RegisterNamespace("BNN.Modules.BlogAuthors"),function(BlogAuthors){var _properties=null,_container=null,_numToShow=4,_currentItem=0,_data=[],_scrollSettings={duration:1e3};BlogAuthors.OnInit=function(p){_properties=p,_container=$("#"+_properties.ContainerID),_numToShow=_properties.NumItemsToShow,$.ajax({url:AjaxWebserviceSvcUrl+"/GetBlogAuthors",contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var result={d:jsonResponse},target;if(result.d!=undefined&&result.d!=null){_data=result.d;var jtContainer=$("#AuthorsContainer",_container),templateUrl=Agility.ResolveUrl("~/ClientTemplates/BlogAuthors.htm"),height=_numToShow*75-6;jtContainer.css("height",height+"px"),jtContainer.css("max-height",height+"px"),jtContainer.setTemplateURL(templateUrl),jtContainer.processTemplate(_data),$(".ScrollUp",_container).bind("click",BNN.Modules.BlogAuthors.ScrollUp),$(".ScrollDown",_container).bind("click",BNN.Modules.BlogAuthors.ScrollDown),_currentItem=0,target=$("#Author"+_currentItem),$("#AuthorsContainer").scrollTo(target,_scrollSettings)}},complete:function(){}})},BlogAuthors.ScrollUp=function(){if(_currentItem>0){_currentItem=_currentItem-1;var target=$("#Author"+_currentItem);$("#AuthorsContainer",_container).scrollTo(target,_scrollSettings)}},BlogAuthors.ScrollDown=function(){if(_currentItem<_data.length-_numToShow){_currentItem=_currentItem+1;var target=$("#Author"+_currentItem);$("#AuthorsContainer",_container).scrollTo(target,_scrollSettings)}},BlogAuthors.GetUrl=function(p){return Agility.ResolveUrl("~/Blogs.aspx?author="+p)}}(BNN.Modules.BlogAuthors);
Agility.RegisterNamespace("BNN.Modules.BlogsListing"),function(BlogsListing){function getDate(dateStr){return eval("new "+dateStr.replace(/\//gi,""))}function cancelTimer(){closetimer&&(window.clearTimeout(closetimer),closetimer=null)}var properties=null,container=null,timeout=500,closetimer=0,menuItem=null;BlogsListing.OnInit=function(p){properties=p,container=$("#"+properties.ContainerID),$(".MenuAuthors .Content ul",container).each(function(){$("li:last",$(this)).css("margin-bottom","0px")}),$(".MenuSectors .Content a:last",container).css("border-bottom","none"),BlogsListing.OnMenuInit()},BlogsListing.LoadPosts=function(){var pageNum=BNN.Controls.Pager.CurrentPage;$.ajax({url:AjaxWebserviceSvcUrl+"/GetBlogPosts?pageNum="+pageNum+"&pageSize="+properties.PostsPerPage+"&year=0&month=0&day=1&category="+properties.Sector+"&author="+properties.Author,contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var res={d:jsonResponse},$container,settings;res.d!=undefined&&res.d!=null&&($container=container.find(".Posts").eq(0),$container.html(""),$container.hasTemplate()||(settings={f_escapeString:function(string){return string}},$container.setTemplateURL(Agility.ResolveUrl("~/ClientTemplates/BlogsListing.htm"),null,settings),$container.setParam("ContinueReadingLabel",properties.ContinueReadingLabel)),$container.processTemplate(res),BNN.Controls.Pager.Render(properties.TotalCount))}})},BlogsListing.OnMenuInit=function(){var config={over:BNN.Modules.BlogsListing.OnMenuOpen,out:BNN.Modules.BlogsListing.OnMenuTimer,timeout:10},lis;$(".ViewBy > a",container).each(function(){var subMenuID=$(this).attr("menuclass");$(this).append($("."+subMenuID,container))}),lis=$(".ViewBy > a",container),lis.hoverIntent(config)},BlogsListing.OnMenuOpen=function(){cancelTimer(),BNN.Modules.BlogsListing.OnMenuClose();var subMenu=$(this).attr("menuclass");$("."+subMenu,container).show()},BlogsListing.OnMenuClose=function(){$(".SubMenu",container).hide()},BlogsListing.OnMenuTimer=function(){closetimer=window.setTimeout("BNN.Modules.BlogsListing.OnMenuClose()",timeout)},BlogsListing.GetImageUrl=function(post){var img="",authorImageUrl;return post.Author!=null?(post.Author.BlogListingImage.URL!=null&&post.Author.BlogListingImage.URL!=""&&(authorImageUrl=post.Author.BlogListingImage.URL),img=post.Image==null||post.Image.URL==""||post.Image.URL==null?authorImageUrl:post.Image.URL):post.BylineImage.URL!=""&&(img=post.BylineImage.URL),img!=""?Agility.ResolveUrl("~/Handlers/ThumbS3.ashx")+"?img="+img+",180,101":""},BlogsListing.GetAuthorSection=function(post){return post.Author!=null?"By <a href='"+Agility.ResolveUrl(post.Author.PageURL)+"' class='Name'>"+post.Author.Title+"</a>"+(typeof post.Author.Type!="undefined"&&post.Author.Type!=""?", "+post.Author.Type:""):post.Byline!=null?post.Byline:""},BlogsListing.GetTeaser=function(teaser,index){if(teaser!=null&&teaser!=""){var length=index==0?properties.PostCharacterCount*2:properties.PostCharacterCount;return length=Math.min(length,teaser.length),teaser.substr(0,length)+"..."}return""},BlogsListing.GetDateTimeSection=function(post){var st="",links,i,cat,link;if(post.Categories.length>0){for(st+="Filed in: ",links=[],i=0;i<post.Categories.length;i++)cat=post.Categories[i],link='<a href="'+Agility.ResolveUrl("~/Blogs.aspx")+"?sector="+cat.FriendlyName.URL+'">'+cat.Title+"</a>",links.push(link);st+=links.join(", ")}return st},BlogsListing.GetDate=function(dateStr){var date=getDate(dateStr);return dateFormat(date,"mmm d yyyy")},BlogsListing.InitBlogRoll=function(p){$.ajax({url:AjaxWebserviceSvcUrl+"/GetBlogRoll",contentType:"application/json",dataType:"json",success:function(jsonResponse){var html,client;jsonResponse!=undefined&&jsonResponse!=null&&(html="",$.each(jsonResponse,function(i,roll){html+="<div class='Post "+(i==0?"FirstPost":"")+"'><div class='Thumbnail'>",html+="<a href='"+roll.AuthorUrl+"'><img src='"+roll.AuthorImageUrl+"' alt='' /></a></div>",html+="<div class='Headline'><a href='"+roll.PostUrl+"'>"+roll.Headline+"</a></div>",html+="<div class='Details'>"+roll.PostDetails+"</div></div>"}),client=$("#"+p.ClientID),client.find("div.Posts").html(html+"<div class='Clear'></div>"))}})}}(BNN.Modules.BlogsListing);
Agility.RegisterNamespace("BNN.Modules.CommoditiesMonitor"),function(CommoditiesMonitor){CommoditiesMonitor.Load=function(indices){for(var data=[],processed=0,i=0;i<indices.length;i++)$.getJSON(MarketDataServiceUrl+"/GetStockQuote?symbol="+indices[i].Symbol+"",function(result){var container;if(result!=undefined){var ticker=result.Ticker,change=result.NetChange,price=result.Last,cssClass=_getCssClass(change),order=_getOrderFromIndices(indices,ticker),name=order<99?indices[order].Name:result.CompanyName;change=_formatCurrency(_keepTwoDecimals(change)),price=_addCommas(_keepTwoDecimals(price)),price=price!=""?"$ "+price:price,data.push({Order:order,Name:name,Change:change,Last:price,CssClass:cssClass})}processed++,processed>=indices.length-1&&(data.sort(function(a,b){return a.Order<b.Order?-1:1}),templateUrl=Agility.ResolveUrl("~/ClientTemplates/CommoditiesMonitor.htm"),container=$("#Commodities"),container.setTemplateURL(templateUrl),container.processTemplate(data))})},_getOrderFromIndices=function(indices,ticker){for(var i=0;i<indices.length;i++)if(indices[i].Symbol==ticker||indices[i].Symbol==ticker+"-FT")return i},_getCssClass=function(val){var positive=val!=null&&val!=""&&val.indexOf("-")!=0;return val=="0"||val==""?"Neutral":positive?"Positive":"Negative"},_addCommas=function(val){for(var regEx=/(\d+)(\d{3})/;regEx.test(val);)val=val.replace(regEx,"$1,$2");return val},_keepTwoDecimals=function(val){var tmpFloat=Math.round(100*parseFloat(val))/100;return tmpFloat.toString()},_formatCurrency=function(data){if(data==null)return"";var tmp=data;return tmp.indexOf("-")==0&&(tmp=tmp.substring(1)),tmp.indexOf(".")==0&&(tmp="0"+tmp),tmp},_getOrderFromTSXSector=function(tsxsectors,ticker){for(var i=0;i<tsxsectors.length;i++)if(tsxsectors[i].Symbol==ticker)return i;return 99},_getSymbolFromCurrencyList=function(currencyList,ticker){for(var currency,i=0;i<currencyList.length;i++)if(currency=currencyList[i].split("|"),currency!=undefined&&currency.length==2&&currency[0]==ticker)return currency[1]},_getOrderFromCurrencyList=function(currencyList,ticker){for(var currency,i=0;i<currencyList.length;i++)if(currency=currencyList[i].split("|"),currency!=undefined&&currency.length>0&&currency[0]==ticker)return i}}(BNN.Modules.CommoditiesMonitor);
Agility.RegisterNamespace("BNN.Modules.ContactUs"),function(ContactUs){function configureLayout(){$name.watermark($name.next().text()),$email.watermark($email.next().text())}function bindEvents(){$("#btnReset",container).bind("click",function(){resetFields()})}function sendEmail(){var $form=$("form",container),data,queryString;$form.valid()&&show_fun==$bnn_do_show.val()&&($url.val()==""||$url.val()=="2510")&&(data="{'contentReferenceName':'"+properties.ContactReferenceName+"', 'name':'"+$name.val()+"', 'email':'"+$email.val()+"', 'province':'"+$province.find("option:selected").text()+"', 'topic': '"+$topic.find("option:selected").text()+"', 'message': '"+escape($question.val())+"'}",queryString="?contentReferenceName="+properties.ContactReferenceName+"&name="+$name.val()+"&email="+$email.val()+"&province="+$province.find("option:selected").text()+"&topic="+$topic.find("option:selected").text()+"&message="+escape($question.val()),$.ajax({url:AjaxWebserviceSvcUrl+"/SendContactEmail"+queryString,contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var result={d:jsonResponse};result.d!=undefined&&result.d!=null&&($(".InputForm",container).hide(),result.d?$(".ThankYou",container).show():$(".ThankYou",container).text("Sorry we were unable to send your email. Please try again.").show())},complete:function(){}}))}function _buildContestInputForm(p){var html="";return html+="<div class='Description'>"+p.Description+"</div>",html+="<div class='ErrorSummary'><ul></ul></div>",html+="<input type='hidden' id='bnn_do_show' name='bnn_do_show' value='"+show_fun+"'>",html+="<div class='Label'><label for='txtName'>"+p.NameLabel+":</label></div>",html+="<div class='Field'>",html+="<input id='txtName' name='txtName' class='required' />",html+="<div class='Hidden'>"+p.NameWatermarkLabel+"</div>",html+="</div>",html+="<div class='Label'><label for='txtEmail'>"+p.EmailLabel+":</label></div>",html+="<div class='Field' style='margin-bottom:16px'>",html+="<input id='txtEmail' name='txtEmail' class='required email'  />",html+="<div class='Hidden'>"+p.EmailWatermarkLabel+"</div>",html+="</div>",html+="<table cellspacing='0' cellpadding='0'>",html+="<tr>",html+="<td valign='bottom' style='width:200px'><div class='Label'><label for='ddlProvinces'>"+p.ProvinceLabel+":</label></div></td>",html+="<td valign='bottom' style='width:350px'><div class='Label'><label for='ddlTopics'>"+p.TopicLabel+" :</label></div></td>",html+="</tr>",html+="<tr>",html+="<td valign='top'>",html+="<div class='Field'>",html+="<select id='ddlProvinces' name='ddlProvinces' class='required' style='width:59px'>"+p.Provinces+"</select>",html+="</div>",html+="</td>",html+="<td valign='top'>",html+="<div class='Field'>",html+="<select id='ddlTopics' name='ddlTopics' class='required' style='width:186px'>"+p.Topics+"</select>",html+="</div>",html+="</td>",html+="</tr>",html+="</table>",html+="<div class='Label'>",html+="<label for='txtQuestion'>"+p.QuestionLabel+":</label>",html+="</div>",html+="<div class='Field' style='margin-bottom:8px'>",html+="<textarea id='txtQuestion' name='txtQuestion' class='required' style='width:598px; height:175px'></textarea>",html+="</div>",html+="<div class='Field' style='visibility:hidden; display:none;'><label>*What is (25 x 25) - 15?</label><br/><input type='text' id='url' name='url'></div>",html+="<div class='Buttons'>",html+="<input id='btnSubmit' type='image' style='border-width: 0px; margin-right:12px' alt='Submit' src=' "+p.SubmitImageURL+"'>",html+="<img id='btnReset' class='Reset' src='"+p.ResetImageURL+"' alt='"+p.ResetImageLabel+"' />",html+="</div>",html+="<div class='ErrorMessages'>",html+="<div class='ErrName'>"+p.NameError+"</div>",html+="<div class='ErrEmail'>"+p.EmailError+"</div>",html+="<div class='InvalidEmail'>"+p.InvalidEmailError+"</div>",html+="<div class='ErrProvince'>"+p.ProvinceError+"</div>",html+="<div class='ErrTopic'>"+p.TopicError+"</div>",html+="<div class='ErrQuestion'>"+p.QuestionError+"</div>",html+="</div>"}function resetFields(){$(".ErrorSummary",container).hide(),$name.val($name.next().text()).watermark(),$email.val($email.next().text()).watermark(),$province.val(-1),$topic.val(-1),$question.val("")}function _genRandString(){for(var chars="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",string_length=8,randomstring="",rnum,i=0;i<string_length;i++)rnum=Math.floor(Math.random()*chars.length),randomstring+=chars.substring(rnum,rnum+1);return randomstring}var properties=null,container=null,$name,$email,$province,$topic,$question,$bnn_do_show,$url,show_fun=_genRandString();ContactUs.OnInit=function(p){var FormContainer,errorMsgs,form;console.log(p),properties=p,FormContainer=$("#"+properties.FormContainerID),FormContainer.html(_buildContestInputForm(properties)),container=$("#"+properties.ContainerID),$name=$("#txtName",container),$email=$("#txtEmail",container),$province=$("#ddlProvinces",container),$topic=$("#ddlTopics",container),$question=$("#txtQuestion",container),$bnn_do_show=$("#bnn_do_show",container),$url=$("#url",container),bindEvents(),configureLayout(),errorMsgs=$(".ErrorMessages",container),form=$("form",container),form.validate({invalidHandler:function(e,validator){var errors=validator.numberOfInvalids();errors>0?$(".ErrorSummary",container).show():$(".ErrorSummary",container).hide()},submitHandler:function(){sendEmail()},messages:{txtName:$(".ErrName",errorMsgs).text(),txtEmail:{required:$(".ErrEmail",errorMsgs).text(),email:$(".InvalidEmail",errorMsgs).text()},ddlProvinces:$(".ErrProvince",errorMsgs).text(),ddlTopics:$(".ErrTopic",errorMsgs).text(),txtQuestion:$(".ErrQuestion",errorMsgs).text()},errorLabelContainer:".ErrorSummary ul",wrapper:"li"})}}(BNN.Modules.ContactUs);
Agility.RegisterNamespace("BNN.Modules.ShowContactUs"),function(ShowContactUs){function configureLayout(){$name.watermark($name.next().text()),$email.watermark($email.next().text()),$topic.watermark($topic.next().text()),$city.watermark($city.next().text())}function bindEvents(){$("#btnReset",container).bind("click",function(){resetFields()})}function sendEmail(){var $form=$("form",container),data,queryString;$form.valid()&&show_fun==$bnn_do_show.val()&&($url.val()==""||$url.val()=="20")&&(data="{'contentReferenceName':'"+properties.ContactReferenceName+"', 'name':'"+$name.val()+"', 'email':'"+$email.val()+"', 'province':'"+$province.find("option:selected").text()+"', 'city': '"+$city.val()+"', 'topic': '"+$topic.val()+"', 'message': '"+escape($question.val())+"'}",queryString="?contentReferenceName="+properties.ContactReferenceName+"&name="+$name.val()+"&email="+$email.val()+"&province="+$province.find("option:selected").text()+"&city="+$city.val()+"&topic="+$topic.val()+"&message="+escape($question.val()),$.ajax({url:AjaxWebserviceSvcUrl+"/SendShowContactEmail"+queryString,contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var result={d:jsonResponse};result.d!=undefined&&result.d!=null&&($(".InputForm",container).hide(),result.d?$(".ThankYou",container).show():$(".ThankYou",container).text("Sorry we were unable to send your email. Please try again.").show())},complete:function(){}}))}function resetFields(){$(".ErrorSummary",container).hide(),$name.val($name.next().text()).watermark(),$email.val($email.next().text()).watermark(),$province.val(-1),$city.val($city.next().text()).watermark(),$topic.val($topic.next().text()).watermark(),$question.val("")}function _buildContestInputForm(p){var html="";return html+="<div class='Description'>"+p.Description+"</div>",html+="<div class='ErrorSummary'><ul></ul></div>",html+="<div class='Field'>",html+="<input type='hidden' id='bnn_do_show' name='bnn_do_show' value='"+show_fun+"'>",html+="<div class='Label'><label for='inpShow_Name'>"+p.NameLabel+":</label></div>",html+="<input id='inpShow_Name' name='inpShow_Name' class='required'  />",html+="<div class='Hidden'>"+p.NameWatermark+"</div>",html+="</div>",html+="<div class='Field'>",html+="<div class='Label'><label for='inpShow_Email'>"+p.EmailLabel+":</label></div>",html+="<input id='inpShow_Email' name='inpShow_Email' class='required email'  />",html+="<div class='Hidden'>"+p.EmailWatermark+"</div>",html+="</div>",html+="<div class='Field' style='width:140px;' >",html+="<div class='Label'><label for='inpShow_Provinces'>"+p.ProvinceLabel+":</label></div>",html+="<select id='inpShow_Provinces' name='inpShow_Provinces' class='required' >"+p.Provinces+"</select>",html+="</div>",html+="<div class='Field' >",html+="<div class='Label'><label for='inpShow_City'>"+p.CityLabel+":</label></div>",html+="<input id='inpShow_City' name='inpShow_City' class='required' />",html+="<div class='Hidden'>"+p.CityWatermark+"</div>",html+="</div>",html+="<div class='Field' >",html+="<div class='Label'><label for='inpShow_Subject'>"+p.TopicLabel+":</label></div>",html+="<input id='inpShow_Subject' name='inpShow_Subject' class='required' />",html+="<div class='Hidden'>"+p.TopicWatermark+"</div>",html+="</div>",html+="<div class='FieldTexArea'>",html+="<div class='Label'>",html+="<label for='inpShow_Question'>"+p.QuestionLabel+":</label>",html+="</div>",html+="<textarea id='inpShow_Question' name='inpShow_Question' class='required' style='width:598px; height:175px'></textarea>",html+="</div>",html+="<div class='Field' style='visibility:hidden; display:none;'><label>*What is (5 x 5) - 5?</label><br/><input type='text' id='url' name='url'></div>",html+="<div class='Buttons'>",html+="<input id='btnSubmit' type='image' style='border-width: 0px; margin-right:12px' alt='Submit' src='"+p.SubmitImageURL+"'>",html+="<img id='btnReset' class='Reset' src='"+p.ResetImageURL+"' alt='"+p.ResetImageLabel+"' />",html+="</div>",html+="<div class='ErrorMessages'>",html+="<div class='ErrName'>"+p.NameError+"</div>",html+="<div class='ErrEmail'>"+p.EmailError+"</div>",html+="<div class='InvalidEmail'>"+p.EmailInvalidError+"</div>",html+="<div class='ErrProvince'>"+p.ProvinceError+"</div>",html+="<div class='ErrCity'>"+p.CityError+"</div>",html+="<div class='ErrTopic'>"+p.TopicError+"</div>",html+="<div class='ErrQuestion'>"+p.QuestionError+"</div>",html+="</div>"}function _showfunString(){for(var chars="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",string_length=8,randomstring="",rnum,i=0;i<string_length;i++)rnum=Math.floor(Math.random()*chars.length),randomstring+=chars.substring(rnum,rnum+1);return randomstring}var properties=null,container=null,$name,$email,$province,$topic,$question,$bnn_do_show,$url,show_fun=_showfunString();ShowContactUs.OnInit=function(p){var FormContainer,errorMsgs,form;properties=p,FormContainer=$("#"+properties.FormContainerID),FormContainer.html(_buildContestInputForm(properties)),container=$("#"+properties.ContainerID),$name=$("#inpShow_Name",container),$email=$("#inpShow_Email",container),$province=$("#inpShow_Provinces",container),$topic=$("#inpShow_Subject",container),$city=$("#inpShow_City",container),$question=$("#inpShow_Question",container),$bnn_do_show=$("#bnn_do_show",container),$url=$("#url",container),bindEvents(),configureLayout(),errorMsgs=$(".ErrorMessages",container),form=$("form",container),form.validate({invalidHandler:function(e,validator){var errors=validator.numberOfInvalids();errors>0?$(".ErrorSummary",container).show():$(".ErrorSummary",container).hide()},submitHandler:function(){sendEmail()},messages:{inpShow_Name:$(".ErrName",errorMsgs).text(),inpShow_Email:{required:$(".ErrEmail",errorMsgs).text(),email:$(".InvalidEmail",errorMsgs).text()},inpShow_Provinces:$(".ErrProvince",errorMsgs).text(),inpShow_City:$(".ErrCity",errorMsgs).text(),inpShow_Subject:$(".ErrTopic",errorMsgs).text(),inpShow_Question:$(".ErrQuestion",errorMsgs).text()},errorLabelContainer:".ErrorSummary ul",wrapper:"li"})}}(BNN.Modules.ShowContactUs);
Agility.RegisterNamespace("BNN.Modules.CurrenciesData"),function(CurrenciesData){CurrenciesData.Load=function(target,currencyList,exclude){for(var data=[],processed=0,currency,i=0;i<currencyList.length;i++)currency=currencyList[i].split("|"),currency[0]!=exclude&&$.getJSON(MarketDataServiceUrl+"/GetStockQuote?symbol="+exclude+"/"+currency[0]+"-I",function(result){if(result!=undefined&&result.Ticker!=null){var newDisplay=result.CompanyName,ticker=result.Ticker,change=result.NetChange,price=result.Last,positive=change!=null&&change!=""&&change.indexOf("-")!=0,cssClass=change=="0"||change==""?"Neutral":positive?"Positive":"Negative",order=i,alt=order==0||order==1||order%2==1?"":"Alt",displayedTicker=result.Currency=="CAD"?"$Cdn":result.Currency=="USD"?"$US":result.Currency=="JPY"?"Yen":result.Currency=="EUR"?"Euro":result.Currency,displayedSymbol=result.Currency=="CAD"?"$":result.Currency=="USD"?"$":result.Currency=="JPY"?"¥":result.Currency=="EUR"?"€":result.Currency;change=_formatCurrency(change),formattedPrice=_formatCurrency(price),price=displayedSymbol+" "+formattedPrice,data.push({Order:order,RowCssClass:alt,Name:displayedTicker,ChangeCssClass:cssClass,NetChange:change,Price:price})}processed++,processed>=currencyList.length-1&&(data.sort(function(a,b){return a.Order<b.Order?-1:1}),_processCurrencyTemplate(target,data))})},_processCurrencyTemplate=function(target,data){var container=$("#"+target),templateUrl=Agility.ResolveUrl("~/ClientTemplates/CurrenciesData.htm");container.setTemplateURL(templateUrl),container.processTemplate(data)},_formatCurrency=function(data){var tmp=data;return tmp.indexOf("-")==0&&(tmp=tmp.substring(1)),tmp.indexOf(".")==0&&(tmp="0"+tmp),tmp},_getSymbolFromCurrencyList=function(currencyList,ticker){for(var currency,i=0;i<currencyList.length;i++)if(currency=currencyList[i].split("|"),currency!=undefined&&currency.length==2&&currency[0]==ticker)return currency[1]},_getOrderFromCurrencyList=function(currencyList,ticker){for(var currency,i=0;i<currencyList.length;i++)if(currency=currencyList[i].split("|"),currency!=undefined&&currency.length>0&&currency[0]==ticker)return i}}(BNN.Modules.CurrenciesData);
Agility.RegisterNamespace("BNN.LatestAndPopularNews"),function(LatestAndPopularNews){var properties=null;LatestAndPopularNews.OnInit=function(p){properties=p;var latestNews=$("#LatestAndPopularNews .LatestNews"),latestData="?itemCount="+properties.NumToShow+"&currentStoryID="+properties.CurrentStoryID,popularNews=$("#LatestAndPopularNews .PopularNews"),popularData="?itemCount="+properties.NumToShow+"&popularAge="+p.PopularAge},_populateNewsTemplate=function(container,method,data){$.ajax({url:AjaxWebserviceSvcUrl+"/"+method+data,contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var result={d:jsonResponse},templateUrl;result.d!=undefined&&result.d!=null&&(templateUrl=Agility.ResolveUrl("~/ClientTemplates/LatestAndPopularNews.htm"),container.setTemplateURL(templateUrl),container.setParam("ExpandStoryLabel",properties.ExpandStoryHoverLabel),container.setParam("FullStoryLabel",properties.FullStoryLabel),container.processTemplate(result.d))},complete:function(){}})},LatestAndPopularNews.ShowLatest=function(){$("#LatestAndPopularNews .PopularNews").hide(),$("#LatestAndPopularNews .LatestNews").show(),$("#LatestNewsTab").addClass("Selected"),$("#PopularNewsTab").removeClass("Selected")},LatestAndPopularNews.ShowPopular=function(){$("#LatestAndPopularNews .LatestNews").hide(),$("#LatestAndPopularNews .PopularNews").show(),$("#PopularNewsTab").addClass("Selected"),$("#LatestNewsTab").removeClass("Selected")},LatestAndPopularNews.ToHTML=function(text){var $div=$("<div></div>").html(text);return $div.text()},LatestAndPopularNews.displayIcon=function(video){if(video!=null)return"&nbsp;<img src=/Images/Icons/icn_video.png  />"}}(BNN.LatestAndPopularNews);
Agility.RegisterNamespace("BNN.LatestAndPopularVideos"),function(LatestAndPopularVideos){function outputLog(str){try{console.log("[ ETS ]="+str)}catch(e){}}var _scrollSettings={duration:1e3},_itemsToScroll=3,_mode=1,clipId,width,height,v_arr=[],arrayCopy=[],zone="",globalPlayerObjListLength,mc,containerLimit;LatestAndPopularVideos.OnInit=function(latestVideos,popularVideos,mainContainer,limit){var latestButton,popularButton,dynFlashVars;if(containerLimit=limit,(width==undefined||width==null)&&(width=300),(height==undefined||height==null)&&(height=168),mc=mainContainer,$.each(latestVideos,function(i,l){var vitem={id:l.Id,title:l.Title,image:l.ThumbnailUrl.substr(l.ThumbnailUrl.indexOf("=")+1,l.ThumbnailUrl.indexOf(",")-27)};v_arr.push(vitem)}),latestVideos.length==0&&popularVideos.length==0){$("#"+mainContainer).hide();return}if($("#"+mainContainer+" .Main .Nav .Up").bind("click",function(){var currentPosition=parseInt($("#"+mainContainer).attr("currentPosition")),target=currentPosition-_itemsToScroll;target=Math.max(target,0),target!=currentPosition&&($("#"+mainContainer+" .Main .MoreVideos").scrollTo($("#"+mainContainer+" .Main .MoreVideos .MoreVideos"+target),_scrollSettings),$("#"+mainContainer).attr("currentPosition",target))}),$("#"+mainContainer+" .Main .Nav .Down").bind("click",function(){var currentPosition=parseInt($("#"+mainContainer).attr("currentPosition")),target=currentPosition+_itemsToScroll;target=Math.min(target,latestVideos.length-1),target!=currentPosition&&($("#"+mainContainer+" .Main .MoreVideos").scrollTo($("#"+mainContainer+" .Main .MoreVideos .MoreVideos"+target),_scrollSettings),$("#"+mainContainer).attr("currentPosition",target))}),latestButton=$("#"+mainContainer+" .Main .FilterControls .Latest"),popularButton=$("#"+mainContainer+" .Main .FilterControls .Popular"),latestButton.bind("click",function(){latestButton.addClass("Selected"),popularButton.removeClass("Selected"),_updateContainerContent(latestVideos,mainContainer)}),popularButton.bind("click",function(){popularButton.addClass("Selected"),latestButton.removeClass("Selected"),_updateContainerContent(popularVideos,mainContainer)}),latestVideos.length>0){dynFlashVars="lv_mpFlashVars_"+mc,eval("var "+dynFlashVars+";"),dynFlashVars={},dynFlashVars.vid=latestVideos[0].id,dynFlashVars.autoplay=0,dynFlashVars.zone=BNN.AdModule.GetPreRollZone("");var Environment="",pUri=BNN.AdModule.parseUri(window.location),domain=pUri.authority.toLowerCase();Environment=domain=="bnn.local"||domain=="stage-origin.bnn.ca"?"dev":"prod",dynFlashVars.dartkey="envr="+Environment+";",dynFlashVars.fscontrolx=0,dynFlashVars.fscontroly=280,globalMainApp.push(etsapi.embedPlayer("lv_vplayer"+mc,"lv_mediaplayerdiv_"+mc,width,height,"bnn","300x168/",{flashVars:dynFlashVars})),globalMainAppLength=globalMainApp.length,globalMainApp[globalMainApp.length-1].registerEvent(MediaPlayerControllerEvent.PLAYER_READY,this,LatestAndPopularVideos.onPlayerReady),globalMainApp[globalMainApp.length-1].registerEvent(MediaPlayerControllerEvent.VIDEO_STARTED,this,LatestAndPopularVideos.onVideoStart),globalMainApp[globalMainAppLength-1].registerEvent(MediaPlayerControllerEvent.VIDEO_COAD,this,LatestAndPopularVideos.onVideoCoAd),$("#"+mainContainer+" .VideoTitle").html(latestVideos[0].Title),$("#"+mainContainer+" .VideoTitle").attr("title",latestVideos[0].Title)}popularVideos.length==0&&(popularButton.hide(),popularButton.next().hide()),latestButton.addClass("Selected"),_updateContainerContent(latestVideos,mainContainer)},_updateContainerContent=function(content,mainContainer){var templateUrl=Agility.ResolveUrl("~/ClientTemplates/MoreVideos.htm"),container=$("#"+mainContainer+" .Main .MoreVideos .Scroll");container.html(""),container.setTemplateURL(templateUrl),container.setParam("MainContainer",mainContainer),container.processTemplate(content),$("#"+mainContainer+" .Main .MoreVideos").scrollTo($("#"+mainContainer+" .Main .MoreVideos .MoreVideos0"),_scrollSettings),$("#"+mainContainer).attr("currentPosition","0")},LatestAndPopularVideos.onVideoStart=function(infoObj){outputLog("onVideoStart");var container=infoObj.objectID.substring(10);$("#"+container+" .VideoTitle").html(infoObj.title),$("#"+container+" .VideoTitle").attr("title",infoObj.title)},LatestAndPopularVideos.onPlayerReady=function(infoObj){outputLog("__NewAdRuleInPlace____"),outputLog("onPlayerReady"),LatestAndPopularVideos.setlist(infoObj.objectID)},LatestAndPopularVideos.PlayElement=function(element,mainContainer){for(var i=0;i<globalMainApp.length;i++)globalMainApp[i]._playerID=="lv_vplayer"+mainContainer&&globalMainApp[i].playMediaAt(element)},LatestAndPopularVideos.setlist=function(num){var infoObj_1,len,i,xarray,x,infoObj_2;for(outputLog("setPlaylist: "),infoObj_1={},infoObj_1.type="array",infoObj_1.autoplay=0,infoObj_1.playlist=[],infoObj_1.playlist=v_arr,len=globalMainApp.length,i=0;i<len;i++)if(globalMainApp[i]._playerID==num)if(i>=1){for(xarray=[],x=containerLimit*i;x<v_arr.length;x++)xarray.push(v_arr[x]);infoObj_2={},infoObj_2.type="array",infoObj_2.autoplay=0,infoObj_2.playlist=[],infoObj_2.playlist=xarray,globalMainApp[i].setPlaylist(infoObj_2)}else globalMainApp[i].setPlaylist(infoObj_1)},LatestAndPopularVideos.onVideoCoAd=function(infoObj){var contentDiv,i;if(outputLog("inside coad handler"),contentDiv="",infoObj.ads!=undefined)for(i=0;i<infoObj.ads.length;i++)contentDiv=infoObj.ads[i].content,infoObj.dartTemplate=="js"&&contentDiv!=""?contentDiv='<script language="JavaScript" src="'+infoObj.ads[i].content+'"   type="text/javascript"><\/script>':infoObj.dartTemplate=="vast"&&contentDiv!=""?(outputLog("vast coad is: "+infoObj.ads[i].content),contentDiv=infoObj.ads[i].content):outputLog("no js no vast"+infoObj.dartTemplate),outputLog(infoObj.dartTemplate+" contentDiv is "+contentDiv),LatestAndPopularVideos.writeIntoCompanionDiv(contentDiv,infoObj.ads[i].size)},LatestAndPopularVideos.writeIntoCompanionDiv=function(content,size){content!=""&&(outputLog(content),$("#AdModule_"+size).writeCapture().html(content))}}(BNN.LatestAndPopularVideos);
Agility.RegisterNamespace("BNN.Modules.MarketMonitorSmall"),function(MarketMonitorSmall){var marketLabels=["TSX","DJIA","S&P 500","Nasdaq"],marketNames=["S&P/TSX","Dow Jones","S&P 500","NASDAQ"],marketSymbols=["TSX-I","DJIA","SPX-I","COMP-I"],searchDefault="",_isOverStockSearchMenu=!1;MarketMonitorSmall.OnInit=function(sd){var marketData,processed,i,searchBox,stockSearchMenu;for($("#MarketMonitorSmall .Main .Indexes div").bind("click",function(){$("#MarketMonitorSmall .Main .Indexes div").each(function(){$(this).removeClass("Selected")}),$(this).addClass("Selected");var symbol=_getMarketSymbolFromMarketSmallLabel($(this).text());_populateMarketSmallChart($(this),symbol),searchDefault=sd}),_populateMarketSmallChart($("#MarketMonitorSmall .Main .Indexes div:first-child"),marketSymbols[0]),marketData=[],processed=0,i=0;i<marketSymbols.length;i++)$.getJSON(MarketDataServiceUrl+"/GetStockQuote?symbol="+marketSymbols[i]+"",function(result){if(result!=undefined&&result.Ticker!=null){var change=result.NetChange;change=change.indexOf("-")==0?change.substring(1):change,change=change.indexOf(".")==0?"0"+change:change,marketData.push({Order:_getOrderFromMarketSmallSymbols(result.Ticker),Name:_getMarketSmallNameFromTicker(result.Ticker),Change:change,Price:result.Last,CssClass:result.NetChange==undefined||result.NetChange==""?"Neutral":result.NetChange.indexOf("-")==0?"Negative":"Positive",Symbol:result.Ticker=="DJIA"?result.Ticker:result.Ticker+"-"+result.Exchange})}processed++,processed>=marketSymbols.length-1&&(marketData.sort(function(a,b){return a.Order<b.Order?-1:1}),_processMarketSmallTemplate(marketData))});searchBox=$(".MarketMonitorSmall_StockSearch .SearchBox"),stockSearchMenu=$("#MarketMonitorSmall_StockSearch_Drop"),stockSearchMenu.bind("mouseenter",function(){_isOverStockSearchMenu=!0}),stockSearchMenu.bind("mouseleave",function(){_isOverStockSearchMenu=!1}),searchBox.bind("focus",function(){(searchBox.val()==searchDefault||searchDefault=="")&&searchBox.val("")}).bind("keyup",function(){if(searchBox.val()==""){stockSearchMenu.hide();return}var container=$("#MarketMonitorSmall_StockSearch_Drop .Results");$.getJSON(MarketDataServiceUrl+"/GetTopNStocks?symbolBeginsWith="+searchBox.val()+"&n=5",function(result){var templateUrl,moreUrl,newMoreUrl;result!=undefined&&result.length>0?(templateUrl=Agility.ResolveUrl("~/ClientTemplates/StockSearchResults.htm"),container.setTemplateURL(templateUrl),container.processTemplate(result),_updateStockSearchPosition(searchBox,stockSearchMenu),stockSearchMenu.show(),moreUrl=$(".MoreResults a",stockSearchMenu).attr("href"),newMoreUrl=moreUrl.substring(0,moreUrl.indexOf("Search.aspx")+11)+"?query="+searchBox.val(),$(".MoreResults a",stockSearchMenu).attr("href",newMoreUrl),container.children(".DataItem").bind("mouseenter",function(){$(this).addClass("Hover")}),container.children(".DataItem").bind("mouseleave",function(){$(this).removeClass("Hover")})):stockSearchMenu.hide()})}).bind("blur",function(){searchBox.val()==""&&searchBox.val(searchDefault),_isOverStockSearchMenu?stockSearchMenu.bind("mouseleave",function(){stockSearchMenu.hide()}):stockSearchMenu.hide()}).bind("keydown",function(event){(event.which||event.keyCode)&&(event.which==13||event.keyCode==13)&&$(this).next().trigger("click")}),$("#btnMarketMonitorSmallSearch").bind("click",function(){var query=searchBox.val();return query!=""&&query!=searchDefault&&(window.location=Agility.ResolveUrl("~/Stock.aspx")+"?pi_symbol="+escape(query)),!1})},_updateShowsMenuPosition=function(linkElement,menuElement){if(linkElement.length>0&&menuElement.length>0){var x=linkElement.offset().left+linkElement.width()/2-menuElement.width()/2,y=linkElement.offset().top+linkElement.height()+8;menuElement.css("left",x+"px"),menuElement.css("top",y+"px")}},_getMarketSymbolFromMarketSmallLabel=function(marketLabel){for(var i=0;i<marketLabels.length;i++)if(marketLabel==marketLabels[i])return marketSymbols[i]},_processMarketSmallTemplate=function(data){var container=$("#MarketMonitorSmall .MarketMonitorData"),templateUrl=Agility.ResolveUrl("~/ClientTemplates/MarketMonitorSmall.htm");container.setTemplateURL(templateUrl),container.processTemplate(data)},_getOrderFromMarketSmallSymbols=function(ticker){for(var i=0;i<marketSymbols.length;i++)if(marketSymbols[i].indexOf(ticker)==0)return i},_getMarketSmallNameFromTicker=function(ticker){for(var i=0;i<marketSymbols.length;i++)if(marketSymbols[i].indexOf(ticker)==0)return marketNames[i]},_populateMarketSmallChart=function(obj,selectedMarketSymbol){$(obj).addClass("Selected"),$.getJSON(MarketDataServiceUrl+"/GetMarketMonitorSmallChartUrl?symbol="+selectedMarketSymbol+"",function(result){var chartHtml='<img src="'+result+'" id="chart1">';$("#MarketMonitorSmall .Main .Chart").html(chartHtml)})}}(BNN.Modules.MarketMonitorSmall);
jQuery.fn.extend({NewComments:function(arg){$(this).each(function(){var argObj={PageSize:arg.PageSize,RecordOffset:0,SortedField:"CreatedOn",SortDirection:"desc",Columns:["Name","Comment","ParentRecordID","RelatedContentID","FacebookID"],onSubmitComment:BNN.Modules.NewComments.SubmitComment,onEmptyComments:BNN.Modules.NewComments.onEmptyComments,onFlagOffensive:BNN.Modules.NewComments.onFlagOffensive,onCommentSubmitComplete:BNN.Modules.NewComments.onCommentSubmitComplete,CommentContainer:arg.CommentContainer,CommentCountContainer:arg.CommentCountContainer};$.extend(argObj,arg),BNN.Modules.NewComments.LoadComments(argObj)})}});var _currentFacebookUser;Agility.RegisterNamespace("BNN.Modules.NewComments"),function(NewComments){function _buildCommentInputForm(argObj){var html="";return html+="<div class='CommentSubmission'>",html+="<div id='fb-root'></div>",html+="<a name='PostComment-"+argObj.RelatedContentID+"'></a>",html+="<h2>"+argObj.AddCommentTitle+"</h2>",html+="<div class='Description'>"+argObj.Description+"</div>",html+="<div class='ReplyTo' style='display:none;'></div>",html+="<div class='Name'><label>"+argObj.NameLabel+"</label><input type='text' id='txtCommentPluginName_"+argObj.RelatedContentID+"' class='NameInput'/></div>",html+="<div class='EmailAddress'><label>"+argObj.EmailAddressLabel+"</label><input type='text' id='txtCommentPluginEmailAddress_"+argObj.RelatedContentID+"' class='EmailAddressInput'/></div>",html+="<div class='Comment'><label>"+argObj.CommentLabel+"</label><textarea id='txtCommentPluginComment_"+argObj.RelatedContentID+"' class='CommentInput' rows='4'></textarea><span>"+_currentArgs.CommentsInputHelp+"</span></div>",html+="<input type='hidden' id='txtCommentParentRecordID_"+argObj.RelatedContentID+"' class='ParentRecordInput'/>",html+="<div class='Submit'><input type='button' value='"+argObj.SubmitLabel+"' class='btnSubmit'/></div>",html+="</div>",html+="<div class='ThankYou'>",html+="<div class='Message'>"+argObj.ThankyouMessage+"</div>",html+="<div class='Another'>Click to Submit Another Comment!</div>",html+="</div>"}function _buildCommentContainerArea(){var html="";return html+="<div class='CommentContainer'><div class='Loading'>&nbsp;</div></div>"}function _loadComments(elem,_argObj){var cached=new Date,commentSearchArg={RelatedContentID:_argObj.RelatedContentID,PageSize:_argObj.PageSize,CacheKey:cached.getTime(),RecordOffset:(_currentPage-1)*_argObj.PageSize,SortedField:_argObj.SortedField,SortDirection:_argObj.SortDirection,RecordTypeName:_argObj.RecordTypeName,State:Agility.UGC.API.RecordState.Published,Columns:_argObj.Columns};Agility.UGC.API.SearchComments(commentSearchArg,function(data){var topLevelItems,subItems,i,parentRecordID,commentsContainer,commentHtml;if(data.ResponseType==0){for(_currentComments[_argObj.RelatedContentID]=data.ResponseData.Records,_totalPages=Math.ceil(data.ResponseData.TotalRecords/_argObj.PageSize),topLevelItems=[],subItems=[],ary=[],i=0;i<_currentComments[_argObj.RelatedContentID].length;i++)parentRecordID=_currentComments[_argObj.RelatedContentID][i].ParentRecordID,(parentRecordID=null||parentRecordID==undefined||parentRecordID<=0)?topLevelItems.push(data.ResponseData.Records[i]):subItems.push(_currentComments[_argObj.RelatedContentID][i]);if(commentsContainer=$(".CommentContainer",elem),commentHtml=NewComments.LoadCommentData(0,0,topLevelItems,subItems,_argObj.RecordTypeName),commentsContainer.html(commentHtml),NewComments.GetCommentFeedBackCounts(commentsContainer,_argObj.RecordTypeName),_bindActionEvents(elem,_argObj),data.ResponseData.TotalRecords==0&&_argObj.onEmptyComments!=null&&_argObj.onEmptyComments!=undefined&&$.isFunction(_argObj.onEmptyComments)){_argObj.onEmptyComments(elem);return}NewComments.BuildCommentPager(commentSearchArg,commentSearchArg.RelatedContentID,_currentPage,_totalPages),_argObj.isStockFeedback||($("#slide-right",_argObj.CommentCountContainer).html(data.ResponseData.TotalRecords),$("#slide-right-bottom",_argObj.CommentCountContainer).html(data.ResponseData.TotalRecords))}else $(".CommentContainer",elem).html("Error Loading Comments: "+data.Message)})}function _bindActionEvents(elem,argObj){$(".Approve",elem).click(function(){var commentID=$(this).attr("commentID");$.cookie("BNNCommentApproval_"+commentID)||NewComments.AddFeedback(commentID,!0,"#span_ap_",argObj.RecordTypeName)}),$(".Disapprove",elem).click(function(){var commentID=$(this).attr("commentID");$.cookie("BNNCommentApproval_"+commentID)||NewComments.AddFeedback(commentID,!1,"#span_dp_",argObj.RecordTypeName)}),$(".FlagOffensive",elem).click(function(){var commentID=$(this).attr("commentID");argObj.onFlagOffensive(commentID)}),$(".CommentReply",elem).click(function(){var commentID=$(this).attr("commentID"),replyTo=$(this).attr("replyTo");_setParentRecordID(elem,commentID,replyTo,argObj)}),$(".ThankYou .Another",elem).bind("click",function(){NewComments.HideThankYou()})}function _setParentRecordID(elem,commentID,replyTo,argObj){var parentInput=$(".ParentRecordInput",elem),message,i;for(parentInput.val(commentID),message="<div class='CancelReply'><a class='CancelReply' href='#'>Cancel Reply</a></div>",message+="Replying to comment",replyTo!=null&&replyTo!=undefined&&replyTo.length>0&&(message+=" from '"+replyTo+"'"),i=0;i<_currentComments[argObj.RelatedContentID].length;i++)_currentComments[argObj.RelatedContentID][i].ID==commentID&&(message+="<div class='CommentPreview'>"+_currentComments[argObj.RelatedContentID][i].Comment+"</div>");$(".ReplyTo",elem).html(message),location.href="#PostComment-"+argObj.RelatedContentID,$(".ReplyTo",elem).slideDown("fast"),$(".CancelReply",elem).click(function(){$(".ReplyTo").slideUp("fast"),parentInput.val(""),$(".ReplyTo",elem).html("")})}function _formatDate(date){var year=Number(date.substr(0,4)),month=Number(date.substr(5,2))-1,day=Number(date.substr(8,2)),hours=Number(date.substr(11,2)),minutes=Number(date.substr(14,2)),seconds=Number(date.substr(17,2)),theDate=new Date(year,month,day,hours,minutes,seconds,0),months=["January","February","March","April","May","June","July","August","September","October","November","December"];return months[theDate.getMonth()]+" "+theDate.getDate()+", "+theDate.getFullYear()+"<br/>"+(theDate.getHours()>12?theDate.getHours()-12:theDate.getHours())+":"+(theDate.getMinutes()<10?"0":"")+theDate.getMinutes()+(theDate.getHours()<12?"AM":"PM")}function handleSessionResponse(response){if(response.authResponse)$(".user-info").show("fast"),$(".Name").hide("fast"),$(".EmailAddress").hide("fast"),$(".FacebookConnect").hide("fast");else{NewComments.clearForFBDisplay();return}FB.api("/me",function(response){var fbpic_Str,cntr,$signOut_ctrl;_currentFacebookUser=response,fbpic_Str="https://graph.facebook.com/"+response.id+"/picture",cntr=$(".user-info"),$(".fbimg",cntr).attr("src",fbpic_Str),$(".fbspan",cntr).html("Welcome "+response.name+",<br/>you are now connected with your Facebook account.<br/>"),$signOut_ctrl=$(".SignOut",cntr),$signOut_ctrl.bind("click",function(){FB.logout(handleSessionResponse),_currentFacebookUser=null,NewComments.clearForFBDisplay()})})}var _container=null,_currentComments=[],_currentArgs=[],_currentPage=1,_totalPages=1;NewComments.LoadComments=function(argObj){var CommentContainer,CommentCountCainer,html;argObj.EnableComments=="True"?($(".Stock-Comments-Container",argObj.CommentCountContainer).click(function(){if(argObj.RecordTypeName=="CommentsForRecordType44"){var options={direction:"right"};$(argObj.CommentContainer).toggle("slide",options,"fast"),$("html, body").animate({scrollTop:0},0)}else return $(document).scrollTop($("#Comments").offset().top),!1}),CommentContainer=$(argObj.CommentContainer),CommentCountCainer=$(argObj.CommentCountContainer),_currentArgs=argObj,_container=CommentContainer,html="<div class='AgilityCommentsPlugin'>",html+="<div class='CommentHeading'><h2>"+_currentArgs.CommentTitle+"</h2></div>",html+="<div class='SubLine'></div>",html+=_buildCommentInputForm(argObj),html+=_buildCommentContainerArea(),html+="<div id='Pager_"+argObj.RelatedContentID+"' class='Pager'></div>",html+="</div>",CommentContainer.html(html),_loadComments(_container,_currentArgs),$(".btnSubmit",CommentContainer).click(function(){if(argObj.isStockFeedback){var start=CommentContainer.attr("id").indexOf("_");argObj.onSubmitComment(CommentContainer,_currentArgs.RecordTypeName,CommentContainer.attr("id").substr(start+1))}else argObj.onSubmitComment(CommentContainer,argObj.RecordTypeName,argObj.RelatedContentID)})):($(argObj.CommentCountContainer).attr("style","display:none"),$("#<%=pnlComments.ClientID %>").attr("style","display:none"))},NewComments.onFlagOffensive=function(commentID){Agility.UGC.API.SetRecordFlag(commentID,Agility.UGC.API.RecordFlag.Abuse,null,function(data){data.ResponseType==Agility.UGC.API.ResponseType.OK&&alert("The Comment has been Flagged Offensive. Thank you for your submission.")})},NewComments.onEmptyComments=function(elem){$(".CommentContainer",elem).html("<p style='text-align: center; font-size:16px;'><strong>No comments available.</strong></p>")},NewComments.ResetCommentForm=function(elem){$(".NameInput",elem).val(""),$(".EmailAddressInput",elem).val(""),$(".CommentInput",elem).val(""),$(".ParentRecordInput",elem).val(""),$(".CancelReply",elem).click()},NewComments.DisplayThankYou=function(elem){$(".CommentSubmission",elem).hide(),$(".ThankYou",elem).show()},NewComments.HideThankYou=function(elem){$(".CommentSubmission",elem).show(),$(".ThankYou",elem).hide()},NewComments.clearForFBDisplay=function(){$(".user-info").hide("fast"),$(".FacebookConnect").show("fast"),$(".Name").show("fast"),$(".EmailAddress").show("fast")},NewComments.SubmitComment=function(elem,RecordTypeName,RelatedContentID){var name=_currentFacebookUser?_currentFacebookUser.name:$(".NameInput",elem).val(),comment=$(".CommentInput",elem).val(),emailAddress=_currentFacebookUser?_currentFacebookUser.email:$(".EmailAddressInput",elem).val(),parentRecordID=$(".ParentRecordInput",elem)
.val(),facebookID=_currentFacebookUser?_currentFacebookUser.id:-1,emailRegex;if(name!=null&&name.length==0){alert("Please add a name before submitting");return}if(emailRegex=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i,emailAddress==""||!emailAddress.match(emailRegex)){alert("Please add a valid email address before submitting");return}if(comment!=null&&comment.length==0){alert("Please add a comment before submitting");return}comment={ID:-1,RecordTypeName:RecordTypeName,RelatedContentID:RelatedContentID,Name:name,EmailAddress:emailAddress,FacebookID:facebookID,Comment:comment,ParentRecordID:parentRecordID},Agility.UGC.API.SaveRecord(comment,function(data){_currentArgs.onCommentSubmitComplete(data)})},NewComments.onCommentSubmitComplete=function(data){data.ResponseType==Agility.UGC.API.ResponseType.OK?(NewComments.ResetCommentForm(),NewComments.DisplayThankYou()):alert("There was an error submitting your comment:"+data.Message)},NewComments.GetTotals=function(id,type){var cached=new Date,commentTotalSearchArg={RelatedContentID:id,CacheKey:cached.getTime(),PageSize:1,RecordOffset:0,SortedField:"CreatedOn",SortDirection:"asc",RecordTypeName:"CommentsForRecordType44",State:Agility.UGC.API.RecordState.Published};Agility.UGC.API.SearchComments(commentTotalSearchArg,function(data){data.ResponseType==0&&data.ResponseData.TotalRecords>0&&(type=="Big"?$("#Stock-Comments_"+data.ResponseData.Records[0].RelatedContentID+" .Stock-Comments-Container").html("COMMENTS "+data.ResponseData.TotalRecords):$("#Stock-Comments_"+data.ResponseData.Records[0].RelatedContentID+" .Stock-Comments-Container").html(data.ResponseData.TotalRecords))})},NewComments.GetCommentFeedBackCounts=function(commentContainer,recordTypeName){var idList=[],feedbackSearch;$.each($(".CommentRow",commentContainer),function(){var contentID=Number($(this).attr("contentid"));isNaN(contentID)||idList.push(contentID)}),feedbackSearch=new Agility.UGC.API.FeedbackSearchArg,feedbackSearch.ReferenceName=recordTypeName,feedbackSearch.ContentType=Agility.UGC.API.FeedbackContentType.UGC,feedbackSearch.SubmissionType=Agility.UGC.API.FeedbackSubmissionType.ApproveDisapprove,feedbackSearch.RelatedContentIDs=idList,feedbackSearch.Action=Agility.UGC.API.AggregateTypes.Count,feedbackSearch.IsPositive=!0,Agility.UGC.API.GetFeedbackAggregate(feedbackSearch,function(data){data.ResponseType==Agility.UGC.API.ResponseType.OK&&data.ResponseData.length>0&&$.each(data.ResponseData,function(index,item){NewComments.SetFeedbackResult(commentContainer,"span_ap_"+item.RelatedContentID,item.Result)})}),feedbackSearch.IsPositive=!1,Agility.UGC.API.GetFeedbackAggregate(feedbackSearch,function(data){data.ResponseType==Agility.UGC.API.ResponseType.OK&&data.ResponseData.length>0&&$.each(data.ResponseData,function(index,item){NewComments.SetFeedbackResult(commentContainer,"span_dp_"+item.RelatedContentID,item.Result)})})},NewComments.SetFeedbackResult=function(container,elementID,feedbackCount){$("#"+elementID,container).html(feedbackCount)},NewComments.LoadCommentData=function(recordID,level,topLevelItems,subItems,RelatedContentID){var childAry,html,isAlt,i,comment;if(level>5)return"";for(childAry=[],childAry=level==0&&recordID==0?topLevelItems:$.grep(subItems,function(item){return item.ParentRecordID==recordID}),html="",isAlt=!1,i=0;i<childAry.length;i++)comment=childAry[i],html+=NewComments.GetCommentHTML(comment,level,isAlt,RelatedContentID),html+=NewComments.LoadCommentData(comment.ID,level+1,topLevelItems,subItems),isAlt=!isAlt;return html},NewComments.GetCommentHTML=function(comment,level,isAlternate){var html="",margin,altClass;return(level==undefined||level==null||level==NaN)&&(level=0),margin=level*30,altClass="",isAlternate&&level==0?altClass=" AltRow":level>0&&(altClass=" SubItem"),html+="<div class='CommentRow"+altClass+"' style='margin-left: "+margin+"px' id='pnlComment_"+comment.ID+"' contentID='"+comment.ID+"' commentLevel='"+comment.CommentLevel+"' parentRecordID='"+comment.ParentRecordID+"'>",html+="<div class='Feedback'><div class='Commentor'>"+comment.Name+"</div><div class='PostedDate'>"+_formatDate(comment.CreatedOn)+"</div>",html+="<div class='Approve' commentID='"+comment.ID+"'><img src='"+Agility.ResolveUrl("~/Images/Icons/icn_feedback_up.png")+"'/><span id=span_ap_"+comment.ID+">0</span></div>",html+="<div class='Disapprove' commentID='"+comment.ID+"'><img src='"+Agility.ResolveUrl("~/Images/Icons/icn_feedback_down.png")+"'/><span id='span_dp_"+comment.ID+"'>0</span></div>",html+="</div>",html+="<div class='CommentDescription'><p>"+comment.Comment+"</p>",_currentArgs.EnableReplies&&(html+="\t\t\t<div class='Reply'><a class='CommentReply'  commentID='"+comment.ID+"' replyTo='"+comment.Name+"'>Reply</a></div>"),_currentArgs.EnableFlagging&&(html+="           <div class='Flag'><a class='FlagOffensive' href='#' commentID='"+comment.ID+"'>Report Abuse</a></div>"),html+="</div>",html+="<div class='Clear'></div>",html+="\t</div>"},NewComments.GetFeedBackCount=function(id,ParentRecordID,isPositive,RecordTypeName){var approveSearch=new Agility.UGC.API.FeedbackSearchArg;approveSearch.ReferenceName=RecordTypeName,approveSearch.ContentType=Agility.UGC.API.FeedbackContentType.UGC,approveSearch.SubmissionType=Agility.UGC.API.FeedbackSubmissionType.ApproveDisapprove,approveSearch.RelatedContentIDs=[id],approveSearch.IsPositive=isPositive,approveSearch.Action=Agility.UGC.API.AggregateTypes.Count,Agility.UGC.API.GetFeedbackAggregate(approveSearch,function(data){if(data.ResponseType==0){var tmp=data.ResponseData.length>0?data.ResponseData[0].Result:"0";isPositive?$("#span_ap_"+id).html(" "+tmp+" "):$("#span_dp_"+id).html(" "+tmp+" ")}})},NewComments.AddFeedback=function(id,isPositive,element,RecordTypeName){var ApprovalFeedback=new Agility.UGC.API.BooleanFeedback;ApprovalFeedback.ReferenceName=RecordTypeName,ApprovalFeedback.ContentType=Agility.UGC.API.FeedbackContentType.UGC,ApprovalFeedback.RelatedContentID=id,Agility.UGC.API.SaveApproveDisapprove(ApprovalFeedback,isPositive,function(data){if(data.ResponseType==Agility.UGC.API.ResponseType.OK){var currentLabel=$(element+id).html(),currentCount=Number(currentLabel);$(element+id).html(" "+(currentCount+1)+" "),$.cookie("BNNCommentApproval_"+id,!0)}})},NewComments.InitFacebook=function(argObj,CommentContainer){argObj.EnableFacebookConnect&&(NewComments.clearForFBDisplay(),FB._initialized=!1,FB.init({appId:"182608561808508",cookie:!0,oauth:!0,status:!0,xfbml:!0,channelUrl:"http://ctvbnn.s3.amazonaws.com/fbchannel/channel.html"}),FB.getLoginStatus(handleSessionResponse,!0),$("#login",CommentContainer).bind("click",function(){FB.login(handleSessionResponse,{scope:"email"})}))},NewComments.BuildCommentPager=function(_argObj_,_relatedContentID,currentPage,totalPages){var $pagerContainer="",html,i;if($pagerContainer=$("#Pager_"+_relatedContentID),totalPages>1){for(html="",html+='<div class="Previous"><a href="#">&nbsp;</a></div>',i=1;i<=totalPages;i++)html+='<div class="PageItem'+(i==currentPage?" Selected":"")+"\"><a href='#'>"+i+"</a></div>";html+='<div class="Next"><a href="#">&nbsp;</a></div>',$pagerContainer.html(html),$.each($(".PageItem",$pagerContainer),function(){$(this).unbind("click"),$(this).find("a").unbind("click"),$(this).hasClass("Selected")?($(this).bind("click",function(){return!1}),$(this).find("a").bind("click",function(){return!1})):($(this).bind("click",function(){var page=$(this).text();return _currentPage=Number(page),_loadComments($pagerContainer.parent().parent(),_argObj_),!1}),$(this).find("a").bind("click",function(){var page=$(this).text();return _currentPage=Number(page),_loadComments($pagerContainer.parent().parent(),_argObj_),!1}))}),$("#Pager_"+_relatedContentID+" .Previous").bind("click",function(){return _currentPage=Math.max(1,_currentPage-1),_loadComments($pagerContainer.parent().parent(),_argObj_),!1}),$("#Pager_"+_relatedContentID+" .Next").bind("click",function(){return _currentPage=Math.min(_totalPages,_currentPage+1),_loadComments($pagerContainer.parent().parent(),_argObj_),!1})}else $pagerContainer.html("")}}(BNN.Modules.NewComments);
Agility.RegisterNamespace("BNN.Modules.NewStockDetails");var _currentFacebookUser;(function(NewStockDetails){function BindSearch(){var searchBox=$("#StockSymbolSearch_Feedback .SearchBox"),stockSearchMenu=$("#StockSymbolSearch_Feedback_Drop"),seriesSymbol;stockSearchMenu.bind("mouseenter",function(){_isOverStockSearchMenu=!0}),stockSearchMenu.bind("mouseleave",function(){_isOverStockSearchMenu=!1}),searchBox.bind("focus",function(){(searchBox.val()==searchDefault||searchDefault=="")&&searchBox.val("")}).bind("keyup",function(){if(searchBox.val()==""){stockSearchMenu.hide();return}var container=$("#StockSymbolSearch_Feedback_Drop .Results");$.getJSON(MarketDataServiceUrl+"/GetTopNReutersSearch?symbolBeginsWith="+searchBox.val()+"&pageSize=5&pageNo=0",function(result){var templateUrl,moreUrl,newMoreUrl;result!=undefined&&result.length>0?(templateUrl=Agility.ResolveUrl("~/ClientTemplates/ReutersSearchResults.htm"),container.setTemplateURL(templateUrl),container.processTemplate(result),_updateStockSearchPosition(searchBox,stockSearchMenu),stockSearchMenu.show(),moreUrl=$(".MoreResults a",stockSearchMenu).attr("href"),newMoreUrl=moreUrl.substring(0,moreUrl.indexOf("Search.aspx")+11)+"?query="+searchBox.val(),$(".MoreResults a",stockSearchMenu).attr("href",newMoreUrl),container.children(".DataItem").bind("mouseenter",function(){$(this).addClass("Hover")}),container.children(".DataItem").bind("mouseleave",function(){$(this).removeClass("Hover")})):stockSearchMenu.hide()})}).bind("blur",function(){searchBox.val()==""&&searchBox.val(searchDefault),_isOverStockSearchMenu?stockSearchMenu.bind("mouseleave",function(){stockSearchMenu.hide()}):stockSearchMenu.hide()}).bind("keydown",function(event){(event.which||event.keyCode)&&(event.which==13||event.keyCode==13)&&$(this).next().trigger("click")}),$("#btnStockSymbolSearch_Feedback").bind("click",function(){var query=searchBox.val();return query!=""&&query!=searchDefault&&(window.location=Agility.ResolveUrl("~/Stock.aspx")+"?pi_symbol="+escape(query)),!1}),$("#StockDetails .StockQuote .Summary .ChartContainer .ChartFilterContainer .ChartFilterItem").bind("click",function(){NewStockDetails.ChartClick(this)}),$chk=$("#chkVolume"),$chk.click(function(){var chart=$("#highStockContainer").highcharts(),series=chart.series[1];series.visible?(series.hide(),$chk.html("Show Volume"),$chk.addClass("Selected")):(series.show(),$chk.html("Hide Volume"),$chk.removeClass("Selected"))}),$btnAddSeries=$("#btnAddSeries"),seriesSymbol="BCE.TO",$btnAddSeries.click(function(){var chart=$("#highStockContainer").highcharts(),close_series=chart.series[0],vol_series=chart.series[1];$.getJSON(MarketDataServiceUrl+"/GetStockQuote?symbol="+seriesSymbol+"",function(result){result!=undefined&&(BNN.Controls.TimeSeriesChart.AddSeries(result,chart),vol_series.hide())})}),$("#StockDetails .StockQuote .Summary .ChartContainer .ChartNavContainer button").click(function(event){event.preventDefault(),type=$(this).attr("id"),$(this).addClass("Selected"),$.each($("#StockDetails .StockQuote .Summary .ChartContainer .ChartNavContainer button").not($(this)),function(){$(this).removeClass("Selected")}),BNN.Controls.TimeSeriesChart.StockDetailsChart("#highStockContainer",quote,type,!1)})}function searchInGoogle(searchFor,pageSize,pageNo,contentType){contentType!=undefined&&contentType!=""&&$.ajax({url:AjaxWebserviceSvcUrl+"/Search?query="+escape(searchFor)+"&PageSize="+pageSize+"&PageNo="+pageNo+"&PageType="+contentType+"s",contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var result={d:jsonResponse},container=$("ul.SearchResultsIn"+contentType+"s"),templateUrl,total,paginationIssueMode;if(result.d!=undefined&&result.d!=null&&result.d.Results.length>0)templateUrl=Agility.ResolveUrl("~/ClientTemplates/SearchResultsIn"+contentType+"s.htm"),container.setTemplateURL(templateUrl),container.setParam("HTMLDecode",decodeHTML),contentType=="Video"?container.setParam("ContinueReadingLabel",ContinueViewingLabel):container.setParam("ContinueReadingLabel",ContinueReadingLabel),container.processTemplate(result.d.Results),total=estimatedTotalResults(container,parseInt(result.d.TotalResults),pageNo*PageSize,result.d.Results.length,PageSize),paginationIssueMode=eval(container.data("paginationIssueMode")),paginationIssueMode?(pageNo=Math.floor(total/pageSize),searchInGoogle(searchFor,pageSize,pageNo,contentType)):PagerRender($("div.SearchResultsIn"+contentType+"sPager"),total,pageSize,pageNo+1);else if(pageNo>0)pageNo=pageNo-1,container.data("paginationIssueMode",!0),searchInGoogle(searchFor,pageSize,pageNo,contentType);else switch(contentType){case"New":$("#NewsTab").hide();break;case"Video":$("#VideosTab").hide();break;case"Blog":$("#BlogsTab").hide()}},complete:function(){}})}function searchInAxis(searchFor,pageSize,pageNo){var total=0;SearchFor=searchFor,$.ajaxSetup({cache:!0}),$.ajax({url:AxisShowServiceURL+"/contents?$inlinecount=true&$include=["+fieldNames+"]&$page="+pageNo+"&$top="+PageSize+"&$sort=BroadcastDate&$order=desc&$search="+escape(searchFor),contentType:"application/json;",dataType:"jsonp",cache:!0,jsonpCallback:"getJsonFromCAPI_StockDetail_searchInAxis",success:function(jsonResponse){var result=jsonResponse,container=$("ul.SearchResultsInVideos"),templateUrl;result.Count>0?(templateUrl=Agility.ResolveUrl("~/ClientTemplates/SearchResultsInVideos.htm"),container.setTemplateURL(templateUrl),container.setParam("HTMLDecode",decodeHTML),container.setParam("ContinueReadingLabel",ContinueViewingLabel),container.processTemplate(result.Items),pageNo=pageNo==0||pageNo==1?1:pageNo,total=result.Count,PagerRender($("div.SearchResultsInVideosPager"),total,pageSize,pageNo)):$("#VideosTab").hide()},complete:function(){}})}function decodeHTML(encodedHTML){return $("<div/>").html(encodedHTML).text()}function estimatedTotalResults(container,total,start,resultLength,pagesize){var paginationIssueMode=eval(container.data("paginationIssueMode")),maxTotal=parseInt(container.data("maxTotal")),newStart;if(paginationIssueMode)start+resultLength<total&&(total=start+resultLength),total<maxTotal&&(maxTotal=total),maxTotal>0&&(total=maxTotal),container.data("paginationIssueMode",!1);else if(start>0&&resultLength<pagesize&&start+resultLength<total&&(total=start+resultLength),(maxTotal==0||total<maxTotal)&&(maxTotal=total),maxTotal>0&&(total=maxTotal),start>0&&total<start+1){for(newStart=start-pagesize>0?start-pagesize:0;newStart>=total;)newStart=newStart-pagesize>0?newStart-pagesize:0;return container.data("paginationIssueMode",!0),newStart}return total}function bindPageFn($p){return $p.unbind("click").bind("click",function(){return searchInContext(this),!1}),$p}function pageLink(pageNum,pageText,currentPage){if(pageNum!=currentPage){var $page=$('<a class="Page" href="javascript:;"></a>').text(pageText);return $page.data("page",pageNum),bindPageFn($page,pageNum)}return $('<a class="CurrentPage"></a>').text(pageNum)}function PagerRender($pager,numItems,postsPerPage,currentPage){var i;$pager.show();var numPages=Math.ceil(numItems/postsPerPage),links=$('<span class="Links"></span>'),$previousBtn=$pager.find("a.Previous"),$nextBtn=$pager.find("a.Next");if(numItems==0||numPages<=1){$pager.hide();return}for(currentPage<=1?$previousBtn.hide():($previousBtn.data("page",currentPage-1).show(),bindPageFn($previousBtn,currentPage-1)),currentPage>=numPages?$nextBtn.hide():($nextBtn.data("page",currentPage+1).show(),bindPageFn($nextBtn,currentPage+1)),links.append(pageLink(1,1,currentPage)),currentPage>4&&links.append($("<span>...</span>")),i=Math.max(2,currentPage-2);i<=Math.min(numPages-1,currentPage+2);i++)links.append(pageLink(i,i,currentPage));currentPage<numPages-3&&links.append($("<span>...</span>")),links.append(pageLink(numPages,"Last",currentPage)),$(".Links",$pager).replaceWith(links).show()}function searchInContext(sender){var a=$(sender);if(a.parent().parent().is(".SearchResultsInVideosPager")||a.parent().is(".SearchResultsInVideosPager")){searchInAxis(SearchFor,PageSize,parseInt(a.data("page")));return}if(a.parent().parent().is(".SearchResultsInNewsPager")||a.parent().is(".SearchResultsInNewsPager")){searchInGoogle(SearchFor,PageSize,parseInt(a.data("page"))-1,"New");return}if(a.parent().parent().is(".SearchResultsInBlogsPager")||a.parent().is(".SearchResultsInBlogsPager")){searchInGoogle(SearchFor,PageSize,parseInt(a.data("page"))-1,"Blog");return}}var symbol,defaults={Container:{}},_properties=null,recordID=null,_rating=null,_feedbackFlag=null,feedbackproperties=null,ContinueReadingLabel=null,ContinueViewingLabel="View More",PageSize=null,SearchFor=null,_symbol=null,searchDefault="",quote=null,AnnualReports=null,InterimReports=null;NewStockDetails.OnInit=function(p,p2,arg,p3){var argObj,userStockList;BindSearch(),$("#blocks").addClass("BlocksLoading"),$("#blockIn").hide(),ContinueReadingLabel=p3.ContinueReadingLabel,ContinueViewingLabel=p3.ContinueViewingLabel,PageSize=p3.PageSize,feedbackproperties=p2,_symbol=_trimSymbol(feedbackproperties.Symbol),argObj={PageSize:arg.PageSize,RecordOffset:0,SortedField:"CreatedOn",SortDirection:"asc",Columns:["Name","Comment","ParentRecordID","RelatedContentID","FacebookID"],onSubmitComment:BNN.Modules.NewComments.SubmitComment,onEmptyComments:BNN.Modules.NewComments.onEmptyComments,onFlagOffensive:BNN.Modules.NewComments.onFlagOffensive,onCommentSubmitComplete:BNN.Modules.NewComments.onCommentSubmitComplete,CommentContainer:arg.CommentContainer,CommentCountContainer:arg.CommentCountContainer},$.extend(argObj,arg),_renderTip(),_properties=$.extend({},defaults,p||{}),symbol=_properties.Symbol,userStockList=$.fn.StockCookieList("BNN_User_StockList"),$.getJSON(MarketDataServiceUrl+"/GetStockQuote?symbol="+symbol+"",function(result){var $stockQuote,$price,mCap,ifString,i,coSearch,splCoName,searchcontainer,container,templateUrl,cssClass,last,percentChange,currencyLabel,bid,ask;if(result!=undefined){for(userStockList.contains(symbol)==!1&&(userStockList.length()>=_properties
.UserStockListSize?(userStockList.remove(0),userStockList.add(symbol)):userStockList.add(symbol)),quote=result,$stockQuote=$("#StockDetails .StockQuote"),$price=$(".Price",$stockQuote),BNN.Controls.TimeSeriesChart.StockDetailsChart("#highStockContainer",quote,"1year",!1),_properties.CompanySnapShot!=null?($(".Title",$stockQuote).html(_properties.CompanySnapShot.CompanyName+" ("+quote.Ticker+")"),NewStockDetails.SearchStockSymbol(_symbol,_properties.CompanySnapShot.CompanyName,argObj)):($(".Title",$stockQuote).html(quote.CompanyName+" ("+quote.Ticker+")"),$(document).attr("title","Stock: "+symbol+" – "+quote.CompanyName+" - BNN News"),NewStockDetails.SearchStockSymbol(_symbol,quote.CompanyName,argObj)),mCap=null,ifString="",i=0;i<p.RelatedExclusionList.length;i++)ifString+=" symbol != '"+p.RelatedExclusionList[i].trim()+"'",ifString+=i!=p.RelatedExclusionList.length-1?" && ":"";eval(ifString)?(coSearch=null,splCoName=null,mCap=_properties.CompanySnapShot!=null?_properties.CompanySnapShot.RatioGroups[1].Ratios[0].Value:null,coSearch=symbol,searchcontainer=$("ul.SearchResultsInNews"),searchcontainer.data("paginationIssueMode",!1),searchcontainer.data("maxTotal",0),searchInGoogle(coSearch,PageSize,0,"New"),searchcontainer=$("ul.SearchResultsInVideos"),searchcontainer.data("paginationIssueMode",!1),searchcontainer.data("maxTotal",0),searchInAxis(coSearch,PageSize,0),searchcontainer=$("ul.SearchResultsInBlogs"),searchcontainer.data("paginationIssueMode",!1),searchcontainer.data("maxTotal",0),searchInGoogle(coSearch,PageSize,0,"Blog"),container=$(".CompanyInfo"),p.CompanySnapShot!=undefined||p.CompanySnapShot!=null?(templateUrl=Agility.ResolveUrl("~/ClientTemplates/StockDetailCompanyInfo.htm"),container.setTemplateURL(templateUrl),container.processTemplate(p.CompanySnapShot),$(".CompanyInfo").show()):$("#InfoTab").hide()):($("#InfoTab").hide(),$("#NewsTab").hide(),$("#VideosTab").hide(),$("#BlogsTab").hide(),$("#VideosTab").hide()),cssClass=_getCssClass(result.NetChange),last=_formatPriceInfo(result.Last),last=last!=null&&last!=""?"$"+last:last,$(".Last",$price).addClass(cssClass).text(last),$(".NetChange",$price).addClass(cssClass).text(_formatPriceInfo(result.NetChange)),percentChange=_formatPriceInfo(result.PercentChange),percentChange=percentChange.indexOf("%")<0?percentChange+"%":percentChange,$(".PercentChange",$price).addClass(cssClass).text(percentChange),$("img[id$="+cssClass+"]",$price).show(),currencyLabel=_properties.CADCurrencyLabel,$(".NetCurrencyLabel",$price).html(currencyLabel+":&nbsp;"),$("#Open_Value").text(_formatPriceInfo(result.Open)),$("#High_Value").text(_formatPriceInfo(result.High)),$("#Low_Value").text(_formatPriceInfo(result.Low)),$("#Volume_Value").text(_formatPriceInfo(result.Volume)),$("#High52Week_Value").text(_formatPriceInfo(result.W52High)),$("#Low52Week_Value").text(_formatPriceInfo(result.W52Low)),bid=parseFloat(result.Bid).toString(),$("#Bid_Value").text(_formatPriceInfo(bid)),$("#BidSize_Value").text(_formatPriceInfo(result.BidSize)),ask=parseFloat(result.Ask).toString(),$("#Ask_Value").text(_formatPriceInfo(ask)),$("#AskSize_Value").text(_formatPriceInfo(result.AskSize)),$("#EPS_Value").text(_formatPriceInfo(result.EPS)),$("#PE_Value").text(_formatPriceInfo(result.PeRatio)),mCap!=null&&$("#MarketCap_Value").text(_formatPriceInfo(mCap)),$("#Yield_Value").text(_formatPriceInfo(result.Yield))}});var annualLinkContainer=$("#AnnualFinancials .ReportPeriods .Links"),interimLinkContainer=$("#Trailing12MonthResults .ReportPeriods .Links"),annualStatementLinkContainer=$("#AnnualFinancials .StatementType .StatementLinks"),interimStatementLinkContainer=$("#Trailing12MonthResults .StatementType .StatementLinks");$.getJSON(MarketDataServiceUrl+"/GetReutersCompanyFinancialStatements?symbol="+symbol+"",function(result){var ann_templateUrl,int_templateUrl,annualStatementContainer,Statement_templateUrl,StatementLink_templateUrl,interimStatementContainer;result!=undefined?(AnnualReports=result.AnnualPeriods,InterimReports=result.InterimPeriods,ann_templateUrl=Agility.ResolveUrl("~/ClientTemplates/StockDetail_FinanicalReports_AnnualLinks.htm"),annualLinkContainer.setTemplateURL(ann_templateUrl),annualLinkContainer.processTemplate(result.AnnualPeriods),int_templateUrl=Agility.ResolveUrl("~/ClientTemplates/StockDetail_FinanicalReports_InterimLinks.htm"),interimLinkContainer.setTemplateURL(int_templateUrl),interimLinkContainer.processTemplate(result.InterimPeriods),StatementLink_templateUrl=Agility.ResolveUrl("~/ClientTemplates/StockDetail_FinancialReport_AnnualTypes.htm"),annualStatementLinkContainer.setTemplateURL(StatementLink_templateUrl),annualStatementLinkContainer.setParam("ParentIndex",0),annualStatementLinkContainer.processTemplate(result.AnnualPeriods[0].Statements),annualStatementContainer=$("#AnnualFinancials .Statements"),Statement_templateUrl=Agility.ResolveUrl("~/ClientTemplates/StockDetail_FinancialReport_Statement.htm"),annualStatementContainer.setTemplateURL(Statement_templateUrl),annualStatementContainer.setParam("Period",AnnualReports[0].fiscalYear),annualStatementContainer.setParam("Type",AnnualReports[0].Statements[0].Type),annualStatementContainer.processTemplate(AnnualReports[0].Statements[0]),StatementLink_templateUrl=Agility.ResolveUrl("~/ClientTemplates/StockDetail_FinancialReport_InterimTypes.htm"),interimStatementLinkContainer.setTemplateURL(StatementLink_templateUrl),interimStatementLinkContainer.setParam("ParentIndex",0),interimStatementLinkContainer.processTemplate(InterimReports[0].Statements),interimStatementContainer=$("#Trailing12MonthResults .Statements"),interimStatementContainer.setTemplateURL(Statement_templateUrl),interimStatementContainer.setParam("Period",BNN.Modules.NewStockDetails.FormatInterimPeriodDate(InterimReports[0].endDate)),interimStatementContainer.setParam("Type",InterimReports[0].Statements[0].Type),interimStatementContainer.processTemplate(InterimReports[0].Statements[0])):$("#FinancialsTab").hide()})},NewStockDetails.ReportAnnualClick=function(index,elem){var annualStatementLinkContainer,StatementLink_templateUrl,annualStatementContainer,Statement_templateUrl;$(elem).addClass("Selected"),$.each($("#AnnualFinancials .ReportPeriods .Links .ReportLink").not(elem),function(){$(this).removeClass("Selected")}),annualStatementLinkContainer=$("#AnnualFinancials .StatementLinks"),StatementLink_templateUrl=Agility.ResolveUrl("~/ClientTemplates/StockDetail_FinancialReport_AnnualTypes.htm"),annualStatementLinkContainer.setTemplateURL(StatementLink_templateUrl),annualStatementLinkContainer.setParam("ParentIndex",index),annualStatementLinkContainer.processTemplate(AnnualReports[index].Statements),annualStatementContainer=$("#AnnualFinancials .Statements"),Statement_templateUrl=Agility.ResolveUrl("~/ClientTemplates/StockDetail_FinancialReport_Statement.htm"),annualStatementContainer.setTemplateURL(Statement_templateUrl),annualStatementContainer.setParam("Period",AnnualReports[index].fiscalYear),annualStatementContainer.setParam("Type",AnnualReports[index].Statements[0].Type),annualStatementContainer.processTemplate(AnnualReports[index].Statements[0])},NewStockDetails.AnnualStatementClick=function(index,parentIndex,elem){$(elem).addClass("Selected"),$.each($("#AnnualFinancials .StatementType .StatementLinks .StatementLink").not(elem),function(){$(this).removeClass("Selected")});var annualStatementContainer=$("#AnnualFinancials .Statements"),Statement_templateUrl=Agility.ResolveUrl("~/ClientTemplates/StockDetail_FinancialReport_Statement.htm");annualStatementContainer.setTemplateURL(Statement_templateUrl),annualStatementContainer.setParam("Period",AnnualReports[parentIndex].fiscalYear),annualStatementContainer.setParam("Type",AnnualReports[parentIndex].Statements[index].Type),annualStatementContainer.processTemplate(AnnualReports[parentIndex].Statements[index])},NewStockDetails.ReportInterimClick=function(index,elem){var interimStatementLinkContainer,InterimLink_templateUrl,interimStatementContainer,Statement_templateUrl;$(elem).addClass("Selected"),$.each($("#Trailing12MonthResults .ReportPeriods .Links .ReportLink").not(elem),function(){$(this).removeClass("Selected")}),interimStatementLinkContainer=$("#Trailing12MonthResults .StatementLinks"),InterimLink_templateUrl=Agility.ResolveUrl("~/ClientTemplates/StockDetail_FinancialReport_InterimTypes.htm"),interimStatementLinkContainer.setTemplateURL(InterimLink_templateUrl),interimStatementLinkContainer.setParam("ParentIndex",index),interimStatementLinkContainer.processTemplate(InterimReports[index].Statements),interimStatementContainer=$("#Trailing12MonthResults .Statements"),Statement_templateUrl=Agility.ResolveUrl("~/ClientTemplates/StockDetail_FinancialReport_Statement.htm"),interimStatementContainer.setTemplateURL(Statement_templateUrl),interimStatementContainer.setParam("Period",BNN.Modules.NewStockDetails.FormatInterimPeriodDate(InterimReports[index].endDate)),interimStatementContainer.setParam("Type",InterimReports[index].Statements[0].Type),interimStatementContainer.processTemplate(InterimReports[index].Statements[0])},NewStockDetails.InterimStatementClick=function(index,parentIndex,elem){$(elem).addClass("Selected"),$.each($("#Trailing12MonthResults .StatementType .StatementLinks .StatementLink").not(elem),function(){$(this).removeClass("Selected")});var interimStatementContainer=$("#Trailing12MonthResults .Statements"),Statement_templateUrl=Agility.ResolveUrl("~/ClientTemplates/StockDetail_FinancialReport_Statement.htm");interimStatementContainer.setTemplateURL(Statement_templateUrl),interimStatementContainer.setParam("Period",BNN.Modules.NewStockDetails.FormatInterimPeriodDate(InterimReports[parentIndex].endDate)),interimStatementContainer.setParam("Type",InterimReports[parentIndex].Statements[index].Type),interimStatementContainer.processTemplate(InterimReports[parentIndex].Statements[index])},_resetVolumeBtn=function(){$chk=$("#chkVolume"),$chk.html("Hide
 Volume"),$chk.addClass("Selected")},NewStockDetails.FormatDate=function(dt){if(dt!=null){var fdate=new Date(parseInt(dt.replace("/Date(","").replace(")/",""),10));return fdate.getDate()+"/"+(fdate.getMonth()+1)+"/"+fdate.getFullYear()}},NewStockDetails.FormatInterimPeriodDate=function(dt){if(dt!=null){var fdate=new Date(parseInt(dt.replace("/Date(","").replace(")/",""),10)),ret_str;return fdate.getMonth()+1>=1&&fdate.getMonth()+1<3?ret_str="Q1 "+fdate.getFullYear():fdate.getMonth()+1>=3&&fdate.getMonth()+1<6?ret_str="Q2 "+fdate.getFullYear():fdate.getMonth()+1>=6&&fdate.getMonth()+1<9?ret_str="Q3 "+fdate.getFullYear():fdate.getMonth()+1>=9&&fdate.getMonth()+1<=12&&(ret_str="Q4 "+fdate.getFullYear()),ret_str}},NewStockDetails.SearchStockSymbol=function(s,cname,argObj){var cachekey="stock_cache_key_"+s,searchQuery="Symbol = '"+s+"'",searchArg={RecordTypeName:"ReutersStockFeedback",Search:searchQuery,CacheKey:cachekey,State:Agility.UGC.API.RecordState.Published};Agility.UGC.API.SearchRecords(searchArg,function(data){var exist,records,updateType;data.ResponseType==Agility.UGC.API.ResponseType.OK&&(exist=data.ResponseData!=null&&data.ResponseData.TotalRecords>0,exist?(records=data.ResponseData.Records,updateType=null,data.ResponseData.TotalRecords==1&&_updateAndDisplayFeedback(records[0],argObj,updateType,cachekey,cname)):NewStockDetails.AddStockSymbol(s,cname,cachekey,argObj))},cachekey)},NewStockDetails.AddStockSymbol=function(s,cname,cachekey,argObj){var record={ID:-1,RecordTypeName:"ReutersStockFeedback",Symbol:s,CompanyName:cname,EnableComments:!0,EnableFeedback:!0};Agility.UGC.API.SaveRecord(record,function(data){if(data.ResponseType==Agility.UGC.API.ResponseType.OK){var recordID=data.ResponseData;NewStockDetails.LoadRatings(recordID),argObj.RelatedContentID=recordID,argObj.EnableComments="True",BNN.Modules.NewComments.LoadComments(argObj),$(".Stats .StatsContainer").show("fast"),$(".Stats .Loading-Stock-UGC").hide("fast")}},cachekey)},NewStockDetails.LoadRatings=function(id){NewStockDetails.UpdateRatings(id),$(".Stats .StatsContainer .Loading-Stock-UGC").hide("fast"),$(".Stats .StatsContainer .Rate .Filter .All").addClass("Selected"),$(".Stats .StatsContainer .Rate .Filter .Today").click(function(){var edate=new Date,sdate=new Date;sdate.setHours(0,0,0,0),edate.setHours(23,59,59,0),NewStockDetails.SearchRatingFeedback(id,sdate,edate),_feedbackFlag="Today",$(this).addClass("Selected"),_removeFilterSelected($(this))}),$(".Stats .StatsContainer .Rate .Filter .ThisWeek").click(function(){var edate=new Date,sdate=new Date;sdate.setDate(sdate.getDate()-7),sdate.setHours(0,0,0,0),edate.setHours(23,59,59,0),NewStockDetails.SearchRatingFeedback(id,sdate,edate),_feedbackFlag="ThisWeek",$(this).addClass("Selected"),_removeFilterSelected($(this))}),$(".Stats .StatsContainer .Rate .Filter .OneMonth").click(function(){var edate=new Date,sdate=new Date;sdate.setMonth(sdate.getMonth()),sdate.setDate(1),sdate.setHours(0,0,0,0),edate.setHours(23,59,59,0),NewStockDetails.SearchRatingFeedback(id,sdate,edate),_feedbackFlag="OneMonth",$(this).addClass("Selected"),_removeFilterSelected($(this))}),$(".Stats .StatsContainer .Rate .Filter .SixMonths").click(function(){var edate=new Date,sdate=new Date;sdate.setMonth(sdate.getMonth()-6),sdate.setHours(0,0,0,0),edate.setHours(23,59,59,0),NewStockDetails.SearchRatingFeedback(id,sdate,edate),_feedbackFlag="SixMonths",$(this).addClass("Selected"),_removeFilterSelected($(this))}),$(".Stats .StatsContainer .Rate .Filter .All").click(function(){NewStockDetails.SearchRatingFeedback(id,null,null),_feedbackFlag="All",$(this).addClass("Selected"),_removeFilterSelected($(this))})},NewStockDetails.UpdateRatings=function(id){var edate=new Date,sdate=new Date;switch(_feedbackFlag){case"Today":sdate.setHours(0,0,0,0),edate.setHours(23,59,59,0),NewStockDetails.SearchRatingFeedback(id,sdate,edate);break;case"ThisWeek":sdate.setDate(sdate.getDate()-7),sdate.setHours(0,0,0,0),edate.setHours(23,59,59,0),NewStockDetails.SearchRatingFeedback(id,sdate,edate);break;case"OneMonth":sdate.setMonth(sdate.getMonth()-1),sdate.setHours(0,0,0,0),edate.setHours(23,59,59,0),NewStockDetails.SearchRatingFeedback(id,sdate,edate);break;case"SixMonths":sdate.setMonth(sdate.getMonth()-6),sdate.setHours(0,0,0,0),edate.setHours(23,59,59,0),NewStockDetails.SearchRatingFeedback(id,sdate,edate);break;case"All":NewStockDetails.SearchRatingFeedback(id,null,null);break;default:NewStockDetails.SearchRatingFeedback(id,null,null)}},NewStockDetails.SearchRatingFeedback=function(id,sdate,edate){var ratingsSearch,ratingsCountSearch;_rating=0,ratingsSearch=new Agility.UGC.API.FeedbackSearchArg,ratingsSearch.ReferenceName="ReutersStockFeedback",ratingsSearch.ContentType=Agility.UGC.API.FeedbackContentType.UGC,ratingsSearch.SubmissionType=Agility.UGC.API.FeedbackSubmissionType.Rating,ratingsSearch.RelatedContentIDs=[id],ratingsSearch.StartDate=sdate?"/Date("+Date.UTC(sdate.getFullYear(),sdate.getMonth(),sdate.getDate(),sdate.getHours(),sdate.getMinutes(),sdate.getSeconds(),0)+")/":null,ratingsSearch.EndDate=edate?"/Date("+Date.UTC(edate.getFullYear(),edate.getMonth(),edate.getDate(),edate.getHours(),edate.getMinutes(),edate.getSeconds(),0)+")/":null,ratingsSearch.Action=Agility.UGC.API.AggregateTypes.Average,ratingsCountSearch=new Agility.UGC.API.FeedbackSearchArg,ratingsCountSearch.ReferenceName="ReutersStockFeedback",ratingsCountSearch.ContentType=Agility.UGC.API.FeedbackContentType.UGC,ratingsCountSearch.SubmissionType=Agility.UGC.API.FeedbackSubmissionType.Rating,ratingsCountSearch.RelatedContentIDs=[id],ratingsCountSearch.StartDate=sdate?"/Date("+Date.UTC(sdate.getFullYear(),sdate.getMonth(),sdate.getDate(),sdate.getHours(),sdate.getMinutes(),sdate.getSeconds(),0)+")/":null,ratingsCountSearch.EndDate=edate?"/Date("+Date.UTC(edate.getFullYear(),edate.getMonth(),edate.getDate(),edate.getHours(),edate.getMinutes(),edate.getSeconds(),0)+")/":null,ratingsCountSearch.Action=Agility.UGC.API.AggregateTypes.Count,Agility.UGC.API.GetFeedbackAggregate(ratingsSearch,function(data){var result,text_rating;data.ResponseType==0&&(result=data.ResponseData.length>0?data.ResponseData[0].Result:0,_rating=Math.round(Number(result*10)),text_rating=_getRating(_rating,"new"),$(".Stats .StatsContainer .Rate .Votes").html("Total Ratings: 0 "),$(".Stats .StatsContainer .Rate .Label").html(" | Avg: "+text_rating.textRating).addClass(text_rating.cssclass),NewStockDetails.InitSlider(result,id))}),Agility.UGC.API.GetFeedbackAggregate(ratingsCountSearch,function(data){if(data.ResponseType==0){var result=data.ResponseData.length>0?data.ResponseData[0].Result:0;$(".Stats .StatsContainer .Rate .Votes").html("Total Ratings: "+result+" ")}})},NewStockDetails.InitSlider=function(result,id){$(".Stats .StatsContainer .Rate #ratingSlider").slider({min:0,max:10,value:result,range:"min",animate:"slow",create:function(){if($.cookie("BNNStockRating_"+id)){$(".Stats .StatsContainer .Rate #ratingSlider").slider("option","disabled",!0);var text_rating=_getRating($.cookie("BNNStockRating_"+id),null);$(".Stats .StatsContainer .Rate .Result").html("YOU RATED:"+text_rating.textRating).addClass(text_rating.cssclass)}},stop:function(){var rating,ratingFeedback,fnl_rating;$.cookie("BNNStockRating_"+id)?$(".Stats .StatsContainer .Rate #ratingSlider").slider("option","disabled",!0):(rating=$(this).slider("value"),ratingFeedback=new Agility.UGC.API.RatingFeedback,ratingFeedback.ReferenceName="ReutersStockFeedback",ratingFeedback.ContentType=Agility.UGC.API.FeedbackContentType.UGC,ratingFeedback.RelatedContentID=id,ratingFeedback.RatingValue=rating,fnl_rating=Math.round(Number(rating*10)),Agility.UGC.API.SaveRating(ratingFeedback,function(data){if(data.ResponseType==0){NewStockDetails.UpdateRatings(id);var text_rating=_getRating(fnl_rating,null);$(".Stats .StatsContainer .Rate .Result").html("YOU RATED:"+text_rating.textRating).addClass(text_rating.cssclass),$.cookie("BNNStockRating_"+id,fnl_rating,!0),$(".Stats .StatsContainer .Rate #ratingSlider").slider("option","disabled",!0)}}))}})},NewStockDetails.UpdateStockSymbol=function(record,updateType,cachekey){Agility.UGC.API.SaveRecord(record,function(data){if(data.ResponseType==Agility.UGC.API.ResponseType.OK)var recordID=data.ResponseData},cachekey)},NewStockDetails.ShowSummary=function(){$("#StockDetails .StockQuote .Summary").show(),$("#StockDetails .StockQuote .Info").hide(),$("#StockDetails .StockQuote .Financials").hide(),$("#StockDetails .StockQuote .News").hide(),$("#StockDetails .StockQuote .Videos").hide(),$("#StockDetails .StockQuote .Blogs").hide(),$("#StockDetails .StockQuote .Picks").hide(),$("#SummaryTab").addClass("Selected"),$("#InfoTab").removeClass("Selected"),$("#FinancialsTab").removeClass("Selected"),$("#NewsTab").removeClass("Selected"),$("#VideosTab").removeClass("Selected"),$("#BlogsTab").removeClass("Selected"),$("#PicksTab").removeClass("Selected")},NewStockDetails.ShowInfo=function(){$("#StockDetails .StockQuote .Summary").hide(),$("#StockDetails .StockQuote .Info").show(),$("#StockDetails .StockQuote .Financials").hide(),$("#StockDetails .StockQuote .News").hide(),$("#StockDetails .StockQuote .Videos").hide(),$("#StockDetails .StockQuote .Blogs").hide(),$("#StockDetails .StockQuote .Picks").hide(),$("#SummaryTab").removeClass("Selected"),$("#InfoTab").addClass("Selected"),$("#FinancialsTab").removeClass("Selected"),$("#NewsTab").removeClass("Selected"),$("#VideosTab").removeClass("Selected"),$("#BlogsTab").removeClass("Selected"),$("#PicksTab").removeClass("Selected")},NewStockDetails.ShowFinancials=function(){$("#StockDetails .StockQuote .Summary").hide(),$("#StockDetails .StockQuote .Info").hide(),$("#StockDetails .StockQuote .Financials").show(),$("#StockDetails .StockQuote .News").hide(),$("#StockDetails .StockQuote .Videos").hide(),$("#StockDetails .StockQuote .Blogs").hide(),$("#StockDetails .StockQuote .Picks").hide(),$("#SummaryTab").removeClass("Selected"),$("#InfoTab").removeClass("Selected"),$("#Financi
alsTab").addClass("Selected"),$("#NewsTab").removeClass("Selected"),$("#VideosTab").removeClass("Selected"),$("#BlogsTab").removeClass("Selected"),$("#PicksTab").removeClass("Selected")},NewStockDetails.ShowNews=function(){$("#StockDetails .StockQuote .Summary").hide(),$("#StockDetails .StockQuote .Info").hide(),$("#StockDetails .StockQuote .Financials").hide(),$("#StockDetails .StockQuote .News").show(),$("#StockDetails .StockQuote .Videos").hide(),$("#StockDetails .StockQuote .Blogs").hide(),$("#StockDetails .StockQuote .Picks").hide(),$("#SummaryTab").removeClass("Selected"),$("#InfoTab").removeClass("Selected"),$("#FinancialsTab").removeClass("Selected"),$("#NewsTab").addClass("Selected"),$("#VideosTab").removeClass("Selected"),$("#BlogsTab").removeClass("Selected"),$("#PicksTab").removeClass("Selected")},NewStockDetails.ShowVideos=function(){$("#StockDetails .StockQuote .Summary").hide(),$("#StockDetails .StockQuote .Info").hide(),$("#StockDetails .StockQuote .Financials").hide(),$("#StockDetails .StockQuote .News").hide(),$("#StockDetails .StockQuote .Videos").show(),$("#StockDetails .StockQuote .Blogs").hide(),$("#StockDetails .StockQuote .Picks").hide(),$("#SummaryTab").removeClass("Selected"),$("#InfoTab").removeClass("Selected"),$("#FinancialsTab").removeClass("Selected"),$("#NewsTab").removeClass("Selected"),$("#VideosTab").addClass("Selected"),$("#BlogsTab").removeClass("Selected"),$("#PicksTab").removeClass("Selected")},NewStockDetails.ShowBlogs=function(){$("#StockDetails .StockQuote .Summary").hide(),$("#StockDetails .StockQuote .Info").hide(),$("#StockDetails .StockQuote .Financials").hide(),$("#StockDetails .StockQuote .News").hide(),$("#StockDetails .StockQuote .Videos").hide(),$("#StockDetails .StockQuote .Blogs").show(),$("#StockDetails .StockQuote .Picks").hide(),$("#SummaryTab").removeClass("Selected"),$("#InfoTab").removeClass("Selected"),$("#FinancialsTab").removeClass("Selected"),$("#NewsTab").removeClass("Selected"),$("#VideosTab").removeClass("Selected"),$("#BlogsTab").addClass("Selected"),$("#PicksTab").removeClass("Selected")},NewStockDetails.ShowPicks=function(){$("#StockDetails .StockQuote .Summary").hide(),$("#StockDetails .StockQuote .Info").hide(),$("#StockDetails .StockQuote .Financials").hide(),$("#StockDetails .StockQuote .News").hide(),$("#StockDetails .StockQuote .Videos").hide(),$("#StockDetails .StockQuote .Blogs").hide(),$("#StockDetails .StockQuote .Picks").show(),$("#SummaryTab").removeClass("Selected"),$("#InfoTab").removeClass("Selected"),$("#FinancialsTab").removeClass("Selected"),$("#NewsTab").removeClass("Selected"),$("#VideosTab").removeClass("Selected"),$("#BlogsTab").removeClass("Selected"),$("#PicksTab").addClass("Selected")},NewStockDetails.GetDateFromLink=function(url){if(url!=null||url!=""){var parts=url.split("/");return parts[5]+"/"+parts[6]+"/"+parts[4]}},_removeFilterSelected=function(elem){$.each($(".Stats .StatsContainer .Rate .Filter div").not(elem),function(){$(this).removeClass("Selected")})},_renderTip=function(){$(".Stats .StatsContainer .Rate .help").tooltip({effect:"slide",position:"bottom right",offset:[-20,0]}),$(".Stats .Stock-Comments .help").tooltip({effect:"slide",position:"bottom right",offset:[-20,0]})},_trimSymbol=function(str){return str.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},_getRating=function(rating,type){return resObj={},rating>=0&&rating<=33?resObj={textRating:"SELL",cssclass:"Negative"}:rating>33&&rating<=66?resObj={textRating:"HOLD",cssclass:"Neutral"}:rating>66&&(resObj={textRating:"BUY",cssclass:"Positive"}),type=="new"&&rating==0&&(resObj={textRating:"NONE",cssclass:"Neutral"}),resObj},_getCssClass=function(val){var positive=val!=null&&val!=""&&val.indexOf("-")!=0;return val=="0"||val==""?"Neutral":positive?"Positive":"Negative"},_formatPriceInfo=function(val){return val!=null&&val!=""?_addCommas(_keepTwoDecimals(_addZero(_removeSign(val)))):val},_removeSign=function(val){return val.indexOf("-")==0?val.substring(1):val.indexOf("+")==0?val.substring(1):val},_addCommas=function(val){for(var regEx=/(\d+)(\d{3})/;regEx.test(val);)val=val.replace(regEx,"$1,$2");return val},_keepTwoDecimals=function(val){var tmpFloat=Math.round(100*parseFloat(val))/100;return tmpFloat.toString()},_addZero=function(val){return val.indexOf(".")==0?"0"+val:val.indexOf("-.")==0?"-0"+val.substring(1):val.indexOf("+.")==0?"+0"+val.substring(1):val},_processStockDetailsPeriodTemplate=function(data){var container=$("#StockDetails .StockQuote .Summary .ChartFooter .Periods"),templateUrl=Agility.ResolveUrl("~/ClientTemplates/NewStockDetailsPeriods.htm");container.setTemplateURL(templateUrl),container.processTemplate(data)},_processStockDetailsFlotPeriodTemplate=function(data){var container=$("#StockDetails .StockQuote .Summary .ChartFooter .FlotPeriods"),templateUrl=Agility.ResolveUrl("~/ClientTemplates/NewStockDetailsFlotPeriods.htm");container.setTemplateURL(templateUrl),container.processTemplate(data)},_NewmarketDetailsPeriodDivClick=function(event){var obj=event.srcElement!=undefined?event.srcElement:event.originalTarget!=undefined?event.originalTarget:event.target,period;$("#StockDetails .StockQuote .Summary .ChartFooter .Periods div").each(function(index,item){$(item).removeClass("Selected")}),$(obj).addClass("Selected"),period=$(obj).attr("data"),_populateStockChart(symbol,period)},_NewmarketDetailsFlotPeriodDivClick=function(event){var obj=event.srcElement!=undefined?event.srcElement:event.originalTarget!=undefined?event.originalTarget:event.target,period;$("#StockDetails .StockQuote .Summary .ChartFooter .FlotPeriods div").each(function(index,item){$(item).removeClass("Selected")}),$(obj).addClass("Selected"),period=$(obj).attr("data"),period=="INTRA"?BNN.Controls.TimeSeriesChart.StoryDetailStockChart("#highStockContainer",quote,"1day",!1):period=="I5D5M"?BNN.Controls.TimeSeriesChart.StoryDetailStockChart("#highStockContainer",quote,"5day",!1):period=="OneYRD"&&BNN.Controls.TimeSeriesChart.StoryDetailStockChart("#highStockContainer",quote,"1year",!1)},_populateStockChart=function(symbol,period){$.getJSON(MarketDataServiceUrl+"/GetReutersChartUrl?symbol="+symbol+"&period="+period+"",function(result){var priceChartHtml="<img src='/Handlers/ChartHandler.ashx/"+result+"' id='chart1' />";$("#StockDetails .StockQuote .Summary .PriceChart").html(priceChartHtml)})},_trimSymbol=function(str){return str.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},_updateAndDisplayFeedback=function(record,argObj,updateType,ck,cname){var enableComments,enableFeedback,record;recordID=record.ID,enableComments=record.EnableComments,enableFeedback=record.EnableFeedback,argObj.RelatedContentID=recordID,argObj.EnableComments=enableComments,name=record.CompanyName,symb=record.Symbol,name=="n/a"&&(updateType=1),symb!=symb&&(updateType=2),name=="n/a"&&symb!=symb&&(updateType=3);switch(updateType){case 1:record={ID:recordID,RecordTypeName:"ReutersStockFeedback",CompanyName:cname},NewStockDetails.UpdateStockSymbol(record,updateType,ck);break;case 2:record={ID:recordID,RecordTypeName:"ReutersStockFeedback",Symbol:symb},NewStockDetails.UpdateStockSymbol(record,updateType,ck);break;case 3:record={ID:recordID,RecordTypeName:"ReutersStockFeedback",CompanyName:cname,Symbol:symb},NewStockDetails.UpdateStockSymbol(record,updateType,ck)}enableFeedback=="True"?(NewStockDetails.LoadRatings(recordID),$(".Stats .StatsContainer").show("fast"),$("#blocks").removeClass("BlocksLoading"),$("#blocks").addClass("Blocks"),$(".Stats .Loading-Stock-UGC").hide("fast")):$(".Stats .Loading-Stock-UGC").hide("fast"),enableComments&&BNN.Modules.NewComments.LoadComments(argObj)}})(BNN.Modules.NewStockDetails),function($){$.fn.extend({StockCookieList:function(cookieName){var cookie=$.cookie(cookieName),items=cookie?eval("(['"+cookie+"'])"):[];return{add:function(val){var index=items.indexOf(val);index==-1&&(items.push(val),$.cookie(cookieName,items.join(","),{expires:365,path:"/"}))},remove:function(){var tmp=items[0].split(",");tmp.shift(),items=tmp,$.cookie(cookieName,items.join(","),{expires:365,path:"/"})},indexOf:function(val){return items.indexOf(val)},clear:function(){items=null,$.cookie(cookieName,null,{expires:365,path:"/"})},items:function(){return items},length:function(){if(items.length>0){var tmp=items[0].split(",");return tmp.length}return items.length},join:function(separator){return items.join(separator)},contains:function(val){Array.prototype.indexOf||(Array.prototype.indexOf=function(obj,start){for(var i=start||0,j=this.length;i<j;i++)if(this[i]===obj)return i;return-1});var indx=items.join(",").indexOf(val);return indx>-1?!0:!1}}}})}(jQuery);
Agility.RegisterNamespace("BNN.Modules.StockFeedbackResults"),function(StockFeedbackResults){var _feedbackFlag="All",_allowRatings=null,_ratingTooltip=null,_allowLikes;StockFeedbackResults.OnInit=function(parameters,commentArgs){var argObj={PageSize:commentArgs.PageSize,RecordOffset:0,SortedField:"CreatedOn",SortDirection:"asc",Columns:["Name","Comment","ParentRecordID","RelatedContentID","FacebookID"],onSubmitComment:BNN.Modules.NewComments.SubmitComment,onEmptyComments:BNN.Modules.NewComments.onEmptyComments,onFlagOffensive:BNN.Modules.NewComments.onFlagOffensive,onCommentSubmitComplete:BNN.Modules.NewComments.onCommentSubmitComplete,CommentContainer:commentArgs.CommentContainer,CommentCountContainer:commentArgs.CommentCountContainer},sl;$.extend(argObj,commentArgs),sl=StockFeedbackResults.generateArray(parameters),$container=$(".StockFeedbackResults .StockItemContainer"),$container.hasTemplate()||($container.setTemplateURL(Agility.ResolveUrl("~/ClientTemplates/StockFeedbackResults.htm")),_allowLikes==!1?$container.setParam("commentsize","Big"):$container.setParam("commentsize",null)),$container.processTemplate(sl),$(sl).each(function(index,value){argObj.RelatedContentID=value.id,argObj.isStockFeedback=!0,argObj.EnableComments="True",argObj.CommentContainer="#Comments_"+value.id,argObj.CommentCountContainer="#Stock-Comments_"+value.id,BNN.Modules.NewComments.LoadComments(argObj),StockFeedbackResults.getStockQuote(value.symbol,value.id),StockFeedbackResults.UpdateRatings(value.id),$("a#divClick_"+value.id).fancybox({hideOnContentClick:!1,type:"inline",onClosed:function(){var t=setTimeout("$('#sffbox').trigger('click');",5)}}),_allowRatings&&($("#stockItem_"+value.id+" .Blocks").attr("style","cursor: pointer"),$("#stockItem_"+value.id+" .help").show(),$("#stockItem_"+value.id+" .help").tooltip2({track:!0,delay:1,showURL:!1,fixPNG:!0,top:-20,left:10,showBody:" - ",extraClass:"tooltip_2"})),StockFeedbackResults.InitLikes(value.id)}),StockFeedbackResults.bindSortEvents(sl),$(".StockFeedbackResults .Filter .All").addClass("Selected"),$(".StockFeedbackResults .Filter .Today").click(function(){_feedbackFlag="Today",$(sl).each(function(index,value){StockFeedbackResults.UpdateRatings(value.id)}),$(this).addClass("Selected"),StockFeedbackResults.removeFilterSelected($(this))}),$(".StockFeedbackResults .Filter .OneMonth").click(function(){_feedbackFlag="OneMonth",$(sl).each(function(index,value){StockFeedbackResults.UpdateRatings(value.id)}),$(this).addClass("Selected"),StockFeedbackResults.removeFilterSelected($(this))}),$(".StockFeedbackResults .Filter .SixMonths").click(function(){_feedbackFlag="SixMonths",$(sl).each(function(index,value){StockFeedbackResults.UpdateRatings(value.id)}),$(this).addClass("Selected"),StockFeedbackResults.removeFilterSelected($(this))}),$(".StockFeedbackResults .Filter .All").click(function(){_feedbackFlag="All",$(sl).each(function(index,value){StockFeedbackResults.UpdateRatings(value.id)}),$(this).addClass("Selected"),StockFeedbackResults.removeFilterSelected($(this))})},StockFeedbackResults.UpdateRatings=function(id){var edate=new Date,sdate=new Date;$ctnr=$(".StockFeedbackResults .StockItemContainer #stockItem_"+id+" .Blocks");switch(_feedbackFlag){case"Today":sdate.setHours(0,0,0,0),edate.setHours(23,59,59,0),StockFeedbackResults.SearchRatingFeedback(id,$ctnr,sdate,edate),StockFeedbackResults.SearchFeedback(id,!0,$("#stockItem_"+id+" .Like"),sdate,edate),StockFeedbackResults.SearchFeedback(id,!1,$("#stockItem_"+id+" .DisLike"),sdate,edate);break;case"ThisWeek":sdate.setDate(sdate.getDate()-7),sdate.setHours(0,0,0,0),edate.setHours(23,59,59,0),StockFeedbackResultsBig.SearchRatingFeedback(id,$ctnr,sdate,edate),StockFeedbackResultsBig.SearchFeedback(id,!0,$("#stockItem_"+id+" .Like"),sdate,edate),StockFeedbackResultsBig.SearchFeedback(id,!1,$("#stockItem_"+id+" .DisLike"),sdate,edate);break;case"OneMonth":sdate.setMonth(sdate.getMonth()),sdate.setDate(1),sdate.setHours(0,0,0,0),edate.setHours(23,59,59,0),StockFeedbackResults.SearchRatingFeedback(id,$ctnr,sdate,edate),StockFeedbackResults.SearchFeedback(id,!0,$("#stockItem_"+id+" .Like"),sdate,edate),StockFeedbackResults.SearchFeedback(id,!1,$("#stockItem_"+id+" .DisLike"),sdate,edate);break;case"SixMonths":sdate.setMonth(sdate.getMonth()-6),sdate.setHours(0,0,0,0),edate.setHours(23,59,59,0),StockFeedbackResults.SearchRatingFeedback(id,$ctnr,sdate,edate),StockFeedbackResults.SearchFeedback(id,!0,$("#stockItem_"+id+" .Like"),sdate,edate),StockFeedbackResults.SearchFeedback(id,!1,$("#stockItem_"+id+" .DisLike"),sdate,edate);break;case"All":StockFeedbackResults.SearchRatingFeedback(id,$ctnr,null,null),StockFeedbackResults.SearchFeedback(id,!0,$("#stockItem_"+id+" .Like"),null,null),StockFeedbackResults.SearchFeedback(id,!1,$("#stockItem_"+id+" .DisLike"),null,null);break;default:StockFeedbackResults.SearchRatingFeedback(id,$ctnr,null,null),StockFeedbackResults.SearchFeedback(id,!0,$("#stockItem_"+id+" .Like"),null,null),StockFeedbackResults.SearchFeedback(id,!1,$("#stockItem_"+id+" .DisLike"),null,null)}},StockFeedbackResults.SearchRatingFeedback=function(id,container,sdate,edate){var ratingsSearch,ratingsCountSearch;_rating=0,ratingsSearch=new Agility.UGC.API.FeedbackSearchArg,ratingsSearch.ReferenceName="StockFeedback",ratingsSearch.ContentType=Agility.UGC.API.FeedbackContentType.UGC,ratingsSearch.SubmissionType=Agility.UGC.API.FeedbackSubmissionType.Rating,ratingsSearch.RelatedContentIDs=[id],ratingsSearch.StartDate=sdate?"/Date("+Date.UTC(sdate.getFullYear(),sdate.getMonth(),sdate.getDate(),sdate.getHours(),sdate.getMinutes(),sdate.getSeconds(),0)+")/":null,ratingsSearch.EndDate=edate?"/Date("+Date.UTC(edate.getFullYear(),edate.getMonth(),edate.getDate(),edate.getHours(),edate.getMinutes(),edate.getSeconds(),0)+")/":null,ratingsSearch.Action=Agility.UGC.API.AggregateTypes.Average,ratingsCountSearch=new Agility.UGC.API.FeedbackSearchArg,ratingsCountSearch.ReferenceName="StockFeedback",ratingsCountSearch.ContentType=Agility.UGC.API.FeedbackContentType.UGC,ratingsCountSearch.SubmissionType=Agility.UGC.API.FeedbackSubmissionType.Rating,ratingsCountSearch.RelatedContentIDs=[id],ratingsCountSearch.StartDate=sdate?"/Date("+Date.UTC(sdate.getFullYear(),sdate.getMonth(),sdate.getDate(),sdate.getHours(),sdate.getMinutes(),sdate.getSeconds(),0)+")/":null,ratingsCountSearch.EndDate=edate?"/Date("+Date.UTC(edate.getFullYear(),edate.getMonth(),edate.getDate(),edate.getHours(),edate.getMinutes(),edate.getSeconds(),0)+")/":null,ratingsCountSearch.Action=Agility.UGC.API.AggregateTypes.Count,Agility.UGC.API.GetFeedbackAggregate(ratingsSearch,function(data){var result,text_rating;data.ResponseType==0&&(result=data.ResponseData.length>0?data.ResponseData[0].Result:0,_rating=Math.round(Number(result*10)),text_rating=StockFeedbackResults.getRating(_rating,"new"),$("#stockItem_"+id+" .avg").html("avg:"+text_rating.textRating).addClass(text_rating.cssclass),StockFeedbackResults.InitSlider(result,id))}),Agility.UGC.API.GetFeedbackAggregate(ratingsCountSearch,function(data){if(data.ResponseType==0){var result=data.ResponseData.length>0?data.ResponseData[0].Result:0;$("#stockItem_"+id+" .votes").html("Total Ratings: "+result)}})},StockFeedbackResults.addFeedback=function(id,isPositive,container){var ApprovalFeedback=new Agility.UGC.API.BooleanFeedback,target;ApprovalFeedback.ReferenceName="StockFeedback",ApprovalFeedback.ContentType=Agility.UGC.API.FeedbackContentType.UGC,ApprovalFeedback.RelatedContentID=id,target=$(".likeResult",container),Agility.UGC.API.SaveApproveDisapprove(ApprovalFeedback,isPositive,function(data){if(data.ResponseType==Agility.UGC.API.ResponseType.OK){var currentLabel=$(target).html(),currentCount=Number(currentLabel);$(target).html(" "+(currentCount+1)+" "),$.cookie("BNNStockApproval_"+id,!0),$("#stockItem_"+id+" .likeContainer").addClass("disabled")}})},StockFeedbackResults.SearchFeedback=function(id,isPositive,container,sdate,edate){var $result=$(".likeResult",container),feedbackSearch=new Agility.UGC.API.FeedbackSearchArg;feedbackSearch.ReferenceName="StockFeedback",feedbackSearch.ContentType=Agility.UGC.API.FeedbackContentType.UGC,feedbackSearch.SubmissionType=Agility.UGC.API.FeedbackSubmissionType.ApproveDisapprove,feedbackSearch.StartDate=sdate?"/Date("+Date.UTC(sdate.getFullYear(),sdate.getMonth(),sdate.getDate(),sdate.getHours(),sdate.getMinutes(),sdate.getSeconds(),0)+")/":null,feedbackSearch.EndDate=edate?"/Date("+Date.UTC(edate.getFullYear(),edate.getMonth(),edate.getDate(),edate.getHours(),edate.getMinutes(),edate.getSeconds(),0)+")/":null,feedbackSearch.RelatedContentIDs=[id],feedbackSearch.IsPositive=isPositive,feedbackSearch.Action=Agility.UGC.API.AggregateTypes.Count,Agility.UGC.API.GetFeedbackAggregate(feedbackSearch,function(data){if(data.ResponseType==0){var tmp=data.ResponseData.length>0?data.ResponseData[0].Result:0;$result.html(" "+tmp+" "),$.cookie("BNNStockApproval_"+id)?$("#stockItem_"+id+" .likeContainer").addClass("disabled"):$("#stockItem_"+id+" .likeContainer").removeClass("disabled")}})},StockFeedbackResults.GetLikeImage=function(){return"<img src="+Agility.ResolveUrl("~/Images/Icons/new_like_small.png")+" alt='' width='20px' height='35px' />"},StockFeedbackResults.GetDisLikeImage=function(){return"<img src="+Agility.ResolveUrl("~/Images/Icons/new_dislike_small.png")+" alt='' width='20px' height='35px' />"},StockFeedbackResults.GetRatingToolTip=function(){return _ratingTooltip},StockFeedbackResults.removeFilterSelected=function(elem){$.each($(".StockFeedbackResults .Filter div").not(elem),function(){$(this).removeClass("Selected")})},StockFeedbackResults.generateArray=function(p){var tmp_symbols=p.StockSymbols,tmp_ids=p.StockIDs,tmp_cnames=p.CompanyNames,i,stockInfo;_ratingTooltip=p.RatingTooltip,_allowRatings=p.AllowRating=="True"?!0:!1,_allowLikes=p.AllowLikeDislike=="True"?!0:!1,tmp_ids=tmp_ids.slice(0,tmp_ids.length-1),tmp_symbols=tmp_symbols.slice(0,tmp_symbols.length-1),tmp_cnames=tmp_cnames.slice(0,tm
p_cnames.length-1);var ids=tmp_ids.split(","),symbols=tmp_symbols.split(","),cnames=tmp_cnames.split(","),len=ids.length,stockList=[];for(i=0;i<len;i++)stockInfo={id:ids[i],symbol:symbols[i],name:cnames[i]},stockList[i]=stockInfo;return stockList},StockFeedbackResults.InitLikes=function(id){_allowLikes?($("#stockItem_"+id+" .likeContainer").show(),$("#Stock-Comments_"+id).addClass("Stock-CommentsRight"),$("#stockItem_"+id+" .Like").click(function(){$.cookie("BNNStockApproval_"+id)||StockFeedbackResults.addFeedback(id,!0,$(this))}),$("#stockItem_"+id+" .DisLike").click(function(){$.cookie("BNNStockApproval_"+id)||StockFeedbackResults.addFeedback(id,!1,$(this))}),$(".stockItem .LikeLabel").show(),$(".stockItem .DisLikeLabel").show()):($("#stockItem_"+id+" .likeContainer").hide(),$("#Stock-Comments_"+id).addClass("Stock-CommentsLeft"),$(".stockItem .LikeLabel").hide(),$(".stockItem .DisLikeLabel").hide())},StockFeedbackResults.getStockQuote=function(s,id){$.getJSON(MarketDataServiceUrl+"/GetStockQuote?symbol="+s+"",function(result){var cssClass,last,change,temp;result!=undefined&&(cssClass=_getCssClass(result.NetChange),last=_formatPriceInfo(result.Last),last=last!=null&&last!=""?"$"+last:last,$("#stockItem_"+id+" .Quote .Last").addClass(cssClass).text(last),temp=_formatPriceInfo(result.NetChange),change=result.NetChange.indexOf("-")==0?"-$"+result.NetChange.substring(1):result.NetChange==0?"$"+result.NetChange:"+$"+result.NetChange,change.indexOf(".")==2&&(change=change.substring(0,2)+"0"+change.substring(2)),$("#stockItem_"+id+" .Quote .NetChange").addClass(cssClass).text(change))})},StockFeedbackResults.InitSlider=function(result,id){$("#stockItem_"+id+" .sliderContainer .ratingSlider").slider({min:0,max:10,value:result,range:"min",animate:!0,create:function(){console.log("Init Create Slider: "+id),$.cookie("BNNStockRating_"+id)&&$("#stockItem_"+id+" .sliderContainer .ratingSlider").slider("option","disabled",!0)},stop:function(){var rating,ratingFeedback,fnl_rating;$.cookie("BNNStockRating_"+id)?$("#stockItem_"+id+" .sliderContainer .ratingSlider").slider("option","disabled",!0):(rating=$(this).slider("value"),ratingFeedback=new Agility.UGC.API.RatingFeedback,ratingFeedback.ReferenceName="StockFeedback",ratingFeedback.ContentType=Agility.UGC.API.FeedbackContentType.UGC,ratingFeedback.RelatedContentID=id,ratingFeedback.RatingValue=rating,fnl_rating=Math.round(Number(rating*10)),Agility.UGC.API.SaveRating(ratingFeedback,function(data){if(data.ResponseType==0){StockFeedbackResults.UpdateRatings(id);var text_rating=StockFeedbackResults.getRating(fnl_rating,null);$("#stockItem_"+id+" .result").html("YOU RATED:"+text_rating.textRating).addClass(text_rating.cssclass),$.cookie("BNNStockRating_"+id,!0),$("#stockItem_"+id+" .sliderContainer .ratingSlider").slider("option","disabled",!0)}}))}})},StockFeedbackResults.bindSortEvents=function(stl){$(".StockFeedbackResults .Filter .All").addClass("Selected"),$(".StockFeedbackResults .Filter .Today").click(function(){_feedbackFlag="Today",$(stl).each(function(index,value){StockFeedbackResults.UpdateRatings(value.id)}),$(this).addClass("Selected"),StockFeedbackResults.removeFilterSelected($(this))}),$(".StockFeedbackResultsBig .Filter .ThisWeek").click(function(){_feedbackFlag="ThisWeek",$(stockList).each(function(index,value){StockFeedbackResultsBig.UpdateRatings(value.id)}),$(this).addClass("Selected"),removeFilterSelected($(this))}),$(".StockFeedbackResults .Filter .OneMonth").click(function(){_feedbackFlag="OneMonth",$(stl).each(function(index,value){StockFeedbackResults.UpdateRatings(value.id)}),$(this).addClass("Selected"),StockFeedbackResults.removeFilterSelected($(this))}),$(".StockFeedbackResults .Filter .SixMonths").click(function(){_feedbackFlag="SixMonths",$(stl).each(function(index,value){StockFeedbackResults.UpdateRatings(value.id)}),$(this).addClass("Selected"),StockFeedbackResults.removeFilterSelected($(this))}),$(".StockFeedbackResults .Filter .All").click(function(){_feedbackFlag="All",$(stl).each(function(index,value){StockFeedbackResults.UpdateRatings(value.id)}),$(this).addClass("Selected"),StockFeedbackResults.removeFilterSelected($(this))})},StockFeedbackResults.getRating=function(rating,type){return resObj={},rating>=0&&rating<=33?resObj={textRating:"SELL",cssclass:"Negative"}:rating>33&&rating<=66?resObj={textRating:"HOLD",cssclass:"Neutral"}:rating>66&&(resObj={textRating:"BUY",cssclass:"Positive"}),type=="new"&&rating==0&&(resObj={textRating:"NONE",cssclass:"Neutral"}),resObj}}(BNN.Modules.StockFeedbackResults);
Agility.RegisterNamespace("BNN.Modules.StockFeedbackResultsBig"),function(StockFeedbackResultsBig){function removeFilterSelected(elem){$.each($(".StockFeedbackResultsBig .Filter div").not(elem),function(){$(this).removeClass("Selected")})}function SortByName(a,b){var aName=a.name.toLowerCase(),bName=b.name.toLowerCase();return aName<bName?-1:aName>bName?1:0}var _feedbackFlag="Today",_allowRatings=null,_ratingTooltip=null,_allowLikes,_containerClass,_globalIds;StockFeedbackResultsBig.OnInit=function(parameters,commentArgs){var argObj={PageSize:commentArgs.PageSize,RecordOffset:0,SortedField:"CreatedOn",SortDirection:"asc",Columns:["Name","Comment","ParentRecordID","RelatedContentID","FacebookID"],onSubmitComment:BNN.Modules.NewComments.SubmitComment,onEmptyComments:BNN.Modules.NewComments.onEmptyComments,onFlagOffensive:BNN.Modules.NewComments.onFlagOffensive,onCommentSubmitComplete:BNN.Modules.NewComments.onCommentSubmitComplete,CommentContainer:commentArgs.CommentContainer,CommentCountContainer:commentArgs.CommentCountContainer},sl;$.extend(argObj,commentArgs),sl=StockFeedbackResultsBig.GenerateArray(parameters),$container=$(".StockFeedbackResultsBig .StockItemBigContainer"),$container.hasTemplate()||$container.setTemplateURL(Agility.ResolveUrl("~/ClientTemplates/StockFeedbackResultsBig.htm")),$container.processTemplate(sl),_globalIds=parameters.StockIDs.replace(/,(?=[^,]*$)/,"").split(","),StockFeedbackResultsBig.UpdateNewRatings(_globalIds),$(sl).each(function(index,value){$("a#divClick_"+value.id).fancybox({hideOnContentClick:!1,width:650,onClosed:function(){var t=setTimeout("$('#sffbox').trigger('click');",5)},onStart:function(){argObj.RelatedContentID=value.id,argObj.isStockFeedback=!0,argObj.EnableComments="True",argObj.CommentTitle="Comments For "+value.name+" ("+value.symbol+")",argObj.CommentContainer="#Comments_"+value.id,argObj.CommentCountContainer="#Stock-Comments_"+value.id,BNN.Modules.NewComments.LoadComments(argObj)}}),StockFeedbackResultsBig.GetStockQuote(value.symbol,value.id);var tipposition=index<=2?"center left":"center right";StockFeedbackResultsBig.InitLikes(value.id)}),StockFeedbackResultsBig.BindSortEvents(sl),$(".StockFeedbackResultsBigContainer .Description p span.Disclaimer").tooltip({effect:"slide",position:"bottom right",offset:[10,5]})},StockFeedbackResultsBig.GetLikeImage=function(){return"<img src="+Agility.ResolveUrl("~/Images/Icons/new_like_small.png")+" alt='' width='20px' height='35px' />"},StockFeedbackResultsBig.GetDisLikeImage=function(){return"<img src="+Agility.ResolveUrl("~/Images/Icons/new_dislike_small.png")+" alt='' width='20px' height='35px' />"},StockFeedbackResultsBig.GetRatingToolTip=function(){return _ratingTooltip},StockFeedbackResultsBig.GetApprovalToolTip=function(){return"Like DISLIKE tooltip"},StockFeedbackResultsBig.GetContainerClass=function(){return _containerClass},StockFeedbackResultsBig.UpdateNewRatings=function(ids){var startdate=new Date,utcStart=new Date(Date.UTC(startdate.getFullYear(),startdate.getMonth(),startdate.getDate(),startdate.getHours(),startdate.getMinutes(),startdate.getSeconds(),0)),enddate=new Date,utcEnd=new Date(Date.UTC(enddate.getFullYear(),enddate.getMonth(),enddate.getDate(),enddate.getHours(),enddate.getMinutes(),enddate.getSeconds(),0)),params;switch(_feedbackFlag){case"Today":params={},params.relatedContentIDs=ids,utcStart=null,utcEnd=null;break;case"ThisWeek":params={},params.relatedContentIDs=ids,utcStart.setDate(utcStart.getDate()-7),utcStart.setHours(0,0,0,0),utcEnd.setHours(23,59,59,0),params.startDate=dateFormat(utcStart,"yyyy-mm-dd 00:00:00"),params.endDate=dateFormat(utcEnd,"yyyy-mm-dd 23:59:59");break;case"OneMonth":params={},params.relatedContentIDs=ids,utcStart.setMonth(utcStart.getMonth()),utcStart.setDate(1),utcStart.setHours(0,0,0,0),utcEnd.setHours(23,59,59,0),params.startDate=dateFormat(utcStart,"yyyy-mm-dd 00:00:00"),params.endDate=dateFormat(utcEnd,"yyyy-mm-dd 23:59:59");break;case"All":params={},params.relatedContentIDs=ids,utcStart.setFullYear(1999),utcStart.setHours(0,0,0,0),utcEnd.setHours(23,59,59,0),params.startDate=dateFormat(utcStart,"yyyy-mm-dd 00:00:00"),params.endDate=dateFormat(utcEnd,"yyyy-mm-dd 23:59:59")}_rating=0,StockFeedbackResultsBig.ClearRatings(),Agility.UGC.API.ExecCustomProcedure("GetAggregates",params,function(data){var i,text_rating;if(data.ResponseType==0){if(data.ResponseData[0].length>0)for(i=0;i<data.ResponseData[0].length;i++)$("#divClick_"+data.ResponseData[0][i].RelatedContentID+" div.Stock-Comments-Container > div.Label > span").html(data.ResponseData[0][i].Result);if(data.ResponseData[1].length>0)for(i=0;i<data.ResponseData[1].length;i++)$("#stockItem_"+data.ResponseData[1][i].RelatedContentID+" .votes").html("Total Ratings: "+data.ResponseData[1][i].Result);if(data.ResponseData[3].length>0)for(i=0;i<data.ResponseData[3].length;i++)text_rating=_getRating(Number(data.ResponseData[3][i].Result*10),"new"),$("#stockItem_"+data.ResponseData[3][i].RelatedContentID+" .avg").html("AVG Rating: <span class='"+text_rating.cssclass+"'>"+text_rating.textRating+"</span>"),StockFeedbackResultsBig.InitSlider(data.ResponseData[3][i].Result,data.ResponseData[3][i].RelatedContentID)}})},StockFeedbackResultsBig.ClearRatings=function(){$.each($("div.StockItemBigContainer .stockItem"),function(){$(this).find(".avg").text("AVG Rating: NONE"),$(this).find(".votes").text("Total Ratings: 0"),StockFeedbackResultsBig.InitSlider(0,$(this).attr("id").split("stockItem_")[1])})},StockFeedbackResultsBig.AddFeedback=function(id,isPositive,container){var ApprovalFeedback=new Agility.UGC.API.BooleanFeedback,target;ApprovalFeedback.ReferenceName="ReutersStockFeedback",ApprovalFeedback.ContentType=Agility.UGC.API.FeedbackContentType.UGC,ApprovalFeedback.RelatedContentID=id,target=$(".likeResult",container),Agility.UGC.API.SaveApproveDisapprove(ApprovalFeedback,isPositive,function(data){if(data.ResponseType==Agility.UGC.API.ResponseType.OK){var currentLabel=$(target).html(),currentCount=Number(currentLabel);$(target).html(" "+(currentCount+1)+" "),$.cookie("BNNStockApproval_"+id,!0),$("#stockItem_"+id+" .likeContainer").addClass("disabled")}})},StockFeedbackResultsBig.SearchFeedback=function(id,isPositive,container,sdate,edate){var $result=$(".likeResult",container),feedbackSearch=new Agility.UGC.API.FeedbackSearchArg;feedbackSearch.ReferenceName="ReutersStockFeedback",feedbackSearch.ContentType=Agility.UGC.API.FeedbackContentType.UGC,feedbackSearch.SubmissionType=Agility.UGC.API.FeedbackSubmissionType.ApproveDisapprove,feedbackSearch.StartDate=sdate?"/Date("+Date.UTC(sdate.getFullYear(),sdate.getMonth(),sdate.getDate(),sdate.getHours(),sdate.getMinutes(),sdate.getSeconds(),0)+")/":null,feedbackSearch.EndDate=edate?"/Date("+Date.UTC(edate.getFullYear(),edate.getMonth(),edate.getDate(),edate.getHours(),edate.getMinutes(),edate.getSeconds(),0)+")/":null,feedbackSearch.RelatedContentIDs=[id],feedbackSearch.IsPositive=isPositive,feedbackSearch.Action=Agility.UGC.API.AggregateTypes.Count,Agility.UGC.API.GetFeedbackAggregate(feedbackSearch,function(data){if(data.ResponseType==0){var tmp=data.ResponseData.length>0?data.ResponseData[0].Result:0;$result.html(" "+tmp+" "),$.cookie("BNNStockApproval_"+id)?$("#stockItem_"+id+" .likeContainer").addClass("disabled"):$("#stockItem_"+id+" .likeContainer").removeClass("disabled")}})},StockFeedbackResultsBig.GetStockQuote=function(s,id){$("#stockItem_"+id+" .Quote").attr("style",'background: url("../Images/Icons/loading.gif") no-repeat scroll center center transparent;'),$.getJSON(MarketDataServiceUrl+"/GetStockQuote?symbol="+s+"",function(result){var cssClass,last,change,temp,percentChange;result!=undefined&&(cssClass=_getCssClass(result.NetChange),last=_formatPriceInfo(result.Last),last=last!=null&&last!=""?"$"+last:last,$("#stockItem_"+id+" .Quote .Last").text(last),temp=_formatPriceInfo(result.NetChange),change=result.NetChange.indexOf("-")==0?"-$"+result.NetChange.substring(1):result.NetChange==0?"$"+result.NetChange:"+$"+result.NetChange,change.indexOf(".")==2&&(change=change.substring(0,2)+"0"+change.substring(2)),percentChange=_formatPriceInfo(result.PercentChange),percentChange=percentChange.indexOf("%")<0?percentChange+"%":percentChange,$("#stockItem_"+id+" .Quote .NetChange").addClass(cssClass).text(percentChange),$("#stockItem_"+id+" .Quote").attr("style","background-color: #fff;"),$("#stockItem_"+id+"  h3 a").html(result.Ticker),$("#stockItem_"+id+"  h3 a").attr("href","Stock.aspx?pi_symbol="+result.Ticker))})},StockFeedbackResultsBig.GenerateArray=function(parameters){var tmp_symbols=parameters.StockSymbols,tmp_ids=parameters.StockIDs,tmp_cnames=parameters.CompanyNames,stockList,i,stockInfo;_ratingTooltip=parameters.RatingTooltip,_allowRatings=parameters.AllowRating=="True"?!0:!1,_allowLikes=parameters.AllowLikeDislike=="True"?!0:!1,tmp_ids=tmp_ids.slice(0,tmp_ids.length-1),tmp_symbols=tmp_symbols.slice(0,tmp_symbols.length-1),tmp_cnames=tmp_cnames.slice(0,tmp_cnames.length-1);var ids=tmp_ids.split(","),symbols=tmp_symbols.split(","),cnames=tmp_cnames.split(","),len=ids.length;for(_containerClass="stockItem",stockList=[],i=0;i<5;i++)stockInfo={id:ids[i],symbol:symbols[i],name:cnames[i]},stockList[i]=stockInfo;return stockList.sort(SortByName),stockList},StockFeedbackResultsBig.InitLikes=function(id){_allowLikes?($("#stockItem_"+id+" .likeContainer").show(),$("#Stock-Comments_"+id).addClass("Stock-Comments"),$.browser.msie&&parseInt($.browser.version,10)==7?$("#stockItem_"+id+" .sliderContainer  .ratingSlider").addClass("ie7hack"):$("#stockItem_"+id+" .sliderContainer  .ratingSlider").addClass("withLikes"),$("#stockItem_"+id+" .Like").click(function(){$.cookie("BNNStockApproval_"+id)||StockFeedbackResultsBig.AddFeedback(id,!0,$(this))}),$("#stockItem_"+id+" .DisLike").click(function(){$.cookie("BNNStockApproval_"+id)||StockFeedbackResultsBig.AddFeedback(id,!1,$(this))}),$(".stockItem
 .LikeLabel").show(),$(".stockItem .DisLikeLabel").show()):($("#stockItem_"+id+" .likeContainer").hide(),$("#Stock-Comments_"+id).addClass("Stock-Comments"),$("#stockItem_"+id+" .sliderContainer  .ratingSlider").addClass("withOutLikes"),$(".stockItem .LikeLabel").hide(),$(".stockItem .DisLikeLabel").hide())},StockFeedbackResultsBig.BindSortEvents=function(){$(".StockFeedbackResultsBig .Filter .Today").addClass("Selected"),$(".StockFeedbackResultsBig .Filter .Today").click(function(){_feedbackFlag="Today",StockFeedbackResultsBig.UpdateNewRatings(_globalIds),$(this).addClass("Selected"),removeFilterSelected($(this))}),$(".StockFeedbackResultsBig .Filter .ThisWeek").click(function(){_feedbackFlag="ThisWeek",StockFeedbackResultsBig.UpdateNewRatings(_globalIds),$(this).addClass("Selected"),removeFilterSelected($(this))}),$(".StockFeedbackResultsBig .Filter .OneMonth").click(function(){_feedbackFlag="OneMonth",StockFeedbackResultsBig.UpdateNewRatings(_globalIds),$(this).addClass("Selected"),removeFilterSelected($(this))}),$(".StockFeedbackResultsBig .Filter .SixMonths").click(function(){_feedbackFlag="SixMonths",StockFeedbackResultsBig.UpdateNewRatings(_globalIds),$(this).addClass("Selected"),removeFilterSelected($(this))}),$(".StockFeedbackResultsBig .Filter .All").click(function(){_feedbackFlag="All",StockFeedbackResultsBig.UpdateNewRatings(_globalIds),$(this).addClass("Selected"),removeFilterSelected($(this))})},StockFeedbackResultsBig.InitSlider=function(result,id){$("#stockItem_"+id+" .sliderContainer .ratingSlider").slider({min:0,max:10,value:result,orientation:"vertical",range:"min",animate:"slow",create:function(){if($.cookie("BNNStockRating_"+id)){$("#stockItem_"+id+" .sliderContainer .ratingSlider").slider("option","disabled",!0);var text_rating=_getRating($.cookie("BNNStockRating_"+id),null);$("#stockItem_"+id+" .result").html("YOU RATED:"+text_rating.textRating).addClass(text_rating.cssclass)}},stop:function(){var rating,ratingFeedback,fnl_rating;$.cookie("BNNStockRating_"+id)?$("#stockItem_"+id+" .sliderContainer .ratingSlider").slider("option","disabled",!0):(rating=$(this).slider("value"),ratingFeedback=new Agility.UGC.API.RatingFeedback,ratingFeedback.ReferenceName="ReutersStockFeedback",ratingFeedback.ContentType=Agility.UGC.API.FeedbackContentType.UGC,ratingFeedback.RelatedContentID=id,ratingFeedback.RatingValue=rating,fnl_rating=Math.round(Number(rating*10)),Agility.UGC.API.SaveRating(ratingFeedback,function(data){if(data.ResponseType==0){StockFeedbackResultsBig.UpdateNewRatings(_globalIds);var text_rating=_getRating(fnl_rating,null);$("#stockItem_"+id+" .result").html("YOU RATED:"+text_rating.textRating).addClass(text_rating.cssclass),$.cookie("BNNStockRating_"+id,fnl_rating,!0),$("#stockItem_"+id+" .sliderContainer .ratingSlider").slider("option","disabled",!0)}}))}})},_getRating=function(rating,type){return resObj={},rating>=0&&rating<=33?resObj={textRating:"SELL",cssclass:"Negative"}:rating>33&&rating<=66?resObj={textRating:"HOLD",cssclass:"NeutralBlack"}:rating>66&&(resObj={textRating:"BUY",cssclass:"Positive"}),type=="new"&&rating==0&&(resObj={textRating:"NONE",cssclass:"Neutral"}),resObj},_getCssClass=function(val){var positive=val!=null&&val!=""&&val.indexOf("-")!=0;return val=="0"||val==""?"Neutral":positive?"Positive":"Negative"},_formatPriceInfo=function(val){return val!=null&&val!=""?_addCommas(_keepTwoDecimals(_addZero(_removeSign(val)))):val},_removeSign=function(val){return val.indexOf("-")==0?val.substring(1):val.indexOf("+")==0?val.substring(1):val},_addCommas=function(val){for(var regEx=/(\d+)(\d{3})/;regEx.test(val);)val=val.replace(regEx,"$1,$2");return val},_keepTwoDecimals=function(val){var tmpFloat=Math.round(100*parseFloat(val))/100;return tmpFloat.toString()},_addZero=function(val){return val.indexOf(".")==0?"0"+val:val.indexOf("-.")==0?"-0"+val.substring(1):val.indexOf("+.")==0?"+0"+val.substring(1):val}}(BNN.Modules.StockFeedbackResultsBig);
Agility.RegisterNamespace("BNN.Modules.StockSymbolSearch"),function(StockSymbolSearch){var searchDefault="",_isOverStockSearchMenu=!1;StockSymbolSearch.OnInit=function(){var searchBox=$("#StockSymbolSearch .SearchBox"),stockSearchMenu=$("#StockSymbolSearch_Drop");stockSearchMenu.bind("mouseenter",function(){_isOverStockSearchMenu=!0}),stockSearchMenu.bind("mouseleave",function(){_isOverStockSearchMenu=!1}),searchBox.bind("focus",function(){(searchBox.val()==searchDefault||searchDefault=="")&&searchBox.val("")}).bind("keyup",function(){if(searchBox.val()==""){stockSearchMenu.hide();return}var container=$("#StockSymbolSearch_Drop .Results");$.getJSON(MarketDataServiceUrl+"/GetTopNReutersSearch?symbolBeginsWith="+searchBox.val()+"&pageSize=5&pageNo=0",function(result){var templateUrl,moreUrl,newMoreUrl;result!=undefined&&result.length>0?(templateUrl=Agility.ResolveUrl("~/ClientTemplates/ReutersSearchResults.htm"),container.setTemplateURL(templateUrl),container.processTemplate(result),_updateStockSearchPosition(searchBox,stockSearchMenu),stockSearchMenu.show(),moreUrl=$(".MoreResults a",stockSearchMenu).attr("href"),newMoreUrl=moreUrl.substring(0,moreUrl.indexOf("Search.aspx")+11)+"?query="+searchBox.val(),$(".MoreResults a",stockSearchMenu).attr("href",newMoreUrl),container.children(".DataItem").bind("mouseenter",function(){$(this).addClass("Hover")}),container.children(".DataItem").bind("mouseleave",function(){$(this).removeClass("Hover")})):stockSearchMenu.hide()})}).bind("blur",function(){searchBox.val()==""&&searchBox.val(searchDefault),_isOverStockSearchMenu?stockSearchMenu.bind("mouseleave",function(){stockSearchMenu.hide()}):stockSearchMenu.hide()}).bind("keydown",function(event){(event.which||event.keyCode)&&(event.which==13||event.keyCode==13)&&$(this).next().trigger("click")}),$("#btnStockSymbolSearch").bind("click",function(){var query=searchBox.val();return query!=""&&query!=searchDefault&&(window.location=Agility.ResolveUrl("~/Stock.aspx")+"?pi_symbol="+escape(query)),!1})},_updateShowsMenuPosition=function(linkElement,menuElement){if(linkElement.length>0&&menuElement.length>0){var x=linkElement.offset().left+linkElement.width()/2-menuElement.width()/2,y=linkElement.offset().top+linkElement.height()+8;menuElement.css("left",x+"px"),menuElement.css("top",y+"px")}}}(BNN.Modules.StockSymbolSearch);
Agility.RegisterNamespace("BNN.Modules.StockChartDisplay"),function(StockChartDisplay){var symbol;StockChartDisplay.OnInit=function(p){var periods=p.Periods.split(","),periodData,i,tempPeriod,periodDIVs,period;for(symbol=p.Symbol,$("#StockChartDisplay .ChartFooter .link").html("<a href="+Agility.ResolveUrl("~/Stock.aspx?pi_symbol="+symbol)+">&raquo; view stock details</a>"),$.getJSON(MarketDataServiceUrl+"/GetStockQuote?symbol="+symbol+"",function(result){var $price,cssClass,last,percentChange;result!=undefined&&($price=$("#StockChartDisplay .Price"),$("#StockChartDisplay .Header").html(result.CompanyName+" ("+symbol+")"),cssClass=_getCssClass(result.NetChange),last=_formatPriceInfo(result.Last),last=last!=null&&last!=""?"$"+last:last,$(".Last",$price).addClass(cssClass).text(last),$(".NetChange",$price).addClass(cssClass).text(_formatPriceInfo(result.NetChange)),percentChange=_formatPriceInfo(result.PercentChange),percentChange=percentChange.indexOf("%")<0?percentChange+"%":percentChange,$(".PercentChange",$price).addClass(cssClass).text(percentChange),$("img[id$="+cssClass+"]",$price).show())}),period="INTRA",_populateStockChartDisplayChart(symbol,period),periodData=[],i=0;i<periods.length;i++)tempPeriod=periods[i].split("|"),tempPeriod.length==2&&(periodData[periodData.length]={Label:tempPeriod[0],Period:tempPeriod[1]});_processStockChartDisplayPeriodTemplate(periodData.reverse()),periodDIVs=$("#StockChartDisplay .ChartFooter .Periods div"),periodDIVs.length>0?(period=$(periodDIVs[periodDIVs.length-1]).attr("data"),$(periodDIVs[periodDIVs.length-1]).addClass("Selected")):period="INTRA"},_processStockChartDisplayPeriodTemplate=function(data){var container=$("#StockChartDisplay .ChartFooter .Periods"),templateUrl=Agility.ResolveUrl("~/ClientTemplates/StockChartDisplayPeriods.htm");container.setTemplateURL(templateUrl),container.processTemplate(data)},_StockChartPeriodDivClick=function(event){var obj=event.srcElement!=undefined?event.srcElement:event.originalTarget!=undefined?event.originalTarget:event.target,period;$("#StockChartDisplay .ChartFooter .Periods div").each(function(index,item){$(item).removeClass("Selected")}),$(obj).addClass("Selected"),period=$(obj).attr("data"),_populateStockChartDisplayChart(symbol,period)},_populateStockChartDisplayChart=function(symbol,period){$.getJSON(MarketDataServiceUrl+"/GetStockChartDisplayUrl?symbol="+symbol+"&period="+period+"",function(result){var priceChartHtml='<img src="'+result+'" id="chart1">';$("#StockChartDisplay .PriceChart").html(priceChartHtml)})},_StockChartDisplayPeriodDivClick=function(event){var obj=event.srcElement!=undefined?event.srcElement:event.originalTarget!=undefined?event.originalTarget:event.target,period;$("#StockChartDisplay .ChartFooter .Periods div").each(function(index,item){$(item).removeClass("Selected")}),$(obj).addClass("Selected"),period=$(obj).attr("data"),_populateStockChartDisplayChart(symbol,period)},_getCssClass=function(val){var positive=val!=null&&val!=""&&val.indexOf("-")!=0;return val=="0"||val==""?"Neutral":positive?"Positive":"Negative"},_formatPriceInfo=function(val){return val!=null&&val!=""?_addCommas(_keepTwoDecimals(_addZero(_removeSign(val)))):val},_removeSign=function(val){return val.indexOf("-")==0?val.substring(1):val.indexOf("+")==0?val.substring(1):val},_addCommas=function(val){for(var regEx=/(\d+)(\d{3})/;regEx.test(val);)val=val.replace(regEx,"$1,$2");return val},_keepTwoDecimals=function(val){var tmpFloat=Math.round(100*parseFloat(val))/100;return tmpFloat.toString()},_addZero=function(val){return val.indexOf(".")==0?"0"+val:val.indexOf("-.")==0?"-0"+val.substring(1):val.indexOf("+.")==0?"+0"+val.substring(1):val}}(BNN.Modules.StockChartDisplay);
jQuery.fn.extend({NewSubscribe:function(arg){$(this).each(function(){var argObj={onSubmitForm:BNN.Modules.NewSubscribe.SubmitComment,onCommentSubmitComplete:BNN.Modules.NewSubscribe.onCommentSubmitComplete};$.extend(argObj,arg),BNN.Modules.NewSubscribe.LoadForm(argObj)})}}),Agility.RegisterNamespace("BNN.Modules.NewSubscribe"),function(NewSubscribe){function _buildContestInputForm(argObj){var html="";return html+="<div class='ErrorSummary'><ul></ul></div>",html+="<form id='SilverPopForm'>",html+="<div class='SignUpForm'>",html+="<div class='Large'>",html+="<input type='hidden' id='bnn_do' name='bnn_do' value='"+fun+"'>",html+="<label for='inpFirstName'>*First Name:</label><br /><input type='text' id='inpFirstName' name='inpFirstName' class='required'/><br />",html+="</div>",html+="<div class='Large'>",html+="<label for='inpLastName'>*Last Name:</label><br /><input type='text' id='inpLastName' name='inpLastName' class='required'/><br />",html+="</div>",html+="<div class='Clear'></div>",html+="<div class='Large'>",html+="<label for='inpEmail'>*Email:</label><br /><input type='text' id='inpEmail' name='inpEmail' class='EmailAddressInput required email'/><br />",html+="</div>",html+="<div class='Large'>",html+="<label>City:</label><br /><input type='text' id='inpCity' name='inpCity'/>",html+="</div>",html+="<div class='Clear'></div>",html+="<div class='Short'>",html+="<label>*Province:</label><br />",html+="<select id='inpProvince' name='inpProvince' class='NameInput required' style='width:90px'>",html+="<option value=''></option>",html+="<option>AB</option>",html+="<option value='BC'>BC</option>",html+="<option value='MB'>MB</option>",html+="<option value='NB'>NB</option>",html+="<option value='NF'>NF</option>",html+="<option value='NS'>NS</option>",html+="<option value='NT'>NT</option>",html+="<option value='NU'>NU</option>",html+="<option value='ON'>ON</option>",html+="<option value='PE'>PE</option>",html+="<option value='PQ'>PQ</option>",html+="<option value='SK'>SK</option>",html+="<option value='YK'>YK</option>",html+="<option value='Other'>Other</option>",html+="</select></div>",html+="<div class='Short'>",html+="<label>*Country:</label><br />",html+="<select id='inpCountry' name='inpCountry' class='required' style='width: 90px;'><option value=''></option><option value='Canada'>Canada</option><option value='U.S.'>U.S.</option><option value='Other'>Other</option></select>",html+="</div>",html+="<div class='Short'>",html+="<label for='inpPostalCode'>*Postal Code:</label><br />",html+="<input type='text' id='inpPostalCode' name='inpPostalCode' class='NameInput required' style='width: 90px;'/>",html+="</div>",html+="<div class='Short'>",html+="<label for='inpAge'>Age:</label><br />",html+="<select id='inpAge' name='inpAge' style='width: 90px;'><option value=''></option><option value='18-24'>18-24</option><option value='25-34'>25-34</option><option value='35-49'>35-49</option><option value='50-64'>50-64</option><option value='65+'>65+</option></select>",html+="</div>",html+="<div class='Short'>",html+="<label for='options:gender:Male'>Male</label><br />",html+="<input type='radio' id='options:gender:Male' name='inpGender' value='Male' class='other' />",html+="</div>",html+="<div class='Short'>",html+="<label for='options:gender:Female'>Female</label><br />",html+="<input type='radio' id='options:gender:Female' name='inpGender' value='Female' class='other' />",html+="</div>",html+="<div class='Clear'></div>",html+="<div class='Agree'>",html+="<label for='ConnectResearchPanel'>Yes, I would like to join the Bell Media Connect research panel, to provide input on Canadian media programming and advertising. I understand I will receive related emails, and can opt-out at any time.",html+="<input type='checkbox' id='ConnectResearchPanel' name='ConnectResearchPanel'  class='other' /></label>",html+="</div>",html+="<div class='Clear'></div>",html+="<div class='Agree'>",html+="<label for='InsiderEmailEnabled'>Yes, I would like to receive The Insider email - with occasional offers and information from carefully selected Bell Media advertising partners. I understand I will receive related emails, and can opt-out at any time.",html+="<input type='checkbox' id='InsiderEmailEnabled' name='InsiderEmailEnabled'  class='other' /></label>",html+="</div>",html+="<div class='Short' style='visibility:hidden; display:none;'><label>*What is (3 x 3) - 2 ?</label><br/><input type='text' id='url' name='url'></div>",html+="<div class='Clear'></div>",html+="<div class='Submit'><input id='Submit' name='Submit' style='border-width: 0px; margin-right:12px; width:64px;'  type='image' src='"+argObj.SubmitButtonImageUrl+"' alt='Submit' /></div>",html+="<div class='Reset'><img id='btnReset' class='Reset' src='"+argObj.ResetButtonImageUrl+"' /></div>",html+="</div>",html+="<div class='ContestErrorMessage'>",html+="<div class='ErrFirstName'>First name is required</div>",html+="<div class='ErrLastName'>last name is required</div>",html+="<div class='ErrEmail'>Email address is required</div>",html+="<div class='InvalidEmail'>Please enter a valid email address</div>",html+="<div class='ErrCountry'>Please select a country</div>",html+="<div class='ErrProvince'>Please select a province</div>",html+="<div class='ErrCity'>City is required</div>",html+="<div class='ErrPostal'>Postal/Zip code is required</div>",html+="<div class='InvalidPostal'>Please enter a valid postal/zip code</div>",html+="<div class='ErrTerms'>You must agree to the terms to continue</div>",html+="</div>",html+="</form>",html+="</div>",html+="<div class='ThankYou'>",html+="<div class='Message'>"+argObj.ThankyouMessage+"</div>",html+="</div>"}function _funString(){for(var chars="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",string_length=8,randomstring="",rnum,i=0;i<string_length;i++)rnum=Math.floor(Math.random()*chars.length),randomstring+=chars.substring(rnum,rnum+1);return randomstring}var properties=null,fun=_funString();NewSubscribe.LoadForm=function(argObj){var ContestContainer=$("#FormContainer"),html,container,errorMsgs;_currentArgs=argObj,html="<div class='SubscribeFormPlugin'>",html+=_buildContestInputForm(argObj),html+="</div>",ContestContainer.html(html),$("#SilverPopForm .SignUpForm .Reset #btnReset").bind("click",function(){NewSubscribe.ResetCommentForm(ContestContainer)}),container="#FormContainer .SubscribeFormPlugin",errorMsgs=$("#FormContainer .ContestErrorMessage"),$("#SilverPopForm").validate({invalidHandler:function(e,validator){var errors=validator.numberOfInvalids();errors>0?$(".ErrorSummary",container).show():$(".ErrorSummary",container).hide()},submitHandler:function(){argObj.onSubmitForm()},rules:{inpPostalCode:{required:function(){return $("#inpCountry option:selected").val()!="Other"}},inpProvince:{required:function(){return $("#inpProvince option:selected").val()!="other"}},inpPostalCode:{postalcode:!0}},messages:{inpFirstName:$(".ErrFirstName",errorMsgs).text(),inpLastName:$(".ErrLastName",errorMsgs).text(),inpEmail:{required:$(".ErrEmail",errorMsgs).text(),email:$(".InvalidEmail",errorMsgs).text()},inpCountry:$(".ErrCountry",errorMsgs).text(),inpProvince:$(".ErrProvince",errorMsgs).text(),inpCity:$(".ErrCity",errorMsgs).text(),inpPostalCode:{required:$(".ErrPostal",errorMsgs).text(),postalcode:$(".InvalidPostal",errorMsgs).text()},inpTerms:$(".ErrTerms",errorMsgs).text()},errorLabelContainer:".ErrorSummary ul",wrapper:"li"}),$.validator.addMethod("postalcode",function(postalcode,element){return this.optional(element)||postalcode.match(/^((\d{5})|(([ABCEGHJKLMNPRSTVXY]|[abceghjklmnprstvxy])\d([ABCEGHJKLMNPRSTVWXYZ]|[abceghjklmnprstvwxyz])(\s|)\d([ABCEGHJKLMNPRSTVWXYZ]|[abceghjklmnprstvwxyz])\d))$/)},"Please specify a valid postal/zip code")},NewSubscribe.ResetCommentForm=function(){$("#FormContainer .ErrorSummary").hide(),$("#inpFirstName").val(""),$("#inpLastName").val(""),$("#inpEmail").val(""),$("#inpCity").val(""),$("#inpPostalCode").val(""),$("#SilverPopForm :input").each(function(){$(this).removeClass("error")})},NewSubscribe.DisplayThankYou=function(elem){$("#FormContainer .SignUpForm").hide(),$(".ThankYou",elem).show()},NewSubscribe.HideThankYou=function(elem){$(".#FormContainer .SignUpForm").show(),$(".ThankYou",elem).hide()},NewSubscribe.SubmitComment=function(){var $url=$.trim($("#url").val()),$bnn_do=$.trim($("#bnn_do").val()),$fname=$.trim($("#inpFirstName").val()),$lname=$.trim($("#inpLastName").val()),$emailAddress=$.trim($("#inpEmail").val()),$city=$.trim($("#inpCity").val()),$province=$("#inpProvince option:selected").text(),$country=$("#inpCountry option:selected").val(),$postalcode=$.trim($("#inpPostalCode").val()),$age=$("#inpAge option:selected").text(),$gender=$("input:radio[name=inpGender]:checked").val(),$ConnectResearchPanel,$InsiderEmailEnabled;if($gender=$gender==undefined?"":$gender,$ConnectResearchPanel=$("input[name=ConnectResearchPanel]").is(":checked")?"Yes":"No",$InsiderEmailEnabled=$("input[name=InsiderEmailEnabled]").is(":checked")?"Yes":"No",$("#SilverPopForm").valid()&&fun==$bnn_do)($url==""||$url=="7")&&$.ajax({url:AjaxWebserviceSvcUrl+"/SubmitSilverPopForm?firstname="+$fname+"&lastname="+$lname+"&email="+$emailAddress+"&province="+$province+"&city="+$city+"&postal="+$postalcode+"&country="+$country+"&age="+$age+"&gender="+$gender+"&ConnectResearchPanel="+$ConnectResearchPanel+"&InsiderEmailEnabled="+$InsiderEmailEnabled,contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var res={d:jsonResponse};if(res.d!=undefined&&res.d!=null)_currentArgs.onCommentSubmitComplete(res.d)}});else _currentArgs.onCommentSubmitComplete(!1)},NewSubscribe.onCommentSubmitComplete=function(data){data==!0?(NewSubscribe.ResetCommentForm(),NewSubscribe.DisplayThankYou()):alert("There was an error submitting your request, please try again later:")}}(BNN.Modules.NewSubscribe);
Agility.RegisterNamespace("BNN.Modules.PitchPersonalityDetails"),function(PitchPersonalityDetails){var properties=null,container=null;PitchPersonalityDetails.OnInit=function(p){properties=p,PitchPersonalityDetails.LoadPersonality(properties.friendly)},PitchPersonalityDetails.LoadPersonality=function(friendly){var name=friendly.split("-");$.getJSON(AjaxWebserviceSvcUrl+"/GetPitchPersonalityByName?Fname="+name[0]+"&Lname="+name[1],function(result){if(result!=undefined){var comp=result.Company2==null?"":", "+result.Company2;$("#Heading").text(result.FirstName+" "+result.LastName+", "+result.Title+comp),$("#PitchPersonalityDetails .Bio").html(result.Bio),$("#PitchPersonalityDetails .Questionaire").html(result.Questionaire),result.Image.URL!=null&&$("#PitchPersonalityDetails .Image").html("<img class='thumb' src='"+Agility.ResolveUrl("~/Handlers/ThumbS3.ashx")+"?img="+result.Image.URL+",300,169,1' />")}})}}(BNN.Modules.PitchPersonalityDetails);
Agility.RegisterNamespace("BNN.Modules.PitchPersonalitySocials"),function(PitchPersonalitySocials){var properties=null,container=null;PitchPersonalitySocials.OnInit=function(p){properties=p,container=properties.container,PitchPersonalitySocials.LoadSocials(properties.friendly)},PitchPersonalitySocials.LoadSocials=function(friendly){var name=friendly.split("-");$.getJSON(AjaxWebserviceSvcUrl+"/GetPitchPersonalitySocialsByName?Fname="+name[0]+"&Lname="+name[1],function(result){if(result!=undefined){if(result.Facebook?($(".pp_facebook a",container).attr("href",result.Facebook),$(".pp_facebook a",container).attr("target","_blank"),$(".pp_facebook a",container).html(result.Facebook)):$(".pp_facebook",container).hide(),result.TwitterFeed){var twitlink=result.TwitterFeed.charAt(0)=="@"?result.TwitterFeed.substring(1):result.TwitterFeed;$(".pp_twitter a",container).attr("href","http://www.twitter.com/"+twitlink),$(".pp_twitter a",container).attr("target","_blank"),$(".pp_twitter a",container).html(result.TwitterFeed)}else $(".pp_twitter",container).hide();result.LinkedIn?($(".pp_linkedin a",container).attr("href",result.LinkedIn),$(".pp_linkedin a",container).attr("target","_blank"),$(".pp_linkedin a",container).html(result.LinkedIn)):$(".pp_linkedin",container).hide(),result.Website?$(".pp_website .link",container).html(result.Website):$(".pp_website",container).hide()}})}}(BNN.Modules.PitchPersonalitySocials);
Agility.RegisterNamespace("BNN.ShowCarousel"),function(ShowCarousel){function outputLog(str){try{console.log("[ ETS ]="+str)}catch(e){}}var _scrollSettings={duration:1e3},_itemsToScroll=4,_mode=1,clipId,width,height,v_arr=[],arrayCopy=[],zone="",globalPlayerObjListLength,sc_mc,containerLimit;ShowCarousel.OnInit=function(latestVideos,popularVideos,mainContainer,limit){var latestButton,popularButton,dynFlashVars;if(containerLimit=limit,(width==undefined||width==null)&&(width=640),(height==undefined||height==null)&&(height=360),sc_mc=mainContainer,$.each(latestVideos,function(i,l){var vitem={id:l.Id,title:l.Title,image:l.ThumbnailUrl.substr(l.ThumbnailUrl.indexOf("=")+1,l.ThumbnailUrl.indexOf(",")-27),description:l.Description};v_arr.push(vitem)}),latestVideos.length==0&&popularVideos.length==0){$("#"+mainContainer).hide();return}if($("#"+mainContainer+" .NavLeft").bind("click",function(){var currentVideoListPosition=parseInt($("#"+mainContainer).attr("currentVideoListPosition")),target=currentVideoListPosition-_itemsToScroll;target==0&&$("#"+mainContainer+" .NavLeft").hide(),target=Math.max(target,0),target!=currentVideoListPosition&&($("#"+mainContainer+" .ListVideos").scrollTo($("#"+mainContainer+" .ListVideos .Video"+target),_scrollSettings),$("#"+mainContainer).attr("currentVideoListPosition",target))}),$("#"+mainContainer+" .NavRight").bind("click",function(){$("#"+mainContainer+" .NavLeft").show();var currentVideoListPosition=parseInt($("#"+mainContainer).attr("currentVideoListPosition")),target=currentVideoListPosition+_itemsToScroll;target=Math.min(target,latestVideos.length-1),target!=currentVideoListPosition&&($("#"+mainContainer+" .ListVideos").scrollTo($("#"+mainContainer+" .ListVideos .Video"+target),_scrollSettings),$("#"+mainContainer).attr("currentVideoListPosition",target))}),$("#"+mainContainer+" .NavLeft").hide(),latestButton=$("#"+mainContainer+" .Main .FilterControls .Latest"),popularButton=$("#"+mainContainer+" .Main .FilterControls .Popular"),latestButton.bind("click",function(){latestButton.addClass("Selected"),popularButton.removeClass("Selected"),_updateCarouselContainerContent(latestVideos,mainContainer)}),popularButton.bind("click",function(){popularButton.addClass("Selected"),latestButton.removeClass("Selected"),_updateCarouselContainerContent(popularVideos,mainContainer)}),latestVideos.length>0){dynFlashVars="lv_mpFlashVars_"+sc_mc,eval("var "+dynFlashVars+";"),dynFlashVars={},dynFlashVars.vid=latestVideos[0].id,dynFlashVars.autoplay=0,dynFlashVars.zone=BNN.AdModule.GetPreRollZone(""),dynFlashVars.programlogo="http://www.bnn.ca/Images/Icons/bnn_videoplayerlogo.png";var Environment="",pUri=BNN.AdModule.parseUri(window.location),domain=pUri.authority.toLowerCase();Environment=domain=="bnn.local"||domain=="stage-origin.bnn.ca"?"dev":"prod",dynFlashVars.dartkey="envr="+Environment+";",dynFlashVars.fscontrolx=0,dynFlashVars.fscontroly=370,sc_globalMainApp.push(etsapi.embedPlayer("sc_vplayer"+sc_mc,"sc_mediaplayerdiv_"+sc_mc,640,360,"bnn","640x360/",{flashVars:dynFlashVars})),globalMainAppLength=sc_globalMainApp.length,sc_globalMainApp[sc_globalMainApp.length-1].registerEvent(MediaPlayerControllerEvent.PLAYER_READY,this,ShowCarousel.onPlayerReady),sc_globalMainApp[sc_globalMainApp.length-1].registerEvent(MediaPlayerControllerEvent.VIDEO_STARTED,this,ShowCarousel.onVideoStart),sc_globalMainApp[sc_globalMainApp.length-1].registerEvent(MediaPlayerControllerEvent.VIDEO_COAD,this,ShowCarousel.onVideoCoAd),$("#"+mainContainer+" .VideoTitle").html(latestVideos[0].Title),$("#"+mainContainer+" .VideoTitle").attr("title",latestVideos[0].Title)}popularVideos.length==0&&(popularButton.hide(),popularButton.next().hide()),latestButton.addClass("Selected"),_updateCarouselContainerContent(latestVideos,mainContainer)},_updateCarouselContainerContent=function(content,mainContainer){var templateUrl=Agility.ResolveUrl("~/ClientTemplates/ShowCarousel_MoreVideos.htm"),container=$("#"+mainContainer+" .ListVideos .Scrolling");container.html(""),container.setTemplateURL(templateUrl),container.setParam("MainContainer",mainContainer),container.processTemplate(content),$("#"+mainContainer+" .ListVideos").scrollTo($("#"+mainContainer+" .ListVideos .Video0"),_scrollSettings),$("#"+mainContainer).attr("currentVideoListPosition","0")},ShowCarousel.onVideoStart=function(infoObj){outputLog("onVideoStart");var container=infoObj.objectID.substring(10);$("#"+container+" .VideoTitle").html(infoObj.title),$("#"+container+" .VideoTitle").attr("title",infoObj.title),infoObj.title!="Advertisement"&&$("#"+container+" .Main .VideoDescription").html(infoObj.description)},ShowCarousel.onPlayerReady=function(infoObj){outputLog("__NewAdRuleInPlace____"),outputLog("onPlayerReady"),ShowCarousel.setlist(infoObj.objectID)},ShowCarousel.PlayElement=function(element,mainContainer){$("#"+mainContainer+" .Main .VideoDescription").html("");for(var i=0;i<sc_globalMainApp.length;i++)sc_globalMainApp[i]._playerID=="sc_vplayer"+mainContainer&&sc_globalMainApp[i].playMediaAt(element)},ShowCarousel.setlist=function(num){var infoObj_1,len,i,xarray,x,infoObj_2;for(outputLog("setPlaylist: "),infoObj_1={},infoObj_1.type="array",infoObj_1.autoplay=0,infoObj_1.playlist=[],infoObj_1.playlist=v_arr,len=sc_globalMainApp.length,i=0;i<len;i++)if(sc_globalMainApp[i]._playerID==num)if(i>=1){for(xarray=[],x=containerLimit*i;x<v_arr.length;x++)xarray.push(v_arr[x]);infoObj_2={},infoObj_2.type="array",infoObj_2.autoplay=0,infoObj_2.playlist=[],infoObj_2.playlist=xarray,sc_globalMainApp[i].setPlaylist(infoObj_2)}else sc_globalMainApp[i].setPlaylist(infoObj_1)},ShowCarousel.onVideoCoAd=function(infoObj){var contentDiv,i;if(outputLog("inside coad handler"),contentDiv="",infoObj.ads!=undefined)for(i=0;i<infoObj.ads.length;i++)contentDiv=infoObj.ads[i].content,infoObj.dartTemplate=="js"&&contentDiv!=""?contentDiv='<script language="JavaScript" src="'+infoObj.ads[i].content+'"   type="text/javascript"><\/script>':infoObj.dartTemplate=="vast"&&contentDiv!=""?(outputLog("vast coad is: "+infoObj.ads[i].content),contentDiv=infoObj.ads[i].content):outputLog("no js no vast"+infoObj.dartTemplate),outputLog(infoObj.dartTemplate+" contentDiv is "+contentDiv),ShowCarousel.writeIntoCompanionDiv(contentDiv,infoObj.ads[i].size)},ShowCarousel.writeIntoCompanionDiv=function(content,size){content!=""&&(outputLog(content),$("#AdModule_"+size).writeCapture().html(content))},ShowCarousel.formatTitle=function(index,title){return title.substr(0,title.indexOf("["))},ShowCarousel.formatDate=function(index,title){var date=title.substr(title.indexOf("[")+1,title.indexOf("]"));return date.slice(0,-1)}}(BNN.ShowCarousel);
Agility.RegisterNamespace("BNN.HomePageTopStories"),function(HomePageTopStories){var properties=null,TopStories=null,_scrollSettings={duration:1e3};HomePageTopStories.OnInit=function(clientID,sliderContent){var client=$("#"+clientID);sliderContent.length<=1?$("#flavor_2").agile_carousel({carousel_data:sliderContent,carousel_outer_height:360,carousel_height:360,slide_height:640,carousel_outer_width:640,slide_width:640,transition_time:300,timer:6e3,continuous_scrolling:!0}):$("#flavor_2").agile_carousel({carousel_data:sliderContent,carousel_outer_height:360,carousel_height:360,slide_height:640,carousel_outer_width:640,slide_width:640,transition_time:300,timer:6e3,continuous_scrolling:!0,control_set_1:"numbered_buttons"}),$("#HomePageTopStories .Story .Thumbnail").hover(function(){$(this).find(".play").toggleClass("play-on")})},HomePageTopStories.ShowLatest=function(){$("#NewLatestAndPopularNews .PopularNews").hide(),$("#NewLatestAndPopularNews .LatestNews").show(),$("#LatestNewsTab").addClass("Selected"),$("#PopularNewsTab").removeClass("Selected")},HomePageTopStories.ShowPopular=function(){$("#NewLatestAndPopularNews .LatestNews").hide(),$("#NewLatestAndPopularNews .PopularNews").show(),$("#PopularNewsTab").addClass("Selected"),$("#LatestNewsTab").removeClass("Selected")}}(BNN.HomePageTopStories);
Agility.RegisterNamespace("BNN.HomePageMarkets"),function(HomePageMarkets){function updateStockTicker(data,txtClientTemplateMarketData){$.getJSON(MarketDataServiceUrl+"/GetStockTickers?symbols="+data+"",function(result){var marketData,i,ticker,positive,icon,url,change,container;if(result!=undefined&&result.length>0){for(marketData=[],i=0;i<result.length;i++)ticker=result[i],ticker.NetChange!=null&&(positive=ticker.NetChange==null?0:ticker.NetChange.indexOf("-")!=0,icon=ticker.NetChange.indexOf("-")!=0?Agility.ResolveUrl("~/Images/Icons/icn_positive_new.png"):Agility.ResolveUrl("~/Images/Icons/icn_negative_new.png"),url=StockPageUrl+ticker.Ticker,change=ticker.NetChange.indexOf("-")==0?"-$"+ticker.NetChange.substring(1):"+$"+ticker.NetChange,change.indexOf(".")==2&&(change=change.substring(0,2)+"0"+change.substring(2)),marketData.push({Symbol:ticker.Ticker,Price:ticker.Last,NetChange:change,Url:url,icon:icon}));container=$("div.NewStockTicker div.NewScroll"),txtClientTemplateMarketData==undefined||txtClientTemplateMarketData==null||txtClientTemplateMarketData==""?(templateUrl=Agility.ResolveUrl("~/ClientTemplates/NewMarketData.htm"),container.setTemplateURL(templateUrl)):container.setTemplate($("#"+txtClientTemplateMarketData).val()),container.processTemplate(marketData),startScrolling(container)}})}function startScrolling(container){var divWidth=156,scroll=container,divs=scroll.find("div"),count=divs.size()*divWidth;scroll.width(count);var left=0,width5=5*divWidth,scrollFunction=function(){scroll.css("left",--left+"px"),-left==count-width5&&(left+=divWidth,scroll.css("left",left+"px"),scroll.append(divs.eq(0)),divs=scroll.find("div"))},interval=setInterval(function(){scrollFunction()},20);container.parent().hover(function(){clearInterval(interval)},function(){interval=setInterval(function(){scrollFunction()},20)})}var _isOverStockSearchMenu=!1,marketLabels=["TSX","DJIA","S&P 500","Nasdaq"],marketNames=["S&P/TSX","Dow Jones","S&P 500","NASDAQ"],marketSymbols=[".GSPTSE",".DJI",".INX",".IXIC"],commoditiesFlag=!1;HomePageMarkets.Init=function(indices,currencies,symbolList){HomePageMarkets.Begin(indices,currencies),updateStockTicker(symbolList,null)},HomePageMarkets.Begin=function(indices){$("#HomePageMarkets .MarketsContainer").show(),HomePageMarkets.DisplayMarkets(),HomePageMarkets.DisplayCommodoties(indices);var CDNCurrencies=["CADUSD=X","CADJPY=X","CADEUR=X"],USCurrencies=["CAD=X","JPY=X","USDEUR=X"];HomePageMarkets.LoadReutersCurrenciesData("CurrenciesCdn",CDNCurrencies),HomePageMarkets.LoadReutersCurrenciesData("CurrenciesUsd",USCurrencies),$("#HomePageMarkets .MarketsContainer .Currencies  .ToggleCurrencyView").bind("click",function(){$("#HomePageMarkets .MarketsContainer .Currencies  .CurrencyContainer .Data").is(":visible")?($("#HomePageMarkets .MarketsContainer .Currencies  .CurrencyContainer .Data").hide(),$("#HomePageMarkets .MarketsContainer .Currencies  .CurrencyContainer .UsData").show(),$(this).html("View $CDN")):($("#HomePageMarkets .MarketsContainer .Currencies  .CurrencyContainer .Data").show(),$("#HomePageMarkets .MarketsContainer .Currencies  .CurrencyContainer .UsData").hide(),$(this).html("View $US"))})},HomePageMarkets.DisplayMarkets=function(){for(var marketData=[],processed=0,i=0;i<marketSymbols.length;i++)$.getJSON(MarketDataServiceUrl+"/GetStockQuote?symbol="+marketSymbols[i]+"",function(result){if(result!=undefined&&result.Ticker!=null){var change=result.NetChange;change=change.indexOf("-")==0?change.substring(1):change,change=change.indexOf(".")==0?"0"+change:change,marketData.push({Order:_getOrderFromHomePageMarketsSymbols(result.Ticker),Name:_getHomePageMarketsNameFromTicker(result.Ticker),NetChange:change,Price:result.Last,CssClass:result.NetChange==undefined||result.NetChange==""?"Neutral":result.NetChange.indexOf("-")==0?"Negative":"Positive",Ticker:result.Ticker,HistoricalCloseDate:result.HistoricalCloseDate,Volume:result.Volume,Gv1_Text:result.Gv1_Text})}processed++,processed>=marketSymbols.length-1&&(marketData.sort(function(a,b){return a.Order<b.Order?-1:1}),_processMarketsTemplate(marketData),$("#HomePageMarkets .MarketsContainer .Markets .DataItem:first-child").addClass("Selected"),$("#HomePageMarkets .MarketsContainer .Markets .DataItem:first-child .Expanded").show(),$("#HomePageMarkets .MarketsContainer .Markets .DataItem:first-child .Expand").hide())})},HomePageMarkets.BindExpandClick=function(data){var item;$("#HomePageMarkets .MarketsContainer .Markets .DataItem .Expand").bind("click",function(){var symbol,indexOrder;item=$(this).parent(),item.toggleClass("Selected",200,"linear"),$("#HomePageMarkets .MarketsContainer .Markets .DataItem").each(function(){$(this).removeClass("Selected"),$(".Expanded",$(this)).hide(),$(".Expand",$(this)).show(),$(this).children(".Chart").hide()}),$.each($("#HomePageMarkets .MarketsContainer .Markets .DataItem").not(item),function(){$(".Chart",this).attr("data-highcharts-chart")!==undefined&&$(".Chart",this).highcharts().destroy()}),item.children(".Chart").show(200,"linear"),symbol=_getMarketSymbolLabel(item.children(".Data").children(".Name").children("a").html()),$(".Expanded",item).show(),$(".Expand",item).hide(),indexOrder=$(item).attr("index-order"),BNN.Controls.TimeSeriesChart.HighChartHomePageINTRA($(".Chart",item),data[indexOrder])})},HomePageMarkets.DisplayCommodoties=function(indices){for(var data=[],processed=0,i=0;i<indices.length;i++)$.getJSON(MarketDataServiceUrl+"/GetStockQuote?symbol="+indices[i].Symbol+"",function(result){var container;if(result!=undefined){var ticker=result.Ticker,change=result.NetChange,price=result.Last,cssClass=_getCssClass(change),order=_getOrderFromIndices(indices,ticker),name=order<99?indices[order].Name:result.CompanyName;change=_formatCurrency(_keepTwoDecimals(change)),price=_addCommas(_keepTwoDecimals(price)),price=price!=""?"$ "+price:price,data.push({Order:order,Name:name,NetChange:change,Last:price,CssClass:cssClass})}processed++,processed>=indices.length-1&&(data.sort(function(a,b){return a.Order<b.Order?-1:1}),templateUrl=Agility.ResolveUrl("~/ClientTemplates/HomePageCommodoties.htm"),container=$("#HomePageMarkets .MarketsContainer .Commodities"),container.setTemplateURL(templateUrl),container.processTemplate(data))})},HomePageMarkets.LoadReutersCurrenciesData=function(target,currencyList){for(var data=[],processed=0,i=0;i<currencyList.length;i++)$.getJSON(MarketDataServiceUrl+"/GetStockQuote?symbol="+currencyList[i],function(result){if(result!=undefined&&result.Ticker!=null){var newDisplay=result.CompanyName,ticker=result.Ticker,change=result.NetChange,price=result.Last,positive=change!=null&&change!=""&&change.indexOf("-")!=0,cssClass=change=="0"||change==""?"Neutral":positive?"Positive":"Negative",order=i,alt=order==0||order==1||order%2==1?"":"Alt",displayedTicker=result.Currency=="CAD"?"$Cdn":result.Currency=="USD"?"$US":result.Currency=="JPY"?"Yen":result.Currency=="EUR"?"Euro":result.Currency,displayedSymbol=result.Currency=="CAD"?"$":result.Currency=="USD"?"$":result.Currency=="JPY"?"¥":result.Currency=="EUR"?"€":result.Currency;formattedPrice=_formatCurrency(price),price=displayedSymbol+" "+formattedPrice,data.push({Order:order,RowCssClass:alt,Name:displayedTicker,ChangeCssClass:cssClass,NetChange:change,Price:price})}processed++,processed>=currencyList.length-1&&_processCurrencyTemplate(target,data)}).complete(function(){$("#HomePageMarkets .MarketsContainer .Currencies").show()})},HomePageMarkets.toNumber=function(value){return new Number(value)},_processMarketsTemplate=function(data){var container=$("#HomePageMarkets .MarketsContainer .Markets"),templateUrl=Agility.ResolveUrl("~/ClientTemplates/HomePageMarkets.htm");container.setTemplateURL(templateUrl),container.processTemplate(data),data[0].Name=="S&P/TSX"&&($("#HomePageMarkets .MarketsContainer .Markets .DataItem:first-child .Chart").show(),BNN.Controls.TimeSeriesChart.HighChartHomePageINTRA("#HomePageMarkets .MarketsContainer .Markets .DataItem:first-child .Chart",data[0])),HomePageMarkets.BindExpandClick(data)},_getOrderFromHomePageMarketsSymbols=function(ticker){for(var i=0;i<marketSymbols.length;i++)if(marketSymbols[i].indexOf(ticker)==0)return i},_getHomePageMarketsNameFromTicker=function(ticker){for(var i=0;i<marketSymbols.length;i++)if(marketSymbols[i].indexOf(ticker)==0)return marketNames[i]},_getHomePageMarketsSymbolFromCurrencyList=function(currencyList,ticker){for(var currency,i=0;i<currencyList.length;i++)if(currency=currencyList[i].split("|"),currency!=undefined&&currency.length==2&&currency[0]==ticker)return currency[1]},_getHomePageMarketsOrderFromCurrencyList=function(currencyList,ticker){for(var currency,i=0;i<currencyList.length;i++)if(currency=currencyList[i].split("|"),currency!=undefined&&currency.length>0&&currency[0]==ticker)return i},_getMarketSymbolLabel=function(marketName){marketName=marketName.replace("&amp;","&");for(var i=0;i<marketNames.length;i++)if(marketName==marketNames[i])return marketSymbols[i]},_getOrderFromIndices=function(indices,ticker){for(var i=0;i<indices.length;i++)if(indices[i].Symbol==ticker||indices[i].Symbol==ticker+"-FT")return i},_getCssClass=function(val){var positive=val!=null&&val!=""&&val.indexOf("-")!=0;return val=="0"||val==""?"Neutral":positive?"Positive":"Negative"},_addCommas=function(val){for(var regEx=/(\d+)(\d{3})/;regEx.test(val);)val=val.replace(regEx,"$1,$2");return val},_keepTwoDecimals=function(val){var tmpFloat=Math.round(100*parseFloat(val))/100;return tmpFloat.toString()},_formatCurrency=function(data){if(data==null)return"";var tmp=data;return tmp.indexOf("-")==0&&(tmp=tmp.substring(1)),tmp.indexOf(".")==0&&(tmp="0"+tmp),tmp},_getOrderFromTSXSector=function(tsxsectors,ticker){for(var i=0;i<tsxsectors.length;i++)if(tsxsectors[i].Symbol==ticker)return i;return 99},_getSymbolFromCurrencyList=function(currencyList,ticker){for(var currency,i=0;i<currencyList.length;i++)if(currency=currencyList[i].split("|"),currency!=undefined&&currency.length==2&&currency[0]==
ticker)return currency[1]},_processCurrencyTemplate=function(target,data){var container=$("#"+target),templateUrl=Agility.ResolveUrl("~/ClientTemplates/CurrenciesData.htm");container.setTemplateURL(templateUrl),container.processTemplate(data)}}(BNN.HomePageMarkets);
Agility.RegisterNamespace("BNN.HomePageMarketsWithoutCommodities"),function(HomePageMarketsWithoutCommodities){var _isOverStockSearchMenu=!1,marketLabels=["TSX","DJIA","S&P 500","Nasdaq"],marketNames=["S&P/TSX","Dow Jones","S&P 500","NASDAQ"],marketSymbols=["TSX-I","DJIA","SPX-I","COMP-I"];HomePageMarketsWithoutCommodities.Init=function(){HomePageMarketsWithoutCommodities.DisplayMarkets(),$("#HomePageMarketsWithoutCommodities .MarketsContainer .Currencies  .ToggleCurrencyView").bind("click",function(){$("#HomePageMarketsWithoutCommodities .MarketsContainer .Currencies  .CurrencyContainer .Data").is(":visible")?($("#HomePageMarketsWithoutCommodities .MarketsContainer .Currencies  .CurrencyContainer .Data").hide(),$("#HomePageMarketsWithoutCommodities .MarketsContainer .Currencies  .CurrencyContainer .UsData").show(),$(this).html("View $CDN")):($("#HomePageMarketsWithoutCommodities .MarketsContainer .Currencies  .CurrencyContainer .Data").show(),$("#HomePageMarketsWithoutCommodities .MarketsContainer .Currencies  .CurrencyContainer .UsData").hide(),$(this).html("View $US"))})},HomePageMarketsWithoutCommodities.DisplayMarkets=function(){for(var marketData=[],processed=0,i=0;i<marketSymbols.length;i++)$.getJSON(MarketDataServiceUrl+"/GetStockQuote?symbol="+marketSymbols[i]+"",function(result){if(result!=undefined&&result.Ticker!=null){var change=result.NetChange;change=change.indexOf("-")==0?change.substring(1):change,change=change.indexOf(".")==0?"0"+change:change,marketData.push({Order:_getOrderFromMarketSmallSymbols(result.Ticker),Name:_getMarketSmallNameFromTicker(result.Ticker),Change:change,Price:result.Last,CssClass:result.NetChange==undefined||result.NetChange==""?"Neutral":result.NetChange.indexOf("-")==0?"Negative":"Positive",Ticker:result.Ticker=="DJIA"?result.Ticker:result.Ticker+"-"+result.Exchange})}processed++,processed>=marketSymbols.length-1&&(marketData.sort(function(a,b){return a.Order<b.Order?-1:1}),_processMarketsTemplate2(marketData),$("#HomePageMarketsWithoutCommodities .MarketsContainer .Markets .DataItem:first-child").addClass("Selected"),_populateChart2($("#HomePageMarketsWithoutCommodities .MarketsContainer .Markets .DataItem:first-child"),"TSX-I"),$("#HomePageMarketsWithoutCommodities .MarketsContainer .Markets .DataItem:first-child .Expanded").show(),$("#HomePageMarketsWithoutCommodities .MarketsContainer .Markets .DataItem:first-child .Expand").hide(),$("#HomePageMarketsWithoutCommodities .MarketsContainer .Markets .DataItem .Expand").bind("click",function(){var item=$(this).parent(),symbol;item.toggleClass("Selected",200,"linear"),$("#HomePageMarketsWithoutCommodities .MarketsContainer .Markets .DataItem").each(function(){$(this).removeClass("Selected"),$(".Expanded",$(this)).hide(),$(".Expand",$(this)).show(),$(this).children(".Chart").hide()}),item.children(".Chart").show(200,"linear"),symbol=_getMarketSymbolLabel2(item.children(".Data").children(".Name").children("a").html()),$(".Expanded",item).show(),$(".Expand",item).hide(),_populateChart2(item,symbol)}))})},HomePageMarketsWithoutCommodities.LoadCurrenciesData=function(target,currencyList,exclude){for(var data=[],processed=0,currency,i=0;i<currencyList.length;i++)currency=currencyList[i].split("|"),currency[0]!=exclude&&$.getJSON(MarketDataServiceUrl+"/GetStockQuote?symbol="+exclude+"/"+currency[0]+"-I",function(result){if(result!=undefined&&result.Ticker!=null){var ticker=result.Ticker.split("/")[1],change=result.NetChange,price=result.Last,positive=change!=null&&change!=""&&change.indexOf("-")!=0,cssClass=change=="0"||change==""?"Neutral":positive?"Positive":"Negative",order=_getOrderFromCurrencyList(currencyList,ticker),alt=order==0||order==1||order%2==1?"":"Alt",displayedTicker=ticker=="CAD"?"$Cdn":ticker=="USD"?"$US":ticker=="JPY"?"Yen":ticker=="EUR"?"Euro":ticker;change=_formatCurrency2(change),formattedPrice=_formatCurrency2(price),price=_getSymbolFromCurrencyList2(currencyList,ticker)+" "+formattedPrice,data.push({Order:order,RowCssClass:alt,Name:displayedTicker,ChangeCssClass:cssClass,Change:change,Price:price})}processed++,processed>=currencyList.length-1&&(data.sort(function(a,b){return a.Order<b.Order?-1:1}),_processCurrencyTemplate2(target,data))}).complete(function(){$("#HomePageMarketsWithoutCommodities .MarketsContainer .Currencies").show()})},_processMarketsTemplate2=function(data){var container=$("#HomePageMarketsWithoutCommodities .MarketsContainer .Markets"),templateUrl=Agility.ResolveUrl("~/ClientTemplates/HomePageMarkets.htm");container.setTemplateURL(templateUrl),container.processTemplate(data)},_populateChart2=function(obj,selectedMarketSymbol){$.getJSON(MarketDataServiceUrl+"/GetNewHeaderSmallChartUrl2?symbol="+selectedMarketSymbol+"",function(result){var chartHtml='<img src="'+result+'" id="chart1">';obj.children(".Chart").html(chartHtml),obj.children(".Chart").show("slow")})},_getMarketSymbolLabel2=function(marketName){marketName=marketName.replace("&amp;","&");for(var i=0;i<marketNames.length;i++)if(marketName==marketNames[i])return marketSymbols[i]},_formatCurrency2=function(data){if(data==null)return"";var tmp=data;return tmp.indexOf("-")==0&&(tmp=tmp.substring(1)),tmp.indexOf(".")==0&&(tmp="0"+tmp),tmp},_getSymbolFromCurrencyList2=function(currencyList,ticker){for(var currency,i=0;i<currencyList.length;i++)if(currency=currencyList[i].split("|"),currency!=undefined&&currency.length==2&&currency[0]==ticker)return currency[1]},_processCurrencyTemplate2=function(target,data){var container=$("#"+target),templateUrl=Agility.ResolveUrl("~/ClientTemplates/CurrenciesData.htm");container.setTemplateURL(templateUrl),container.processTemplate(data)},_getSymbolFromCurrencyList2=function(currencyList,ticker){for(var currency,i=0;i<currencyList.length;i++)if(currency=currencyList[i].split("|"),currency!=undefined&&currency.length==2&&currency[0]==ticker)return currency[1]}}(BNN.HomePageMarketsWithoutCommodities);
Agility.RegisterNamespace("BNN.Modules.OneClipPlayer"),function(OneClipPlayer){function outputLog(str){try{console.log("[ ETS ]="+str)}catch(e){}}var playerObjList={},flashPlaylistObj={},properties=null,container=null,frameWidth=640,frameHeight=360,mc;OneClipPlayer.OnInit=function(p){var oc_dynFlashVars;properties=p,container=$("#"+properties.ContainerID),mc=container,oc_dynFlashVars="oc_mpFlashVars_",eval("var "+oc_dynFlashVars+";"),oc_dynFlashVars={},oc_dynFlashVars.vid=properties.ClipID,oc_dynFlashVars.autoplay=0,oc_dynFlashVars.zone=BNN.AdModule.GetPreRollZone(""),oc_dynFlashVars.programlogo="http://www.bnn.ca/Images/Icons/bnn_videoplayerlogo.png";var Environment="",pUri=BNN.AdModule.parseUri(window.location),domain=pUri.authority.toLowerCase();Environment=domain=="bnn.local"||domain=="stage-origin.bnn.ca"?"dev":"prod",oc_dynFlashVars.dartkey="envr="+Environment+";",oc_dynFlashVars.fscontrolx=0,oc_dynFlashVars.fscontroly=280,oc_globalMainApp.push(etsapi.embedPlayer("oc_vplayer","oc_mediaplayerdiv",frameWidth,frameHeight,"bnn","640x360/",{flashVars:oc_dynFlashVars,adRule:"generic"})),globalMainAppLength=oc_globalMainApp.length,oc_globalMainApp[oc_globalMainApp.length-1].registerEvent(MediaPlayerControllerEvent.PLAYER_READY,this,OneClipPlayer.onPlayerReady),oc_globalMainApp[oc_globalMainApp.length-1].registerEvent(MediaPlayerControllerEvent.VIDEO_STARTED,this,OneClipPlayer.onVideoStart),oc_globalMainApp[oc_globalMainApp.length-1].registerEvent(MediaPlayerControllerEvent.VIDEO_COAD,this,OneClipPlayer.onVideoCoAd)},OneClipPlayer.onVideoStart=function(){outputLog("onVideoStart")},OneClipPlayer.onPlayerReady=function(){outputLog("__GenericAdRuleInPlace____"),outputLog("onPlayerReady")},OneClipPlayer.onVideoCoAd=function(infoObj){var contentDiv,i;if(outputLog("inside coad handler"),contentDiv="",infoObj.ads!=undefined)for(i=0;i<infoObj.ads.length;i++)contentDiv=infoObj.ads[i].content,infoObj.dartTemplate=="js"&&contentDiv!=""?contentDiv='<script language="JavaScript" src="'+infoObj.ads[i].content+'"   type="text/javascript"><\/script>':infoObj.dartTemplate=="vast"&&contentDiv!=""?(outputLog("vast coad is: "+infoObj.ads[i].content),contentDiv=infoObj.ads[i].content):outputLog("no js no vast"+infoObj.dartTemplate),outputLog(infoObj.dartTemplate+" contentDiv is "+contentDiv),OneClipPlayer.writeIntoCompanionDiv(contentDiv,infoObj.ads[i].size)},OneClipPlayer.writeIntoCompanionDiv=function(content,size){content!=""&&(outputLog(content),$("#AdModule_"+size).writeCapture().html(content))}}(BNN.Modules.OneClipPlayer);
Agility.RegisterNamespace("BNN.Modules.NewVideoCarousel"),function(NewVideoCarousel){function outputLog(str){try{console.log("[ ETS ]="+str)}catch(e){}}var _scrollSettings={duration:1e3},_itemsToScroll=5,_mode=1,width,height,v_arr=[],zone="",playerObjList={},container=null,timeout=500,closetimer=0,prop=null;NewVideoCarousel.OnInit=function(pr){prop=pr,$.each(eval(prop.FirstPageRecords),function(i,l){$("a#click_"+l.ClipId).fancybox({hideOnContentClick:!1,autoDimensions:!1,width:650,height:360,scrolling:"no",onStart:function(){NewVideoCarousel.LaunchPlayer(l.ClipId)}})})},NewVideoCarousel.LoadVideos=function(latestVideos,pagesize){var maincontainer=prop.ContainerID;container=$("#"+maincontainer),(latestVideos.length>0||!latestVideos)&&($("#"+maincontainer+" .NotFound").hide(),_updateNewVideoCarouselContainerContentByPage(latestVideos,maincontainer,pagesize))},_updateNewVideoCarouselContainerContentByPage=function(content,maincontainer,pagesize){for(var tmpArr=[],templateUrl,container,i=0;i<pagesize;i++)tmpArr.push(content[i]);templateUrl=Agility.ResolveUrl("~/ClientTemplates/NewVideoCarousel.htm"),container=$("#"+maincontainer+" .Videos"),container.html(""),container.setTemplateURL(templateUrl),container.setParam("MainContainer",maincontainer),container.processTemplate(tmpArr),$.each(eval(tmpArr),function(i,l){$("a#click_"+l.ClipId).fancybox({hideOnContentClick:!1,autoDimensions:!1,width:650,height:360,scrolling:"no",onStart:function(){NewVideoCarousel.LaunchPlayer(l.ClipId)}})})},NewVideoCarousel.LoadVideosAllByPage=function(){var pageNum=BNN.Controls.Pager.CurrentPage;$.ajax({url:AjaxWebserviceSvcUrl+"/GetVideoJsonFromXmlByPage?videoBinId="+prop.BinId+"&pageNum="+pageNum+"&pageSize="+prop.VideosPerPage,contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var result={d:jsonResponse},str;result.d!=undefined&&result.d!=null&&(str=eval(result.d),BNN.Modules.NewVideoCarousel.LoadVideos(str,prop.VideosPerPage),BNN.Controls.Pager.Render(prop.TotalCount))}})},NewVideoCarousel.LaunchPlayer=function(clipid){var nvc_dynFlashVars;nvc_dynFlashVars="nvc_mpFlashVars_",eval("var "+nvc_dynFlashVars+";"),nvc_dynFlashVars={},nvc_dynFlashVars.vid=clipid,nvc_dynFlashVars.autoplay=0,nvc_dynFlashVars.zone=BNN.AdModule.GetPreRollZone(""),nvc_dynFlashVars.programlogo="http://www.bnn.ca/Images/Icons/bnn_videoplayerlogo.png";var Environment="",pUri=BNN.AdModule.parseUri(window.location),domain=pUri.authority.toLowerCase();Environment=domain=="bnn.local"||domain=="stage-origin.bnn.ca"?"dev":"prod",nvc_dynFlashVars.dartkey="envr="+Environment+";",nvc_dynFlashVars.fscontrolx=0,nvc_dynFlashVars.fscontroly=370,nvc_dynFlashVars.fsinfox=-110,nvc_dynFlashVars.fsinfoy=-60,nvc_globalMainApp.push(etsapi.embedPlayer("nvc_vplayer","nvc_mediaplayerdiv_"+clipid,640,360,"bnn","640x360/",{flashVars:nvc_dynFlashVars})),globalMainAppLength=oc_globalMainApp.length,nvc_globalMainApp[nvc_globalMainApp.length-1].registerEvent(MediaPlayerControllerEvent.PLAYER_READY,this,NewVideoCarousel.onPlayerReady),nvc_globalMainApp[nvc_globalMainApp.length-1].registerEvent(MediaPlayerControllerEvent.VIDEO_STARTED,this,NewVideoCarousel.onVideoStart),nvc_globalMainApp[nvc_globalMainApp.length-1].registerEvent(MediaPlayerControllerEvent.VIDEO_COAD,this,NewVideoCarousel.onVideoCoAd)},NewVideoCarousel.onVideoStart=function(){outputLog("onVideoStart")},NewVideoCarousel.onPlayerReady=function(){outputLog("onPlayerReady")},NewVideoCarousel.onVideoCoAd=function(infoObj){var contentDiv,i;if(outputLog("inside coad handler"),contentDiv="",infoObj.ads!=undefined)for(i=0;i<infoObj.ads.length;i++)contentDiv=infoObj.ads[i].content,infoObj.dartTemplate=="js"&&contentDiv!=""?contentDiv='<script language="JavaScript" src="'+infoObj.ads[i].content+'"   type="text/javascript"><\/script>':infoObj.dartTemplate=="vast"&&contentDiv!=""?(outputLog("vast coad is: "+infoObj.ads[i].content),contentDiv=infoObj.ads[i].content):outputLog("no js no vast"+infoObj.dartTemplate),outputLog(infoObj.dartTemplate+" contentDiv is "+contentDiv),OneClipPlayer.writeIntoCompanionDiv(contentDiv,infoObj.ads[i].size)},NewVideoCarousel.writeIntoCompanionDiv=function(content,size){content!=""&&(outputLog(content),$("#AdModule_"+size).writeCapture().html(content))}}(BNN.Modules.NewVideoCarousel);
Agility.RegisterNamespace("BNN.Modules.VideoList"),function(VideoList){function onVideoStart(infoObj){outputLog("onVideoStart"),$(".VideoList .VideoTitle").html(infoObj.title),$(".VideoList .VideoTitle").attr("title",infoObj.title)}function onPlayerReady(){outputLog("onPlayerReady")}function outputLog(str){try{console.log("[ ETS ]="+str)}catch(e){}}function onVideoCoAd(infoObj){var contentDiv,i;if(outputLog("inside coad handler"),contentDiv="",infoObj.ads!=undefined)for(i=0;i<infoObj.ads.length;i++)contentDiv=infoObj.ads[i].content,infoObj.dartTemplate=="js"&&contentDiv!=""?contentDiv='<script language="JavaScript" src="'+infoObj.ads[i].content+'"   type="text/javascript"><\/script>':infoObj.dartTemplate=="vast"&&contentDiv!=""?(outputLog("vast coad is: "+infoObj.ads[i].content),contentDiv=infoObj.ads[i].content):outputLog("no js no vast"),outputLog(infoObj.dartTemplate+" contentDiv is "+contentDiv),writeIntoCompanionDiv(contentDiv,infoObj.ads[i].size)}function writeIntoCompanionDiv(content,size){content!=""&&(outputLog(content),$("#AdModule_"+size).writeCapture().html(content))}function cancelTimer(){closetimer&&(window.clearTimeout(closetimer),closetimer=null)}function removeFilterSelected(elem){$.each($(".ViewBy .FilterView .SubMenu .Content a",container).not(elem),function(){$(this).removeClass("Selected")})}function removeAllFilterSelected(){$.each($(".ViewBy .FilterView .SubMenu .Content a",container),function(){$(this).removeClass("Selected")})}function removeMonthSelected(elem){$.each($(".Filter .FilterMonth .FilterView .SubMenu .Content a",container).not(elem),function(){$(this).removeClass("Selected")})}function removeAllMonthSelected(){$.each($(".Filter .FilterMonth .FilterView .SubMenu .Content a",container),function(){$(this).removeClass("Selected")})}function loadPagerControl(totalCount,loadFunction){$.ajax({url:AjaxWebserviceSvcUrl+"/ConfigurePlayerPager?TotalCount="+totalCount+"&VideosPerPage="+prop.VideosPerPage+"&loadFunction="+loadFunction,contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var result={d:jsonResponse};result.d!=undefined&&result.d!=null&&$("#Pager").html(result.d)}})}var _mode=1,width,height,v_arr=[],zone="",playerObjList={},container=null,timeout=500,closetimer=0,prop=null,maincontainer=null,selectedMonth=null,selectedYear=null,selectedDate=null,selectedKeyword=null,TotalCount=null,AdditionalTotalCount=null,selectedTab=0;VideoList.OnInit=function(pr){var mainApp,playlistObj,mpFlashVars,i;if(prop=pr,maincontainer=prop.ContainerID,container=$("#"+maincontainer),TotalCount=pr.TotalCount,AdditionalTotalCount=pr.AdditonalTotalCount,VideoList.OnMenuInit(),VideoList.ConfigureMenuFilter(maincontainer),prop.AdditionalBinId<=0&&AdditionalTotalCount<=0&&($(".VideoList .Tabs").hide(),$(".VideoList .ViewBy").css("margin","0"),$(".VideoList .ViewBy").css("float","right"),$(".VideoList .FilterMonth").css("float","right"),$(".VideoList .FilterDay").css("float","right"),$(".VideoList .FilterKeyword").css("float","right")),prop.FirstClipID.length>0||!prop.FirstClipID){$("#"+maincontainer+" .NotFound").hide(),(width==undefined||width==null)&&(width=640),(height==undefined||height==null)&&(height=360),$("#"+maincontainer+" #VideoListTab1 .Tab1Results").html(prop.TotalCount.toString()+" clips"),$("#"+maincontainer+" #VideoListTab2 .Tab2Results").html(AdditionalTotalCount+" clips"),mpFlashVars={},mpFlashVars.vid=prop.FirstClipID,mpFlashVars.autoplay=0,mpFlashVars.zone=BNN.AdModule.GetZone(""),mpFlashVars.dartkey="envr=dev;",mainApp=etsapi.embedPlayer("vplayer","mediaplayerdiv",width,height,"bnn","640x360/",{flashVars:mpFlashVars}),mainApp.registerEvent(MediaPlayerControllerEvent.PLAYER_READY,this,onPlayerReady),mainApp.registerEvent(MediaPlayerControllerEvent.VIDEO_STARTED,this,onVideoStart),playerObjList.vplayer=mainApp;for(i in playerObjList)playerObjList[i].registerEvent(MediaPlayerControllerEvent.VIDEO_COAD,this,onVideoCoAd);$("#"+maincontainer+" .VideoTitle").html(prop.FirstClipID.Title),$("#"+maincontainer+" .VideoTitle").attr("title",prop.FirstClipID.Title)}else $("#"+maincontainer+" .NotFound").show(),$("#"+maincontainer+" .Videos").hide(),$("#"+maincontainer+" .ViewBy").hide(),$("#"+maincontainer+" .Filter").hide()},VideoList.PlayElement=function(clipId){playerObjList.vplayer.playMediaByID(clipId)},VideoList.OnMenuInit=function(){var config={over:BNN.Modules.VideoList.OnMenuOpen,out:BNN.Modules.VideoList.OnMenuTimer,timeout:10},lis,lis2;$(".ViewBy > a",container).each(function(){var subMenuID=$(this).attr("menuclass");$(this).append($("."+subMenuID,container))}),lis=$(".ViewBy > a",container),lis.hoverIntent(config),$(".FilterMonth > a",container).each(function(){var subMenuID=$(this).attr("menuclass");$(this).append($("."+subMenuID,container))}),lis2=$(".FilterMonth > a",container),lis2.hoverIntent(config)},VideoList.ConfigureMenuFilter=function(maincontainer){$("#hypAllVideos").bind("click",function(){$("#"+maincontainer+" .Filter .FilterMonth").hide(),$("#"+maincontainer+" .Filter .FilterDay").hide(),$("#"+maincontainer+" .Filter .FilterKeyword").hide(),$(this).addClass("Selected"),removeFilterSelected(this)}),$("#hypByMonth").bind("click",function(){$("#"+maincontainer+" .Filter .FilterMonth").show(),$("#"+maincontainer+" .Filter .FilterDay").hide(),$("#"+maincontainer+" .Filter .FilterKeyword").hide(),$(this).addClass("Selected"),removeFilterSelected(this)}),$("#hypByDay").bind("click",function(){$("#"+maincontainer+" .Filter .FilterMonth").hide(),$("#"+maincontainer+" .Filter .FilterDay").show(),$("#"+maincontainer+" .Filter .FilterKeyword").hide(),$(this).addClass("Selected"),removeFilterSelected(this)}),$("#hypByKeyWord").bind("click",function(){$("#"+maincontainer+" .Filter .FilterMonth").hide(),$("#"+maincontainer+" .Filter .FilterDay").hide(),$("#"+maincontainer+" .Filter .FilterKeyword").show(),$(this).addClass("Selected"),removeFilterSelected(this)}),$("#btnKeyword").bind("click",function(){selectedKeyword=$("#keywordSearch").val(),selectedTab==0?(VideoList.LoadVideosAllByKeywordByPage2(selectedKeyword),selectedTab=0,$(".VideoList .Videos").show(),$(".VideoList .AdditionalVideos").hide(),$("#VideoListTab1").addClass("Selected"),$("#VideoListTab2").removeClass("Selected")):(VideoList.LoadAdditionalVideosAllByKeywordByPage2(selectedKeyword),selectedTab=1,$(".VideoList .Videos").hide(),$(".VideoList .AdditionalVideos").show(),$("#VideoListTab2").addClass("Selected"),$("#VideoListTab1").removeClass("Selected")),$("#keywordSearch").val("")}),$(".hypMonthSelected").bind("click",function(){selectedMonth=$(this).text(),selectedYear=$(this).attr("data-year"),selectedTab==0?(VideoList.LoadVideosAllByMonthByPage2(),selectedTab=0,$(".VideoList .Videos").show(),$(".VideoList .AdditionalVideos").hide(),$("#VideoListTab1").addClass("Selected"),$("#VideoListTab2").removeClass("Selected")):(VideoList.LoadAdditionalVideosAllByMonthByPage2(),selectedTab=1,$(".VideoList .Videos").hide(),$(".VideoList .AdditionalVideos").show(),$("#VideoListTab2").addClass("Selected"),$("#VideoListTab1").removeClass("Selected")),$(this).addClass("Selected"),removeMonthSelected(this)}),$("#hypAllVideos").bind("click",function(){selectedTab==0?(VideoList.LoadVideosAllByPage2(),selectedTab=0,$(".VideoList .Videos").show(),$(".VideoList .AdditionalVideos").hide(),$("#VideoListTab1").addClass("Selected"),$("#VideoListTab2").removeClass("Selected")):(VideoList.LoadAdditionalVideosAllByPage2(),selectedTab=1,$(".VideoList .Videos").hide(),$(".VideoList .AdditionalVideos").show(),$("#VideoListTab2").addClass("Selected"),$("#VideoListTab1").removeClass("Selected"))})},VideoList.DateClick=function(date){selectedDate=date,selectedTab==0?(BNN.Modules.VideoList.LoadVideosAllByDateByPage2(),selectedTab=0,$(".VideoList .Videos").show(),$(".VideoList .AdditionalVideos").hide(),$("#VideoListTab1").addClass("Selected"),$("#VideoListTab2").removeClass("Selected")):(BNN.Modules.VideoList.LoadAdditionalVideosAllByDateByPage2(),selectedTab=1,$(".VideoList .Videos").hide(),$(".VideoList .AdditionalVideos").show(),$("#VideoListTab2").addClass("Selected"),$("#VideoListTab1").removeClass("Selected"))},VideoList.ExpandDetails=function(ClipId){$("#Expanded_"+ClipId).show(),$.each($(".VideoList .VideoListContainer .Videos .list .Item .Expanded").not($("#Expanded_"+ClipId)),function(){$(this).hide()})},VideoList.CloseDetails=function(ClipId){$("#Expanded_"+ClipId).hide()},VideoList.OnMenuOpen=function(){cancelTimer(),BNN.Modules.VideoList.OnMenuClose();var subMenu=$(this).attr("menuclass");$("."+subMenu,container).show()},VideoList.OnMenuClose=function(){$(".SubMenu",container).hide()},VideoList.OnMenuTimer=function(){closetimer=window.setTimeout("BNN.Modules.VideoList.OnMenuClose()",timeout)},VideoList.formatTitle=function(title){var show;return show=title.indexOf("[")!=-1?title.substr(0,title.indexOf("[")):title},VideoList.formatDate=function(inDate){return inDate},VideoList.LoadVideos=function(content,pagesize){var maincontainer=prop.ContainerID;container=$("#"+maincontainer),(content.length>0||!content)&&($("#"+maincontainer+" .NotFound").hide(),_updateVideoListContainerContentByPage(content,maincontainer,pagesize))},VideoList.LoadAdditionalVideos=function(content,pagesize){var maincontainer=prop.ContainerID;container=$("#"+maincontainer),(content.length>0||!content)&&($("#"+maincontainer+" .NotFound").hide(),_updateAdditionalVideoListContainerContentByPage(content,maincontainer,pagesize))},_updateVideoListContainerContentByPage=function(content,maincontainer,pagesize){for(var tmpArr=[],templateUrl,container,i=0;i<pagesize;i++)tmpArr.push(content[i]);templateUrl=Agility.ResolveUrl("~/ClientTemplates/VideoList.htm"),container=$("#"+maincontainer+" .VideoListContainer .Videos .list"),container.html(""),container.setTemplateURL(templateUrl),container.setParam("MainContainer",maincontainer),container.processTemplate(content)},_updateAdditionalVideoListContainerContentByPage=function(content,maincont
ainer,pagesize){for(var tmpArr=[],templateUrl,container,i=0;i<pagesize;i++)tmpArr.push(content[i]);templateUrl=Agility.ResolveUrl("~/ClientTemplates/VideoList.htm"),container=$("#"+maincontainer+" .VideoListContainer .AdditionalVideos .list"),container.html(""),container.setTemplateURL(templateUrl),container.setParam("MainContainer",maincontainer),container.processTemplate(content)},VideoList.LoadVideosAllByPage=function(){var pageNum=BNN.Controls.Pager.CurrentPage,height=$("#"+maincontainer+" .Videos").height();$("#"+maincontainer+" .Videos .list").html('<div class="VideoLoading">'),$("#"+maincontainer+" .Videos .VideoLoading").css("height",height+"px"),$.ajax({url:AjaxWebserviceSvcUrl+"/GetNewVideoJsonFromXmlByPage?videoBinId="+prop.BinId+"&pageNum="+pageNum+"&pageSize="+prop.VideosPerPage,contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var result={d:jsonResponse},str;result.d!=undefined&&result.d!=null&&(str=eval(result.d),TotalCount=str.TotalCount,BNN.Modules.VideoList.LoadVideos(str.videos,prop.VideosPerPage),BNN.Controls.Pager.Render(TotalCount),$("#"+maincontainer+".Videos .list .VideoLoading").hide())}})},VideoList.LoadVideosAllByPage2=function(){var pageNum=BNN.Controls.Pager.CurrentPage,height=$("#"+maincontainer+" .Videos").height();$("#"+maincontainer+" .Videos .list").html('<div class="VideoLoading">'),$("#"+maincontainer+" .Videos .VideoLoading").css("height",height+"px"),$.ajax({url:AjaxWebserviceSvcUrl+"/GetNewVideoJsonFromXmlByPage?videoBinId="+prop.BinId+"&pageNum="+pageNum+"&pageSize="+prop.VideosPerPage,contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var result={d:jsonResponse};result.d!=undefined&&result.d!=null&&(TotalCount=result.d.TotalCount,BNN.Modules.VideoList.LoadVideos(result.d.videos,prop.VideosPerPage),$("#"+maincontainer+" .Tab1Results").html(TotalCount.toString()+" clips"),loadPagerControl(TotalCount,"BNN.Modules.VideoList.LoadVideosAllByPage"),$("#"+maincontainer+".Videos .list .VideoLoading").hide())}})},VideoList.LoadAdditionalVideosAllByPage=function(){var pageNum=BNN.Controls.Pager.CurrentPage,height=434;$("#"+maincontainer+" .AdditionalVideos .list").html('<div class="VideoLoading">'),$("#"+maincontainer+" .AdditionalVideos .VideoLoading").css("height",height+"px"),$.ajax({url:AjaxWebserviceSvcUrl+"/GetNewVideoJsonFromXmlByPage?videoBinId="+prop.AdditionalBinId+"&pageNum="+pageNum+"&pageSize="+prop.VideosPerPage,contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var result={d:jsonResponse},str;result.d!=undefined&&result.d!=null&&(str=eval(result.d),AdditionalTotalCount=str.TotalCount,BNN.Modules.VideoList.LoadAdditionalVideos(str.videos,prop.VideosPerPage),BNN.Controls.Pager.Render(AdditionalTotalCount),$("#"+maincontainer+".AdditionalVideos .list .VideoLoading").hide())}})},VideoList.LoadAdditionalVideosAllByPage2=function(){var pageNum=BNN.Controls.Pager.CurrentPage,height=434;$("#"+maincontainer+" .AdditionalVideos .list").html('<div class="VideoLoading">'),$("#"+maincontainer+" .AdditionalVideos .VideoLoading").css("height",height+"px"),$.ajax({url:AjaxWebserviceSvcUrl+"/GetNewVideoJsonFromXmlByPage?videoBinId="+prop.AdditionalBinId+"&pageNum="+pageNum+"&pageSize="+prop.VideosPerPage,contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var result={d:jsonResponse};result.d!=undefined&&result.d!=null?(AdditionalTotalCount=result.d.TotalCount,BNN.Modules.VideoList.LoadAdditionalVideos(result.d.videos,prop.VideosPerPage),$("#Pager").html(""),loadPagerControl(AdditionalTotalCount,"BNN.Modules.VideoList.LoadAdditionalVideosAllByPage")):($("#Pager").html(""),$("#"+maincontainer+" .VideoListContainer .Videos .list").html(prop.NotFoundMessage)),$("#"+maincontainer+" .Tab2Results").html(AdditionalTotalCount.toString()+" clips"),$("#"+maincontainer+".AdditionalVideos .list .VideoLoading").hide()}})},VideoList.LoadVideosAllByMonthByPage=function(){var pageNum=BNN.Controls.Pager.CurrentPage,height=$("#"+maincontainer+" .Videos").height();$("#"+maincontainer+" .Videos .list").html('<div class="VideoLoading">'),$("#"+maincontainer+" .Videos .VideoLoading").css("height",height+"px"),$.ajax({url:AjaxWebserviceSvcUrl+"/GetNewVideoJsonFromXmlByMonthByPage?videoBinId="+prop.BinId+"&month="+selectedMonth+"&year="+selectedYear+"&pageNum="+pageNum+"&pageSize="+prop.VideosPerPage,contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var result={d:jsonResponse},str;result.d!=undefined&&result.d!=null?(str=eval(result.d),BNN.Modules.VideoList.LoadVideos(result.d.videos,prop.VideosPerPage),BNN.Controls.Pager.Render(result.d.TotalCount),$("#"+maincontainer+".Videos .list .VideoLoading").hide()):($("#"+maincontainer+" .Videos .list .VideoLoading").hide(),$("#"+maincontainer+" .Videos .Videos .list").html(prop.NotFoundMessage))}})},VideoList.LoadAdditionalVideosAllByMonthByPage=function(){var pageNum=BNN.Controls.Pager.CurrentPage,height=$("#"+maincontainer+" .AdditionalVideos").height();$("#"+maincontainer+" .AdditionalVideos .list").html('<div class="VideoLoading">'),$("#"+maincontainer+" .AdditionalVideos .VideoLoading").css("height",height+"px"),$.ajax({url:AjaxWebserviceSvcUrl+"/GetNewVideoJsonFromXmlByMonthByPage?videoBinId="+prop.AdditionalBinId+"&month="+selectedMonth+"&year="+selectedYear+"&pageNum="+pageNum+"&pageSize="+prop.VideosPerPage,contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var result={d:jsonResponse},str;result.d!=undefined&&result.d!=null&&(str=eval(result.d),BNN.Modules.VideoList.LoadVideos(result.d.videos,prop.VideosPerPage),BNN.Controls.Pager.Render(result.d.TotalCount),$("#"+maincontainer+".AdditionalVideos .list .VideoLoading").hide())}})},VideoList.LoadVideosAllByMonthByPage2=function(){var pageNum=BNN.Controls.Pager.CurrentPage,height=$("#"+maincontainer+" .Videos").height();$("#"+maincontainer+" .Videos .list").html('<div class="VideoLoading">'),$("#"+maincontainer+" .Videos .VideoLoading").css("height",height+"px"),$.ajax({url:AjaxWebserviceSvcUrl+"/GetNewVideoJsonFromXmlByMonthByPage?videoBinId="+prop.BinId+"&month="+selectedMonth+"&year="+selectedYear+"&pageNum="+pageNum+"&pageSize="+prop.VideosPerPage,contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var result={d:jsonResponse};result.d!=undefined&&result.d!=null&&(result.d.TotalCount>0?(BNN.Modules.VideoList.LoadVideos(result.d.videos,prop.VideosPerPage),$("#Pager").html(""),loadPagerControl(result.d.TotalCount,"BNN.Modules.VideoList.LoadVideosAllByMonthByPage")):($("#"+maincontainer+" .Videos .list").html(prop.NotFoundMessage),$("#Pager").html("")),$("#"+maincontainer+" .Tab1Results").html(result.d.TotalCount.toString()+" clips"),$("#"+maincontainer+" .Videos .list .VideoLoading").hide())}})},VideoList.LoadAdditionalVideosAllByMonthByPage2=function(){var pageNum=BNN.Controls.Pager.CurrentPage,height=$("#"+maincontainer+" .Videos").height();$("#"+maincontainer+" .AdditionalVideos .list").html('<div class="VideoLoading">'),$("#"+maincontainer+" .AdditionalVideos .VideoLoading").css("height",height+"px"),$.ajax({url:AjaxWebserviceSvcUrl+"/GetNewVideoJsonFromXmlByMonthByPage?videoBinId="+prop.AdditionalBinId+"&month="+selectedMonth+"&year="+selectedYear+"&pageNum="+pageNum+"&pageSize="+prop.VideosPerPage,contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var result={d:jsonResponse};result.d!=undefined&&result.d!=null&&(result.d.TotalCount>0?(BNN.Modules.VideoList.LoadAdditionalVideos(result.d.videos,prop.VideosPerPage),$("#Pager").html(""),loadPagerControl(result.d.TotalCount,"BNN.Modules.VideoList.LoadAdditionalVideosAllByMonthByPage")):($("#"+maincontainer+" .AdditionalVideos .list").html(prop.NotFoundMessage),$("#Pager").html("")),$("#"+maincontainer+" .Tab2Results").html(result.d.TotalCount.toString()+" clips"),$("#"+maincontainer+".AdditionalVideos .list .VideoLoading").hide())}})},VideoList.LoadVideosAllByDateByPage=function(){var pageNum=BNN.Controls.Pager.CurrentPage,height=$("#"+maincontainer+" .Videos").height();$("#"+maincontainer+" .Videos .list").html('<div class="VideoLoading">'),$("#"+maincontainer+" .Videos .VideoLoading").css("height",height+"px"),$.ajax({url:AjaxWebserviceSvcUrl+"/GetNewVideoJsonFromXmlByDateByPage?videoBinId="+prop.BinId+"&date="+selectedDate+"&pageNum="+pageNum+"&pageSize="+prop.VideosPerPage,contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var result={d:jsonResponse},str;result.d!=undefined&&result.d!=null&&(result.d.TotalCount>0?(str=eval(result.d),BNN.Modules.VideoList.LoadVideos(result.d.videos,prop.VideosPerPage),BNN.Controls.Pager.Render(result.d.TotalCount)):($("#"+maincontainer+" .Videos .list").html(prop.NotFoundMessage),$("#Pager").html(""))),$("#"+maincontainer+".Videos .list .VideoLoading").hide()}})},VideoList.LoadAdditionalVideosAllByDateByPage=function(){var pageNum=BNN.Controls.Pager.CurrentPage,height=$("#"+maincontainer+" .Videos").height();$("#"+maincontainer+" .AdditionalVideos .list").html('<div class="VideoLoading">'),$("#"+maincontainer+" .AdditionalVideos .VideoLoading").css("height",height+"px"),$.ajax({url:AjaxWebserviceSvcUrl+"/GetNewVideoJsonFromXmlByDateByPage?videoBinId="+prop.AdditionalBinId+"&date="+selectedDate+"&pageNum="+pageNum+"&pageSize="+prop.VideosPerPage,contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var result={d:jsonResponse},str;result.d!=undefined&&result.d!=null&&(result.d.TotalCount>0?(str=eval(result.d),BNN.Modules.VideoList.LoadAdditionalVideos(result.d.videos,prop.VideosPerPage),BNN.Controls.Pager.Render(result.d.TotalCount)):($("#"+maincontainer+" .AdditionalVideos .list").html(prop.NotFoundMessage),$("#Pager").html(""))),$("#"+maincontainer+".AdditionalVideos
 .list .VideoLoading").hide()}})},VideoList.LoadVideosAllByDateByPage2=function(){var pageNum=BNN.Controls.Pager.CurrentPage,height=$("#"+maincontainer+" .Videos").height();$("#"+maincontainer+" .Videos .list").html('<div class="VideoLoading">'),$("#"+maincontainer+" .Videos .VideoLoading").css("height",height+"px"),$.ajax({url:AjaxWebserviceSvcUrl+"/GetNewVideoJsonFromXmlByDateByPage?videoBinId="+prop.BinId+"&date="+selectedDate+"&pageNum="+pageNum+"&pageSize="+prop.VideosPerPage,contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var result={d:jsonResponse},str;result.d!=undefined&&result.d!=null&&(result.d.TotalCount>0?(str=eval(result.d),BNN.Modules.VideoList.LoadVideos(result.d.videos,prop.VideosPerPage),$("#Pager").html(""),loadPagerControl(result.d.TotalCount,"BNN.Modules.VideoList.LoadVideosAllByDateByPage")):($("#"+maincontainer+" .Videos .list").html(prop.NotFoundMessage),$("#Pager").html("")),$("#"+maincontainer+" .Tab1Results").html(result.d.TotalCount.toString()+" clips"),$("#"+maincontainer+".Videos .list .VideoLoading").hide())}})},VideoList.LoadAdditionalVideosAllByDateByPage2=function(){var pageNum=BNN.Controls.Pager.CurrentPage,height=$("#"+maincontainer+" .AdditionalVideos").height();$("#"+maincontainer+" .AdditionalVideos .list").html('<div class="VideoLoading">'),$("#"+maincontainer+" .AdditionalVideos .VideoLoading").css("height",height+"px"),$.ajax({url:AjaxWebserviceSvcUrl+"/GetNewVideoJsonFromXmlByDateByPage?videoBinId="+prop.AdditionalBinId+"&date="+selectedDate+"&pageNum="+pageNum+"&pageSize="+prop.VideosPerPage,contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var result={d:jsonResponse},str;result.d!=undefined&&result.d!=null&&(result.d.TotalCount>0?(str=eval(result.d),BNN.Modules.VideoList.LoadAdditionalVideos(result.d.videos,prop.VideosPerPage),$("#Pager").html(""),loadPagerControl(result.d.TotalCount,"BNN.Modules.VideoList.LoadAdditionalVideosAllByDateByPage")):($("#"+maincontainer+" .AdditionalVideos .list").html(prop.NotFoundMessage),$("#Pager").html("")),$("#"+maincontainer+" .Tab2Results").html(result.d.TotalCount.toString()+" clips"),$("#"+maincontainer+".AdditionalVideos .list .VideoLoading").hide())}})},VideoList.LoadVideosAllByKeywordByPage=function(){var pageNum=BNN.Controls.Pager.CurrentPage,height=$("#"+maincontainer+" .lVideos").height();$("#"+maincontainer+" .Videos .list").html('<div class="VideoLoading">'),$("#"+maincontainer+" .Videos .VideoLoading").css("height",height+"px"),$.ajax({url:AjaxWebserviceSvcUrl+"/GetNewVideoJsonFromXmlByKeywordByPage?videoBinId="+prop.BinId+"&keyword="+selectedKeyword+"&pageNum="+pageNum+"&pageSize="+prop.VideosPerPage,contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var result={d:jsonResponse},str;result.d!=undefined&&result.d!=null&&(str=eval(result.d),BNN.Modules.VideoList.LoadVideos(result.d.videos,prop.VideosPerPage),BNN.Controls.Pager.Render(result.d.TotalCount),$("#"+maincontainer+".Videos .VideoLoading").hide())}})},VideoList.LoadAdditionalVideosAllByKeywordByPage=function(){var pageNum=BNN.Controls.Pager.CurrentPage,height=$("#"+maincontainer+" .lVideos").height();$("#"+maincontainer+" .AdditionalVideos .list").html('<div class="VideoLoading">'),$("#"+maincontainer+" .AdditionalVideos .VideoLoading").css("height",height+"px"),$.ajax({url:AjaxWebserviceSvcUrl+"/GetNewVideoJsonFromXmlByKeywordByPage?videoBinId="+prop.AdditionalBinId+"&keyword="+selectedKeyword+"&pageNum="+pageNum+"&pageSize="+prop.VideosPerPage,contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var result={d:jsonResponse},str;result.d!=undefined&&result.d!=null&&(str=eval(result.d),BNN.Modules.VideoList.LoadAdditionalVideos(result.d.videos,prop.VideosPerPage),BNN.Controls.Pager.Render(result.d.TotalCount),$("#"+maincontainer+".AdditionalVideos .VideoLoading").hide())}})},VideoList.LoadVideosAllByKeywordByPage2=function(){var pageNum=BNN.Controls.Pager.CurrentPage,height=$("#"+maincontainer+" .lVideos").height();$("#"+maincontainer+" .Videos .list").html('<div class="VideoLoading">'),$("#"+maincontainer+" .Videos .VideoLoading").css("height",height+"px"),$.ajax({url:AjaxWebserviceSvcUrl+"/GetNewVideoJsonFromXmlByKeywordByPage?videoBinId="+prop.BinId+"&keyword="+selectedKeyword+"&pageNum="+pageNum+"&pageSize="+prop.VideosPerPage,contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var result={d:jsonResponse},str;result.d!=undefined&&result.d!=null&&(result.d.TotalCount>0?(str=eval(result.d),BNN.Modules.VideoList.LoadVideos(result.d.videos,prop.VideosPerPage),$("#Pager").html(""),loadPagerControl(result.d.TotalCount,"BNN.Modules.VideoList.LoadVideosAllByKeywordByPage")):($("#"+maincontainer+" .Videos .list").html(prop.NotFoundMessage),$("#Pager").html("")),$("#"+maincontainer+" .Tab1Results").html(result.d.TotalCount.toString()+" clips"),$("#"+maincontainer+".Videos .list .VideoLoading").hide())}})},VideoList.LoadAdditionalVideosAllByKeywordByPage2=function(){var pageNum=BNN.Controls.Pager.CurrentPage,height=$("#"+maincontainer+" .lVideos").height();$("#"+maincontainer+" .AdditionalVideos .list").html('<div class="VideoLoading">'),$("#"+maincontainer+" .AdditionalVideos .VideoLoading").css("height",height+"px"),$.ajax({url:AjaxWebserviceSvcUrl+"/GetNewVideoJsonFromXmlByKeywordByPage?videoBinId="+prop.AdditionalBinId+"&keyword="+selectedKeyword+"&pageNum="+pageNum+"&pageSize="+prop.VideosPerPage,contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var result={d:jsonResponse},str;result.d!=undefined&&result.d!=null&&(result.d.TotalCount>0?(str=eval(result.d),BNN.Modules.VideoList.LoadAdditionalVideos(result.d.videos,prop.VideosPerPage),$("#Pager").html(""),loadPagerControl(result.d.TotalCount,"BNN.Modules.VideoList.LoadAdditionalVideosAllByKeywordByPage")):($("#"+maincontainer+" .AdditionalVideos .list").html(prop.NotFoundMessage),$("#Pager").html("")),$("#"+maincontainer+" .Tab2Results").html(result.d.TotalCount.toString()+" clips"),$("#"+maincontainer+".AdditionalVideos .list .VideoLoading").hide())}})},VideoList.getParameterByName=function(name){var match=RegExp("[?&]"+name+"=([^&]*)").exec(window.location.search);return match&&decodeURIComponent(match[1].replace(/\+/g," "))},VideoList.ShowTab1=function(){selectedTab=0,$(".VideoList .Videos").show(),$(".VideoList .AdditionalVideos").hide(),VideoList.LoadVideosAllByPage(),loadPagerControl(TotalCount,"BNN.Modules.VideoList.LoadVideosAllByPage"),$("#"+maincontainer+" .Tab1Results").html(TotalCount.toString()+" clips"),$("#VideoListTab1").addClass("Selected"),$("#VideoListTab2").removeClass("Selected"),removeAllFilterSelected(),removeAllMonthSelected(),$("#"+maincontainer+" .Filter .FilterMonth").hide(),$("#"+maincontainer+" .Filter .FilterDay").hide(),$("#"+maincontainer+" .Filter .FilterKeyword").hide(),TotalCount<=prop.VideosPerPage?$("#"+maincontainer+" .ViewBy").hide():$("#"+maincontainer+" .ViewBy").show()},VideoList.ShowTab2=function(){selectedTab=1,$(".VideoList .Videos").hide(),$(".VideoList .AdditionalVideos").show(),VideoList.LoadAdditionalVideosAllByPage(),loadPagerControl(AdditionalTotalCount,"BNN.Modules.VideoList.LoadAdditionalVideosAllByPage"),$("#"+maincontainer+" .Tab2Results").html(AdditionalTotalCount.toString()+" clips"),$("#VideoListTab2").addClass("Selected"),$("#VideoListTab1").removeClass("Selected"),removeAllFilterSelected(),removeAllMonthSelected(),$("#"+maincontainer+" .Filter .FilterMonth").hide(),$("#"+maincontainer+" .Filter .FilterDay").hide(),$("#"+maincontainer+" .Filter .FilterKeyword").hide()}}(BNN.Modules.VideoList);
Agility.RegisterNamespace("BNN.Modules.AxisShowPlayer"),function(AxisShowPlayer){function AxisShowBindPageFn($p,num){return $p.unbind("click").bind("click",function(){var id,ins;return id=$p.is(".Next")||$p.is(".Previous")?$p.parent().attr("id"):$p.parent().parent().attr("id"),ins=id.substring(id.indexOf("_")+1),AxisShowPlayer.LoadVideosByPage(num,ins),!1}),$p}function AxisShowPageLink(pageNum,pageText,currentPage){if(pageNum!=currentPage){var $page=$('<a class="Page" href="javascript:;"></a>').text(pageText);return $page.data("page",pageNum),AxisShowBindPageFn($page,pageNum)}return $('<a class="CurrentPage"></a>').text(pageNum)}var prop=[],InstanceNum=null,AxisQueryString=null,sortField="BroadcastDate",sortField2="BroadcastTime",player={};playerObjList={},AxisShowPlayer.OnInit=function(pr,instancenum){prop[instancenum]=pr,AxisQueryString=AxisShowPlayer.BuildAxisQueryString(1,instancenum);var maincontainer=prop[instancenum].ContainerID,height=$("#"+maincontainer+" .Videos").height();$("#"+maincontainer+" .Videos .list").html('<div class="VideoLoading">'),$("#"+maincontainer+" .Videos .VideoLoading").css("height",height+"px"),$.ajaxSetup({cache:!0}),$.ajax({url:AxisShowServiceURL+AxisQueryString,contentType:"application/json;",dataType:"jsonp",cache:!0,jsonpCallback:"getJsonFromCAPI_AxisShowPlayer",success:function(jsonResponse){var result=jsonResponse;result.Count>0?(AxisShowPlayer.ProcessVideos(result.Items,instancenum),$("#"+maincontainer+".Videos .VideoLoading").hide(),AxisShowPlayer.PagerRender($("#Pager_"+instancenum),result.Count,prop[instancenum].VideosPerPage,1,1)):$("#"+maincontainer).hide()}})},AxisShowPlayer.ProcessVideos=function(latestVideos,instancenum){var maincontainer=prop[instancenum].ContainerID;(latestVideos.length>0||!latestVideos)&&_updateAxisShowPlayerContainerContentByPage(latestVideos,maincontainer,prop[instancenum].pagesize,instancenum)},_updateAxisShowPlayerContainerContentByPage=function(content,maincontainer,pagesize,instancenum){var container=$("#Videos_"+maincontainer),templateUrl=Agility.ResolveUrl("~/ClientTemplates/AxisShowPlayer.htm");container.html(""),container.hasTemplate()||(container.setTemplateURL(templateUrl),container.setParam("DevMode",prop[instancenum].DevMode)),container.processTemplate(content),$.each(content,function(i,l){$("a#click_"+l.Id).fancybox({hideOnContentClick:!1,autoDimensions:!1,width:858,height:490,scrolling:"no",onStart:function(){if(AxisShowPlayer.SetContentID(l.Id),$("#bnnGO_mediaplayerdiv_"+l.Id).contents().length==0){$(document).on("onready.etsapi",{lv:l.Id},function(event){AxisShowPlayer.LaunchPlayer(event.data.lv)});player.ajaxCrossDomainCors(AxisApiInterfaceURL)}else AxisShowPlayer.PlayerReady(l.Id)}}),$("#play_"+l.Id).fancybox({hideOnContentClick:!1,autoDimensions:!1,width:858,height:490,scrolling:"no",onStart:function(){if(AxisShowPlayer.SetContentID(l.Id),$("#bnnGO_mediaplayerdiv_"+l.Id).contents().length==0){$(document).on("onready.etsapi",{lv:l.Id},function(event){AxisShowPlayer.LaunchPlayer(event.data.lv)});player.ajaxCrossDomainCors(AxisApiInterfaceURL)}else AxisShowPlayer.PlayerReady(l.Id)}}),$(".AxisShowPlayer .Videos .DataItem, .AxisShowPlayer .Videos .DataItem .Expanded .ExpandedLeft a").hover(function(){$(this).find(".play").toggleClass("play-on")}),$("#clip_"+l.Id+".DataItem div.Details div.Title a, #Expanded_"+l.Id+".Expanded .ExpandedLeft .ExpandedLeftThumbContainer a, #Expanded_"+l.Id+".Expanded .ExpandedLeft .Title a").bind("click",function(){$("a#click_"+l.Id).trigger("click")}),$(".AxisShowPlayer .Videos .DataItem #Expanded_"+l.Id+".Expanded .ExpandedKeywords .Keywords .keyword").bind("click",function(){AxisShowPlayer.KeywordClick($(this).html(),instancenum),$(this).parent().parent().parent().is(".Expanded")&&$(this).parent().parent().parent().hide()})})},AxisShowPlayer.LoadVideosByPage=function(PageNum,InstanceNum){AxisQueryString=AxisShowPlayer.BuildAxisQueryString(PageNum,InstanceNum);var maincontainer=prop[InstanceNum].ContainerID,height=$("#"+maincontainer+" .Videos").height();$("#"+maincontainer+" .Videos").html('<div class="VideoLoading">'),$("#"+maincontainer+" .Videos .VideoLoading").css("height",height+"px"),$.ajaxSetup({cache:!0}),$.ajax({url:AxisShowServiceURL+AxisQueryString,contentType:"application/json;",dataType:"jsonp",cache:!0,jsonpCallback:"getJsonFromCAPI_AxisShowPlayer",success:function(jsonResponse){var result=jsonResponse;result!=undefined&&result!=null&&(AxisShowPlayer.ProcessVideos(result.Items,InstanceNum),$("#"+maincontainer+".Videos .VideoLoading").hide(),AxisShowPlayer.PagerRender($("#Pager_"+InstanceNum),result.Count,prop[InstanceNum].VideosPerPage,PageNum))}})},AxisShowPlayer.ProcessThumbnail=function(imageObj){if(imageObj!=null&&imageObj[0].Type=="thumbnail")return imageObj[0].Url+"?height=118&width=210"},AxisShowPlayer.is_empty=function(obj){if(obj==null)return!0;if(obj.length&&obj.length>0)return!1;if(obj.length===0)return!0;for(var key in obj)if(hasOwnProperty.call(obj,key))return!1;return!0},AxisShowPlayer.getMedia=function(mediaObj){if(mediaObj!=null)return mediaObj.Name},AxisShowPlayer.DisplayAuth=function(authObj){if(authObj!=null&&authObj.Required==!0)return"<div class='lock'></div>"},AxisShowPlayer.KeywordClick=function(keyword,instancenum){setTimeout(function(){return window.open(encodeURI(Agility.ResolveUrl(prop[instancenum].VideoHubURL)+"?Search="+keyword),"_blank"),!1},1e3)},AxisShowPlayer.ShowMeta=function(metaObj){var ret_str="",i;if(metaObj!=null){for(i=0;i<metaObj.length-1;i++)ret_str+="<span>"+metaObj[i].Name+"</span>,&nbsp;";return ret_str}},AxisShowPlayer.ShowKeywordMeta=function(metaObj){var ret_str="",i;if(metaObj!=null){for(i=0;i<metaObj.length-1;i++)ret_str+="<div class='keyword'>"+metaObj[i].Name+"</div>";return ret_str}},AxisShowPlayer.FormatDate=function(date,time){if(date!=null){var d=null,ret_str;return time!=null?(d=new Date.parse(date+"T"+time),ret_str=dateFormat(d,"m/dd/yyyy-h:MM TT")):(d=new Date.parse(date),ret_str=dateFormat(d,"m/dd/yyyy")),ret_str}return"N/A"},AxisShowPlayer.convertSeconds=function(contentPackageObj){var s=~~contentPackageObj[0].Duration,h=Math.floor(s/3600),m;return s-=h*3600,m=Math.floor(s/60),s-=m*60,m+" : "+(s<10?"0"+s:s)},AxisShowPlayer.ExpandDetails=function(ClipId){var curPos=$("#Expanded_"+ClipId).prev().attr("pos");curPos==1?($("#Expanded_"+ClipId).css("left","212px"),$("#Expanded_"+ClipId).show()):curPos==2?($("#Expanded_"+ClipId).css("left","424px"),$("#Expanded_"+ClipId).show()):$("#Expanded_"+ClipId).show(),$.each($(".AxisShowPlayer .Videos .DataItem .Expanded").not($("#Expanded_"+ClipId)),function(){$(this).hide()})},AxisShowPlayer.CloseDetails=function(ClipId){$("#Expanded_"+ClipId).hide()},AxisShowPlayer.BuildAxisQueryString=function(pageNum,instancenum){var ret_string="";return prop[instancenum].FilterType=="show"?ret_string="/medias/"+prop[instancenum].AxisContentID+"/contents?$inlinecount=true&$include=["+fieldNames+"]&$page="+pageNum+"&$top="+prop[instancenum].VideosPerPage+"&$sort="+sortField+"&$order=desc&BroadcastDate_start="+prop[instancenum].QueryStartDate+"&BroadcastDate_end="+prop[instancenum].QueryEndDate:prop[instancenum].FilterType=="latest"?ret_string="/contents?$inlinecount=true&$include=["+fieldNames+"]&$page="+pageNum+"&$top="+prop[instancenum].VideosPerPage+"&$sort="+sortField+"&$order=desc&BroadcastDate_start="+prop[instancenum].QueryStartDate+"&BroadcastDate_end="+prop[instancenum].QueryEndDate:prop[instancenum].FilterType=="all"?ret_string="/contents?$inlinecount=true&$include=["+fieldNames+"]&$page="+pageNum+"&$top="+prop[instancenum].VideosPerPage+"&$sort="+sortField+"&$order=desc":prop[instancenum].FilterType=="collection"&&(ret_string="/collections/"+prop[instancenum].AxisContentID+"/contents?$inlinecount=true&$include=["+fieldNames+"]&$page="+pageNum+"&$top="+prop[instancenum].VideosPerPage+"&$sort="+sortField+"&$order=desc&$order=desc&BroadcastDate_start="+prop[instancenum].QueryStartDate+"&BroadcastDate_end="+prop[instancenum].QueryEndDate),ret_string+=prop[instancenum].IncludeFullEpisodes?"":"&Type=segment"},AxisShowPlayer.getMedia=function(mediaObj){if(mediaObj!=null)return mediaObj.Name},AxisShowPlayer.DisplayAuth=function(authObj){if(authObj!=null&&authObj.Required==!0)return"<div class='lock'></div>"},AxisShowPlayer.ShowMeta=function(metaObj){var ret_str="",i;if(metaObj!=null){for(i=0;i<metaObj.length-1;i++)ret_str+=metaObj[i].Name+",";return ret_str}},AxisShowPlayer.CloseDetails=function(ClipId){$("#Expanded_"+ClipId).hide()},AxisShowPlayer.SetContentID=function(ClipId){contentId=ClipId},AxisShowPlayer.LaunchPlayer=function(id){var adrule=GetQuerystring("adrule","none"),mainApp,playlistObj,mpFlashVars={},zone;mpFlashVars.enablelog=AxisEnableLog,mpFlashVars.loginterval=AxisLogInterval,mpFlashVars.cms="fortytwo",mainApp=etsapi.embedPlayer("bnnGO_player_"+id,"bnnGO_mediaplayerdiv_"+id,848,480,globalDestination,"",{flashVars:mpFlashVars,adRule:adrule}),mainApp.registerEvent(MediaPlayerControllerEvent.PLAYER_READY,this,AxisShowPlayer.onPlayerReady),mainApp.registerEvent(MediaPlayerControllerEvent.VIDEO_STARTED,this,AxisShowPlayer.onVideoStarted),mainApp.registerEvent(MediaPlayerControllerEvent.VIDEO_ENDED,this,AxisShowPlayer.onVideoEnded),mainApp.registerEvent(MediaPlayerControllerEvent.ERROR,this,AxisShowPlayer.onVideoError),zone="shows/"+$("#clip_"+id+".DataItem .Details .Show").text().toLowerCase().replace(" ","").replace(" ","").replace(" ","").replace("'","").replace("'",""),etsapi.setAdZone("bnnGO_player_"+id,zone),etsapi.setMetricsVideoPlayerName("inPagePlayer"),playerObjList["bnnGO_player_"+id]=mainApp,$.each($(".AxisShowPlayer .Videos .DataItem .Expanded"),function(){$(this).hide()})},AxisShowPlayer.PlayerReady=function(){var initParms={destinationCode:globalDestination,platformCode:globalPlatform,autoPlay:1,resourceId:"BNN"},item={id:contentId};playerObjList["bnnGO_player_"+item.id].playMediaItem(item,initParms)},AxisShowPlayer.onPlayerReady=function(){_log("player
 ready"),AxisShowPlayer.PlayerReady()},AxisShowPlayer.onVideoEnded=function(){_log("player ended")},AxisShowPlayer.onVideoStarted=function(infoObj){if(infoObj.index==0&&infoObj.category=="content"){var pflowPath=window.location.pathname,pflowUrl="http://data.publishflow.com/pflowlog.gif?a=ctv.ca&h=bnn.ca&p="+encodeURI(pflowPath)+"&t="+escape(infoObj.title)+"&v=/video/player.aspx?vid="+infoObj.contentId+"&pt="+escape($(document).find("title").text().trim())+"&ts="+ +new Date,image=new Image;image.src=pflowUrl}},AxisShowPlayer.onVideoError=function(){_error("player error")},player.ajaxCrossDomainCors=function(serviceURL,info){try{player.JqueryCallBack=function(){_log("loading success: "+info);return};var ajaxPars={url:serviceURL,cache:!0,contentType:"application/json",jsonpCallback:"player.JqueryCallBack",error:function(XMLHttpRequest,textStatus){textStatus!="parsererror"&&_error("loading error: "+info+" "+textStatus)}};ajaxPars.type="GET",ajaxPars.dataType="jsonp",ajaxPars.jsonp="callback",$.ajax(ajaxPars)}catch(err){throw err;}},AxisShowPlayer.PagerRender=function($pager,numItems,postsPerPage,currentPage){var i;$pager.show();var numPages=Math.ceil(numItems/postsPerPage),links=$('<span class="Links"></span>'),$previousBtn=$pager.find("a.Previous"),$nextBtn=$pager.find("a.Next");if(numItems==0||numPages<=1){$pager.hide();return}for(currentPage<=1?$previousBtn.hide():($previousBtn.data("page",currentPage-1).show(),AxisShowBindPageFn($previousBtn,currentPage-1)),currentPage>=numPages?$nextBtn.hide():($nextBtn.data("page",currentPage+1).show(),AxisShowBindPageFn($nextBtn,currentPage+1)),links.append(AxisShowPageLink(1,1,currentPage)),currentPage>4&&links.append($("<span>...</span>")),i=Math.max(2,currentPage-2);i<=Math.min(numPages-1,currentPage+2);i++)links.append(AxisShowPageLink(i,i,currentPage));currentPage<numPages-3&&links.append($("<span>...</span>")),links.append(AxisShowPageLink(numPages,"Last",currentPage)),$(".Links",$pager).replaceWith(links).show()},GetQuerystring=function(key,default_){default_==null&&(default_=""),key=key.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var regex=new RegExp("[\\?&]"+key+"=([^&#]*)"),qs=regex.exec(window.location.href);return qs==null?default_:qs[1]},_error=function(str){try{console.error(str)}catch(e){}},_log=function(str){try{console.log(str)}catch(e){}}}(BNN.Modules.AxisShowPlayer);
Agility.RegisterNamespace("BNN.Modules.AxisOneClipPlayer"),function(AxisOneClipPlayer){var contentId,_properties,width,height,autoplay,axisoc_player={};axisoc_playerObjList={},AxisOneClipPlayer.OnInit=function(pr){_properties=pr,contentId=_properties.AxisVideoID,autoplay=_properties.AutoPlay,_properties.Size=="large"?(width=640,height=360):_properties.Size=="small"&&(width=300,height=169),(contentId!=""||contentId!=null)&&$(document).ready(function(){$(document).on("onready.etsapi",{lv:contentId},function(event){AxisOneClipPlayer.LaunchPlayer(event.data.lv)});$.getScript(AxisApiInterfaceURL,function(){})})},AxisOneClipPlayer.LaunchPlayer=function(id){_log(id);var adrule=GetQuerystring("adrule","none"),axisoc_mainApp,mpFlashVars={};mpFlashVars.enablelog=AxisEnableLog,mpFlashVars.loginterval=AxisLogInterval,mpFlashVars.cms="fortytwo",axisoc_mainApp=etsapi.embedPlayer("axisoc_player_"+id,"AxisOneClipPlayerDiv_"+id,width,height,globalDestination,"",{flashVars:mpFlashVars,adRule:adrule}),axisoc_mainApp.registerEvent(MediaPlayerControllerEvent.PLAYER_READY,this,AxisOneClipPlayer.onPlayerReady),axisoc_mainApp.registerEvent(MediaPlayerControllerEvent.VIDEO_STARTED,this,AxisOneClipPlayer.onVideoStarted),axisoc_mainApp.registerEvent(MediaPlayerControllerEvent.VIDEO_ENDED,this,AxisOneClipPlayer.onVideoEnded),axisoc_mainApp.registerEvent(MediaPlayerControllerEvent.ERROR,this,AxisOneClipPlayer.onVideoError),axisoc_playerObjList["axisoc_player_"+id]=axisoc_mainApp},AxisOneClipPlayer.PlayerReady=function(){var initParms={destinationCode:globalDestination,platformCode:globalPlatform,autoPlay:autoplay,resourceId:"BNN"},item={id:contentId};axisoc_playerObjList["axisoc_player_"+item.id].playMediaItem(item,initParms)},AxisOneClipPlayer.onPlayerReady=function(){_log("player ready"),AxisOneClipPlayer.PlayerReady()},AxisOneClipPlayer.onVideoEnded=function(){_log("player ended")},AxisOneClipPlayer.onVideoStarted=function(){_log("player started")},AxisOneClipPlayer.onVideoError=function(){_error("player error")},axisoc_player.ajaxCrossDomainCors=function(serviceURL,info){try{axisoc_player.JqueryCallBack=function(){_log("loading success: "+info);return};var ajaxPars={url:serviceURL,cache:!0,contentType:"application/json",jsonpCallback:"player.JqueryCallBack",error:function(XMLHttpRequest,textStatus){textStatus!="parsererror"&&_error("loading error: "+info+" "+textStatus)}};ajaxPars.type="GET",ajaxPars.dataType="jsonp",ajaxPars.jsonp="callback",$.ajax(ajaxPars)}catch(err){throw err;}},GetQuerystring=function(key,default_){default_==null&&(default_=""),key=key.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var regex=new RegExp("[\\?&]"+key+"=([^&#]*)"),qs=regex.exec(window.location.href);return qs==null?default_:qs[1]},_error=function(str){try{console.error(str)}catch(e){}},_log=function(str){try{console.log(str)}catch(e){}}}(BNN.Modules.AxisOneClipPlayer);
Agility.RegisterNamespace("BNN.Modules.AxisMegaPlayer"),function(AxisMegaPlayer){function removeFilterSelected(elem){$.each($(".ViewBy .FilterView .SubMenu .Content a",container).not(elem),function(){$(this).removeClass("Selected")})}function removeAllFilterSelected(){$.each($(".ViewBy .FilterView .SubMenu .Content a",container),function(){$(this).removeClass("Selected")})}function removeMonthSelected(elem){$.each($(".Filter .FilterMonth .FilterView .SubMenu .Content a",container).not(elem),function(){$(this).removeClass("Selected")})}function removeAllMonthSelected(){$.each($(".Filter .FilterMonth .FilterView .SubMenu .Content a",container),function(){$(this).removeClass("Selected")})}function cancelTimer(){closetimer&&(window.clearTimeout(closetimer),closetimer=null)}function AxisMegaBindPageFn($p,num,tab){return $p.unbind("click").bind("click",function(){var id,ins;return id=$p.is(".Next")||$p.is(".Previous")?$p.parent().attr("id"):$p.parent().parent().attr("id"),ins=id.substring(id.indexOf("_")+1),tab==1?AxisMegaPlayer.LoadContent1VideosByPage(num,ins):AxisMegaPlayer.LoadContent2VideosByPage(num,ins),!1}),$p}function AxisMegaPageLink(pageNum,pageText,currentPage,tab){if(pageNum!=currentPage){var $page=$('<a class="Page" href="javascript:;"></a>').text(pageText);return $page.data("page",pageNum),AxisMegaBindPageFn($page,pageNum,tab)}return $('<a class="CurrentPage"></a>').text(pageNum)}function daysInMonth(iMonth,iYear){return new Date(iYear,iMonth,0).getDate()}function nonWorkingDates(date){for(var day=date.getDay(),Sunday=0,Monday=1,Tuesday=2,Wednesday=3,Thursday=4,Friday=5,Saturday=6,closedDays=[[Saturday],[Sunday]],i=0;i<closedDays.length;i++)if(day==closedDays[i][0])return[!1];return[!0]}var prop=[],InstanceNum=null,AxisQueryString=null,sortField="BroadcastDate",sortField2="BroadcastTime",firstContentID=null,axismeg_player={};axismeg_playerObjList={};var contentId=null,timeout=500,closetimer=0,selectedTab=0,selectedMonth=null,selectedYear=null,selectedDate=null,selectedKeyword=null,query=null,monthNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],media=null;AxisMegaPlayer.OnInit=function(pr,instancenum){var parameterContentID=parseInt(GetQuerystring("vid",null)),maincontainer,height;InstanceNum=instancenum,prop[instancenum]=pr,maincontainer=prop[instancenum].ContainerID,container=$("#"+maincontainer),TotalCount=prop[instancenum].TotalCount,AdditionalTotalCount=prop[instancenum].AdditonalTotalCount,AxisMegaPlayer.OnMenuInit(),AxisMegaPlayer.ConfigureMenuFilter(maincontainer),AxisQueryString=AxisMegaPlayer.BuildContent1AxisQueryString(1,InstanceNum),maincontainer=prop[InstanceNum].ContainerID,height=$("#"+maincontainer+" .Videos").height(),$("#"+maincontainer+" .Videos .list").html('<div class="VideoLoading">'),$("#"+maincontainer+" .Videos .VideoLoading").css("height",height+"px"),$.ajaxSetup({cache:!0}),$.ajax({url:AxisShowServiceURL+AxisQueryString,contentType:"application/json;",dataType:"jsonp",cache:!0,jsonpCallback:"getJsonFromCAPI_AxisMegaPlayer",success:function(jsonResponse){var result=jsonResponse;result.Count>0?(AxisMegaPlayer.ProcessContent1Videos(result.Items,InstanceNum),$("#"+maincontainer+".Videos .VideoLoading").hide(),AxisMegaPlayer.PagerRender($("#Pager_"+InstanceNum),result.Count,prop[InstanceNum].VideosPerPage,1,1),$("#"+maincontainer+" .Tab1Results").html(result.Count.toString()+" clips"),firstContentID=result.Items[0].Id,media=$("#clip_"+firstContentID+".Item .Details .Show").text().toLowerCase().replace(" ","").replace(" ","").replace(" ",""),contentId=isNaN(parameterContentID)?firstContentID:parameterContentID,(contentId!=""||contentId!=null)&&($(document).ready(function(){$(document).on("onready.etsapi",function(){AxisMegaPlayer.LaunchPlayer()});axismeg_player.ajaxCrossDomainCors(AxisApiInterfaceURL)}),$("#"+maincontainer+" .VideoShare .ShareLink input#copyLink").val("http://"+window.location.hostname+window.location.pathname+"?vid="+contentId))):(AxisMegaPlayer.ClearPager($("#Pager_"+InstanceNum)),$("#"+maincontainer+" .Videos .VideoLoading").hide(),$("#"+maincontainer+" .Videos .list").html(prop[InstanceNum].NotFoundMessage),$("#"+maincontainer+" .Tab1Results").html(result.Count.toString()+" clips"))}}),AxisMegaPlayer.LoadContent2VideosByPage(1,InstanceNum),AxisMegaPlayer.PagerRender($("#Pager_"+instancenum),prop[instancenum].Content1TotalCount,prop[instancenum].VideosPerPage,1,1),$("#"+maincontainer+" .Tab1Results").html(prop[instancenum].Content1TotalCount.toString()+" clips"),$("#"+maincontainer+" .Tab2Results").html(prop[instancenum].Content2TotalCount.toString()+" clips"),AxisMegaPlayer.BindEvents()},AxisMegaPlayer.OnMenuInit=function(){var config={over:BNN.Modules.AxisMegaPlayer.OnMenuOpen,out:BNN.Modules.AxisMegaPlayer.OnMenuTimer,timeout:10},lis,lis2;$(".ViewBy > a",container).each(function(){var subMenuID=$(this).attr("menuclass");$(this).append($("."+subMenuID,container))}),lis=$(".ViewBy > a",container),lis.hoverIntent(config),$(".FilterMonth > a",container).each(function(){var subMenuID=$(this).attr("menuclass");$(this).append($("."+subMenuID,container))}),lis2=$(".FilterMonth > a",container),lis2.hoverIntent(config)},AxisMegaPlayer.BindEvents=function(){$("#vh-datepicker").datepicker({dateFormat:"yy-mm-dd",minDate:new Date(2013,0,1),maxDate:"0",beforeShowDay:nonWorkingDates,onSelect:function(dateText,inst){$("#datepickerText").html(monthNames[inst.selectedMonth]+" "+inst.selectedDay+", "+inst.selectedYear),$("#datepickerText").attr("data-value",dateText),$("#vh-datepicker-dialog .vh-datepicker-done").removeClass("disabled")},onChangeMonthYear:function(){$("#datepickerText").focus()}}),$("#vh-datepicker-dialog").dialog({position:{my:"top",at:"right bottom",of:"#datepickerText"},autoOpen:!1,show:{effect:"fade",duration:500},hide:{effect:"fade",duration:500},width:250,draggable:!1})},AxisMegaPlayer.ConfigureMenuFilter=function(maincontainer){$("#hypAllVideos").bind("click",function(){query=null,$("#"+maincontainer+" .Filter .FilterMonth").hide(),$("#"+maincontainer+" .Filter .FilterDay").hide(),$("#"+maincontainer+" .Filter .FilterKeyword").hide(),$(this).addClass("Selected"),removeFilterSelected(this)}),$("#hypByMonth").bind("click",function(){$("#"+maincontainer+" .Filter .FilterMonth").show(),$("#"+maincontainer+" .Filter .FilterDay").hide(),$("#"+maincontainer+" .Filter .FilterKeyword").hide(),$(this).addClass("Selected"),removeFilterSelected(this)}),$("#hypByDay").bind("click",function(){query="date",$("#"+maincontainer+" .Filter .FilterMonth").hide(),$("#"+maincontainer+" .Filter .FilterDay").show(),$("#"+maincontainer+" .Filter .FilterKeyword").hide(),$(this).addClass("Selected"),removeFilterSelected(this),$("#vh-datepicker-dialog").dialog("open"),$("#vh-datepicker-dialog .vh-datepicker-done").addClass("disabled"),$("#vh-datepicker").focus(),$("#vh-datepicker-dialog .vh-datepicker-done").click(function(){$("#datepickerText").text()!=""&&(BNN.Modules.AxisMegaPlayer.DateClick($("#datepickerText").attr("data-value")),$("#vh-datepicker-dialog").dialog("close"))}),$("#vh-datepicker-dialog .vh-datepicker-cancel").click(function(){$("#vh-datepicker-dialog").dialog("close")})}),$("#hypByKeyWord").bind("click",function(){$("#"+maincontainer+" .Filter .FilterMonth").hide(),$("#"+maincontainer+" .Filter .FilterDay").hide(),$("#"+maincontainer+" .Filter .FilterKeyword").show(),$(this).addClass("Selected"),removeFilterSelected(this)}),$("#btnKeyword").bind("click",function(){selectedKeyword=$("#keywordSearch").val(),query="keyword",selectedTab==0?(AxisMegaPlayer.LoadContent1VideosByPage(1,InstanceNum),selectedTab=0,$(".AxisMegaPlayer .Videos").show(),$(".AxisMegaPlayer .AdditionalVideos").hide(),$("#AxisMegaPlayerTab1").addClass("Selected"),$("#AxisMegaPlayerTab2").removeClass("Selected")):(AxisMegaPlayer.LoadContent2VideosByPage(1,InstanceNum),selectedTab=1,$(".AxisMegaPlayer .Videos").hide(),$(".AxisMegaPlayer .AdditionalVideos").show(),$("#AxisMegaPlayerTab2").addClass("Selected"),$("#AxisMegaPlayerTab1").removeClass("Selected"))}),$(".hypMonthSelected").bind("click",function(){query="month",selectedMonth=$(this).attr("data-month"),selectedYear=$(this).attr("data-year"),selectedTab==0?(AxisMegaPlayer.LoadContent1VideosByPage(1,InstanceNum),selectedTab=0,$(".AxisMegaPlayer .Videos").show(),$(".AxisMegaPlayer .AdditionalVideos").hide(),$("#AxisMegaPlayerTab1").addClass("Selected"),$("#AxisMegaPlayerTab2").removeClass("Selected")):(AxisMegaPlayer.LoadContent2VideosByPage(1,InstanceNum),selectedTab=1,$(".AxisMegaPlayer .Videos").hide(),$(".AxisMegaPlayer .AdditionalVideos").show(),$("#AxisMegaPlayerTab2").addClass("Selected"),$("#AxisMegaPlayerTab1").removeClass("Selected")),$(this).addClass("Selected"),removeMonthSelected(this)}),$("#hypAllVideos").bind("click",function(){selectedTab==0?(AxisMegaPlayer.LoadContent1VideosByPage(1,InstanceNum),$(".AxisMegaPlayer .Videos").show(),$(".AxisMegaPlayer .AdditionalVideos").hide(),$("#AxisMegaPlayerTab1").addClass("Selected"),$("#AxisMegaPlayerTab2").removeClass("Selected")):(AxisMegaPlayer.LoadContent2VideosByPage(1,InstanceNum),$(".AxisMegaPlayer .Videos").hide(),$(".AxisMegaPlayer .AdditionalVideos").show(),$("#AxisMegaPlayerTab2").addClass("Selected"),$("#AxisMegaPlayerTab1").removeClass("Selected"))})},AxisMegaPlayer.OnMenuOpen=function(){cancelTimer(),BNN.Modules.AxisMegaPlayer.OnMenuClose();var subMenu=$(this).attr("menuclass");$("."+subMenu,container).show()},AxisMegaPlayer.OnMenuClose=function(){$(".SubMenu",container).hide()},AxisMegaPlayer.OnMenuTimer=function(){closetimer=window.setTimeout("BNN.Modules.AxisMegaPlayer.OnMenuClose()",timeout)},AxisMegaPlayer.ProcessContent1Videos=function(latestVideos,instancenum){var maincontainer=prop[instancenum].ContainerID;(latestVideos.length>0||!latestVideos)&&_updateAxisMegaPlayerContainerContent1ByPage(latestVideos,maincontainer,prop[instancenum].pagesize,instancenum)},_updateAxisMegaPlayerContainerContent1ByPage=function(content,maincontainer,pag
esize,instancenum){var container=$("#Videos_"+maincontainer+" .list"),templateUrl=Agility.ResolveUrl("~/ClientTemplates/AxisMegaPlayer.htm");container.html(""),container.hasTemplate()||(container.setTemplateURL(templateUrl),container.setParam("DevMode",prop[instancenum].DevMode)),container.processTemplate(content),$("#Videos_"+prop[instancenum].ContainerID+" .list .Item").hover(function(){$(this).find(".play").toggleClass("play-on")})},AxisMegaPlayer.ProcessContent2Videos=function(latestVideos,instancenum){var maincontainer=prop[instancenum].ContainerID;(latestVideos.length>0||!latestVideos)&&_updateAxisMegaPlayerContainerContent2ByPage(latestVideos,maincontainer,prop[instancenum].pagesize,instancenum)},_updateAxisMegaPlayerContainerContent2ByPage=function(content,maincontainer,pagesize,instancenum){var container=$("#AdditionalVideos_"+maincontainer+" .list"),templateUrl=Agility.ResolveUrl("~/ClientTemplates/AxisMegaPlayer.htm");container.html(""),container.hasTemplate()||(container.setTemplateURL(templateUrl),container.setParam("DevMode",prop[instancenum].DevMode)),container.processTemplate(content),$("#AdditionalVideos_"+prop[instancenum].ContainerID+" .list .Item").hover(function(){$(this).find(".play").toggleClass("play-on")})},AxisMegaPlayer.LoadContent1VideosByPage=function(PageNum,InstanceNum){AxisQueryString=AxisMegaPlayer.BuildContent1AxisQueryString(PageNum,InstanceNum);var maincontainer=prop[InstanceNum].ContainerID,height=$("#"+maincontainer+" .Videos").height();$("#"+maincontainer+" .Videos .list").html('<div class="VideoLoading">'),$("#"+maincontainer+" .Videos .VideoLoading").css("height",height+"px"),$.ajaxSetup({cache:!0}),$.ajax({url:AxisShowServiceURL+AxisQueryString,contentType:"application/json;",dataType:"jsonp",cache:!0,jsonpCallback:"getJsonFromCAPI_LoadContent1VideosByPage",success:function(jsonResponse){var result=jsonResponse;result.Count>0||result.Items.length>0?(AxisMegaPlayer.ProcessContent1Videos(result.Items,InstanceNum),$("#"+maincontainer+".Videos .VideoLoading").hide(),AxisMegaPlayer.PagerRender($("#Pager_"+InstanceNum),result.Count,prop[InstanceNum].VideosPerPage,PageNum,1),$("#"+maincontainer+" .Tab1Results").html(result.Count.toString()+" clips")):(AxisMegaPlayer.ClearPager($("#Pager_"+InstanceNum)),$("#"+maincontainer+" .Videos .VideoLoading").hide(),$("#"+maincontainer+" .Videos .list").html(prop[InstanceNum].NotFoundMessage),$("#"+maincontainer+" .Tab1Results").html(result.Items.length+" clips"))}})},AxisMegaPlayer.LoadContent2VideosByPage=function(PageNum,InstanceNum){AxisQueryString=AxisMegaPlayer.BuildContent2AxisQueryString(PageNum,InstanceNum);var maincontainer=prop[InstanceNum].ContainerID,height=$("#"+maincontainer+" .AdditionalVideos").height();$("#"+maincontainer+" .AdditionalVideos .list").html('<div class="VideoLoading">'),$("#"+maincontainer+" .AdditionalVideos .VideoLoading").css("height",height+"px"),$.ajaxSetup({cache:!0}),$.ajax({url:AxisShowServiceURL+AxisQueryString,contentType:"application/json;",dataType:"jsonp",cache:!0,jsonpCallback:"getJsonFromCAPI_LoadContent2VideosByPage",success:function(jsonResponse){var result=jsonResponse;result.Count>0||result.Items.length>0?(AxisMegaPlayer.ProcessContent2Videos(result.Items,InstanceNum),$("#"+maincontainer+".AdditionalVideos .VideoLoading").hide(),AxisMegaPlayer.PagerRender($("#Pager_"+InstanceNum),result.Count,prop[InstanceNum].VideosPerPage,PageNum,2),$("#"+maincontainer+" .Tab2Results").html(result.Count.toString()+" clips")):(AxisMegaPlayer.ClearPager($("#Pager_"+InstanceNum)),$("#"+maincontainer+" .AdditionalVideos .VideoLoading").hide(),$("#"+maincontainer+" .AdditionalVideos .list").html(prop[InstanceNum].NotFoundMessage),$("#"+maincontainer+" .Tab2Results").html(result.Items.length+" clips"))}})},AxisMegaPlayer.BuildContent1AxisQueryString=function(pageNum,instancenum){var ret_string=null,querySdate,queryEdate;return query!=null?query=="month"?(querySdate=selectedYear+"-"+selectedMonth+"-01",queryEdate=selectedYear+"-"+selectedMonth+"-"+daysInMonth(selectedMonth,selectedYear),prop[instancenum].Content1FilterType=="show"?ret_string="/medias/"+prop[instancenum].Content1AxisContentID+"/contents?$inlinecount=true&$include=["+fieldNames+"]&$page="+pageNum+"&$top="+prop[instancenum].VideosPerPage+"&$sort="+sortField+"&$order=desc&BroadcastDate_start="+querySdate+"&BroadcastDate_end="+queryEdate:prop[instancenum].Content1FilterType=="collection"&&(ret_string="/collections/"+prop[instancenum].Content1AxisContentID+"/contents?$inlinecount=true&$include=["+fieldNames+"]&$page="+pageNum+"&$top="+prop[instancenum].VideosPerPage+"&$sort="+sortField+"&$order=desc&BroadcastDate_start="+querySdate+"&BroadcastDate_end="+queryEdate)):query=="date"?prop[instancenum].Content1FilterType=="show"?ret_string="/medias/"+prop[instancenum].Content1AxisContentID+"/contents?$include=["+fieldNames+"]&$page="+pageNum+"&$top="+prop[instancenum].VideosPerPage+"&$sort="+sortField+"&$order=desc$&BroadcastDate="+selectedDate+"&$inlinecount=&Images.Type=thumbnail":prop[instancenum].Content1FilterType=="collection"&&(ret_string="/collections/"+prop[instancenum].Content1AxisContentID+"/contents?$include=["+fieldNames+"]&$page="+pageNum+"&$top="+prop[instancenum].VideosPerPage+"&$sort="+sortField+"&$order=desc&$BroadcastDate="+selectedDate+"&$inlinecount=&Images.Type=thumbnail"):query=="keyword"&&(prop[instancenum].Content1FilterType=="show"?ret_string="/medias/"+prop[instancenum].Content1AxisContentID+"/contents?$inlinecount=true&$include=["+fieldNames+"]&$page="+pageNum+"&$top="+prop[instancenum].VideosPerPage+"&$sort="+sortField+"&$order=desc&$search="+escape(selectedKeyword)+"&BroadcastDate_start="+prop[instancenum].Content1QueryStartDate+"&BroadcastDate_end="+prop[instancenum].Content1QueryEndDate:prop[instancenum].Content1FilterType=="collection"&&(ret_string="/collections/"+prop[instancenum].Content1AxisContentID+"/contents?$inlinecount=true&$include=["+fieldNames+"]&$page="+pageNum+"&$top="+prop[instancenum].VideosPerPage+"&$sort="+sortField+"&$order=desc&$search="+escape(selectedKeyword)+"&BroadcastDate_start="+prop[instancenum].Content1QueryStartDate+"&BroadcastDate_end="+prop[instancenum].Content1QueryEndDate)):prop[instancenum].Content1FilterType=="show"?ret_string="/medias/"+prop[instancenum].Content1AxisContentID+"/contents?$inlinecount=true&$include=["+fieldNames+"]&$page="+pageNum+"&$top="+prop[instancenum].VideosPerPage+"&$sort="+sortField+"&$order=desc&BroadcastDate_start="+prop[instancenum].Content1QueryStartDate+"&BroadcastDate_end="+prop[instancenum].Content1QueryEndDate:prop[instancenum].Content1FilterType=="collection"&&(ret_string="/collections/"+prop[instancenum].Content1AxisContentID+"/contents?$inlinecount=true&$include=["+fieldNames+"]&$page="+pageNum+"&$top="+prop[instancenum].VideosPerPage+"&$sort="+sortField+"&$order=desc"),ret_string+=prop[instancenum].Content1IncludeFullEpisodes?"":"&Type=segment"},AxisMegaPlayer.BuildContent2AxisQueryString=function(pageNum,instancenum){var ret_string=null,querySdate,queryEdate;return query!=null?query=="month"?(querySdate=selectedYear+"-"+selectedMonth+"-01",queryEdate=selectedYear+"-"+selectedMonth+"-"+daysInMonth(selectedMonth,selectedYear),prop[instancenum].Content2FilterType=="show"?ret_string="/medias/"+prop[instancenum].Content2AxisContentID+"/contents?$inlinecount=true&$include=["+fieldNames+"]&$page="+pageNum+"&$top="+prop[instancenum].VideosPerPage+"&$sort="+sortField+"&$order=desc&BroadcastDate_start="+querySdate+"&BroadcastDate_end="+queryEdate:prop[instancenum].Content2FilterType=="collection"&&(ret_string="/collections/"+prop[instancenum].Content2AxisContentID+"/contents?$inlinecount=true&$include=["+fieldNames+"]&$page="+pageNum+"&$top="+prop[instancenum].VideosPerPage+"&$sort="+sortField+"&$order=desc&BroadcastDate_start="+querySdate+"&BroadcastDate_end="+queryEdate)):query=="date"?prop[instancenum].Content2FilterType=="show"?ret_string="/medias/"+prop[instancenum].Content2AxisContentID+"/contents?$inlinecount=true&$include=["+fieldNames+"]&$page="+pageNum+"&$top="+prop[instancenum].VideosPerPage+"&$sort="+sortField+"&$order=desc&BroadcastDate="+selectedDate:prop[instancenum].Content2FilterType=="collection"&&(ret_string="/collections/"+prop[instancenum].Content2AxisContentID+"/contents?$inlinecount=true&$include=["+fieldNames+"]&$page="+pageNum+"&$top="+prop[instancenum].VideosPerPage+"&$sort="+sortField+"&$order=desc&BroadcastDate="+selectedDate):query=="keyword"&&(prop[instancenum].Content2FilterType=="show"?ret_string="/medias/"+prop[instancenum].Content1AxisContentID+"/contents?$inlinecount=true&$include=["+fieldNames+"]&$page="+pageNum+"&$top="+prop[instancenum].VideosPerPage+"&$sort="+sortField+"&$order=desc&$search="+escape(selectedKeyword):prop[instancenum].Content2FilterType=="collection"&&(ret_string="/collections/"+prop[instancenum].Content1AxisContentID+"/contents?$inlinecount=true&$include=["+fieldNames+"]&$page="+pageNum+"&$top="+prop[instancenum].VideosPerPage+"&$sort="+sortField+"&$order=desc&$search="+escape(selectedKeyword))):prop[instancenum].Content2FilterType=="show"?ret_string="/medias/"+prop[instancenum].Content2AxisContentID+"/contents?$inlinecount=true&$include=["+fieldNames+"]&$page="+pageNum+"&$top="+prop[instancenum].VideosPerPage+"&$sort="+sortField+"&$order=desc&BroadcastDate_start="+prop[instancenum].Content2QueryStartDate+"&BroadcastDate_end="+prop[instancenum].Content2QueryEndDate:prop[instancenum].Content2FilterType=="collection"&&(ret_string="/collections/"+prop[instancenum].Content2AxisContentID+"/contents?$inlinecount=true&$include=["+fieldNames+"]&$page="+pageNum+"&$top="+prop[instancenum].VideosPerPage+"&$sort="+sortField+"&$order=desc"),ret_string+=prop[instancenum].Content2IncludeFullEpisodes?"":"&Type=segment"},AxisMegaPlayer.DateClick=function(date){query="date",selectedDate=date,selectedTab==0?(selectedTab=0,AxisMegaPlayer.LoadContent1VideosByPage(1,InstanceNum),$(".VideoList
 .Videos").show(),$(".VideoList .AdditionalVideos").hide(),$("#VideoListTab1").addClass("Selected"),$("#VideoListTab2").removeClass("Selected")):(selectedTab=1,AxisMegaPlayer.LoadContent2VideosByPage(1,InstanceNum),$(".VideoList .Videos").hide(),$(".VideoList .AdditionalVideos").show(),$("#VideoListTab2").addClass("Selected"),$("#VideoListTab1").removeClass("Selected"))},AxisMegaPlayer.KeywordClick=function(keyword){selectedKeyword=keyword,query="keyword",selectedTab==0?(AxisMegaPlayer.LoadContent1VideosByPage(1,InstanceNum),selectedTab=0,$(".AxisMegaPlayer .Videos").show(),$(".AxisMegaPlayer .AdditionalVideos").hide(),$(".AxisMegaPlayer .Tabs .Filter .FilterMonth").hide(),$(".AxisMegaPlayer .Tabs .Filter .FilterDay").hide(),$(".AxisMegaPlayer .Tabs .Filter .FilterKeyword").show(),$("#keywordSearch").val(keyword),$("#AxisMegaPlayerTab1").addClass("Selected"),$("#AxisMegaPlayerTab2").removeClass("Selected")):(AxisMegaPlayer.LoadContent2VideosByPage(1,InstanceNum),selectedTab=1,$(".AxisMegaPlayer .Videos").hide(),$(".AxisMegaPlayer .AdditionalVideos").show(),$(".AxisMegaPlayer .Tabs .Filter .FilterMonth").hide(),$(".AxisMegaPlayer .Tabs .Filter .FilterDay").hide(),$(".AxisMegaPlayer .Tabs .Filter .FilterKeyword").show(),$("#keywordSearch").val(keyword),$("#AxisMegaPlayerTab2").addClass("Selected"),$("#AxisMegaPlayerTab1").removeClass("Selected"))},AxisMegaPlayer.ShowKeywordMeta=function(metaObj){var ret_str="",i;if(metaObj!=null){for(i=0;i<metaObj.length-1;i++)ret_str+='<div class="keyword" onclick="BNN.Modules.AxisMegaPlayer.KeywordClick(\''+metaObj[i].Name+"')\">"+metaObj[i].Name+"</div>";return ret_str}},AxisMegaPlayer.ShowTab1=function(){selectedTab=0,query=null;var maincontainer=prop[InstanceNum].ContainerID;$(".AxisMegaPlayer .Videos").show(),$(".AxisMegaPlayer .AdditionalVideos").hide(),AxisMegaPlayer.LoadContent1VideosByPage(1,InstanceNum),$("#AxisMegaPlayerTab1").addClass("Selected"),$("#AxisMegaPlayerTab2").removeClass("Selected"),removeAllFilterSelected(),removeAllMonthSelected(),$("#"+maincontainer+" .Filter .FilterMonth").hide(),$("#"+maincontainer+" .Filter .FilterDay").hide(),$("#"+maincontainer+" .Filter .FilterKeyword").hide(),TotalCount<=prop.VideosPerPage?$("#"+maincontainer+" .ViewBy").hide():$("#"+maincontainer+" .ViewBy").show()},AxisMegaPlayer.ShowTab2=function(){selectedTab=1,query=null;var maincontainer=prop[InstanceNum].ContainerID;$(".AxisMegaPlayer .Videos").hide(),$(".AxisMegaPlayer .AdditionalVideos").show(),AxisMegaPlayer.LoadContent2VideosByPage(1,InstanceNum),$("#AxisMegaPlayerTab2").addClass("Selected"),$("#AxisMegaPlayerTab1").removeClass("Selected"),removeAllFilterSelected(),removeAllMonthSelected(),$("#"+maincontainer+" .Filter .FilterMonth").hide(),$("#"+maincontainer+" .Filter .FilterDay").hide(),$("#"+maincontainer+" .Filter .FilterKeyword").hide()},AxisMegaPlayer.ProcessThumbnail=function(imageObj){if(imageObj!=null&&imageObj[0].Type=="thumbnail")return imageObj[0].Url+"?height=118&width=210"},AxisMegaPlayer.is_empty=function(obj){if(obj==null)return!0;if(obj.length&&obj.length>0)return!1;if(obj.length===0)return!0;for(var key in obj)if(hasOwnProperty.call(obj,key))return!1;return!0},AxisMegaPlayer.getMedia=function(mediaObj){if(mediaObj!=null)return mediaObj.Name},AxisMegaPlayer.DisplayAuth=function(authObj){if(authObj!=null&&authObj.Required==!0)return"<div class='lock'></div>"},AxisMegaPlayer.DisplayAuth2=function(authObj,type){if(authObj!=null)return authObj.Required==!0||type=="episode"?"true - "+type:"false - "+type},AxisMegaPlayer.ShowMeta=function(metaObj){var ret_str="",i;if(metaObj!=null){for(i=0;i<metaObj.length-1;i++)ret_str+="<span>"+metaObj[i].Name+"</span>,&nbsp;";return ret_str}},AxisMegaPlayer.convertSeconds=function(contentPackageObj){var s=~~contentPackageObj[0].Duration,h=Math.floor(s/3600),m;return s-=h*3600,m=Math.floor(s/60),s-=m*60,m+" : "+(s<10?"0"+s:s)},AxisMegaPlayer.FormatDate=function(date,time){if(date!=null){var d=null,ret_str;return time!=null?(d=new Date.parse(date+"T"+time),ret_str=dateFormat(d,"m/dd/yyyy-h:MM TT")):(d=new Date.parse(date),ret_str=dateFormat(d,"m/dd/yyyy")),ret_str}return"N/A"},AxisMegaPlayer.PlayElement=function(clipId){var maincontainer=prop[InstanceNum].ContainerID,initParms={destinationCode:globalDestination,platformCode:globalPlatform,autoPlay:1,resourceId:"BNN"},item={id:clipId};axismeg_playerObjList.axisMeg_player.playMediaItem(item,initParms),media=$("#clip_"+clipId+".Item .Details .Show").text().toLowerCase().replace(" ","").replace(" ","").replace(" ",""),$("#"+maincontainer+" .VideoShare .ShareLink input#copyLink").val("http://"+window.location.hostname+window.location.pathname+"?vid="+clipId)},AxisMegaPlayer.ExpandDetails=function(ClipId){_log($("#Expanded_"+ClipId)),$("#Expanded_"+ClipId).show(),$.each($(".AxisMegaPlayer .AxisMegaPlayerContainer .Videos .list .Item .Expanded").not($("#Expanded_"+ClipId)),function(){$(this).hide()})},AxisMegaPlayer.CloseDetails=function(ClipId){$("#Expanded_"+ClipId).hide()},AxisMegaPlayer.LaunchPlayer=function(){var adrule=GetQuerystring("adrule","generic"),axisMeg_mainApp,mpFlashVars={},zone;mpFlashVars.enablelog=AxisEnableLog,mpFlashVars.loginterval=AxisLogInterval,mpFlashVars.cms="fortytwo",axisMeg_mainApp=etsapi.embedPlayer("axisMeg_player","AxisMegaPlayerDiv",640,360,globalDestination,"",{flashVars:mpFlashVars,adRule:adrule}),axisMeg_mainApp.registerEvent(MediaPlayerControllerEvent.PLAYER_READY,this,AxisMegaPlayer.onPlayerReady),axisMeg_mainApp.registerEvent(MediaPlayerControllerEvent.VIDEO_STARTED,this,AxisMegaPlayer.onVideoStarted),axisMeg_mainApp.registerEvent(MediaPlayerControllerEvent.VIDEO_ENDED,this,AxisMegaPlayer.onVideoEnded),axisMeg_mainApp.registerEvent(MediaPlayerControllerEvent.ERROR,this,AxisMegaPlayer.onVideoError),axismeg_playerObjList.axisMeg_player=axisMeg_mainApp,zone="shows/"+media.toLowerCase().replace(" ","").replace(" ","").replace(" ",""),etsapi.setAdZone("axisMeg_player",zone),etsapi.setMetricsVideoPlayerName("MoneyTalkPlayer")},AxisMegaPlayer.PlayerReady=function(){var initParms={destinationCode:globalDestination,platformCode:globalPlatform,autoPlay:0,resourceId:"BNN"},item={id:contentId};axismeg_playerObjList.axisMeg_player.playMediaItem(item,initParms)},AxisMegaPlayer.onPlayerReady=function(){_log("player ready"),AxisMegaPlayer.PlayerReady()},AxisMegaPlayer.onVideoEnded=function(){_log("player ended")},AxisMegaPlayer.onVideoStarted=function(infoObj){if(infoObj.index==0&&infoObj.category=="content"){var pflowPath=window.location.pathname,pflowUrl="http://data.publishflow.com/pflowlog.gif?a=ctv.ca&h=bnn.ca&p="+encodeURI(pflowPath)+"&t="+escape(infoObj.title)+"&v=/video/player.aspx?vid="+infoObj.contentId+"&pt="+escape($(document).find("title").text().trim())+"&ts="+ +new Date,image=new Image;image.src=pflowUrl}},AxisMegaPlayer.onVideoError=function(){_error("player error")},axismeg_player.ajaxCrossDomainCors=function(serviceURL){try{axismeg_player.JqueryCallBack=function(){_log("api loading success ");return};var ajaxPars={url:serviceURL,cache:!0,contentType:"application/json",jsonpCallback:"player.JqueryCallBack",error:function(XMLHttpRequest,textStatus){textStatus=="parsererror"}};ajaxPars.type="GET",ajaxPars.dataType="jsonp",ajaxPars.jsonp="callback",$.ajax(ajaxPars)}catch(err){throw err;}},GetQuerystring=function(key,default_){default_==null&&(default_=""),key=key.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var regex=new RegExp("[\\?&]"+key+"=([^&#]*)"),qs=regex.exec(window.location.href);return qs==null?default_:qs[1]},AxisMegaPlayer.getParameterByName=function(name){var match=RegExp("[?&]"+name+"=([^&]*)").exec(window.location.search);return match&&decodeURIComponent(match[1].replace(/\+/g," "))},_error=function(str){try{console.error(str)}catch(e){}},_log=function(str){try{console.log(str)}catch(e){}},AxisMegaPlayer.PagerRender=function($pager,numItems,postsPerPage,currentPage,tab){var i;$pager.show();var numPages=Math.ceil(numItems/postsPerPage),links=$('<span class="Links"></span>'),$previousBtn=$pager.find("a.Previous"),$nextBtn=$pager.find("a.Next");if(numItems==0||numPages<=1){$pager.hide();return}for(currentPage<=1?$previousBtn.hide():($previousBtn.data("page",currentPage-1).show(),AxisMegaBindPageFn($previousBtn,currentPage-1,tab)),currentPage>=numPages?$nextBtn.hide():($nextBtn.data("page",currentPage+1).show(),AxisMegaBindPageFn($nextBtn,currentPage+1,tab)),links.append(AxisMegaPageLink(1,1,currentPage,tab)),currentPage>4&&links.append($("<span>...</span>")),i=Math.max(2,currentPage-2);i<=Math.min(numPages-1,currentPage+2);i++)links.append(AxisMegaPageLink(i,i,currentPage,tab));currentPage<numPages-3&&links.append($("<span>...</span>")),links.append(AxisMegaPageLink(numPages,"Last",currentPage,tab)),$(".Links",$pager).replaceWith(links).show()},AxisMegaPlayer.ClearPager=function($pager){$pager.hide()}}(BNN.Modules.AxisMegaPlayer);
Agility.RegisterNamespace("BNN.Modules.DFPAdModule"),function(DFPAdModule){DFPAdModule.Render=function(p){var dfpAd={tile:p.tile,scriptName:p.scriptName,zone:DFPAdModule.GetZone(""),width:p.width,height:p.height};dfp_masterObjList.push(dfpAd)},DFPAdModule.SetEnvironment=function(){var Environment="",pUri=DFPAdModule.parseUri(window.location),domain=pUri.authority.toLowerCase();return Environment=domain=="bnn.local"||domain=="stage-origin.bnn.ca"||domain=="localhost:61087"?"dev":"prod","envr="+Environment},DFPAdModule.GetZone=function(zone){var pUri,directoryPath,sector;if(zone=="")return pUri=DFPAdModule.parseUri(window.location),directoryPath=pUri.directory.toLowerCase().split("/"),directoryPath[1]=="news"?(sector=DFPAdModule.getSectorForZone("Sector"),zone=sector):directoryPath[1]=="blogs"?zone="blogs":directoryPath[1]=="personalities"?zone="personalities":directoryPath[1]=="special-coverage"?zone="specialcoverage/"+pUri.file.toLowerCase().replace(".aspx","").replace("-","").replace("-",""):directoryPath[1]=="redesign"?zone="home/index":directoryPath[1]=="newsletter"?zone="home/index":directoryPath[1]=="sponsored-news"?zone="sponsorednews/investmenttrends":directoryPath[1]=="shows"&&directoryPath.length>3?zone=directoryPath[3].replace("-",""):directoryPath[1]=="test2636176"?zone=pUri.file.toLowerCase().replace(".aspx","").replace("-","").replace("_","")=="reskinhome"?"home/index":pUri.file.toLowerCase().replace(".aspx","").replace("-","").replace("_","").replace("_","")=="reskinhomefeatured"?"home/index":pUri.file.toLowerCase().replace(".aspx","").replace("-","").replace("_","").replace("_","").replace("_","").replace(" ","")=="reskinhomefeaturedv2"?"home/index":"test_tve":pUri.directory.length>0&&pUri.file.length>0?(directoryPath[1]=="shows"&&(zone="shows/"+pUri.file.toLowerCase().replace(".aspx","").replace("-","").replace("-","")),pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="blogs"&&(zone="blogs"),(pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="aboutbnn"||pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="channelguide"||pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="community"||pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="contactus"||pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="faq"||pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="search"||pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="sitemap"||pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="subscribe")&&(zone="default"),(pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="bnnmobile"||pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="mobiletv"||pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="home")&&(zone="home"),(pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="markets"||pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="stock"||pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="commentingrules-and-regulations")&&(zone="markets"),(pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="schedule"||pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="weeklyschedule")&&(zone="schedule"),pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="personalities"&&(zone="personalities"),pUri.file.toLowerCase().replace(".aspx","").replace("-","").replace("-","").replace("-","")=="smallbusinessweek"&&(zone="smallbusinessweek"),(pUri.file.toLowerCase().replace(".aspx","").replace("-","").replace("-","").replace("-","")=="dfptest"||pUri.file.toLowerCase().replace(".aspx","").replace("-","").replace("-","").replace("-","")=="tvetest")&&(zone="home/index"),pUri.file.toLowerCase().replace(".aspx","").replace("-","").replace("-","").replace("-","")=="videohub"&&(zone="video/hub"),pUri.file.toLowerCase().replace(".aspx","").replace("-","").replace("-","").replace("-","")=="player"&&(zone="video/hub"),pUri.file.toLowerCase().replace(".aspx","").replace("-","").replace("-","").replace("-","")=="video"&&(zone="video/hub"),pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="beta_home"&&(zone="home/index"),pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="home"&&(zone="home/index"),pUri.file.toLowerCase().replace(".aspx","").replace("-","").replace("-","")=="bnngoapp"&&(zone="bnngoapp")):zone="home/index",zone==""&&(zone="home/index"),zone},DFPAdModule.GetPreRollZone=function(zone){var pUri,directoryPath,sector;if(zone=="")return pUri=AdModule.parseUri(window.location),directoryPath=pUri.directory.toLowerCase().split("/"),directoryPath[1]=="news"?(sector=DFPAdModule.getSectorForZone("Sector"),zone=sector+"/index"):directoryPath[1]=="blogs"?zone="blogs/index":directoryPath[1]=="personalities"?zone="personalities/index":directoryPath[1]=="special-coverage"?(ctvAd.SetSection(),zone="specialcoverage/"+pUri.file.toLowerCase().replace(".aspx","").replace("-","").replace("-","").replace("-","")+"/index"):directoryPath[1]=="shows"&&directoryPath.length>3?zone=directoryPath[3].replace("-","")+"/index":pUri.directory.length>0&&pUri.file.length>0?(directoryPath[1]=="shows"&&(pUri.file.toLowerCase().replace(".aspx","").replace("-","").replace("-","")=="thelearningcurve"?zone="test/index":(zone="shows/",zone+=pUri.file.toLowerCase().replace(".aspx","").replace("-","").replace("-",""),zone+="/index")),pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="blogs"&&(zone="blogs/index"),(pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="aboutbnn"||pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="channelguide"||pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="community"||pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="contactus"||pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="faq"||pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="search"||pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="sitemap"||pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="subscribe")&&(zone="default/index"),(pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="bnnmobile"||pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="mobiletv"||pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="home")&&(zone="home/index"),(pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="markets"||pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="stock"||pUri.file.toLowerCase().replace(".aspx","").replace("-","")=="commentingrules-and-regulations")&&(zone="markets/index"),pUri.file.toLowerCase().replace(".aspx","").replace("-","").replace("-","").replace("-","")=="smallbusinessweek"&&(ctvAd.SetSection(pUri.file.toLowerCase().replace(".aspx","").replace("-","")),zone="smallbusinessweek/",ctvAd.SetSection("smallbusinessweek"))):zone="home/index",zone},DFPAdModule.getSectorForZone=function(variable){for(var query=window.location.search.substring(1),vars=query.split("&"),pair,i=0;i<vars.length;i++)if(pair=vars[i].split("="),pair[0]==variable||pair[0]==variable.toLowerCase())return unescape(pair[1].replace(/-/g,"").toLowerCase());return"news_index"},DFPAdModule.parseUri=function parseUri(str){for(var o=DFPAdModule.parseUri.options,m=o.parser[o.strictMode?"strict":"loose"].exec(str),uri={},i=14;i--;)uri[o.key[i]]=m[i]||"";return uri[o.q.name]={},uri[o.key[12]].replace(o.q.parser,function($0,$1,$2){$1&&(uri[o.q.name][$1]=$2)}),uri},DFPAdModule.parseUri.options={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}}}(BNN.Modules.DFPAdModule);
Agility.RegisterNamespace("BNN.Modules.AxisVideoHub"),function(AxisVideoHub){function removeNavSelected(elem){$.each($(".vh-left-container ul li.nav-item").not(elem),function(){$(this).find("a:first").removeClass("Selected")}),$(".vh-left-nav div.vh-left-container div.vh-nav-container div.vh-left-playlist ul li a").removeClass("Selected")}function AxisHubBindPageFn($p,num,type,value){return $p.unbind("click").bind("click",function(){var id,ins;return id=$p.is(".Next")||$p.is(".Previous")?$p.parent().attr("id"):$p.parent().parent().attr("id"),ins=id.substring(id.indexOf("_")+1),type=="contentcollection"?AxisVideoHub.LoadContentByPage(num):type=="media"?AxisVideoHub.LoadMediaContent(num,value,null):type=="genre"?AxisVideoHub.LoadGenreContent(num,value,null):type=="search"?AxisVideoHub.SearchContent(num,value):type=="custom"&&AxisVideoHub.LoadByDate(num),!1}),$p}function AxisHubPageLink(pageNum,pageText,currentPage,type,value){var $lastBtn,$page;if(pageNum!=currentPage){if(pageText=="Last"){$lastBtn=$("#Pager").find("a.Last"),AxisHubBindPageFn($lastBtn,pageNum,type,value);return}return $page=$('<a class="Page" href="javascript:;"></a>').text(pageText),$page.data("page",pageNum),AxisHubBindPageFn($page,pageNum,type,value)}return $('<a class="CurrentPage"></a>').text(pageNum)}function nonWorkingDates(date){for(var day=date.getDay(),Sunday=0,Monday=1,Tuesday=2,Wednesday=3,Thursday=4,Friday=5,Saturday=6,closedDays=[[Saturday],[Sunday]],i=0;i<closedDays.length;i++)if(day==closedDays[i][0])return[!1];return[!0]}var properties=null,AxisQueryString=null,container=null,navContainer=null,userSelections={},monthNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],rangeFromFlag,rangeToFlag,userPlayList={date:new Date,listItems:[]},AddLineupText="[+] Add to playlist",RemoveLineupText="[-] Remove from playlist",PlaylistTitle="My Playlist";AxisVideoHub.OnInit=function(p,uS,pL){properties=p,userSelections=uS,userPlayList=pL,container=properties.ContentContainerID,navContainer=properties.NavContainerID;var SearchParameter=decodeURI(AxisVideoHub.GetQuerystring("Search",null)),ShowParameter=decodeURI(AxisVideoHub.GetQuerystring("ShowID",null));SearchParameter!=""?AxisVideoHub.SearchContent(1,SearchParameter):ShowParameter!=""?AxisVideoHub.LoadMediaContent(0,ShowParameter,null):AxisVideoHub.LoadNavContent(userSelections.selectedNavIndex,null),AxisVideoHub.BindEvents(),$.watermark.options.className="hub_watermark",$.watermark.options.useNative=!1,$("#vh-search-value").watermark($("#vh-search-value").next().text()),$(".vh-left-nav .vh-left-container .vh-nav-container .vh-left-playlist span.numItems").text(userPlayList.listItems.length==0?"":userPlayList.listItems.length.toString())},AxisVideoHub.LoadNavContent=function(index){if(userSelections.selectedNavIndex=index,$("#"+properties.ContentContainerID+" .vh-content-filter").hide(),$("#"+properties.ContentContainerID+" .vh-content-sort").hide(),$("#"+properties.ContentContainerID+" .vh-content-lineup-clear").hide(),userSelections.userNavType!="search"?$("#vh-search-value").val(""):$("#vh-search-value").val(userSelections.userSearchValue),$("#"+container+" .vh-crumb-container").html(userSelections.crumbContent),userSelections.selectedPlayList){AxisVideoHub.LoadPlayList();return}if(properties.hubNav[index].Title=="All Shows"){if(userSelections.selectedMediaId!=null&&$("#"+container+" .navHeader").html()!=userSelections.selectedMediaLabel&&userSelections.userNavType!="search"){AxisVideoHub.LoadMediaContent(0,userSelections.selectedMediaId,null);return}}else if(properties.hubNav[index].Title=="Videos By Sector"){if(userSelections.selectedGenreId!=null&&$("#"+container+" .navHeader").html()!=userSelections.selectedGenreLabel&&userSelections.userNavType!="search"){AxisVideoHub.LoadGenreContent(0,userSelections.selectedGenreId,null);return}}else userSelections.selectedCustomDate!=null&&userSelections.userNavType!="search"&&AxisVideoHub.LoadByDate(1);$("#"+container+" .navHeader").html(properties.hubNav[index].Title),$("#nav-item"+index).find("a:first").addClass("Selected"),removeNavSelected($("#nav-item"+index));var height=$("#"+container+" .vh-content-list").height();$("#"+container+" .vh-content-list").html('<div class="VideoLoading">'),$("#"+container+" .vh-content-list .VideoLoading").css("height",height+"px"),userSelections.currentPage=="hub"?userSelections.userNavType!="search"?($.ajaxSetup({cache:!0}),$.ajax({url:AxisShowServiceURL+AxisVideoHub.BuildMediaAxisQueryString(properties.hubNav[index].Type,1,properties.hubNav[index].AxisContentID),contentType:"application/json;",dataType:"jsonp",cache:!0,jsonpCallback:"getJsonFromCAPI_LoadNavContent",success:function(jsonResponse){var result=jsonResponse;result.Count>0||result.Items.length>0?(properties.hubNav[index].Type=="contentcollection"?AxisVideoHub.PagerRender($("#Pager"),result.Count,properties.VideosPerPage,1,properties.hubNav[index].Type,0):$("#Pager").hide(),AxisVideoHub.ProcessVideos(result.Items,properties.hubNav[index].Type),$("#"+container+".vh-content-list .VideoLoading").hide()):($("#Pager").hide(),$("#"+container+" .vh-content-list .VideoLoading").hide(),$("#"+container+" .vh-content-list").html("<div class='noResultsError'>Sorry, no videos found</div>"))}})):AxisVideoHub.SearchContent(1,userSelections.userSearchValue):userSelections.userNavType=="media"&&userSelections.selectedNavIndex==2?AxisVideoHub.LoadMediaContent(1,userSelections.selectedMediaId,null):userSelections.userNavType=="genre"&&userSelections.selectedNavIndex==4?AxisVideoHub.LoadGenreContent(1,userSelections.selectedGenreId,null):userSelections.userNavType=="search"&&userSelections.fromSearch==!1?AxisVideoHub.SearchContent(1,userSelections.userSearchValue):(userSelections.currentPage="hub",AxisVideoHub.setfromSearch(!1),AxisVideoHub.LoadNavContent(userSelections.selectedNavIndex))},AxisVideoHub.LoadNavClick=function(index){var customSelectedDateObj,currentDate,height;localStorage.removeItem("userSelections"),userSelections.userNavType="",userSelections.selectedPlayList=!1,userSelections.selectedNavIndex=index,$("#"+container+" .vh-crumb-container").empty(),userSelections.crumbContent=$("#"+container+" .vh-crumb-container").html(),$("#"+properties.ContentContainerID+" .vh-content-lineup-clear").hide(),$("#vh-datepicker-dialog").dialog("close"),$("#vh-datepicker-range-dialog").dialog("close"),$("#"+properties.ContentContainerID+" .vh-content-filter").hide(),$("#"+properties.ContentContainerID+" .vh-content-sort").hide(),$("#"+properties.ContentContainerID+" .vh-content-lineup-clear").hide(),$("#"+properties.ContentContainerID+" .vh-content-filter-bydate").hide(),AxisVideoHub.ClearFitlersAndSorts(),$.each($(".vh-left-must-watch ul li.nav-item-mw"),function(){$(this).find("a").removeClass("Selected")}),userSelections.userNavType!="search"?$("#vh-search-value").val(""):$("#vh-search-value").val(userSelections.userSearchValue),$("#"+container+" .navHeader").html(properties.hubNav[index].Title),$("#nav-item"+index).find("a:first").addClass("Selected"),removeNavSelected($("#nav-item"+index)),$(".vh-left-nav div.vh-left-container div.vh-nav-container div.vh-left-playlist").css("background-image","none"),properties.hubNav[index].Type=="custom"&&($("#"+container+" .vh-content-list").html(""),$("#"+properties.ContentContainerID+" .vh-content-filter-bydate").show(),$("#Pager").hide(),userSelections.userNavType="custom",userSelections.selectedFilterValue="&BroadcastDate="+properties.TodaysDate,customSelectedDateObj={type:"day",date:properties.TodaysDate},userSelections.selectedCustomDate=customSelectedDateObj,currentDate=new Date,AxisVideoHub.GenerateByDateLinks(currentDate)),height=$("#"+container+" .vh-content-list").height(),$("#"+container+" .vh-content-list").html('<div class="VideoLoading">'),$("#"+container+" .vh-content-list .VideoLoading").css("height",height+"px"),$.ajaxSetup({cache:!0}),$.ajax({url:AxisShowServiceURL+AxisVideoHub.BuildMediaAxisQueryString(properties.hubNav[index].Type,1,properties.hubNav[index].AxisContentID),contentType:"application/json;",dataType:"jsonp",jsonpCallback:"getJsonFromCAPI_LoadNavClick",cache:!0,success:function(jsonResponse){var result=jsonResponse;result.Count>0||result.Items.length>0?(AxisVideoHub.PagerRender($("#Pager"),result.Count,properties.VideosPerPage,1,properties.hubNav[index].Type,0),AxisVideoHub.ProcessVideos(result.Items,properties.hubNav[index].Type),$("#"+container+".vh-content-list .VideoLoading").hide()):($("#Pager").hide(),$("#"+container+" .vh-content-list .VideoLoading").hide(),$("#"+container+" .vh-content-list").html("<div class='noResultsError'>Sorry, no videos found</div>"))}})},AxisVideoHub.LoadContentByPage=function(PageNum){var height=$("#"+container+" .vh-content-list").height();$("#"+container+" .vh-content-list").html('<div class="VideoLoading">'),$("#"+container+" .vh-content-list .VideoLoading").css("height",height+"px"),$.ajaxSetup({cache:!0}),$.ajax({url:AxisShowServiceURL+AxisVideoHub.BuildMediaAxisQueryString(properties.hubNav[userSelections.selectedNavIndex].Type,PageNum,properties.hubNav[userSelections.selectedNavIndex].AxisContentID),contentType:"application/json;",dataType:"jsonp",cache:!0,jsonpCallback:"getJsonFromCAPI_LoadContentByPage",success:function(jsonResponse){var result=jsonResponse;result.Count>0||result.Items.length>0?(AxisVideoHub.PagerRender($("#Pager"),result.Count,properties.VideosPerPage,PageNum,"contentcollection",0),AxisVideoHub.ProcessVideos(result.Items,properties.hubNav[userSelections.selectedNavIndex].Type),$("#"+container+".vh-content-list .VideoLoading").hide()):($("#Pager").hide(),$("#"+container+" .vh-content-list .VideoLoading").hide(),$("#"+container+" .vh-content-list").html("<div class='noResultsError'>Sorry, no videos found</div>"))}})},AxisVideoHub.LoadGenreContent=function(pageNum,genreId,elem){var dateSelection,d,sd,ed,height;userSelections.selectedGenreId=genreId,userSelections.userNavType="genre",userSelections.selectedMediaI
d="",userSelections.selectedMediaLabel="",$(".vh-right-content .vh-content-filter  .select-content-type-box, .vh-middle-content .vh-content-filter .select-content-type-box").html($(".vh-right-content .vh-content-filter .select-content-type-box, .vh-middle-content .vh-content-filter .select-content-type-box").next().find("[data-value="+userSelections.selectedContentTypeFilterValue.split("=")[1]+"]").html()),$(".vh-right-content .vh-content-sort .select-sort-box, .vh-middle-content .vh-content-sort .select-sort-box").html($(".vh-right-content .vh-content-sort .select-sort-box, .vh-middle-content .vh-content-sort .select-sort-box").next().find("[data-value="+userSelections.selectedSortFieldOption[0]+"-"+userSelections.selectedSortFieldOption[1]+"]").html()),$("#"+properties.ContentContainerID+" .vh-content-lineup-clear").hide(),dateSelection=$(".vh-right-content .vh-content-filter .select-date-box, .vh-middle-content .vh-content-filter .select-date-box").next().find("[data-value="+userSelections.selectedFilterOption+"]").html(),dateSelection=="Specific Date"||dateSelection=="Custom Date Range"?(userSelections.selectedFilterValue!=""||userSelections.selectedFilterValue!=null)&&(dateSelection=="Specific Date"?(d=new Date.parse(userSelections.selectedFilterValue.split("=")[1]),$(".vh-right-content .vh-content-filter .select-date-box, .vh-middle-content .vh-content-filter .select-date-box").html(dateFormat(d,"mmm d, yyyy"))):(sd=new Date.parse(userSelections.selectedFilterValue.split("&")[1].split("=")[1]),ed=new Date.parse(userSelections.selectedFilterValue.split("&")[2].split("=")[1]),$(".vh-right-content .vh-content-filter .select-date-box, .vh-middle-content .vh-content-filter .select-date-box").html(dateFormat(sd,"mmm d, yyyy")+"-"+dateFormat(ed,"mmm d, yyyy")))):$(".vh-right-content .vh-content-filter .select-date-box, .vh-middle-content .vh-content-filter .select-date-box").html($(".vh-right-content .vh-content-filter .select-date-box, .vh-middle-content .vh-content-filter .select-date-box").next().find("[data-value="+userSelections.selectedFilterOption+"]").html()),userSelections.selectedSortFieldValue=userSelections.selectedSortFieldValue=="broadcastdate"?"broadcastdate":userSelections.selectedSortFieldValue,userSelections.selectedSortOrderValue=userSelections.selectedSortOrderValue=="desc"?"desc":userSelections.selectedSortOrderValue,userSelections.selectedFilterValue=userSelections.selectedFilterValue==""?"":userSelections.selectedFilterValue,userSelections.selectedContentTypeFilterValue=userSelections.selectedContentTypeFilterValue==""?"":userSelections.selectedContentTypeFilterValue,elem!=null?($(elem).find(">:first-child").is("img")?$("#"+container+" .navHeader").html($(elem).find(">:first-child").attr("alt")):$("#"+container+" .navHeader").html($(elem).html()),userSelections.selectedGenreLabel=$("#"+container+" .navHeader").html()):userSelections.selectedGenreLabel!=""&&$("#"+container+" .navHeader").html(userSelections.selectedGenreLabel),userSelections.userNavType!="search"?$("#vh-search-value").val(""):$("#vh-search-value").val(userSelections.userSearchValue),$("#"+container+" .vh-content-sort").show(),$("#"+container+" .vh-content-filter").show(),$("#"+properties.ContentContainerID+" .vh-content-filter-bydate").hide(),AxisVideoHub.BuildCrumb("allGenres",null),height=$("#"+container+" .vh-content-list").height(),$("#"+container+" .vh-content-list").html('<div class="VideoLoading">'),$("#"+container+" .vh-content-list .VideoLoading").css("height",height+"px"),$.ajaxSetup({cache:!0}),$.ajax({url:AxisShowServiceURL+AxisVideoHub.BuildMediaAxisQueryString("genre",pageNum,genreId),contentType:"application/json;",dataType:"jsonp",cache:!0,jsonpCallback:"getJsonFromCAPI_LoadGenreContent",success:function(jsonResponse){var result=jsonResponse;result.Count>0||result.Items.length>0?(AxisVideoHub.PagerRender($("#Pager"),result.Count,properties.VideosPerPage,pageNum,"genre",genreId),AxisVideoHub.ProcessVideos(result.Items,"contentcollection"),$("#"+container+".vh-content-list .VideoLoading").hide()):($("#Pager").hide(),$("#"+container+" .vh-content-list .VideoLoading").hide(),$("#"+container+" .vh-content-list").html("<div class='noResultsError'>Sorry, no videos found</div>"))}})},AxisVideoHub.LoadMediaContent=function(pageNum,mediaId,elem){var dateSelection,d,sd,ed,height;userSelections.selectedMediaId=mediaId,userSelections.userNavType="media",userSelections.selectedGenreId="",userSelections.selectedGenreLabel="",$(".vh-right-content .vh-content-filter  .select-content-type-box, .vh-middle-content .vh-content-filter .select-content-type-box").html($(".vh-right-content .vh-content-filter .select-content-type-box, .vh-middle-content .vh-content-filter .select-content-type-box").next().find("[data-value="+userSelections.selectedContentTypeFilterValue.split("=")[1]+"]").html()),$(".vh-right-content .vh-content-sort .select-sort-box, .vh-middle-content .vh-content-sort .select-sort-box").html($(".vh-right-content .vh-content-sort .select-sort-box, .vh-middle-content .vh-content-sort .select-sort-box").next().find("[data-value="+userSelections.selectedSortFieldOption[0]+"-"+userSelections.selectedSortFieldOption[1]+"]").html()),$("#"+properties.ContentContainerID+" .vh-content-lineup-clear").hide(),dateSelection=$(".vh-right-content .vh-content-filter .select-date-box, .vh-middle-content .vh-content-filter .select-date-box").next().find("[data-value="+userSelections.selectedFilterOption+"]").html(),dateSelection=="Specific Date"||dateSelection=="Custom Date Range"?(userSelections.selectedFilterValue!=""||userSelections.selectedFilterValue!=null)&&(dateSelection=="Specific Date"?(d=new Date.parse(userSelections.selectedFilterValue.split("=")[1]),$(".vh-right-content .vh-content-filter .select-date-box, .vh-middle-content .vh-content-filter .select-date-box").html(dateFormat(d,"mmm d, yyyy"))):(sd=new Date.parse(userSelections.selectedFilterValue.split("&")[1].split("=")[1]),ed=new Date.parse(userSelections.selectedFilterValue.split("&")[2].split("=")[1]),$(".vh-right-content .vh-content-filter .select-date-box, .vh-middle-content .vh-content-filter .select-date-box").html(dateFormat(sd,"mmm d, yyyy")+"-"+dateFormat(ed,"mmm d, yyyy")))):$(".vh-right-content .vh-content-filter .select-date-box, .vh-middle-content .vh-content-filter .select-date-box").html($(".vh-right-content .vh-content-filter .select-date-box, .vh-middle-content .vh-content-filter .select-date-box").next().find("[data-value="+userSelections.selectedFilterOption+"]").html()),userSelections.selectedSortFieldValue=userSelections.selectedSortFieldValue=="broadcastdate"?"broadcastdate":userSelections.selectedSortFieldValue,userSelections.selectedSortOrderValue=userSelections.selectedSortOrderValue=="desc"?"desc":userSelections.selectedSortOrderValue,userSelections.selectedFilterValue=userSelections.selectedFilterValue==""?"":userSelections.selectedFilterValue,userSelections.selectedContentTypeFilterValue=userSelections.selectedContentTypeFilterValue==""?"":userSelections.selectedContentTypeFilterValue,elem!=null?($(elem).find(">:first-child").is("img")?$("#"+container+" .navHeader").html($(elem).find(">:first-child").attr("alt")):$("#"+container+" .navHeader").html($(elem).html()),userSelections.selectedMediaLabel=$("#"+container+" .navHeader").html()):userSelections.selectedMediaLabel!=""&&$("#"+container+" .navHeader").html(userSelections.selectedMediaLabel),$(elem).parent().is("li")&&(userSelections.selectedNavIndex=2,$(elem).addClass("Selected"),$.each($(".vh-left-must-watch ul li.nav-item-mw").not($(elem).parent()),function(){$(this).find("a").removeClass("Selected")}),$.each($(".vh-left-nav .vh-left-container ul li.nav-item"),function(){$(this).find("a").removeClass("Selected")}),$("#vh-datepicker-dialog").dialog("close"),$("#vh-datepicker-range-dialog").dialog("close"),AxisVideoHub.ClearFitlersAndSorts()),userSelections.userNavType!="search"?$("#vh-search-value").val(""):$("#vh-search-value").val(userSelections.userSearchValue),$("#"+properties.ContentContainerID+" .vh-content-sort").show(),$("#"+properties.ContentContainerID+" .vh-content-filter").show(),$("#"+properties.ContentContainerID+" .vh-content-filter-bydate").hide(),AxisVideoHub.BuildCrumb("allshows",null),height=$("#"+container+" .vh-content-list").height(),$("#"+container+" .vh-content-list").html('<div class="VideoLoading">'),$("#"+container+" .vh-content-list .VideoLoading").css("height",height+"px"),$.ajaxSetup({cache:!0}),$.ajax({url:AxisShowServiceURL+AxisVideoHub.BuildMediaAxisQueryString("media",pageNum,mediaId),contentType:"application/json;",dataType:"jsonp",cache:!0,jsonpCallback:"getJsonFromCAPI_LoadMediaContent",success:function(jsonResponse){var result=jsonResponse,$firstItem;result.Count>0||result.Items.length>0?(AxisVideoHub.PagerRender($("#Pager"),result.Count,properties.VideosPerPage,pageNum,"media",mediaId),AxisVideoHub.ProcessVideos(result.Items,"contentcollection"),$("#"+container+".vh-content-list .VideoLoading").hide(),$("#"+container+" .navHeader").html()==""&&($firstItem=$("#"+container+" .vh-content-list .Item").first(),$firstItem.length>0&&$("#"+container+" .navHeader").html($firstItem.find("div.Details  div.Show").text()))):($("#Pager").hide(),$("#"+container+" .vh-content-list .VideoLoading").hide(),$("#"+container+" .vh-content-list").html("<div class='noResultsError'>Sorry, no videos found</div>"))}})},AxisVideoHub.SearchContent=function(pageNum,value){var byDateIndex,height;userSelections.userNavType="search",userSelections.userSearchValue=value,$.each($(".vh-nav-container ul li.nav-item"),function(){$(this).find("a").text()=="Videos By Date"&&(byDateIndex=$(this).attr("data-index"))}),userSelections.selectedNavIndex=="2"||userSelections.selectedNavIndex=="3"||userSelections.selectedPlayList||userSelections.selectedNavIndex==byDateIndex?userSelections.selectedNavIndex==2?AxisVideoHub.BuildCrumb("show",null):userSelections.selectedNavIndex==3?AxisVideoHu
b.BuildCrumb("genre",null):userSelections.selectedPlayList?AxisVideoHub.BuildCrumb("playList",null):userSelections.selectedNavIndex==byDateIndex&&AxisVideoHub.BuildCrumb("bydate",byDateIndex):AxisVideoHub.BuildCrumb("navItem",userSelections.selectedNavIndex),$("#"+container+" .navHeader").html('Search Results for "'+value+'"'),$("#vhcontent .vh-content-sort").show(),$("#vhcontent .vh-content-filter").show(),$("#"+properties.ContentContainerID+" .vh-content-filter-bydate").hide(),$(".vh-left-nav div.vh-left-container div.vh-nav-container div.vh-left-playlist").css("background-image","none"),$("#"+properties.ContentContainerID+" .vh-content-lineup-clear").hide(),height=$("#"+container+" .vh-content-list").height(),$("#"+container+" .vh-content-list").html('<div class="VideoLoading">'),$("#"+container+" .vh-content-list .VideoLoading").css("height",height+"px"),$.ajaxSetup({cache:!0}),$.ajax({url:AxisShowServiceURL+AxisVideoHub.BuildMediaAxisQueryString("search",pageNum,value),contentType:"application/json;",dataType:"jsonp",cache:!0,jsonpCallback:"getJsonFromCAPI_SearchContent",success:function(jsonResponse){var result=jsonResponse;result.Count>0||result.Items.length>0?(AxisVideoHub.PagerRender($("#Pager"),result.Count,properties.VideosPerPage,pageNum,"search",value),AxisVideoHub.ProcessVideos(result.Items,"contentcollection"),$("#"+container+".vh-content-list .VideoLoading").hide(),Tracking.videoHub.trackSearchKeyword(value)):($("#Pager").hide(),$("#"+container+" .vh-content-list .VideoLoading").hide(),$("#"+container+" .vh-content-list").html("<div class='noResultsError'>Sorry, no videos found</div>"))}})},AxisVideoHub.LoadMedias=function(){var index,height;$("#"+container+" .vh-crumb-container").empty(),userSelections.crumbContent=$("#"+container+" .vh-crumb-container").html(),$("#"+container+" .vh-crumb-container").hide(),index=2,userSelections.selectedNavIndex=index,$("#vh-datepicker-dialog").dialog("close"),$("#vh-datepicker-range-dialog").dialog("close"),$("#"+properties.ContentContainerID+" .vh-content-filter").hide(),$("#"+properties.ContentContainerID+" .vh-content-sort").hide(),AxisVideoHub.ClearFitlersAndSorts(),$.each($(".vh-left-must-watch ul li.nav-item-mw"),function(){$(this).find("a").removeClass("Selected")}),userSelections.userNavType!="search"?$("#vh-search-value").val(""):$("#vh-search-value").val(userSelections.userSearchValue),$("#"+container+" .navHeader").html(properties.hubNav[index].Title),$("#nav-item"+index).find("a:first").addClass("Selected"),removeNavSelected($("#nav-item"+index)),height=$("#"+container+" .vh-content-list").height(),$("#"+container+" .vh-content-list").html('<div class="VideoLoading">'),$("#"+container+" .vh-content-list .VideoLoading").css("height",height+"px"),$.ajaxSetup({cache:!0}),$.ajax({url:AxisShowServiceURL+AxisVideoHub.BuildMediaAxisQueryString(properties.hubNav[index].Type,1,properties.hubNav[index].AxisContentID),contentType:"application/json;",dataType:"jsonp",jsonpCallback:"getJsonFromCAPI_LoadNavClick",cache:!0,success:function(jsonResponse){var result=jsonResponse;result.Count>0||result.Items.length>0?(properties.hubNav[index].Type=="collection"?AxisVideoHub.PagerRender($("#Pager"),result.Count,properties.VideosPerPage,1,"collection",0):$("#Pager").hide(),AxisVideoHub.ProcessVideos(result.Items,properties.hubNav[index].Type),$("#"+container+".vh-content-list .VideoLoading").hide()):($("#Pager").hide(),$("#"+container+" .vh-content-list .VideoLoading").hide(),$("#"+container+" .vh-content-list").html("<div class='noResultsError'>Sorry, no videos found</div>"))}})},AxisVideoHub.LoadGenres=function(){var index,height;$("#"+container+" .vh-crumb-container").empty(),userSelections.crumbContent=$("#"+container+" .vh-crumb-container").html(),$("#"+container+" .vh-crumb-container").hide(),index=3,userSelections.selectedNavIndex=index,$("#vh-datepicker-dialog").dialog("close"),$("#vh-datepicker-range-dialog").dialog("close"),$("#"+properties.ContentContainerID+" .vh-content-filter").hide(),$("#"+properties.ContentContainerID+" .vh-content-sort").hide(),AxisVideoHub.ClearFitlersAndSorts(),$.each($(".vh-left-must-watch ul li.nav-item-mw"),function(){$(this).find("a").removeClass("Selected")}),userSelections.userNavType!="search"?$("#vh-search-value").val(""):$("#vh-search-value").val(userSelections.userSearchValue),$("#"+container+" .navHeader").html(properties.hubNav[index].Title),$("#nav-item"+index).find("a:first").addClass("Selected"),removeNavSelected($("#nav-item"+index)),height=$("#"+container+" .vh-content-list").height(),$("#"+container+" .vh-content-list").html('<div class="VideoLoading">'),$("#"+container+" .vh-content-list .VideoLoading").css("height",height+"px"),$.ajaxSetup({cache:!0}),$.ajax({url:AxisShowServiceURL+AxisVideoHub.BuildMediaAxisQueryString(properties.hubNav[index].Type,1,properties.hubNav[index].AxisContentID),contentType:"application/json;",dataType:"jsonp",jsonpCallback:"getJsonFromCAPI_LoadNavClick",cache:!0,success:function(jsonResponse){var result=jsonResponse;result.Count>0||result.Items.length>0?(properties.hubNav[index].Type=="collection"?AxisVideoHub.PagerRender($("#Pager"),result.Count,properties.VideosPerPage,1,"collection",0):$("#Pager").hide(),AxisVideoHub.ProcessVideos(result.Items,properties.hubNav[index].Type),$("#"+container+".vh-content-list .VideoLoading").hide()):($("#Pager").hide(),$("#"+container+" .vh-content-list .VideoLoading").hide(),$("#"+container+" .vh-content-list").html("<div class='noResultsError'>Sorry, no videos found</div>"))}})},AxisVideoHub.LoadByDate=function(pageNum){var byDateIndex,splitDateRange,height;if(userSelections.userNavType="custom",userSelections.userSearchValue="",$("#vh-search-value").val(""),$("#"+container+" .vh-crumb-container").empty(),userSelections.crumbContent=$("#"+container+" .vh-crumb-container").html(),$("#"+container+" .vh-crumb-container").hide(),$.each($(".vh-nav-container ul li.nav-item"),function(){$(this).find("a").text()=="Videos By Date"&&(byDateIndex=$(this).attr("data-index"))}),userSelections.selectedNavIndex=byDateIndex,$("#vh-datepicker-dialog-bydate").dialog("close"),$("#vh-datepicker-dialog").dialog("close"),$("#vh-datepicker-range-dialog").dialog("close"),$("#"+properties.ContentContainerID+" .vh-content-filter").hide(),$("#"+properties.ContentContainerID+" .vh-content-sort").hide(),$("#"+properties.ContentContainerID+" .vh-content-filter-bydate").show(),userSelections.selectedCustomDate!=null)switch(userSelections.selectedCustomDate.type){case"day":userSelections.selectedFilterValue="&BroadcastDate="+userSelections.selectedCustomDate.date,AxisVideoHub.GenerateByDateLinks(userSelections.selectedCustomDate.date);break;case"specific_date":userSelections.selectedFilterValue="&BroadcastDate="+userSelections.selectedCustomDate.date,AxisVideoHub.GenerateByDateLinks(userSelections.selectedCustomDate.date);break;case"date_range":splitDateRange=userSelections.selectedCustomDate.date.split(","),userSelections.selectedFilterValue="&BroadcastDate_start="+splitDateRange[0]+"&BroadcastDate_end="+splitDateRange[1],AxisVideoHub.GenerateByDateLinks(userSelections.selectedCustomDate.date)}$.each($(".vh-left-must-watch ul li.nav-item-mw"),function(){$(this).find("a").removeClass("Selected")}),userSelections.userNavType!="search"?$("#vh-search-value").val(""):$("#vh-search-value").val(userSelections.userSearchValue),$("#"+container+" .navHeader").html(properties.hubNav[byDateIndex].Title),$("#nav-item"+byDateIndex).find("a:first").addClass("Selected"),removeNavSelected($("#nav-item"+byDateIndex)),height=$("#"+container+" .vh-content-list").height(),$("#"+container+" .vh-content-list").html('<div class="VideoLoading">'),$("#"+container+" .vh-content-list .VideoLoading").css("height",height+"px"),$.ajaxSetup({cache:!0}),$.ajax({url:AxisShowServiceURL+AxisVideoHub.BuildMediaAxisQueryString(properties.hubNav[byDateIndex].Type,pageNum,properties.hubNav[byDateIndex].AxisContentID),contentType:"application/json;",dataType:"jsonp",jsonpCallback:"getJsonFromCAPI_LoadByDate",cache:!0,success:function(jsonResponse){var result=jsonResponse;result.Count>0||result.Items.length>0?(properties.hubNav[byDateIndex].Type=="collection"||properties.hubNav[byDateIndex].Type=="custom"?AxisVideoHub.PagerRender($("#Pager"),result.Count,properties.VideosPerPage,pageNum,"custom",0):$("#Pager").hide(),AxisVideoHub.ProcessVideos(result.Items,properties.hubNav[byDateIndex].Type),$("#"+container+".vh-content-list .VideoLoading").hide()):($("#Pager").hide(),$("#"+container+" .vh-content-list .VideoLoading").hide(),$("#"+container+" .vh-content-list").html("<div class='noResultsError'>Sorry, no videos found</div>"))}})},AxisVideoHub.LoadPlayList=function(){$("#"+container+" .vh-crumb-container").empty(),userSelections.crumbContent=$("#"+container+" .vh-crumb-container").html(),$("#"+container+" .vh-crumb-container").hide(),userSelections.selectedPlayList=!0,$("#vh-datepicker-dialog").dialog("close"),$("#vh-datepicker-range-dialog").dialog("close"),$("#"+properties.ContentContainerID+" .vh-content-filter").hide(),$("#"+properties.ContentContainerID+" .vh-content-sort").hide(),AxisVideoHub.ClearFitlersAndSorts(),$.each($(".vh-left-must-watch ul li.nav-item-mw"),function(){$(this).find("a").removeClass("Selected")}),$.each($(".vh-nav-container ul li.nav-item"),function(){$(this).find("a").removeClass("Selected")}),$(".vh-left-nav div.vh-left-container div.vh-nav-container div.vh-left-playlist").css("background-image","url(../Images/videohub/icons/icn_hub_playlist_arrow.png)"),$(".vh-left-nav div.vh-left-container div.vh-nav-container div.vh-left-playlist").css("background-repeat","no-repeat"),$(".vh-left-nav div.vh-left-container div.vh-nav-container div.vh-left-playlist").css("background-position","right center"),userSelections.userNavType!="search"?$("#vh-search-value").val(""):$("#vh-search-value").val(userSelections.userSearchValue),$("#"+container+"
 .navHeader").html(PlaylistTitle);var height=$("#"+container+" .vh-content-list").height();$("#"+container+" .vh-content-list").html('<div class="VideoLoading">'),$("#"+container+" .vh-content-list .VideoLoading").css("height",height+"px"),$("#Pager").hide(),userPlayList.listItems.length>0?($("#"+properties.ContentContainerID+" .vh-content-lineup-clear").show(),AxisVideoHub.ProcessVideos(userPlayList.listItems,"playList"),$("#"+container+".vh-content-list .VideoLoading").hide()):($("#"+properties.ContentContainerID+" .vh-content-lineup-clear").hide(),$("#"+container+" .vh-content-list .VideoLoading").hide(),$("#"+container+" .vh-content-list").html("<div class='noResultsError'><p>The My Playlist feature is a great way to group videos that you want to watch - or watch again. Simply select the “Add to My Playlist” to add any video to your personal playlist. You can remove a video from the list by selecting “Remove”, or you can clear the list completely to start again.</p><p>You currently do not have any videos in your playlist. Select a menu item on the left and start adding videos now.</p</div>"))},AxisVideoHub.BuildCrumb=function(type,index){var mediaId,showText,genreId,genreText;$("#"+container+" .vh-crumb-container").show();switch(type){case"allshows":$("#"+container+" .vh-crumb-container .allShowsCrumb").length>0?($("#"+container+" .vh-crumb-container .chevron").remove(),$("#"+container+" .vh-crumb-container .showCrumb").remove()):$("#"+container+" .vh-crumb-container").append("<a class='allShowsCrumb' href='javascript:void(0)' onclick='BNN.Modules.AxisVideoHub.setfromSearch(true); BNN.Modules.AxisVideoHub.LoadMedias();'>Select a different show</a>");break;case"show":mediaId=userSelections.selectedMediaId,showText=userSelections.selectedMediaLabel,$("#"+container+" .vh-crumb-container .showCrumb").length==0&&$("#"+container+" .vh-crumb-container").append("<span class='chevron'>&#60;</span><a class='showCrumb' href='javascript:void(0)' onclick='BNN.Modules.AxisVideoHub.LoadMediaContent(1,"+mediaId+",null )'>"+showText+"</a>");break;case"allGenres":$("#"+container+" .vh-crumb-container .allGenresCrumb").length>0?($("#"+container+" .vh-crumb-container .chevron").remove(),$("#"+container+" .vh-crumb-container .genreCrumb").remove()):$("#"+container+" .vh-crumb-container").append("<a class='allGenresCrumb' href='javascript:void(0)' onclick='BNN.Modules.AxisVideoHub.setfromSearch(true); BNN.Modules.AxisVideoHub.LoadGenres();'>Select a different sector</a>");break;case"genre":genreId=userSelections.selectedGenreId,genreText=userSelections.selectedGenreLabel,$("#"+container+" .vh-crumb-container .genreCrumb").length==0&&$("#"+container+" .vh-crumb-container").append("<span class='chevron'>&#60;</span><a class='genreCrumb' href='javascript:void(0)' onclick='BNN.Modules.AxisVideoHub.LoadGenreContent(1,"+genreId+",null );'>"+genreText+"</a>");break;case"navItem":navItemText=$(".vh-left-nav .vh-left-container .vh-nav-container ul li#nav-item"+index+".nav-item").text(),$("#"+container+" .vh-crumb-container .navItemCrumb").length==0&&$("#"+container+" .vh-crumb-container").append("<a class='navItemCrumb' href='javascript:void(0)' onclick='BNN.Modules.AxisVideoHub.LoadNavClick("+index+");'>"+navItemText+"</a>");break;case"playList":navItemText="My Playlist",$("#"+container+" .vh-crumb-container .navItemCrumb").length==0&&$("#"+container+" .vh-crumb-container").append("<a class='navItemCrumb' href='javascript:void(0)' onclick='BNN.Modules.AxisVideoHub.LoadPlayList();'>"+navItemText+"</a>");break;case"bydate":navItemText=$(".vh-left-nav .vh-left-container .vh-nav-container ul li#nav-item"+index+".nav-item").text(),$("#"+container+" .vh-crumb-container .navItemCrumb").length==0&&$("#"+container+" .vh-crumb-container").append("<a class='navItemCrumb' href='javascript:void(0)' onclick='BNN.Modules.AxisVideoHub.LoadByDate(1);'>"+navItemText+"</a>")}userSelections.crumbContent=$("#"+container+" .vh-crumb-container").html()},AxisVideoHub.BindEvents=function(){$("#vh-search-value").keydown(function(event){event.keyCode==13&&$("#vh-search-button").trigger("click")}),$("#vh-search-button").bind("click",function(){var query=$.trim($("#vh-search-value").val());query!=""&&query!="Search Videos"?isHtml(query)?alert("please enter a valid search term"):(userSelections.userSearchValue=query,AxisVideoHub.SearchContent(1,userSelections.userSearchValue)):alert("please enter a valid search term")}),$(".vh-right-content .vh-content-sort .select-sort-box, .vh-middle-content .vh-content-sort .select-sort-box").bind("click",function(){$(this).next().is(":visible")?($(this).css("border","1px solid #ccc"),$(this).next().hide()):($(this).css("border-bottom","0"),$(this).next().show())}),$(".vh-right-content .vh-content-sort ul.vh-select-sort, .vh-middle-content .vh-content-sort ul.vh-select-sort").bind("mouseleave",function(){$(this).prev().css("border","1px solid #ccc"),$(this).hide()}),$(".vh-right-content .vh-content-filter .select-content-type-box, .vh-middle-content .vh-content-filter .select-content-type-box").bind("click",function(){$(this).next().is(":visible")?($(this).css("border","1px solid #ccc"),$(this).next().hide()):($(this).css("border-bottom","0"),$(this).next().show())}),$(".vh-right-content .vh-content-filter ul.vh-select-content-type-filter, .vh-middle-content .vh-content-filter ul.vh-select-content-type-filter").bind("mouseleave",function(){$(this).prev().css("border","1px solid #ccc"),$(this).hide()}),$(".vh-right-content .vh-content-filter .select-date-box, .vh-middle-content .vh-content-filter .select-date-box").bind("click",function(){$(this).next().is(":visible")?($(this).css("border","1px solid #ccc"),$(this).next().hide()):($(this).css("border-bottom","0"),$(this).next().show())}),$(".vh-right-content .vh-content-filter ul.vh-select-date-filter, .vh-middle-content .vh-content-filter ul.vh-select-date-filter").bind("mouseleave",function(){$(this).prev().css("border","1px solid #ccc"),$(this).hide()}),$(".vh-right-content .vh-content-filter-bydate .select-date-box, .vh-middle-content .vh-content-filter-bydate .select-date-box").bind("click",function(){$(this).next().is(":visible")?($(this).css("border","1px solid #ccc"),$(this).next().hide()):($(this).css("border-bottom","0"),$(this).next().show())}),$(".vh-right-content .vh-content-filter-bydate ul.vh-select-date-filter, .vh-middle-content .vh-content-filter-bydate ul.vh-select-date-filter").bind("mouseleave",function(){$(this).prev().css("border","1px solid #ccc"),$(this).hide()}),$("#"+properties.ContentContainerID+" .vh-select-sort li").live("click",function(){$(this).parent().hide(),$(this).parent().prev().html($(this).html()),$(this).parent().prev().css("border","1px solid #ccc");var sortOptions=$(this).attr("data-value").split("-");userSelections.selectedSortFieldOption=sortOptions,userSelections.selectedSortFieldValue=sortOptions[0],userSelections.selectedSortOrderValue=sortOptions[1],userSelections.userNavType=="media"?AxisVideoHub.LoadMediaContent(1,userSelections.selectedMediaId,null):userSelections.userNavType=="genre"?AxisVideoHub.LoadGenreContent(1,userSelections.selectedGenreId,null):userSelections.userNavType=="search"&&AxisVideoHub.SearchContent(1,userSelections.userSearchValue)}),$("#"+properties.ContentContainerID+" .vh-content-filter .vh-select-content-type-filter li").live("click",function(){$(this).parent().hide(),$(this).parent().prev().html($(this).html()),$(this).parent().prev().css("border","1px solid #ccc");var typeFilterOptions=$(this).attr("data-value");switch(typeFilterOptions){case"all":userSelections.selectedContentTypeFilterValue="";break;case"episode":userSelections.selectedContentTypeFilterValue="&Type=episode";break;case"segment":userSelections.selectedContentTypeFilterValue="&Type=segment"}userSelections.userNavType=="media"?AxisVideoHub.LoadMediaContent(1,userSelections.selectedMediaId,null):userSelections.userNavType=="genre"?AxisVideoHub.LoadGenreContent(1,userSelections.selectedGenreId,null):userSelections.userNavType=="search"&&AxisVideoHub.SearchContent(1,userSelections.userSearchValue)}),$("#"+properties.ContentContainerID+" .vh-content-filter .vh-select-date-filter li").live("click",function(){$(this).parent().hide(),$(this).parent().prev().html($(this).html()),$(this).parent().prev().css("border","1px solid #ccc");var dateFilterOptions=$(this).attr("data-value");userSelections.selectedFilterOption=dateFilterOptions;switch(dateFilterOptions){case"all":userSelections.selectedFilterValue="",userSelections.userNavType=="media"?AxisVideoHub.LoadMediaContent(1,userSelections.selectedMediaId,null):userSelections.userNavType=="genre"?AxisVideoHub.LoadGenreContent(1,userSelections.selectedGenreId,null):userSelections.userNavType=="search"&&AxisVideoHub.SearchContent(1,userSelections.userSearchValue);break;case"today":userSelections.selectedFilterValue="&BroadcastDate="+properties.TodaysDate,userSelections.userNavType=="media"?AxisVideoHub.LoadMediaContent(1,userSelections.selectedMediaId,null):userSelections.userNavType=="genre"?AxisVideoHub.LoadGenreContent(1,userSelections.selectedGenreId,null):userSelections.userNavType=="search"&&AxisVideoHub.SearchContent(1,userSelections.userSearchValue);break;case"yesterday":userSelections.selectedFilterValue="&BroadcastDate="+properties.YesterdaysDate,userSelections.userNavType=="media"?AxisVideoHub.LoadMediaContent(1,userSelections.selectedMediaId,null):userSelections.userNavType=="genre"?AxisVideoHub.LoadGenreContent(1,userSelections.selectedGenreId,null):userSelections.userNavType=="search"&&AxisVideoHub.SearchContent(1,userSelections.userSearchValue);break;case"last7days":userSelections.selectedFilterValue="&BroadcastDate_start="+properties.Last7DaysDate+"&BroadcastDate_end="+properties.TodaysDate,userSelections.userNavType=="media"?AxisVideoHub.LoadMediaContent(1,userSelections.selectedMediaId,null):userSelections.userNavType=="genre"?AxisVideoHub.LoadGenreContent(1,userSelections.selectedG
enreId,null):userSelections.userNavType=="search"&&AxisVideoHub.SearchContent(1,userSelections.userSearchValue);break;case"specific_date":$("#vh-datepicker-dialog").dialog("open"),$("#vh-datepicker-dialog .vh-datepicker-done").addClass("disabled"),$("#vh-datepicker").focus(),$("#vh-datepicker-dialog .vh-datepicker-done").click(function(){$("#vh-datepicker-specific").val()!=""&&(BNN.Modules.AxisVideoHub.SingleDateClick($("#vh-datepicker-specific").val()),$(".vh-right-content .vh-content-filter .select-date-box, .vh-middle-content .vh-content-filter .select-date-box").html($("#vh-datepicker-specific").attr("data-value")),$("#vh-datepicker-dialog").dialog("close"))}),$("#vh-datepicker-dialog .vh-datepicker-cancel").click(function(){$("#vh-datepicker-dialog").dialog("close")});break;case"date_range":$("#vh-datepicker-range-dialog").dialog("open"),$("#vh-datepicker-range-dialog .vh-datepicker-range-done").addClass("disabled"),$(".ui-datepicker-week-end").hide(),$("#vh-datepicker-range-dialog .vh-datepicker-range-done").click(function(){if($("#vh-datepicker-text-from").val()==""||$("#vh-datepicker-text-to").val()=="")$("#vh-datepicker-range-dialog .vh-datepicker-range-error").html("You must select both dates");else{$("#vh-datepicker-range-dialog .vh-datepicker-range-error").html("");var splitFromDate=$("#vh-datepicker-text-from").val().split("-"),splitToDate=$("#vh-datepicker-text-to").val().split("-"),fromDate=new Date(splitFromDate[0],splitFromDate[1].charAt(0)=="0"?splitFromDate[1].slice(1,2)-1:splitFromDate[1],splitFromDate[2]),toDate=new Date(splitToDate[0],splitToDate[1].charAt(0)=="0"?splitToDate[1].slice(1,2)-1:splitToDate[1],splitToDate[2]),sdate,edate;fromDate>toDate?(sdate=$("#vh-datepicker-text-to").val(),edate=$("#vh-datepicker-text-from").val(),$(".vh-right-content .vh-content-filter .select-date-box").html($("#vh-datepicker-text-to").attr("data-value")+" - "+$("#vh-datepicker-text-from").attr("data-value"))):fromDate.getTime()===toDate.getTime()?(sdate=$("#vh-datepicker-text-to").val(),edate=$("#vh-datepicker-text-to").val(),$(".vh-right-content .vh-content-filter .select-date-box").html($("#vh-datepicker-text-to").attr("data-value"))):(sdate=$("#vh-datepicker-text-from").val(),edate=$("#vh-datepicker-text-to").val(),$(".vh-right-content .vh-content-filter .select-date-box").html($("#vh-datepicker-text-from").attr("data-value")+" - "+$("#vh-datepicker-text-to").attr("data-value"))),userSelections.selectedFilterValue="&BroadcastDate_start="+sdate+"&BroadcastDate_end="+edate,userSelections.userNavType=="media"?AxisVideoHub.LoadMediaContent(1,userSelections.selectedMediaId,null):userSelections.userNavType=="genre"?AxisVideoHub.LoadGenreContent(1,userSelections.selectedGenreId,null):userSelections.userNavType=="search"&&AxisVideoHub.SearchContent(1,userSelections.userSearchValue),$("#vh-datepicker-range-dialog").dialog("close")}}),$("#vh-datepicker-range-dialog .vh-datepicker-range-cancel").click(function(){$("#vh-datepicker-range-dialog").dialog("close")})}}),$("#"+properties.ContentContainerID+" .vh-content-filter-bydate .vh-content-filter-bydate-button").live("click",function(){var dateFilterOptions=$(this).attr("data-value"),button=$(this),customSelectedDateObj={type:"",date:""};$("#vh-datepicker-range-dialog-bydate").dialog("close"),$("#vh-datepicker-dialog-bydate").dialog("close"),dateFilterOptions=="specific_date"?($("#vh-content-filter-bydate-custom-date").html("Date Range"),$("#vh-datepicker-dialog-bydate").dialog("open"),$("#vh-datepicker-dialog-bydate .vh-datepicker-done").addClass("disabled"),$("#vh-datepicker").focus(),$("#vh-datepicker-dialog-bydate .vh-datepicker-done").click(function(){$("#vh-datepicker-specific-bydate").val()!=""&&(BNN.Modules.AxisVideoHub.CustomSingleDateClick($("#vh-datepicker-specific-bydate").val()),$(button).html("Specific Date ("+$("#vh-datepicker-specific-bydate").attr("data-value")+")"),$("#vh-datepicker-dialog-bydate").dialog("close"))}),$("#vh-datepicker-dialog-bydate .vh-datepicker-cancel").click(function(){$("#vh-datepicker-dialog-bydate").dialog("close")})):dateFilterOptions=="date_range"?($("#vh-datepicker-range-dialog-bydate").dialog("open"),$("#vh-content-filter-bydate-specific-date").html("Specific Date"),$("#vh-datepicker-range-dialog-bydate .vh-datepicker-range-done").addClass("disabled"),$("#vh-datepicker-range-dialog-bydate .vh-datepicker-range-done").click(function(){if($("#vh-datepicker-text-from-bydate").val()==""||$("#vh-datepicker-text-to-bydate").val()=="")$("#vh-datepicker-range-dialog-bydate .vh-datepicker-range-error").html("You must select both dates");else{$("#vh-datepicker-range-dialog-bydate .vh-datepicker-range-error").html("");var splitFromDate=$("#vh-datepicker-text-from-bydate").val().split("-"),splitToDate=$("#vh-datepicker-text-to-bydate").val().split("-"),fromDate=new Date(splitFromDate[0],splitFromDate[1].charAt(0)=="0"?splitFromDate[1].slice(1,2)-1:splitFromDate[1],splitFromDate[2]),toDate=new Date(splitToDate[0],splitToDate[1].charAt(0)=="0"?splitToDate[1].slice(1,2)-1:splitToDate[1],splitToDate[2]),sdate,edate;fromDate>toDate?(sdate=$("#vh-datepicker-text-to-bydate").val(),edate=$("#vh-datepicker-text-from-bydate").val(),$(button).html("Date Range ("+$("#vh-datepicker-text-to-bydate").attr("data-value")+" - "+$("#vh-datepicker-text-from-bydate").attr("data-value")+")")):fromDate.getTime()===toDate.getTime()?(sdate=$("#vh-datepicker-text-to-bydate").val(),edate=$("#vh-datepicker-text-to-bydate").val(),$(button).html("Date Range ("+$("#vh-datepicker-text-to-bydate").attr("data-value")+")")):(sdate=$("#vh-datepicker-text-from-bydate").val(),edate=$("#vh-datepicker-text-to-bydate").val(),$(button).html("Date Range ("+$("#vh-datepicker-text-from-bydate").attr("data-value")+" - "+$("#vh-datepicker-text-to-bydate").attr("data-value")+")")),userSelections.selectedFilterValue="&BroadcastDate_start="+sdate+"&BroadcastDate_end="+edate,customSelectedDateObj.type="date_range",customSelectedDateObj.date=sdate+","+edate,userSelections.selectedCustomDate=customSelectedDateObj,AxisVideoHub.LoadByDate(1),$("#vh-datepicker-range-dialog-bydate").dialog("close")}}),$("#vh-datepicker-range-dialog-bydate .vh-datepicker-range-cancel").click(function(){$("#vh-datepicker-range-dialog-bydate").dialog("close")})):(userSelections.selectedFilterValue="&BroadcastDate="+dateFilterOptions,customSelectedDateObj.type="day",customSelectedDateObj.date=dateFilterOptions,userSelections.selectedCustomDate=customSelectedDateObj,AxisVideoHub.LoadByDate(1),$("#vh-content-filter-bydate-specific-date").html("Specific Date"),$("#vh-content-filter-bydate-custom-date").html("Date Range"))}),$("#vh-datepicker").datepicker({dateFormat:"yy-mm-dd",minDate:new Date(2013,0,1),maxDate:"0",beforeShowDay:nonWorkingDates,onSelect:function(dateText,inst){$("#vh-datepicker-specific").val(dateText),$("#vh-datepicker-specific").attr("data-value",monthNames[inst.selectedMonth]+" "+inst.selectedDay+", "+inst.selectedYear),$("#vh-datepicker-dialog .vh-datepicker-done").removeClass("disabled")},onChangeMonthYear:function(){$("#vh-datepicker").focus()}}),$("#vh-datepicker-range-from").datepicker({dateFormat:"yy-mm-dd",minDate:new Date(2013,0,1),maxDate:"0",changeMonth:!0,beforeShowDay:nonWorkingDates,onSelect:function(selectedDate,inst){$("#vh-datepicker-text-from").val(selectedDate),$("#vh-datepicker-text-from").attr("data-value",monthNames[inst.selectedMonth]+" "+inst.selectedDay+", "+inst.selectedYear),rangeFromFlag=!0,rangeFromFlag==!0&&rangeToFlag==!0&&$("#vh-datepicker-range-dialog .vh-datepicker-range-done").removeClass("disabled")},onClose:function(selectedDate){$("#vh-datepicker-range-to").datepicker("option","minDate",selectedDate)}}),$("#vh-datepicker-range-to").datepicker({dateFormat:"yy-mm-dd",minDate:new Date(2013,1,1),maxDate:"0",changeMonth:!0,dateFormat:"yy-mm-dd",beforeShowDay:nonWorkingDates,onSelect:function(selectedDate,inst){$("#vh-datepicker-text-to").val(selectedDate),$("#vh-datepicker-text-to").attr("data-value",monthNames[inst.selectedMonth]+" "+inst.selectedDay+", "+inst.selectedYear),rangeToFlag=!0,rangeFromFlag==!0&&rangeToFlag==!0&&$("#vh-datepicker-range-dialog .vh-datepicker-range-done").removeClass("disabled")},onClose:function(selectedDate){$("#vh-datepicker-range-from").datepicker("option","maxDate",selectedDate)}}),$("#vh-datepicker-bydate").datepicker({dateFormat:"yy-mm-dd",minDate:new Date(2013,0,1),maxDate:"0",beforeShowDay:nonWorkingDates,onSelect:function(dateText,inst){$("#vh-datepicker-specific-bydate").val(dateText),$("#vh-datepicker-specific-bydate").attr("data-value",monthNames[inst.selectedMonth]+" "+inst.selectedDay+", "+inst.selectedYear),$("#vh-datepicker-dialog-bydate .vh-datepicker-done").removeClass("disabled")},onChangeMonthYear:function(){$("#vh-datepicker-bydate").focus()}}),$("#vh-datepicker-range-from-bydate").datepicker({dateFormat:"yy-mm-dd",minDate:new Date(2013,0,1),maxDate:"0",changeMonth:!0,beforeShowDay:nonWorkingDates,onSelect:function(selectedDate,inst){$("#vh-datepicker-text-from-bydate").val(selectedDate),$("#vh-datepicker-text-from-bydate").attr("data-value",monthNames[inst.selectedMonth]+" "+inst.selectedDay+", "+inst.selectedYear),rangeFromFlag=!0,rangeFromFlag==!0&&rangeToFlag==!0&&$("#vh-datepicker-range-dialog-bydate .vh-datepicker-range-done").removeClass("disabled")},onClose:function(selectedDate){$("#vh-datepicker-range-to-bydate").datepicker("option","minDate",selectedDate)}}),$("#vh-datepicker-range-to-bydate").datepicker({dateFormat:"yy-mm-dd",minDate:new Date(2013,1,1),maxDate:"0",changeMonth:!0,dateFormat:"yy-mm-dd",beforeShowDay:nonWorkingDates,onSelect:function(selectedDate,inst){$("#vh-datepicker-text-to-bydate").val(selectedDate),$("#vh-datepicker-text-to-bydate").attr("data-value",monthNames[inst.selectedMonth]+" "+inst.selectedDay+", "+inst.selectedYear),rangeToFlag=!0,rangeFromFlag==!0&&rangeToFlag==!0&&$("#vh-datepicker-range-dialog-bydate
 .vh-datepicker-range-done").removeClass("disabled")},onClose:function(selectedDate){$("#vh-datepicker-range-from-bydate").datepicker("option","maxDate",selectedDate)}}),$("#vh-datepicker-dialog").dialog({position:{my:"top",at:"right bottom",of:".select-date-box"},autoOpen:!1,show:{effect:"fade",duration:500},hide:{effect:"fade",duration:500},width:250,draggable:!1}),$("#vh-datepicker-range-dialog").dialog({position:{my:"top",at:"right bottom",of:".select-date-box"},autoOpen:!1,width:500,height:350,draggable:!1,show:{effect:"fade",duration:500},hide:{effect:"fade",duration:500}}),$("#vh-datepicker-dialog-bydate").dialog({position:{my:"top",at:"right bottom",of:"#vh-content-filter-bydate-specific-date"},autoOpen:!1,show:{effect:"fade",duration:500},hide:{effect:"fade",duration:500},width:250,draggable:!1});var $targetDIv=$("#vh-content-filter-bydate-custom-date");$("#vh-datepicker-range-dialog-bydate").dialog({position:{my:"top",at:"right bottom",of:$targetDIv},autoOpen:!1,width:500,height:350,draggable:!1,show:{effect:"fade",duration:500},hide:{effect:"fade",duration:500}}),$("#vh-clear-lineup-dialogue").dialog({autoOpen:!1,width:300,height:150,draggable:!1,show:{effect:"fade",duration:500},hide:{effect:"fade",duration:500}}),$(".vh-right-content .vh-content-list .Item .Expanded .ExpandedKeywords .Keywords .keyword, .vh-middle-content .vh-content-list .Item .Expanded .ExpandedKeywords .Keywords .keyword, .vh-player-related .vh-player-related-list .Item .Expanded .ExpandedKeywords .Keywords .keyword, .vh-player-meta .vh-player-meta-keyword-content .vh-player-meta-keyword-content-list .MetaItem").live("click",function(){AxisVideoHub.KeywordClick($(this).html()),$(this).parent().parent().parent().is(".Expanded")&&$(this).parent().parent().parent().hide()}),$(".vh-right-content div.vh-content-lineup-clear a, .vh-middle-content  div.vh-content-lineup-clear a").click(function(){$("#vh-clear-lineup-dialogue").dialog("open")}),$("#vh-clear-lineup-dialogue .vh-clear-lineup-cancel").click(function(){$("#vh-clear-lineup-dialogue").dialog("close")}),$("#vh-clear-lineup-dialogue .vh-clear-lineup-done").click(function(){$("#vh-clear-lineup-dialogue").dialog("close"),AxisVideoHub.RemoveAllPlayList()})},AxisVideoHub.UpdateLocalStorage=function(page){userSelections.currentPage=page,localStorage.userSelections=JSON.stringify(userSelections),localStorage.userPlayList=JSON.stringify(userPlayList)},AxisVideoHub.SingleDateClick=function(date){userSelections.selectedFilterValue="&BroadcastDate="+date,properties.hubNav[userSelections.selectedNavIndex].Type=="mediacollection"?AxisVideoHub.LoadMediaContent(1,userSelections.selectedMediaId,null):properties.hubNav[userSelections.selectedNavIndex].Type=="group"&&AxisVideoHub.LoadGenreContent(1,userSelections.selectedGenreId,null),$("#vh-datepicker-dialog").dialog("close")},AxisVideoHub.CustomSingleDateClick=function(date){var customSelectedDateObj={type:"specific_date",date:date};userSelections.selectedCustomDate=customSelectedDateObj,userSelections.selectedFilterValue="&BroadcastDate="+date,AxisVideoHub.LoadByDate(1),$("#vh-datepicker-dialog-bydate").dialog("close")},AxisVideoHub.DateRangeDateClick=function(){},AxisVideoHub.ProcessVideos=function(contentItems,type){(contentItems.length>0||!contentItems)&&AxisVideoHub.updateAxisHubContentContainer(contentItems,type)},AxisVideoHub.updateAxisHubContentContainer=function(content,type){var templateContainer=$("#"+container+" .vh-content-list"),templateUrl,$playerCheck;type=="contentcollection"||type=="custom"?templateUrl=Agility.ResolveUrl("~/ClientTemplates/AxisVideoHubCollection.htm"):type=="mediacollection"?templateUrl=Agility.ResolveUrl("~/ClientTemplates/AxisVideoHubMedia.htm"):type=="group"?templateUrl=Agility.ResolveUrl("~/ClientTemplates/AxisVideoHubGenre.htm"):type=="playList"&&(templateUrl=Agility.ResolveUrl("~/ClientTemplates/AxisVideoHubPlayList.htm")),templateContainer.html(""),templateContainer.setTemplateURL(templateUrl),templateContainer.processTemplate(content),$(".vh-right-content .vh-content-list .Item  a img, .vh-middle-content .vh-content-list .Item a img, .vh-right-content .vh-content-list .Item .Expanded .ExpandedLeft .ExpandedLeftThumbContainer a img, .vh-middle-content .vh-content-list .Item .Expanded .ExpandedLeft .ExpandedLeftThumbContainer a img").hover(function(){$(this).next().toggleClass("play-on")}),$playerCheck=$(".vh-middle-content"),$playerCheck.length&&BNN.Modules.AxisVideoHubDetail.SetStatus()},AxisVideoHub.SetStatus=function(){var clidpId=BNN.Modules.AxisVideoHubDetail.getParameterByName("vid"),$nowPlayingItem=$(".vh-middle-content .vh-content-list").find("#clip_"+clidpId),$nextPlayingItem;$nowPlayingItem.find(".Status").html("Now Playing").show(),$nextPlayingItem=$(".vh-middle-content .vh-content-list").find("#clip_"+clidpId).next(),$nextPlayingItem.find(".Status").html("Up Next").show()},AxisVideoHub.BuildMediaAxisQueryString=function(type,pageNum,value){switch(type){case"contentcollection":return"/collections/"+value+"/contents?$include=["+fieldNames+"]&$page="+pageNum+"&$top="+properties.VideosPerPage+"&$sort="+userSelections.selectedSortFieldValue+"&$order="+userSelections.selectedSortOrderValue+userSelections.selectedFilterValue+userSelections.selectedContentTypeFilterValue+"&$inlinecount=&Images.Type=thumbnail";case"mediacollection":return"/collections/"+value+"/medias?$include=["+fieldNames+"]&$page="+pageNum+"&$top="+properties.VideosPerPage+"&$sort=name&$order=asc&$inlinecount=&Images.Type=thumbnail";case"group":return"/collections/"+value+"/groups?$include=[name,id,images,itemstype]&$page="+pageNum+"&$top="+properties.VideosPerPage+"&$sort=name&$order=asc&$inlinecount=&Images.Type=thumbnail";case"genre":return"/collections/50/groups/"+value+"/contents?$sort="+userSelections.selectedSortFieldValue+"&$order="+userSelections.selectedSortOrderValue+userSelections.selectedFilterValue+userSelections.selectedContentTypeFilterValue+"&$include=["+fieldNames+"]&$page="+pageNum+"&$top="+properties.VideosPerPage+"&$inlinecount=&Images.Type=thumbnail";case"media":return"/medias/"+value+"/contents?$include=["+fieldNames+"]&$page="+pageNum+"&$top="+properties.VideosPerPage+"&$sort="+userSelections.selectedSortFieldValue+"&$order="+userSelections.selectedSortOrderValue+userSelections.selectedFilterValue+userSelections.selectedContentTypeFilterValue+"&$inlinecount=&Images.Type=thumbnail";case"search":return"/contents?$inlinecount=true&$Images.Type=thumbnail&$include=["+fieldNames+"]&$page="+pageNum+"&$top="+properties.VideosPerPage+"&$sort=BroadcastDate&$order=Desc&$search="+escape(value);case"custom":return"/contents?$include=["+fieldNames+"]&$page="+pageNum+"&$top="+properties.VideosPerPage+"&$sort="+userSelections.selectedSortFieldValue+"&$order="+userSelections.selectedSortOrderValue+userSelections.selectedFilterValue+userSelections.selectedContentTypeFilterValue+"&$inlinecount=&Images.Type=thumbnail"}},AxisVideoHub.ProcessThumbnail=function(imageObj){if(imageObj.length>0&&imageObj[0].Type=="thumbnail")return imageObj[0].Url+"?height=83&width=148"},AxisVideoHub.is_empty=function(obj){if(obj==null)return!0;if(obj.length&&obj.length>0)return!1;if(obj.length===0)return!0;for(var key in obj)if(hasOwnProperty.call(obj,key))return!1;return!0},AxisVideoHub.getMedia=function(mediaObj){if(mediaObj!=null)return mediaObj.Name},AxisVideoHub.DisplayAuth=function(authObj){if(authObj!=null&&authObj.Required==!0)return"<div class='lock'></div>"},AxisVideoHub.KeywordClick=function(keyword){$("#vh-search-value").val(keyword),userSelections.userSearchValue=keyword,BNN.Modules.AxisVideoHub.SearchContent(1,keyword),$.scrollTo("#vh-search-value"),$("#"+properties.ContentContainerID+" .vh-content-filter").hide(),$("#"+properties.ContentContainerID+" .vh-content-sort").hide()},AxisVideoHub.ShowMeta=function(metaObj){var ret_str="",i;if(metaObj!=null){for(i=0;i<metaObj.length-1;i++)ret_str+="<span>"+metaObj[i].Name+"</span>,&nbsp;";return ret_str}},AxisVideoHub.ShowKeywordMeta=function(metaObj){var ret_str="",i;if(metaObj!=null&&metaObj.length>0){for(i=0;i<metaObj.length-1;i++)ret_str+="<div class='keyword'>"+metaObj[i].Name+"</div>";return ret_str}},AxisVideoHub.ShowPlayListKeywordMeta=function(keyArr){var ret_str="",i;if(keyArr!=null&&keyArr.length>0){for(i=0;i<keyArr.length-1;i++)ret_str+="<div class='keyword'>"+keyArr[i]+"</div>";return ret_str}},AxisVideoHub.FormatDate=function(date,time){if(date!=null){var d=null,ret_str;return time!=null?(d=new Date.parse(date+"T"+time),ret_str=dateFormat(d,"m/dd/yyyy-h:MM TT")):(d=new Date.parse(date),ret_str=dateFormat(d,"m/dd/yyyy")),ret_str}return"N/A"},AxisVideoHub.convertSeconds=function(contentPackageObj){var s=~~contentPackageObj[0].Duration,h=Math.floor(s/3600),m;return s-=h*3600,m=Math.floor(s/60),s-=m*60,h>0?h+" : "+m+" : "+(s<10?"0"+s:s):m+" : "+(s<10?"0"+s:s)},AxisVideoHub.ExpandDetails=function(ClipId,elem){$(elem).parent().next().is("#Expanded_"+ClipId)&&$(elem).parent().next().show(),$.each($(".vh-right-content .vh-content-list .Item .Expanded, .vh-middle-content .vh-content-list .Item .Expanded, .vh-player-related .vh-player-related-list .Item .Expanded").not($("#Expanded_"+ClipId)),function(){$(this).hide()})},AxisVideoHub.CloseDetails=function(ClipId){$("#Expanded_"+ClipId).hide()},AxisVideoHub.ExpandPlaylistDetails=function(ClipId,elem){$(elem).parent().next().is("#PlaylistExpanded_"+ClipId)&&$(elem).parent().next().show(),$.each($(".vh-player-related .vh-player-related-list .Item .Expanded").not($("#PlaylistExpanded_"+ClipId)),function(){$(this).hide()})},AxisVideoHub.ClosePlaylistDetails=function(ClipId){$("#PlaylistExpanded_"+ClipId).hide()},AxisVideoHub.PlayListClick=function(ClipId,elem){$(elem).text()==AddLineupText?AxisVideoHub.AddToPlaylist(ClipId,elem):$(elem).text()==RemoveLineupText&&AxisVideoHub.RemoveFromPlayList(ClipId,elem)},AxisVideoHub.GeneratePlaylistText=function(ClipId){var
 vObj=AxisVideoHub.findVideoObj(ClipId);return vObj==null?AddLineupText:RemoveLineupText},AxisVideoHub.AddToPlaylist=function(ClipId,elem){if(userPlayList.listItems.length<25){var VideoObj={Id:ClipId,Name:$(elem).prev().prev().prev().find("a").text().trim(),Date:$(elem).prev().text(),Media:$(elem).prev().prev().text(),Image:$(elem).parent().prev().find("img").attr("src"),Duration:$(elem).parent().prev().find(".DurationOverlay").text(),Desc:$(elem).parent().next().find(".ExpandedRight").find(".Description").text(),Keywords:[]};$.each($("#Expanded_"+ClipId+".Expanded .ExpandedKeywords .Keywords .keyword"),function(){VideoObj.Keywords.push($(this).text().trim())}),userPlayList.listItems.push(VideoObj),AxisVideoHub.UpdateLocalStorage("hub"),$(".vh-left-nav .vh-left-container .vh-nav-container .vh-left-playlist span.numItems").text(userPlayList.listItems.length.toString()),$(elem).text("Adding..."),$(elem).attr("onclick","BNN.Modules.AxisVideoHub.RemoveFromPlayList("+ClipId+",this)"),$(elem).css("color","#009900"),setTimeout(function(){$(elem).text(RemoveLineupText),$(elem).css("color","#000")},1e3),BNN.Modules.AxisVideoHubDetail.GetPlayList(1)}else _log("Max items allowed is 25")},AxisVideoHub.RemoveFromPlayList=function(ClipId,elem){userPlayList.listItems=$.grep(userPlayList.listItems,function(e){return+e.Id!==ClipId}),$(elem).text("Removing..."),$(elem).attr("onclick","BNN.Modules.AxisVideoHub.AddToPlaylist("+ClipId+",this)"),$(elem).css("color","#CC0000"),$(".vh-left-nav .vh-left-container .vh-nav-container .vh-left-playlist span.numItems").text(userPlayList.listItems.length.toString()),setTimeout(function(){$(elem).text(AddLineupText),$(elem).css("color","#000")},1e3),AxisVideoHub.UpdateLocalStorage("hub"),userSelections.selectedPlayList&&AxisVideoHub.LoadPlayList(),BNN.Modules.AxisVideoHubDetail.GetPlayList(1)},AxisVideoHub.RemoveAllPlayList=function(){userPlayList.listItems=[],$(".vh-left-nav .vh-left-container .vh-nav-container .vh-left-playlist span.numItems").text(userPlayList.listItems.length==0?"":userPlayList.listItems.length.toString()),AxisVideoHub.UpdateLocalStorage("hub"),AxisVideoHub.LoadPlayList(),BNN.Modules.AxisVideoHubDetail.GetPlayList(1)},AxisVideoHub.PagerRender=function($pager,numItems,postsPerPage,currentPage,type,value){var i,$lastBtn;$pager.show();var numPages=Math.ceil(numItems/postsPerPage),links=$('<span class="Links"></span>'),$previousBtn=$pager.find("a.Previous"),$nextBtn=$pager.find("a.Next"),$firstBtn=$pager.find("a.First");if(numItems==0||numPages<=1){$pager.hide();return}for(currentPage<=1?($previousBtn.hide(),$firstBtn.hide()):($previousBtn.data("page",currentPage-1).show(),AxisHubBindPageFn($previousBtn,currentPage-1,type,value),$firstBtn.data("page",1).show(),AxisHubBindPageFn($firstBtn,1,type,value)),links.append(AxisHubPageLink(1,1,currentPage,type,value)),i=Math.max(2,currentPage-2);i<=Math.min(numPages-1,currentPage+2);i++)links.append(AxisHubPageLink(i,i,currentPage,type,value));links.append(AxisHubPageLink(numPages,"Last",currentPage,type,value)),currentPage>=numPages?($lastBtn=$pager.find("a.Last"),$nextBtn.hide(),$lastBtn.hide()):($nextBtn.data("page",currentPage+1).show(),AxisHubBindPageFn($nextBtn,currentPage+1,type,value)),$(".Links",$pager).replaceWith(links).show()},AxisVideoHub.ClearPager=function($pager){$pager.hide()},AxisVideoHub.setfromSearch=function(val){userSelections.fromSearch=val},AxisVideoHub.GetQuerystring=function(key,default_){default_==null&&(default_=""),key=key.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var regex=new RegExp("[\\?&]"+key+"=([^&#]*)"),qs=regex.exec(window.location.href);return qs==null?default_:qs[1]},AxisVideoHub.ClearFitlersAndSorts=function(){$(".vh-right-content .vh-content-filter  .select-content-type-box, .vh-middle-content .vh-content-filter .select-content-type-box").html($(".vh-right-content .vh-content-filter .select-content-type-box, .select-content-type-box, .vh-middle-content .vh-content-filter .select-content-type-box").next().find(">:first-child").html()),$(".vh-right-content .vh-content-filter .select-date-box, .vh-middle-content .vh-content-filter .select-date-box").html($(".vh-right-content .vh-content-filter .select-date-box, .vh-middle-content .vh-content-filter .select-date-box").next().find(">:first-child").html()),$(".vh-right-content .vh-content-sort .select-sort-box, .vh-middle-content .vh-content-sort .select-sort-box").html($(".vh-right-content .vh-content-sort .select-sort-box, .vh-middle-content .vh-content-sort .select-sort-box").next().find(">:first-child").html()),userSelections.selectedSortFieldValue="broadcastdate",userSelections.selectedSortOrderValue="desc",userSelections.selectedFilterValue="",userSelections.selectedContentTypeFilterValue="",userSelections.selectedFilterOption="",userSelections.userSearchValue="",userSelections.selectedCustomDate=null},AxisVideoHub.GenerateByDateLinks=function(selectedDate){var currentDate=new Date,range2,tmp,i,iDate;if(!(selectedDate instanceof Date))if(selectedDate.indexOf(",")==-1)tmp=selectedDate.split("-"),selectedDate=new Date(tmp[0],tmp[1]-1,tmp[2]);else{var tmp=selectedDate.split(","),tmp2=tmp[0].split("-"),tmp3=tmp[1].split("-");selectedDate=new Date(tmp2[0],tmp2[1]-1,tmp2[2]),range2=new Date(tmp3[0],tmp3[1]-1,tmp3[2])}for($("#"+properties.ContentContainerID+" .vh-content-filter-bydate .vh-content-filter-bydate-button-container .vh-content-filter-bydate-generated").html(""),i=0;i<=properties.Last5Days.length-1;i++)iDate=new Date(Date.parse(moment(properties.Last5Days[i]).format("MMMM Do, YYYY"))),iDate.setHours(0,0,0,0)==currentDate.setHours(0,0,0,0)?$("#"+properties.ContentContainerID+" .vh-content-filter-bydate .vh-content-filter-bydate-button-container .vh-content-filter-bydate-generated").append("<div class='vh-content-filter-bydate-button' data-value='"+dateFormat(currentDate,"yyyy-mm-dd")+"'>Today</div>"):$("#"+properties.ContentContainerID+" .vh-content-filter-bydate .vh-content-filter-bydate-button-container .vh-content-filter-bydate-generated").append("<div class='vh-content-filter-bydate-button' data-value='"+dateFormat(iDate,"yyyy-mm-dd")+"'>"+dateFormat(iDate,"ddd mmm d")+"</div>"),i<properties.Last5Days.length-1&&$("#"+properties.ContentContainerID+" .vh-content-filter-bydate .vh-content-filter-bydate-button-container .vh-content-filter-bydate-generated").append("<div class='vh-content-filter-bydate-button-seperator'></div>");$.each($("#"+properties.ContentContainerID+" .vh-content-filter-bydate .vh-content-filter-bydate-button-container .vh-content-filter-bydate-button"),function(){$(this).attr("data-value")=="date_range"&&userSelections.selectedCustomDate.type=="date_range"?($(this).addClass("selected"),$(this).html("Date Range ("+dateFormat(selectedDate,"mmm d, yyyy")+" - "+dateFormat(range2,"mmm d, yyyy")+")")):$(this).attr("data-value")=="specific_date"&&userSelections.selectedCustomDate.type=="specific_date"?($(this).addClass("selected"),$(this).html("Specific Date ("+dateFormat(selectedDate,"mmm d, yyyy")+")")):$(this).attr("data-value")==dateFormat(selectedDate,"yyyy-mm-dd")&&(userSelections.selectedCustomDate.type!="specific_date"||userSelections.selectedCustomDate.type=="date_range")?(userSelections.selectedCustomDate.type!="specific_date"||userSelections.selectedCustomDate.type=="date_range")&&$(this).addClass("selected"):$(this).removeClass("selected")})},AxisVideoHub.findVideoObj=function(value){for(var i=0;i<userPlayList.listItems.length;i++)if(userPlayList.listItems[i].Id==value)return userPlayList.listItems[i];return null}}(BNN.Modules.AxisVideoHub);
Agility.RegisterNamespace("BNN.Modules.AxisVideoHubDetail"),function(AxisVideoHubDetail){var Hub_player={};axishub_playerObjList={};var userSelections={},nextID=null,properties=null,media=null,ListPrevPage=null,ListNextPage=null,hasContentPlayed=!1,contentType=null,contentPackageID,totalStacks,userPlayList={date:new Date,listItems:[]},pageSize=5;AxisVideoHubDetail.OnInit=function(uS,hubProperties,pL){var index,i,pageNum;if(properties=hubProperties,userSelections=uS,userPlayList=pL,properties.ContentID!=-1){if($(document).ready(function(){$(document).on("onready.etsapi",function(){AxisVideoHubDetail.LaunchPlayer()});Hub_player.ajaxCrossDomainCors(AxisApiInterfaceURL)}),$(".vh-player-meta .vh-player-meta-share-content .ShareLink input#copyLink").val(document.URL),userPlayList.listItems.length<=0)AxisVideoHubDetail.GetRelatedVideo(properties.ContentID,1);else{for(index=null,i=0;i<=userPlayList.listItems.length-1;i++)userPlayList.listItems[i].Id==properties.ContentID&&(index=i,nextID=i!=userPlayList.listItems.length-1?userPlayList.listItems[i+1].Id:userPlayList.listItems[0].Id);nextID==null&&(nextID=userPlayList.listItems[0].Id),pageNum=null,index>=0&&index<=4?pageNum=1:index>=5&&index<=9?pageNum=2:index>=10&&index<=14?pageNum=3:index>=15&&index<=19?pageNum=4:index>=20&&index<=24&&(pageNum=5),AxisVideoHubDetail.GetPlayList(pageNum)}AxisVideoHubDetail.GetVideoMeta(properties.ContentID),$(".vh-player-related div.vh-player-related-next a").bind("click",function(){userPlayList.listItems.length<=0?AxisVideoHubDetail.GetRelatedVideo(properties.ContentID,2):AxisVideoHubDetail.GetPlayList(ListNextPage)}),$(".vh-player-related div.vh-player-related-previous a").bind("click",function(){userPlayList.listItems.length<=0?AxisVideoHubDetail.GetRelatedVideo(properties.ContentID,1):AxisVideoHubDetail.GetPlayList(ListPrevPage)}),$("#vh-search-value").watermark($("#vh-search-value").next().text()),$("#KeywordTab.vh-player-meta-tab").click(function(){AxisVideoHubDetail.ShowKeywords($(this))}),$("#ShareTab.vh-player-meta-tab").click(function(){AxisVideoHubDetail.ShowShare()})}},AxisVideoHubDetail.SetStatus=function(){var clidpId=AxisVideoHubDetail.getParameterByName("vid"),$nowPlayingRelatedItem,$nextPlayingRelatedItem,$nowPlayingItem,$nextPlayingItem;userPlayList.listItems.length>0?($nowPlayingRelatedItem=$(".vh-player-related div.vh-player-related-list div#clip_"+clidpId),$nowPlayingRelatedItem.find(".Status").html("Now Playing").show(),$nextPlayingRelatedItem=$(".vh-player-related div.vh-player-related-list div#clip_"+nextID),$nextPlayingRelatedItem.find(".Status").html("Up Next").show()):($nowPlayingItem=$(".vh-middle-content div.vh-content-list div#clip_"+clidpId),$nowPlayingItem.find(".Status").html("Now Playing").show(),$nextPlayingItem=$(".vh-middle-content div.vh-content-list div#clip_"+clidpId).next(),$nowPlayingItem.length>0&&($nextPlayingItem.find(".Status").html("Up Next").show(),$nextPlayingItem.length>0&&(nextID=$nextPlayingItem.attr("id").split("_")[1])))},AxisVideoHubDetail.GetRelatedVideo=function(id,pageNum){$(".vh-player-related h2").text(properties.RelatedLabel);var height=$(".vh-player-related .vh-player-related-list").height();$(".vh-player-related .vh-player-related-list").html('<div class="VideoLoading">'),$(".vh-player-related .vh-player-related-list .VideoLoading").css("height",height+"px"),pageNum==1?($(".vh-player-related div.vh-player-related-previous a").hide(),$(".vh-player-related div.vh-player-related-next a").show()):($(".vh-player-related div.vh-player-related-previous a").show(),$(".vh-player-related div.vh-player-related-next a").hide()),$.ajaxSetup({cache:!0}),$.ajax({url:AxisShowServiceURL+AxisVideoHubDetail.BuildMediaAxisQueryString(id,pageNum),contentType:"application/json;",dataType:"jsonp",cache:!0,jsonpCallback:"getJsonFromCAPI_HubDetail_GetRelatedVideo",success:function(jsonResponse){var result=jsonResponse;result.Count>0||result.Items.length>0?(AxisVideoHubDetail.ProcessVideos(result.Items,"related"),$(".vh-player-related .vh-player-related-list .VideoLoading").hide()):($(".vh-player-related .vh-player-related-list .VideoLoading").hide(),$(".vh-player-related").hide())}})},AxisVideoHubDetail.GetPlayList=function(pageNum){var startIndex,endIndex,ListTotal,displayStart,displayEnd,height;userPlayList.listItems.length>0?(pageNum==1?(startIndex=0,endIndex=pageSize):(startIndex=pageNum*pageSize-pageSize,endIndex=startIndex+pageSize),$(".vh-player-related h2").text("My Playlist"),displayStart=startIndex==0?"1":startIndex.toString(),displayEnd=endIndex>userPlayList.listItems.length?userPlayList.listItems.length:endIndex.toString(),$(".vh-player-related .vh-player-lineup-paging").show(),$(".vh-player-related .vh-player-lineup-paging").text("Displaying "+displayStart+" to "+displayEnd+" of "+userPlayList.listItems.length),height=$(".vh-player-related .vh-player-related-list").height(),$(".vh-player-related .vh-player-related-list").html('<div class="VideoLoading">'),$(".vh-player-related .vh-player-related-list .VideoLoading").css("height",height+"px"),pageNum==1?$(".vh-player-related div.vh-player-related-previous a").hide():$(".vh-player-related div.vh-player-related-previous a").show(),pageNum==1&&displayEnd==userPlayList.listItems.length.toString()&&$(".vh-player-related .vh-player-lineup-paging").hide(),endIndex==userPlayList.listItems.length||displayEnd==userPlayList.listItems.length.toString()?$(".vh-player-related div.vh-player-related-next a").hide():$(".vh-player-related div.vh-player-related-next a").show(),AxisVideoHubDetail.ProcessVideos(userPlayList.listItems.slice(startIndex,endIndex),"playList"),$(".vh-player-related .vh-player-related-list .VideoLoading").hide(),ListNextPage=pageNum+1,ListPrevPage=pageNum-1,AxisVideoHubDetail.SetStatus()):($(".vh-player-related .vh-player-related-list .VideoLoading").hide(),$(".vh-player-related").hide())},AxisVideoHubDetail.GetVideoMeta=function(id){id!=null&&($.ajaxSetup({cache:!0}),$.ajax({url:AxisShowServiceURL+"/contents/"+id+"/?$include=[Media,ContentPackages]",contentType:"application/json;",dataType:"jsonp",cache:!0,jsonpCallback:"getJsonFromCAPI_LoadContent2VideosByPage",success:function(jsonResponse){var result=jsonResponse;media=result.Media,contentType=result.Type,contentPackageID=result.ContentPackages[0].Id,AxisVideoHubDetail.ProcessMeta(result.Keywords)}}))},AxisVideoHubDetail.ProcessVideos=function(contentItems,type){(contentItems.length>0||!contentItems)&&AxisVideoHubDetail.updateAxisHubContentContainer(contentItems,type)},AxisVideoHubDetail.updateAxisHubContentContainer=function(content,type){var templateContainer=$(".vh-player-related .vh-player-related-list"),templateUrl;type=="related"?templateUrl=Agility.ResolveUrl("~/ClientTemplates/AxisVideoHubCollection.htm"):type=="playList"&&(templateUrl=Agility.ResolveUrl("~/ClientTemplates/AxisVideoHubDetailPlayList.htm")),templateContainer.setTemplateURL(templateUrl),templateContainer.processTemplate(content),$(".vh-player-related .vh-player-related-list .Item a img").hover(function(){$(this).next().toggleClass("play-on")})},AxisVideoHubDetail.ProcessMeta=function(contentItems){contentItems.length>0||!contentItems?AxisVideoHubDetail.updateAxisHubMetaContainer(contentItems):(AxisVideoHubDetail.ShowShare(),$("#KeywordTab.vh-player-meta-tab").toggleClass("Disabled"))},AxisVideoHubDetail.updateAxisHubMetaContainer=function(content){var templateContainer=$(".vh-player-meta .vh-player-meta-keyword-content .vh-player-meta-keyword-content-list"),templateUrl=Agility.ResolveUrl("~/ClientTemplates/AxisVideoHubMeta.htm");templateContainer.setTemplateURL(templateUrl),templateContainer.processTemplate(content),$(".vh-player-related .vh-player-related-list .Item a img, .vh-player-related .vh-player-related-list .Item .Expanded .ExpandedLeft .ExpandedLeftThumbContainer a img").hover(function(){$(this).next().toggleClass("play-on")})},AxisVideoHubDetail.BuildMediaAxisQueryString=function(value,pageNum){return"/contents/"+value+"/relatedContents?$inlinecount=true&$include=["+fieldNames+"]&$sort=broadcastdate&$order=desc&$page="+pageNum+"&$top=5"},AxisVideoHubDetail.ShowKeywords=function(elem){$(elem).hasClass("Disabled")||($(".vh-player-meta-share-content").hide(),$(".vh-player-meta-keyword-content").show(),$("#KeywordTab").addClass("Selected"),$("#KeywordTab").removeClass("unSelected"),$("#ShareTab").removeClass("Selected"))},AxisVideoHubDetail.ShowShare=function(){$(".vh-player-meta-share-content").show(),$(".vh-player-meta-keyword-content").hide(),$("#KeywordTab").removeClass("Selected"),$("#KeywordTab").addClass("unSelected"),$("#ShareTab").addClass("Selected")},AxisVideoHubDetail.LaunchPlayer=function(){var adrule=AxisVideoHubDetail.GetQuerystring("adrule","generic"),axisHub_mainApp,mpFlashVars={},zone;mpFlashVars.enablelog=AxisEnableLog,mpFlashVars.loginterval=AxisLogInterval,mpFlashVars.cms="fortytwo",axisHub_mainApp=etsapi.embedPlayer("hub_player","vh-player-div",940,528,globalDestination,"",{flashVars:mpFlashVars,adRule:adrule}),axisHub_mainApp.registerEvent(MediaPlayerControllerEvent.PLAYER_READY,this,AxisVideoHubDetail.onPlayerReady),axisHub_mainApp.registerEvent(MediaPlayerControllerEvent.VIDEO_STARTED,this,AxisVideoHubDetail.onVideoStarted),axisHub_mainApp.registerEvent(MediaPlayerControllerEvent.CONTENT_COMPLETE,this,AxisVideoHubDetail.onVideoCompleted),axisHub_mainApp.registerEvent(MediaPlayerControllerEvent.VIDEO_ENDED,this,AxisVideoHubDetail.onVideoEnded),axisHub_mainApp.registerEvent(MediaPlayerControllerEvent.ERROR,this,AxisVideoHubDetail.onVideoError),axishub_playerObjList.hub_player=axisHub_mainApp,zone=null,zone=properties.ContentID=="328771"?"test_tve":media!=null?"shows/"+(media!=null)?media.Name.toLowerCase().replace(" ","").replace(" ","").replace(" ","").replace("'",""):"":"",etsapi.setAdZone("hub_player",zone),etsapi.setMetricsVideoPlayerName("VideoHub")},AxisVideoHubDetail.PlayerReady=function(){var
 initParms={destinationCode:globalDestination,platformCode:globalPlatform,autoPlay:1,resourceId:"BNN"},item={id:properties.ContentID};axishub_playerObjList.hub_player.playMediaItem(item,initParms)},AxisVideoHubDetail.onPlayerReady=function(){_log("player ready"),AxisVideoHubDetail.PlayerReady()},AxisVideoHubDetail.onVideoCompleted=function(){nextID!=null&&setTimeout(function(){return window.open(encodeURI(Agility.ResolveUrl(properties.AxisVideoHubPlayerURL)+"?vid="+nextID),"_self"),!1},500)},AxisVideoHubDetail.onVideoEnded=function(){},AxisVideoHubDetail.onVideoStarted=function(infoObj){if(infoObj.index==0&&infoObj.category=="content"){var pflowPath=window.location.pathname,pflowUrl="http://data.publishflow.com/pflowlog.gif?a=ctv.ca&h=bnn.ca&p="+encodeURI(pflowPath)+"&t="+escape(infoObj.title)+"&v=/video/player.aspx?vid="+infoObj.contentId+"&pt="+escape($(document).find("title").text().trim())+"&ts="+ +new Date,image=new Image;image.src=pflowUrl}},AxisVideoHubDetail.onVideoError=function(){},Hub_player.ajaxCrossDomainCors=function(serviceURL){try{Hub_player.JqueryCallBack=function(){_log("api loading success ");return};var ajaxPars={url:serviceURL,cache:!0,contentType:"application/json",jsonpCallback:"player.JqueryCallBack",error:function(XMLHttpRequest,textStatus){textStatus=="parsererror"}};ajaxPars.type="GET",ajaxPars.dataType="jsonp",ajaxPars.jsonp="callback",$.ajax(ajaxPars)}catch(err){throw err;}},AxisVideoHubDetail.GetQuerystring=function(key,default_){default_==null&&(default_=""),key=key.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var regex=new RegExp("[\\?&]"+key+"=([^&#]*)"),qs=regex.exec(window.location.href);return qs==null?default_:qs[1]},AxisVideoHubDetail.getParameterByName=function(name){var match=RegExp("[?&]"+name+"=([^&]*)").exec(window.location.search);return match&&decodeURIComponent(match[1].replace(/\+/g," "))}}(BNN.Modules.AxisVideoHubDetail);
Agility.RegisterNamespace("BNN.Modules.AxisVideoHubPromo"),function(AxisVideoHubPromo){AxisVideoHubPromo.OnInit=function(p,sliderContent){p.ContentType=="axispromoitems"?$("#hubPromo_carousel").agile_carousel({carousel_data:sliderContent,carousel_outer_height:360,carousel_height:360,slide_height:640,carousel_outer_width:640,slide_width:640,transition_time:300,timer:6e3,continuous_scrolling:!0,control_set_1:"numbered_buttons,previous_button,next_button"}):($("#hubPromo_carousel").html('<div class="VideoLoading">'),$("#hubPromo_carousel .VideoLoading").css("height","360px"),$.ajaxSetup({cache:!0}),$.ajax({url:AxisShowServiceURL+"/collections/294/contents?&$include=[authentication,broadcastdate,broadcasttime,contentpackages,desc,episode,id,images,media,name,runtime,season,shortdesc,type,keywords,genres]&$page=1&$top="+p.ContentCount+"&$sort=broadcastdate&$order=desc&$inlinecount=&Images.Type=thumbnail",contentType:"application/json;",dataType:"jsonp",cache:!0,jsonpCallback:"getJsonFromCAPI_HubDetail_GetRelatedVideo",success:function(jsonResponse){var result=jsonResponse,arr,i,contentObj;if(result.Count>0||result.Items.length>0){for(arr=[],i=0;i<result.Items.length;i++)contentObj={content:"<div class='slide_inner'><a class='photo_link' onClick='BNN.Modules.AxisVideoHub.UpdateLocalStorage()' href='/Video/player.aspx?vid="+result.Items[i].Id+"' title=''><img class='photo' src='"+AxisVideoHubPromo.ProcessThumbnail(result.Items[i].Images)+"' alt='"+result.Items[i].Name+"'><div class='promo_play'></div></a><div class='caption'><div class='Headline'><a onClick='BNN.Modules.AxisVideoHub.UpdateLocalStorage()' href='/Video/player.aspx?vid="+result.Items[i].Id+"'  title=''>"+result.Items[i].Name+"</a></div><div class='clear'></div><div class='Teaser'>"+result.Items[i].ShortDesc+"</div><div class='clear'></div></div></div>"},arr.push(contentObj);$("#hubPromo_carousel").agile_carousel({carousel_data:arr,carousel_outer_height:360,carousel_height:360,slide_height:640,carousel_outer_width:640,slide_width:640,transition_time:300,timer:6e3,continuous_scrolling:!0,control_set_1:"numbered_buttons,previous_button,next_button"}),$("#hubPromo_carousel .VideoLoading").hide()}}}))},AxisVideoHubPromo.ProcessThumbnail=function(imageObj){if(imageObj!=null&&imageObj.length>0)return imageObj[0].Type=="thumbnail"?imageObj[0].Url+"?height=360&width=640":Agility.ResolveUrl("~/Images/spacer.gif")}}(BNN.Modules.AxisVideoHubPromo);
Agility.RegisterNamespace("BNN.Modules.MostPopularStockQuotes"),function(MostPopularStockQuotes){var prop,searchDefault;MostPopularStockQuotes.OnInit=function(properties){var cookie,height,recentlyViewedArray;prop=properties,searchDefault=prop.searchDefault,MostPopularStockQuotes.BindEvents(),cookie=$.cookie("BNN_User_StockList"),height=150,$("#MostPopularQuoteContainer div.MostPopularContainer div.stockConainer").html('<div class="VideoLoading">'),$("#MostPopularQuoteContainer div.MostPopularContainer div.stockConainer .VideoLoading").css("height",height+"px"),prop.stockList!=null?$.getJSON(MarketDataServiceUrl+"/GetReutersStockQuoteList?list="+prop.stockList.toString()+"",function(result){result!=undefined&&(MostPopularStockQuotes.ProcessQuotes(result,"popular"),$("#MostPopularQuoteContainer div.MostPopularContainer div.stockConainer .VideoLoading").hide())}):($("#MostPopularQuoteContainer div.MostPopularContainer div.stockConainer .VideoLoading").hide(),$("#MostPopularQuoteContainer div.MostPopularContainer div.stockConainer").text("There is currenlty no data available")),cookie!=null?(recentlyViewedArray=cookie.split(","),$("#MostPopularQuoteContainer div.RecentlyViewedContainer div.stockListContainer").show(),$("#MostPopularQuoteContainer .MostPopularContainer").hide(),$("#MostPopularQuoteContainer .RecentlyViewedContainer").show(),$("#RecentlyViewedTab").addClass("Selected"),$("#MostPopularTab").removeClass("Selected"),$("#MostPopularQuoteContainer div.RecentlyViewedContainer div.NoStockContainer").hide(),$("#MostPopularQuoteContainer div.RecentlyViewedContainer div.stockListContainer div.stockContainer").html('<div class="VideoLoading">'),$("#MostPopularQuoteContainer div.RecentlyViewedContainer div.stockListContainer div.stockContainer .VideoLoading").css("height",height+"px"),$.getJSON(MarketDataServiceUrl+"/GetReutersStockQuoteList?list="+recentlyViewedArray.reverse().toString()+"",function(result){result!=undefined&&(MostPopularStockQuotes.ProcessQuotes(result,"recent"),$("#MostPopularQuoteContainer div.RecentlyViewedContainer div.stockListContainer div.stockContainer .VideoLoading").hide())})):($("#MostPopularQuoteContainer div.RecentlyViewedContainer div.NoStockContainer").show(),$("#MostPopularQuoteContainer div.RecentlyViewedContainer div.stockListContainer").hide())},MostPopularStockQuotes.ProcessQuotes=function(quotes,type){(quotes.length>0||!quotes)&&MostPopularStockQuotes.updateTemplate(quotes,type)},MostPopularStockQuotes.updateTemplate=function(content,type){var templateContainer,templateUrl=Agility.ResolveUrl("~/ClientTemplates/MostPopularStockQuotes.htm");switch(type){case"popular":templateContainer=$("#MostPopularQuoteContainer div.MostPopularContainer div.stockConainer");break;case"recent":templateContainer=$("#MostPopularQuoteContainer div.RecentlyViewedContainer div.stockListContainer div.stockContainer")}templateContainer.html(""),templateContainer.setTemplateURL(templateUrl),templateContainer.processTemplate(content)},MostPopularStockQuotes.BindEvents=function(){$("#RecentlyViewedTab").click(function(){$("#MostPopularQuoteContainer .MostPopularContainer").hide(),$("#MostPopularQuoteContainer .RecentlyViewedContainer").show(),$("#RecentlyViewedTab").addClass("Selected"),$("#MostPopularTab").removeClass("Selected")}),$("#MostPopularTab").click(function(){$("#MostPopularQuoteContainer .RecentlyViewedContainer").hide(),$("#MostPopularQuoteContainer .MostPopularContainer").show(),$("#MostPopularTab").addClass("Selected"),$("#RecentlyViewedTab").removeClass("Selected")});var searchBox=$("#txtMostPopularQuotesSearch"),stockSearchMenu=$("#MostPopularQuotes_StockSearch");stockSearchMenu.bind("mouseenter",function(){_isOverStockSearchMenu=!0}),stockSearchMenu.bind("mouseleave",function(){_isOverStockSearchMenu=!1}),searchBox.bind("focus",function(){searchBox.val()==searchDefault&&searchBox.val("")}).bind("keyup",function(){if(searchBox.val()==""){stockSearchMenu.hide();return}$.getJSON(MarketDataServiceUrl+"/GetTopNReutersSearch?symbolBeginsWith="+searchBox.val()+"&pageSize=5&pageNo=0",function(result){var templateUrl,container,moreUrl,newMoreUrl;result!=undefined&&result.length>0?(templateUrl=Agility.ResolveUrl("~/ClientTemplates/ReutersSearchResults.htm"),container=$("#MostPopularQuotes_StockSearch .Results"),container.setTemplateURL(templateUrl),container.processTemplate(result),_updateNewStockSearchPosition(searchBox,stockSearchMenu),stockSearchMenu.show(),moreUrl=$(".MoreResults a",stockSearchMenu).attr("href"),newMoreUrl=moreUrl.substring(0,moreUrl.indexOf("Search.aspx")+11)+"?query="+searchBox.val(),$(".MoreResults a",stockSearchMenu).attr("href",newMoreUrl),container.children(".DataItem").bind("mouseenter",function(){$(this).addClass("Hover")}),container.children(".DataItem").bind("mouseleave",function(){$(this).removeClass("Hover")})):stockSearchMenu.hide()})}).bind("blur",function(){searchBox.val()==""&&searchBox.val(searchDefault),_isOverStockSearchMenu?stockSearchMenu.bind("mouseleave",function(){stockSearchMenu.hide()}):stockSearchMenu.hide()}).bind("keydown",function(event){(event.which||event.keyCode)&&(event.which==13||event.keyCode==13)&&$(this).next().trigger("click")}),$("#btnMostPopularQuotesSearch").bind("click",function(){var query=searchBox.val();return query!=""&&query!=searchDefault&&(window.location=Agility.ResolveUrl("~/Stock.aspx")+"?pi_symbol="+escape(query)),!1})},MostPopularStockQuotes.getCssClass=function(val){var positive=val!=null&&val!=""&&val.indexOf("-")!=0;return val=="0"||val==""?"Neutral":positive?"Positive":"Negative"}}(BNN.Modules.MostPopularStockQuotes);
Agility.RegisterNamespace("BNN.Modules.AxisShowPlayerBig"),function(AxisShowPlayerBig){function AxisShowBindPageFn($p,num){return $p.unbind("click").bind("click",function(){var id,ins;return id=$p.is(".Next")||$p.is(".Previous")?$p.parent().attr("id"):$p.parent().parent().attr("id"),ins=id.substring(id.indexOf("_")+1),AxisShowPlayerBig.LoadVideosByPage(num,InstanceNum),!1}),$p}function AxisShowPageLink(pageNum,pageText,currentPage){var $lastBtn,$page;if(pageNum!=currentPage){if(pageText=="Last"){$lastBtn=$("#Pager_"+InstanceNum).find("a.Last"),AxisShowBindPageFn($lastBtn,pageNum);return}return $page=$('<a class="Page" href="javascript:;"></a>').text(pageText),$page.data("page",pageNum),AxisShowBindPageFn($page,pageNum)}return $('<a class="CurrentPage"></a>').text(pageNum)}var prop=[],InstanceNum=null,AxisQueryString=null,sortField="BroadcastDate",sortField2="BroadcastTime",contentId,currentId,nextID,globalCurrentPage,numPages,nowPlayingPage=null,player={};playerObjList={},AxisShowPlayerBig.OnInit=function(pr,instancenum){InstanceNum=instancenum,prop[InstanceNum]=pr,AxisQueryString=AxisShowPlayerBig.BuildAxisQueryString(1,InstanceNum);var maincontainer=prop[instancenum].ContainerID,height=$("#"+maincontainer+" .Videos").height();$("#"+maincontainer+" .Videos .list").html('<div class="VideoLoading">'),$("#"+maincontainer+" .Videos .VideoLoading").css("height",height+"px"),$.ajaxSetup({cache:!0}),$.ajax({url:AxisShowServiceURL+AxisQueryString,contentType:"application/json;",dataType:"jsonp",cache:!0,jsonpCallback:"getJsonFromCAPI_AxisShowPlayerBig",success:function(jsonResponse){var result=jsonResponse;result.Count>0?(AxisShowPlayerBig.ProcessVideos(result.Items,InstanceNum),$("#"+maincontainer+".Videos .VideoLoading").hide(),AxisShowPlayerBig.PagerRender($("#Pager_"+instancenum),result.Count,prop[instancenum].VideosPerPage,1,1),contentId=result.Items[0].Id,AxisShowPlayerBig.SetStatus(),globalCurrentPage=1,(contentId!=""||contentId!=null)&&$(document).ready(function(){$(document).on("onready.etsapi",function(){AxisShowPlayerBig.LaunchPlayer(instancenum)});player.ajaxCrossDomainCors(AxisApiInterfaceURL)})):$("#"+maincontainer).hide()}})},AxisShowPlayerBig.ProcessVideos=function(latestVideos,instancenum){var maincontainer=prop[instancenum].ContainerID;(latestVideos.length>0||!latestVideos)&&_updateAxisShowPlayerBigContainerContentByPage(latestVideos,maincontainer,prop[instancenum].pagesize,instancenum)},_updateAxisShowPlayerBigContainerContentByPage=function(content,maincontainer,pagesize,instancenum){var container=$("#Videos_"+maincontainer),templateUrl=Agility.ResolveUrl("~/ClientTemplates/AxisShowPlayerBig.htm");container.html(""),container.hasTemplate()||(container.setTemplateURL(templateUrl),container.setParam("DevMode",prop[instancenum].DevMode)),container.processTemplate(content),$.each(content,function(i,l){$(".AxisShowPlayerBig .Videos .DataItem, .AxisShowPlayerBig .Videos .DataItem .Expanded .ExpandedLeft a").hover(function(){$(this).find(".play").toggleClass("play-on")}),$("#clip_"+l.Id+".DataItem div.Details div.Title a, #Expanded_"+l.Id+".Expanded .ExpandedLeft .ExpandedLeftThumbContainer a, #Expanded_"+l.Id+".Expanded .ExpandedLeft .Title a").bind("click",function(){$("a#click_"+l.Id).trigger("click")}),$(".AxisShowPlayerBig .Videos .DataItem #Expanded_"+l.Id+".Expanded .ExpandedKeywords .Keywords .keyword").bind("click",function(){AxisShowPlayerBig.KeywordClick($(this).html(),instancenum),$(this).parent().parent().parent().is(".Expanded")&&$(this).parent().parent().parent().hide()})})},AxisShowPlayerBig.LoadVideosByPage=function(PageNum,instance){globalCurrentPage=PageNum,AxisQueryString=AxisShowPlayerBig.BuildAxisQueryString(PageNum,instance);var maincontainer=prop[instance].ContainerID,height=$("#"+maincontainer+" .Videos").height();$("#"+maincontainer+" .Videos").html('<div class="VideoLoading">'),$("#"+maincontainer+" .Videos .VideoLoading").css("height",height+"px"),$.ajaxSetup({cache:!0}),$.ajax({url:AxisShowServiceURL+AxisQueryString,contentType:"application/json;",dataType:"jsonp",cache:!0,jsonpCallback:"getJsonFromCAPI_AxisShowPlayerBig",success:function(jsonResponse){var result=jsonResponse;result!=undefined&&result!=null&&(contentId=contentId==null?result.Items[0].Id:contentId,AxisShowPlayerBig.ProcessVideos(result.Items,instance),AxisShowPlayerBig.SetStatus(),$("#"+maincontainer+".Videos .VideoLoading").hide(),AxisShowPlayerBig.PagerRender($("#Pager_"+instance),result.Count,prop[instance].VideosPerPage,PageNum))}})},AxisShowPlayerBig.ProcessThumbnail=function(imageObj){if(imageObj!=null&&imageObj[0].Type=="thumbnail")return imageObj[0].Url+"?height=49&width=87"},AxisShowPlayerBig.is_empty=function(obj){if(obj==null)return!0;if(obj.length&&obj.length>0)return!1;if(obj.length===0)return!0;for(var key in obj)if(hasOwnProperty.call(obj,key))return!1;return!0},AxisShowPlayerBig.getMedia=function(mediaObj){if(mediaObj!=null)return mediaObj.Name},AxisShowPlayerBig.DisplayAuth=function(authObj){if(authObj!=null&&authObj.Required==!0)return"<div class='lock'></div>"},AxisShowPlayerBig.KeywordClick=function(keyword,instancenum){setTimeout(function(){return window.open(encodeURI(Agility.ResolveUrl(prop[instancenum].VideoHubURL)+"?Search="+keyword),"_blank"),!1},1e3)},AxisShowPlayerBig.ShowMeta=function(metaObj){var ret_str="",i;if(metaObj!=null){for(i=0;i<metaObj.length-1;i++)ret_str+="<span>"+metaObj[i].Name+"</span>,&nbsp;";return ret_str}},AxisShowPlayerBig.ShowKeywordMeta=function(metaObj){var ret_str="",i;if(metaObj!=null){for(i=0;i<metaObj.length-1;i++)ret_str+="<div class='keyword'>"+metaObj[i].Name+"</div>";return ret_str}},AxisShowPlayerBig.FormatDate=function(date,time){if(date!=null){var d=null,ret_str;return time!=null?(d=new Date.parse(date+"T"+time),ret_str=dateFormat(d,"m/dd/yyyy-h:MM TT")):(d=new Date.parse(date),ret_str=dateFormat(d,"m/dd/yyyy")),ret_str}return"N/A"},AxisShowPlayerBig.convertSeconds=function(contentPackageObj){var s=~~contentPackageObj[0].Duration,h=Math.floor(s/3600),m;return s-=h*3600,m=Math.floor(s/60),s-=m*60,m+" : "+(s<10?"0"+s:s)},AxisShowPlayerBig.ExpandDetails=function(ClipId){var curPos=$("#Expanded_"+ClipId).prev().attr("pos");curPos==1?($("#Expanded_"+ClipId).css("left","212px"),$("#Expanded_"+ClipId).show()):curPos==2?($("#Expanded_"+ClipId).css("left","424px"),$("#Expanded_"+ClipId).show()):$("#Expanded_"+ClipId).show(),$.each($(".AxisShowPlayerBig .Videos .DataItem .Expanded").not($("#Expanded_"+ClipId)),function(){$(this).hide()})},AxisShowPlayerBig.CloseDetails=function(ClipId){$("#Expanded_"+ClipId).hide()},AxisShowPlayerBig.BuildAxisQueryString=function(pageNum,instancenum){var ret_string="";return prop[instancenum].FilterType=="show"?ret_string="/medias/"+prop[instancenum].AxisContentID+"/contents?$inlinecount=true&$include=["+fieldNames+"]&$page="+pageNum+"&$top="+prop[instancenum].VideosPerPage+"&$sort="+sortField+"&$order=desc&BroadcastDate_start="+prop[instancenum].QueryStartDate+"&BroadcastDate_end="+prop[instancenum].QueryEndDate:prop[instancenum].FilterType=="collection"&&(ret_string="/collections/"+prop[instancenum].AxisContentID+"/contents?$inlinecount=true&$include=["+fieldNames+"]&$page="+pageNum+"&$top="+prop[instancenum].VideosPerPage+"&$sort="+sortField+"&$order=desc&$order=desc&BroadcastDate_start="+prop[instancenum].QueryStartDate+"&BroadcastDate_end="+prop[instancenum].QueryEndDate),ret_string+=prop[instancenum].IncludeFullEpisodes?"":"&Type=segment"},AxisShowPlayerBig.getMedia=function(mediaObj){if(mediaObj!=null)return mediaObj.Name},AxisShowPlayerBig.DisplayAuth=function(authObj){if(authObj!=null&&authObj.Required==!0)return"<div class='lock'></div>"},AxisShowPlayerBig.ShowMeta=function(metaObj){var ret_str="",i;if(metaObj!=null){for(i=0;i<metaObj.length-1;i++)ret_str+=metaObj[i].Name+",";return ret_str}},AxisShowPlayerBig.PlayElement=function(clipId){contentId=currentId=clipId,AxisShowPlayerBig.SetStatus();var initParms={destinationCode:globalDestination,platformCode:globalPlatform,autoPlay:1,resourceId:"BNN"},item={id:clipId};playerObjList["bnnGO_player_"+InstanceNum].playMediaItem(item,initParms),media=$("#clip_"+clipId+".Item .Details .Show").text().toLowerCase().replace(" ","").replace(" ","").replace(" ","")},AxisShowPlayerBig.CloseDetails=function(ClipId){$("#Expanded_"+ClipId).hide()},AxisShowPlayerBig.LaunchPlayer=function(id){var adrule=GetQuerystring("adrule","none"),mainApp,playlistObj,mpFlashVars={},zone;mpFlashVars.enablelog=AxisEnableLog,mpFlashVars.loginterval=AxisLogInterval,mpFlashVars.cms="fortytwo",mainApp=etsapi.embedPlayer("bnnGO_player_"+id,"PlayerDiv_"+id,640,360,globalDestination,"",{flashVars:mpFlashVars,adRule:adrule}),mainApp.registerEvent(MediaPlayerControllerEvent.PLAYER_READY,this,AxisShowPlayerBig.onPlayerReady),mainApp.registerEvent(MediaPlayerControllerEvent.VIDEO_STARTED,this,AxisShowPlayerBig.onVideoStarted),mainApp.registerEvent(MediaPlayerControllerEvent.VIDEO_ENDED,this,AxisShowPlayerBig.onVideoEnded),mainApp.registerEvent(MediaPlayerControllerEvent.CONTENT_COMPLETE,this,AxisShowPlayerBig.onVideoCompleted),mainApp.registerEvent(MediaPlayerControllerEvent.ERROR,this,AxisShowPlayerBig.onVideoError),zone="shows/"+$("#clip_"+id+".DataItem .Details .Show").text().toLowerCase().replace(" ","").replace(" ","").replace(" ","").replace("'","").replace("'",""),etsapi.setAdZone("bnnGO_player_"+id,zone),etsapi.setMetricsVideoPlayerName("inPagePlayer"),playerObjList["bnnGO_player_"+id]=mainApp,$.each($(".AxisShowPlayerBig .Videos .DataItem .Expanded"),function(){$(this).hide()})},AxisShowPlayerBig.PlayerReady=function(){var initParms={destinationCode:globalDestination,platformCode:globalPlatform,autoPlay:1,resourceId:"BNN"},item={id:contentId};playerObjList["bnnGO_player_"+InstanceNum].playMediaItem(item,initParms)},AxisShowPlayerBig.onPlayerReady=function(){_log("player ready"),AxisShowPlayerBig.PlayerReady()},AxisShowPlayerBig.onVideoEnded=function(){_log("player
 ended")},AxisShowPlayerBig.onVideoStarted=function(infoObj){if(infoObj.index==0&&infoObj.category=="content"){var pflowPath=window.location.pathname,pflowUrl="http://data.publishflow.com/pflowlog.gif?a=ctv.ca&h=bnn.ca&p="+encodeURI(pflowPath)+"&t="+escape(infoObj.title)+"&v=/video/player.aspx?vid="+infoObj.contentId+"&pt="+escape($(document).find("title").text().trim())+"&ts="+ +new Date,image=new Image;image.src=pflowUrl}},AxisShowPlayerBig.onVideoError=function(){_error("player error")},player.ajaxCrossDomainCors=function(serviceURL,info){try{player.JqueryCallBack=function(){_log("loading success: "+info);return};var ajaxPars={url:serviceURL,cache:!0,contentType:"application/json",jsonpCallback:"player.JqueryCallBack",error:function(XMLHttpRequest,textStatus){textStatus!="parsererror"&&_error("loading error: "+info+" "+textStatus)}};ajaxPars.type="GET",ajaxPars.dataType="jsonp",ajaxPars.jsonp="callback",$.ajax(ajaxPars)}catch(err){throw err;}},AxisShowPlayerBig.onVideoCompleted=function(){if(nextID==null&&globalCurrentPage<numPages)AxisShowPlayerBig.LoadVideosByPage(globalCurrentPage+1,InstanceNum);else if(globalCurrentPage==numPages&&nextID==null){contentId=null,AxisShowPlayerBig.LoadVideosByPage(1,InstanceNum),setTimeout(function(){contentId=nextID;var initParms={destinationCode:globalDestination,platformCode:globalPlatform,autoPlay:1,resourceId:"BNN"},item={id:contentId};return playerObjList["bnnGO_player_"+InstanceNum].playMediaItem(item,initParms),!1},500);return}setTimeout(function(){contentId=nextID;var initParms={destinationCode:globalDestination,platformCode:globalPlatform,autoPlay:1,resourceId:"BNN"},item={id:contentId};return playerObjList["bnnGO_player_"+InstanceNum].playMediaItem(item,initParms),AxisShowPlayerBig.SetStatus(),!1},500)},AxisShowPlayerBig.SetStatus=function(){var $nowPlayingItem=$("#clip_"+contentId),$nextPlayingItem;$nowPlayingItem.length>0?(nowPlayingPage=globalCurrentPage,$nowPlayingItem.find(".Status").html("Now Playing").show(),$nowPlayingItem.attr("data-index")==2||$nowPlayingItem.is("#Videos_"+prop[InstanceNum].ContainerID+" .Item:last")?nextID=null:($nextPlayingItem=$nowPlayingItem.next().next(),$nextPlayingItem.find(".Status").html("Up Next").show(),nextID=$nextPlayingItem.attr("id").split("_")[1])):nowPlayingPage+1==globalCurrentPage&&nextID==null?($nextPlayingItem=$("#Videos_"+prop[InstanceNum].ContainerID+" .Item").first(),$nextPlayingItem.find(".Status").html("Up Next").show(),nextID=$nextPlayingItem.attr("id").split("_")[1]):globalCurrentPage==1&&nextID==null&&($nextPlayingItem=$("#Videos_"+prop[InstanceNum].ContainerID+" .Item").first(),$nextPlayingItem.find(".Status").html("Up Next").show(),nextID=$nextPlayingItem.attr("id").split("_")[1]),$.each($("#Videos_"+prop[InstanceNum].ContainerID+" .Item").not($("#clip_"+contentId+",#clip_"+nextID)),function(){$(this).find(".Status").html("STATUS").hide()})},AxisShowPlayerBig.PagerRender=function($pager,numItems,postsPerPage,currentPage){var i,$lastBtn;$pager.show(),numPages=Math.ceil(numItems/postsPerPage);var links=$('<span class="Links"></span>'),$previousBtn=$pager.find("a.Previous"),$nextBtn=$pager.find("a.Next"),$firstBtn=$pager.find("a.First");if(numItems==0||numPages<=1){$pager.hide();return}for(currentPage<=1?($previousBtn.hide(),$firstBtn.hide()):($previousBtn.data("page",currentPage-1).show(),AxisShowBindPageFn($previousBtn,currentPage-1),$firstBtn.data("page",1).show(),AxisShowBindPageFn($firstBtn,1)),links.append(AxisShowPageLink(1,1,currentPage)),i=Math.max(2,currentPage-2);i<=Math.min(numPages-1,currentPage+2);i++)links.append(AxisShowPageLink(i,i,currentPage));links.append(AxisShowPageLink(numPages,"Last",currentPage)),$lastBtn=$pager.find("a.Last"),currentPage==numPages?($nextBtn.hide(),$lastBtn.hide()):($nextBtn.data("page",currentPage+1).show(),AxisShowBindPageFn($nextBtn,currentPage+1),$lastBtn.show()),$(".Links",$pager).replaceWith(links).show()},GetQuerystring=function(key,default_){default_==null&&(default_=""),key=key.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var regex=new RegExp("[\\?&]"+key+"=([^&#]*)"),qs=regex.exec(window.location.href);return qs==null?default_:qs[1]},_error=function(str){try{console.error(str)}catch(e){}},_log=function(str){try{console.log(str)}catch(e){}}}(BNN.Modules.AxisShowPlayerBig);
Agility.RegisterNamespace("BNN.Modules.NewHomePageTopStories"),function(NewHomePageTopStories){var contentId,autoPlay,properties=null,fts_player={};fts_playerObjList={},NewHomePageTopStories.OnInit=function(prop){properties=prop,contentId=properties.contentId,autoPlay=properties.autoPlay,properties.renderPlayer?(contentId!=""||contentId!=null)&&$(document).ready(function(){$(document).on("onready.etsapi",{lv:contentId},function(event){NewHomePageTopStories.LaunchPlayer(event.data.lv)});$.getScript(AxisApiInterfaceURL,function(){})}):$("#featured-top-storyplayer-div").hide(),$("#NewHomePageTopStoryContainer  div.topStoryRight div.Item a img.Thumbnail, #NewHomePageTopStoryContainer div.topStoryLeft a div.thumb img, #ctl00_MainContent_ctl03_pnlFeatured > div.topFeaturedLeft > a > img").hover(function(){var $play=$(this).next();$play.hasClass("play")&&$play.toggleClass("play-on")})},NewHomePageTopStories.LaunchPlayer=function(id){_log(id);var adrule=GetQuerystring("adrule","none"),featuredTopStoryPlayer_mainApp,mpFlashVars={};mpFlashVars.enablelog=AxisEnableLog,mpFlashVars.loginterval=AxisLogInterval,mpFlashVars.cms="fortytwo",featuredTopStoryPlayer_mainApp=etsapi.embedPlayer("featuredTopStoryPlayer_","featured-top-storyplayer-div",640,360,globalDestination,"",{flashVars:mpFlashVars,adRule:adrule}),featuredTopStoryPlayer_mainApp.registerEvent(MediaPlayerControllerEvent.PLAYER_READY,this,NewHomePageTopStories.onPlayerReady),featuredTopStoryPlayer_mainApp.registerEvent(MediaPlayerControllerEvent.VIDEO_STARTED,this,NewHomePageTopStories.onVideoStarted),featuredTopStoryPlayer_mainApp.registerEvent(MediaPlayerControllerEvent.VIDEO_ENDED,this,NewHomePageTopStories.onVideoEnded),featuredTopStoryPlayer_mainApp.registerEvent(MediaPlayerControllerEvent.ERROR,this,NewHomePageTopStories.onVideoError),fts_playerObjList.featuredTopStoryPlayer_=featuredTopStoryPlayer_mainApp},NewHomePageTopStories.PlayerReady=function(){var initParms={destinationCode:globalDestination,platformCode:globalPlatform,autoPlay:autoPlay,resourceId:"BNN"},item={id:contentId};fts_playerObjList.featuredTopStoryPlayer_.playMediaItem(item,initParms)},NewHomePageTopStories.onPlayerReady=function(){_log("player ready"),NewHomePageTopStories.PlayerReady()},NewHomePageTopStories.onVideoEnded=function(){_log("player ended")},NewHomePageTopStories.onVideoStarted=function(){_log("player started")},NewHomePageTopStories.onVideoError=function(){_error("player error")},fts_player.ajaxCrossDomainCors=function(serviceURL,info){try{fts_player.JqueryCallBack=function(){_log("loading success: "+info);return};var ajaxPars={url:serviceURL,cache:!0,contentType:"application/json",jsonpCallback:"player.JqueryCallBack",error:function(XMLHttpRequest,textStatus){textStatus!="parsererror"&&_error("loading error: "+info+" "+textStatus)}};ajaxPars.type="GET",ajaxPars.dataType="jsonp",ajaxPars.jsonp="callback",$.ajax(ajaxPars)}catch(err){throw err;}}}(BNN.Modules.NewHomePageTopStories);
Agility.RegisterNamespace("BNN.Modules.NewHomePageLatestNews"),function(NewHomePageLatestNews){NewHomePageLatestNews.OnInit=function(){NewHomePageLatestNews.BindEvents()},NewHomePageLatestNews.BindEvents=function(){$("#NewHomePageLatestNews_LatestNewsTab").click(function(){$("#NewHomePageLatestNews .PopularContainer").hide(),$("#NewHomePageLatestNews .AdditionalContainer").hide(),$("#NewHomePageLatestNews .LatestContainer").show(),$("#NewHomePageLatestNews_LatestNewsTab").addClass("Selected"),$("#NewHomePageLatestNews_MostPopularNewsTab").removeClass("Selected"),$("#ctl00_MainContent_ctl07_NewHomePageLatestNews_AdditionalTab").removeClass("Selected")}),$("#NewHomePageLatestNews_MostPopularNewsTab").click(function(){$("#NewHomePageLatestNews .LatestContainer").hide(),$("#NewHomePageLatestNews .AdditionalContainer").hide(),$("#NewHomePageLatestNews .PopularContainer").show(),$("#NewHomePageLatestNews_MostPopularNewsTab").addClass("Selected"),$("#NewHomePageLatestNews_LatestNewsTab").removeClass("Selected"),$("#ctl00_MainContent_ctl07_NewHomePageLatestNews_AdditionalTab").removeClass("Selected")}),$("#ctl00_MainContent_ctl07_NewHomePageLatestNews_AdditionalTab").click(function(){$("#NewHomePageLatestNews .LatestContainer").hide(),$("#NewHomePageLatestNews .PopularContainer").hide(),$("#NewHomePageLatestNews .AdditionalContainer").show(),_log($(this)),$("#NewHomePageLatestNews_MostPopularNewsTab").removeClass("Selected"),$("#NewHomePageLatestNews_LatestNewsTab").removeClass("Selected"),$("#ctl00_MainContent_ctl07_NewHomePageLatestNews_AdditionalTab").addClass("Selected")}),$("#NewHomePageLatestNews div.NewsStory").hover(function(){$(this).find(".play").toggleClass("play-on")})}}(BNN.Modules.NewHomePageLatestNews);
Agility.RegisterNamespace("BNN.Modules.NewHomePageLatestVideos"),function(NewHomePageLatestVideos){var prop,sortField="BroadcastDate";NewHomePageLatestVideos.OnInit=function(properties){var $maincontainer,height,AxisQueryString;prop=properties,$maincontainer=$("NewHomePageLatestVideos"),height=$("#NewHomePageLatestVideos .VideoListContainer").height(),$("#NewHomePageLatestVideos .VideoListContainer").html('<div class="VideoLoading">'),$("#NewHomePageLatestVideos .VideoListContainer .VideoLoading").css("height",height+"px"),AxisQueryString=NewHomePageLatestVideos.BuildAxisQueryString(1),_log(AxisShowServiceURL+AxisQueryString),$.ajaxSetup({cache:!0}),$.ajax({url:AxisShowServiceURL+AxisQueryString,contentType:"application/json;",dataType:"jsonp",cache:!0,jsonpCallback:"getJsonFromCAPI_HomePageLatestVideos",success:function(jsonResponse){var result=jsonResponse;result.Count>0?(_log(result),NewHomePageLatestVideos.ProcessVideos(result.Items),$("#NewHomePageLatestVideos .VideoListContainer .VideoLoading").hide()):$maincontainer.hide()}})},NewHomePageLatestVideos.ProcessVideos=function(latestVideos){(latestVideos.length>0||!latestVideos)&&_updateNewHomePageLatestVideos(latestVideos)},_updateNewHomePageLatestVideos=function(content){var container=$("#NewHomePageLatestVideos .VideoListContainer"),templateUrl=Agility.ResolveUrl("~/ClientTemplates/NewHomePageLatestVideos.htm");container.html(""),container.hasTemplate()||(container.setTemplateURL(templateUrl),container.setParam("playerURL",prop.VideoHubPlayerURL)),container.processTemplate(content),$.each(content,function(){$("#NewHomePageLatestVideos .Item, #NewHomePageLatestVideos .firstItem").hover(function(){$(this).find(".play").toggleClass("play-on")})})},NewHomePageLatestVideos.BuildAxisQueryString=function(pageNum){var ret_string="";return prop.FilterType=="show"?ret_string="/medias/"+prop.AxisContentID+"/contents?$inlinecount=true&$include=["+fieldNames+"]&$page="+pageNum+"&$top="+prop.VideosToShow+"&$sort="+sortField+"&$order=desc&BroadcastDate_start="+prop.QueryStartDate+"&BroadcastDate_end="+prop.QueryEndDate:prop.FilterType=="collection"&&(ret_string="/collections/"+prop.AxisContentID+"/contents?$inlinecount=true&$include=["+fieldNames+"]&$page="+pageNum+"&$top="+prop.VideosToShow+"&$sort="+sortField+"&$order=desc&$order=desc&BroadcastDate_start="+prop.QueryStartDate+"&BroadcastDate_end="+prop.QueryEndDate),ret_string+=prop.IncludeFullEpisodes?"":"&Type=segment"},NewHomePageLatestVideos.GetItemClass=function(index){if(index>=0&&index!=null)return index==0?"firstItem":"Item"},NewHomePageLatestVideos.ProcessThumbnail=function(imageObj){if(imageObj!=null&&imageObj[0].Type=="thumbnail")return imageObj[0].Url+"?width=290&height=163"}}(BNN.Modules.NewHomePageLatestVideos);
Agility.RegisterNamespace("BNN.Modules.NewHomePageShowRotator"),function(NewHomePageShowRotator){var properties=null,_scrollSettings={duration:1e3},_currentItem=0;NewHomePageShowRotator.OnInit=function(prop){var i,reset,$next;if(properties=prop,prop.RotatingShowList!=null||prop.RotatingShowList.length>0){var container=$("#NewHomePageShowRotator .ShowRotatorContainer"),templateUrl=Agility.ResolveUrl("~/ClientTemplates/NewHomePageShowRotator.htm"),settings={f_escapeString:function(string){return string}};for(container.setTemplateURL(templateUrl,null,settings),container.processTemplate(prop.RotatingShowList),i=0;i<prop.RotatingShowList.length;i++)i==0?$("#NewHomePageShowRotator .Pages").append("<div class='PageItem Selected' data-index='"+i+"'></div>"):$("#NewHomePageShowRotator .Pages").append("<div class='PageItem' data-index='"+i+"'></div>");$("#NewHomePageShowRotator div.Pages div.PageItem").bind("click",function(){var pageNum,target;$.each($("#NewHomePageShowRotator div.Pages div.PageItem"),function(){$(this).removeClass("Selected")}),$(this).addClass("Selected"),pageNum=$(this).attr("data-index"),_currentItem=pageNum,target=$("#NewHomePageShowRotator").find(".Show"+_currentItem),$("#NewHomePageShowRotator .ShowRotatorList").scrollTo(target,_scrollSettings)}),reset=!1,$next=null,setInterval(function(){reset?($next=$("#NewHomePageShowRotator").find(".Show"+_currentItem),reset=!1):$next=$("#NewHomePageShowRotator").find(".Show"+_currentItem).next(),$next.length>0?_currentItem=$next.attr("data-index"):(_currentItem=0,reset=!0),$next.length>0&&($("#NewHomePageShowRotator .ShowRotatorList").scrollTo($next,_scrollSettings),$.each($("#NewHomePageShowRotator div.Pages div.PageItem"),function(){$(this).removeClass("Selected"),$(this).attr("data-index")==_currentItem&&$(this).addClass("Selected")}))},5e3),$("#NewHomePageShowRotator div.DropDown div.switcher-box").bind("click",function(){$(this).next().is(":visible")?($(this).css("border","1px solid #ccc"),$(this).next().hide()):($(this).css("border-bottom","0"),$(this).next().show())}),$("#NewHomePageShowRotator .DropDown ul.switcher-select").bind("mouseleave",function(){$(this).prev().css("border","1px solid #ccc"),$(this).hide()}),$("#NewHomePageShowRotator div.DropDown div.switcher-box ul.switcher-select li").live("click",function(){$(this).parent().hide(),$(this).parent().prev().html($(this).html()),$(this).parent().prev().attr("data-value",$(this).attr("data-value")),$(this).parent().prev().css("border","1px solid #ccc")}),$("#NewHomePageShowRotator div.DropDown ul.switcher-select li").bind("click",function(){var url=$(this).attr("data-value");window.location.href=url})}}}(BNN.Modules.NewHomePageShowRotator);
Agility.RegisterNamespace("BNN.Modules.SponsoredCategoryNewsList"),function(SponsoredCategoryNewsList){function SponsoredCategoryNewsListBindPageFN($p,num){return $p.unbind("click").bind("click",function(){var id,ins;return id=$p.is(".Next")||$p.is(".Previous")?$p.parent().attr("id"):$p.parent().parent().attr("id"),ins=id.substring(id.indexOf("_")+1),SponsoredCategoryNewsList.LoadVideosByPage(num,ins),!1}),$p}function SponsoredCategoryNewsListLink(pageNum,pageText,currentPage){if(pageNum!=currentPage){var $page=$('<a class="Page" href="javascript:;"></a>').text(pageText);return $page.data("page",pageNum),SponsoredCategoryNewsListBindPageFN($page,pageNum)}return $('<a class="CurrentPage"></a>').text(pageNum)}var properties,sortField="BroadcastDate",AxisQueryString,contentId=null;SponsoredCategoryNewsList.OnInit=function(prop){if(properties=prop,_log(prop),SponsoredCategoryNewsList.BindEvents(),properties.AxisContentID!=-1){var AxisQueryString=SponsoredCategoryNewsList.BuildAxisQueryString(1);_log(AxisShowServiceURL+AxisQueryString),$.ajaxSetup({cache:!0}),$.ajax({url:AxisShowServiceURL+AxisQueryString,contentType:"application/json;",dataType:"jsonp",cache:!0,jsonpCallback:"getJsonFromCAPI_SponsoredContentVideoList",success:function(jsonResponse){var result=jsonResponse;result.Count>0&&(SponsoredCategoryNewsList.ProcessVideos(result.Items),SponsoredCategoryNewsList.PagerRender($("#SponsoredContentPager"),result.Count,properties.ListSize,1),$("#SponsoredCategoryNewsList > div.leadItem > h3 a").text(properties.FirstRecord.Headline),$("#SponsoredCategoryNewsList > div.leadItem > h3 a").attr("href",Agility.ResolveUrl(properties.FirstRecord.Url)),$("#SponsoredCategoryNewsList > div.leadItem > a img").attr("src",properties.FirstRecord.Image.URL),$("#SponsoredCategoryNewsList > div.leadItem >").attr("href",Agility.ResolveUrl(properties.FirstRecord.Url)),$("#SponsoredCategoryNewsList > div.leadItem > div.teaser").text(properties.FirstRecord.Teaser))}})}else $("#SponsoredCategoryNewsList > div.Tabs").hide(),$("#SponsoredCategoryNewsList > div.leadItem > h3 a").text(properties.FirstRecord.Headline),$("#SponsoredCategoryNewsList > div.leadItem > h3 a").attr("href",Agility.ResolveUrl(properties.FirstRecord.Url)),$("#SponsoredCategoryNewsList > div.leadItem > a img").attr("src",properties.FirstRecord.Image.URL),$("#SponsoredCategoryNewsList > div.leadItem >").attr("href",Agility.ResolveUrl(properties.FirstRecord.Url)),$("#SponsoredCategoryNewsList > div.leadItem > div.teaser").text(properties.FirstRecord.Teaser),$("#News > div:nth-child(1)").hide()},SponsoredCategoryNewsList.LoadNews=function(){var pageNum=BNN.Controls.Pager.CurrentPage,height=$("#News").height();$("#News").html('<div class="Loading">'),$("#News .Loading").css("height",height+"px"),$.ajax({url:AjaxWebserviceSvcUrl+"/GetSponsoredNewsByPage?pageNum="+pageNum+"&pageSize="+properties.ListSize+"&category="+properties.SponsoredCategory,contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var res={d:jsonResponse},$container;res.d!=undefined&&res.d!=null&&($container=$("#SponsoredCategoryNewsList .News"),$container.html(""),$container.hasTemplate()||($container.setTemplateURL(Agility.ResolveUrl("~/ClientTemplates/SponsoredCategoryNewsList.htm")),$container.setParam("AdverstimentIconLabel",properties.AdvertisementIconLabel)),$container.processTemplate(res),BNN.Controls.Pager.Render(properties.TotalCount),$("#News .Loading").hide(),$("#News > div.NewsStory > div.Thumbnail").hover(function(){$(this).find(".play").toggleClass("play-on")}))}})},SponsoredCategoryNewsList.BindEvents=function(){$("#SponsoredCategoryNewsList_NewsTab").click(function(){$("#SponsoredCategoryNewsList .VideoContainer").hide(),$("#SponsoredCategoryNewsList .NewsContainer").show(),$("#SponsoredCategoryNewsList_NewsTab").addClass("Selected"),$("#SponsoredCategoryNewsList_VideoTab").removeClass("Selected")}),$("#SponsoredCategoryNewsList_VideoTab").click(function(){$("#SponsoredCategoryNewsList .NewsContainer").hide(),$("#SponsoredCategoryNewsList .VideoContainer").show(),$("#SponsoredCategoryNewsList_VideoTab").addClass("Selected"),$("#SponsoredCategoryNewsList_NewsTab").removeClass("Selected")})},SponsoredCategoryNewsList.BuildAxisQueryString=function(pageNum){return"/medias/"+properties.AxisContentID+"/contents?$inlinecount=true&$include=["+fieldNames+"]&$page="+pageNum+"&$top="+properties.ListSize+"&$sort="+sortField+"&$order=desc&BroadcastDate_start="+properties.QueryStartDate+"&BroadcastDate_end="+properties.QueryEndDate},SponsoredCategoryNewsList.ProcessVideos=function(latestVideos){(latestVideos.length>0||!latestVideos)&&_updateAxisSponseredNewsListContentByPage(latestVideos,properties.ListSize)},SponsoredCategoryNewsList.DisplaySponsoredIcon=function(){if(properties.AdvertisementIconLabel!="")return'<div class="Advertisement"><span>'+properties.AdvertisementIconLabel+"</span></div>"},_updateAxisSponseredNewsListContentByPage=function(content){_log(content);var container=$("#SponsoredCategoryNewsList .VideoContainer .VideoList"),templateUrl=Agility.ResolveUrl("~/ClientTemplates/SponsoredCategoryNewsList_Videos.htm");container.html(""),container.hasTemplate()||(container.setTemplateURL(templateUrl),container.setParam("playerURL",properties.VideoHubPlayerURL)),container.processTemplate(content),$("#SponsoredCategoryNewsList div.VideoContainer div.VideoList div.NewsStory div.Thumbnail").hover(function(){$(this).find(".play").toggleClass("play-on")})},SponsoredCategoryNewsList.LoadVideosByPage=function(PageNum){globalCurrentPage=PageNum,AxisQueryString=SponsoredCategoryNewsList.BuildAxisQueryString(PageNum),_log(AxisShowServiceURL+AxisQueryString);var height=$("#SponsoredCategoryNewsList div.VideoContainer div.VideoList .Videos").height();$("#SponsoredCategoryNewsList div.VideoContainer div.VideoList .Videos").html('<div class="VideoLoading">'),$("#SponsoredCategoryNewsList div.VideoContainer div.VideoList .VideoLoading").css("height",height+"px"),$.ajaxSetup({cache:!0}),$.ajax({url:AxisShowServiceURL+AxisQueryString,contentType:"application/json;",dataType:"jsonp",cache:!0,jsonpCallback:"getJsonFromCAPI_SponsoredContentVideoListByPage",success:function(jsonResponse){var result=jsonResponse;result!=undefined&&result!=null&&(contentId=contentId==null?result.Items[0].Id:contentId,SponsoredCategoryNewsList.ProcessVideos(result.Items),$("#SponsoredCategoryNewsList div.VideoContainer div.VideoList .VideoLoading").hide(),SponsoredCategoryNewsList.PagerRender($("#SponsoredContentPager"),result.Count,properties.ListSize,PageNum))}})},SponsoredCategoryNewsList.DisplaySponsoredCategoryIcon=function(news){return _log(properties.AdvertisementIconLabel),news.SponsoredCategories.length>0&&properties.AdvertisementIconLabel!=""?'<div class="Advertisement"><span>'+properties.AdvertisementIconLabel+"</span></div>":""},SponsoredCategoryNewsList.ProcessThumbnail=function(imageObj,width,height){if(imageObj!=null&&imageObj[0].Type=="thumbnail")return imageObj[0].Url+"?height="+height+"&width="+width},SponsoredCategoryNewsList.PagerRender=function($pager,numItems,postsPerPage,currentPage){var i;$pager.show();var numPages=Math.ceil(numItems/postsPerPage),links=$('<span class="Links"></span>'),$previousBtn=$pager.find("a.Previous"),$nextBtn=$pager.find("a.Next");if(numItems==0||numPages<=1){$pager.hide();return}for(currentPage<=1?$previousBtn.hide():($previousBtn.data("page",currentPage-1).show(),SponsoredCategoryNewsListBindPageFN($previousBtn,currentPage-1)),currentPage>=numPages?$nextBtn.hide():($nextBtn.data("page",currentPage+1).show(),SponsoredCategoryNewsListBindPageFN($nextBtn,currentPage+1)),links.append(SponsoredCategoryNewsListLink(1,1,currentPage)),currentPage>4&&links.append($("<span>...</span>")),i=Math.max(2,currentPage-2);i<=Math.min(numPages-1,currentPage+2);i++)links.append(SponsoredCategoryNewsListLink(i,i,currentPage));currentPage<numPages-3&&links.append($("<span>...</span>")),links.append(SponsoredCategoryNewsListLink(numPages,"Last",currentPage)),$(".Links",$pager).replaceWith(links).show()}}(BNN.Modules.SponsoredCategoryNewsList);
Agility.RegisterNamespace("BNN.Modules.SponsoredCategoryNewsListSmall"),function(SponsoredCategoryNewsListSmall){var properties,sortField="BroadcastDate",AxisQueryString,contentId=null,player={};playerObjList={},SponsoredCategoryNewsListSmall.OnInit=function(prop){if(properties=prop,contentId=properties.AxisContentID,_log(properties),$("#SponsoredCategoryNewsListSmall .Item").last().addClass("Last"),contentId!=-1?$(document).ready(function(){$(document).on("onready.etsapi",function(){SponsoredCategoryNewsListSmall.LaunchPlayer(),properties.CustomVideoTitle!=""?($("#SponsoredCategoryNewsListSmall .playerTitle").show(),$("#SponsoredCategoryNewsListSmall .playerTitle a").text(properties.CustomVideoTitle),$("#SponsoredCategoryNewsListSmall .playerTitle a").attr("href",Agility.ResolveUrl("~/Video/Player.aspx?vid="+contentId))):$("#SponsoredCategoryNewsListSmall .playerTitle").hide()});player.ajaxCrossDomainCors(AxisApiInterfaceURL)}):$("#SponsoredCategoryNewsListSmall .playerTitle").hide(),prop.SponsoredCategoryObj.StoryList==null&&($("#SponsoredCategoryNewsListSmall").hide(),$("#StoryDetails > div.Advertisement").length>0)){var friendly=$("#StoryDetails > div.Advertisement").attr("data-id");SponsoredCategoryNewsListSmall.LoadNews(friendly),$("#SponsoredCategoryNewsListSmall").show()}properties.SponsoredCategoryObj.Category!=null&&$("#SponsoredCategoryNewsListSmall .Footer img").attr("src",properties.SponsoredCategoryObj.Category.ThumbImages.Logo)},SponsoredCategoryNewsListSmall.LoadNews=function(friendly){var height="50";$("#SponsoredCategoryNewsListSmall div.ItemContainer").html('<div class="Loading">'),$("#SponsoredCategoryNewsListSmall div.ItemContainer .Loading").css("height",height+"px"),$.ajax({url:AjaxWebserviceSvcUrl+"/GetLatestSponsored?SponsoredCategory="+friendly+"&ListSize="+properties.ListSize,contentType:"application/json; charset=utf-8",dataType:"json",success:function(jsonResponse){var res={d:jsonResponse},$container,list;res.d!=undefined&&res.d!=null&&($("#SponsoredCategoryNewsListSmall .Footer img").attr("src",res.d.Category.ThumbImages[0].Value),friendly==res.d.Category.FriendlyName.URL?($container=$("#SponsoredCategoryNewsListSmall > div.ItemContainer"),$container.html(""),$container.setTemplateURL(Agility.ResolveUrl("~/ClientTemplates/SponsoredCategoryNewsListSmall.htm")),list=res.d.StoryList,$container.processTemplate(list),$("#SponsoredCategoryNewsListSmall div.ItemContainer .Loading").hide()):$("#SponsoredCategoryNewsListSmall").hide())}})},SponsoredCategoryNewsListSmall.LaunchPlayer=function(){var adrule=GetQuerystring("adrule","none"),mainApp,mpFlashVars={};mpFlashVars.enablelog=AxisEnableLog,mpFlashVars.loginterval=AxisLogInterval,mpFlashVars.cms="fortytwo",mainApp=etsapi.embedPlayer("bnnGO_player_SponsoredContent","SponsoredCategoryPlayerDiv",300,169,globalDestination,"",{flashVars:mpFlashVars,adRule:adrule}),mainApp.registerEvent(MediaPlayerControllerEvent.PLAYER_READY,this,SponsoredCategoryNewsListSmall.onPlayerReady),mainApp.registerEvent(MediaPlayerControllerEvent.VIDEO_STARTED,this,SponsoredCategoryNewsListSmall.onVideoStarted),mainApp.registerEvent(MediaPlayerControllerEvent.VIDEO_ENDED,this,SponsoredCategoryNewsListSmall.onVideoEnded),mainApp.registerEvent(MediaPlayerControllerEvent.ERROR,this,SponsoredCategoryNewsListSmall.onVideoError),playerObjList.bnnGO_player_SponsoredContent=mainApp},SponsoredCategoryNewsListSmall.PlayerReady=function(){var initParms={destinationCode:globalDestination,platformCode:globalPlatform,autoPlay:0,resourceId:"BNN"},item={id:properties.AxisContentID};playerObjList.bnnGO_player_SponsoredContent.playMediaItem(item,initParms)},SponsoredCategoryNewsListSmall.onPlayerReady=function(){_log("player ready"),SponsoredCategoryNewsListSmall.PlayerReady()},SponsoredCategoryNewsListSmall.onVideoEnded=function(){_log("player ended")},SponsoredCategoryNewsListSmall.onVideoStarted=function(infoObj){if(infoObj.index==0&&infoObj.category=="content"){var pflowPath=window.location.pathname,pflowUrl="http://data.publishflow.com/pflowlog.gif?a=ctv.ca&h=bnn.ca&p="+encodeURI(pflowPath)+"&t="+escape(infoObj.title)+"&v=/video/player.aspx?vid="+infoObj.contentId+"&pt="+escape($(document).find("title").text().trim())+"&ts="+ +new Date,image=new Image;image.src=pflowUrl}},SponsoredCategoryNewsListSmall.onVideoError=function(){_error("player error")},player.ajaxCrossDomainCors=function(serviceURL,info){try{player.JqueryCallBack=function(){_log("loading success: "+info);return};var ajaxPars={url:serviceURL,cache:!0,contentType:"application/json",jsonpCallback:"player.JqueryCallBack",error:function(XMLHttpRequest,textStatus){textStatus!="parsererror"&&_error("loading error: "+info+" "+textStatus)}};ajaxPars.type="GET",ajaxPars.dataType="jsonp",ajaxPars.jsonp="callback",$.ajax(ajaxPars)}catch(err){throw err;}}}(BNN.Modules.SponsoredCategoryNewsListSmall);
�4�S��}�5��R�#########T���T���:��[T��####B:http://www.bnn.ca/Scripts/min_DA11C5274D05C9F0FB10729C50492563.js#necko:classified#1#request-method#GET#response-head#HTTP/1.1 200 OK
Content-Type: application/javascript
Last-Modified: Sun, 25 Jan 2015 01:04:50 GMT
Etag: "846668eb3a38d01:0"
Content-Length: 1081634
Accept-Ranges: bytes
Date: Sun, 25 Jan 2015 10:30:50 GMT
#uncompressed-len#0###�"
