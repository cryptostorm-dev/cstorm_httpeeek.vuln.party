
// Peter's Data Entry Suite Release 5.0.5.5000
// Copyright 2002 - 2013 Peter L. Blum, All Rights Reserved, www.PeterBlum.com
var gDES_InCallback=false;var gDES_BI={UA:navigator.userAgent.toLowerCase(),onkeypress:1,innerHTML:(document.body!=null)&&(document.body.innerHTML!=null),setInterval:window.setInterval!=null};if(DES_ChkBrws('konqueror')){gDES_BI.Name="Konqueror";gDES_BI.OS="Linux";gDES_BI.Konqueror=1;}else if(DES_ChkBrws('safari',1)||DES_ChkBrws('applewebkit',1)){gDES_BI.Name="Safari";gDES_BI.Safari=1;}else if(DES_ChkBrws('omniweb',1))gDES_BI.Name="OmniWeb";else if(DES_ChkBrws('opera',1)){gDES_BI.Name="Opera";gDES_BI.Opera1=1;}else if(DES_ChkBrws('webtv',1))gDES_BI.Name="WebTV";else if(DES_ChkBrws('msie',1)){gDES_BI.Name="Internet Explorer";gDES_BI.IEWin=1;}else if((gDES_BI.UA.indexOf('trident')>-1)&&DES_ChkBrws('rv',1)){gDES_BI.Name="Internet Explorer";gDES_BI.IEWin=1;}else if(DES_ChkBrws('netscape',1)){gDES_BI.Name="Netscape Mozilla";gDES_BI.Gecko=1;}else if(DES_ChkBrws('gecko',1)){gDES_BI.Name="Gecko";gDES_BI.Gecko=1;}else if(!DES_ChkBrws('compatible',1)){gDES_BI.Name="Netscape Navigator";gDES_BI.Ver=gDES_BI.UA.charAt(8);gDES_BI.Netscape=1;}else gDES_BI.Name="unknown";if(!gDES_BI.OS){if(DES_ChkBrws('linux',0))gDES_BI.OS="Linux";else if(DES_ChkBrws('x11',0))gDES_BI.OS="Unix";else if(DES_ChkBrws('mac',0))gDES_BI.OS="Mac";else if(DES_ChkBrws('win',0))gDES_BI.OS="Windows";else gDES_BI.OS="unknown";}if(gDES_BI.IEWin&&(gDES_BI.OS=="Mac")){gDES_BI.IEWin=0;gDES_BI.IEMac=1;if(gDES_BI.Ver>=5.2)gDES_BI.IEMacOSX=1;else if(gDES_BI.Ver>=5.1)gDES_BI.IEMac51=1;}else if(gDES_BI.IEWin){if(gDES_BI.Ver>=5.5){gDES_BI.IEWin55=1;if(gDES_BI.Ver>=7)gDES_BI.IEWin7=1;if(gDES_BI.Ver>=8)gDES_BI.IEWin8=1;}}else if(gDES_BI.Opera1){var vV=parseInt(gDES_BI.Ver);if(vV>=7){gDES_BI.Opera7=1;gDES_BI.Opera1=0;if(vV>=9){gDES_BI.Opera9=1;if(DES_ChkBrws("version",1))gDES_BI.Opera10=1;}}}else if(gDES_BI.Gecko){if(DES_ChkBrws('firefox',1)){gDES_BI.FireFox=1;gDES_BI.Name="FireFox";var vFFV=parseFloat(gDES_BI.Ver);if(vFFV>=1.5)gDES_BI.FireFox15=1;if(vFFV>=2)gDES_BI.FireFox2=1;if(vFFV>=3)gDES_BI.FireFox3=1;}}else if(gDES_BI.Safari){if(gDES_BI.Ver>=520){gDES_BI.Safari3=1;if(gDES_BI.Ver>=533)gDES_BI.Safari41=1;}}gDES_BI.onkeypress=!gDES_BI.Opera1&&!gDES_BI.Konqueror;gDES_BI.focusontable=gDES_BI.IEWin||gDES_BI.FireFox15;gDES_BI.MultilineTT=gDES_BI.IEWin||gDES_BI.IEMac51;function DES_ChkBrws(pID,pSetVer){var vPos=gDES_BI.UA.indexOf(pID)+1;if(pSetVer&&vPos){gDES_BI.Ver=parseFloat(gDES_BI.UA.substring(vPos+pID.length));if(isNaN(gDES_BI.Ver))gDES_BI.Ver=gDES_BI.UA.charAt(vPos+pID.length);}return vPos;}function DES_GetById(pId){function Fix(pF){if(pF&&window.RadAjaxNamespace){if(pF.innerHTML=="RADAJAX_HIDDENCONTROL")return null;if((pF.tagName=="DIV")&&(pF.style.display=="none")&&(pF.innerHTML=="")&&(pF.className=="")&&(pF.style.visibility==""))return null;}return pF;}if(typeof(pId)!="string")return pId;if(document.getElementById)return Fix(document.getElementById(pId));else if(document.all)return Fix(document.all[pId]);else if(document.layers){var vElement="";eval("if (document."+pId+") vElement = document."+pId+"; else vElement =document."+gDES_FormName+"."+pId);return Fix(vElement);}else return null;}function DES_GetByIdEx(pId,pExt,pMode){return DES_GetById(DES_PrepIdEx(pId,pExt,pMode));}function DES_PrepIdEx(pId,pExt,pMode){if(pMode==1)return pId+pExt;if(!gGBIRE)gGBIRE=new RegExp("_\\d+$");var vM=gGBIRE.exec(pId);if(vM!=null){pId=pId.substr(0,pId.length-vM[0].length)+pExt;if(!pMode)pId=pId+vM[0];}else pId=pId+pExt;return pId;}var gGBIRE;function DES_GetAtt(pE,pAName,pDefVal){if(pE.getAttribute){var vR=pE.getAttribute(pAName,0);if(vR==null){vR=eval("pE."+pAName);if(vR==null)vR=pDefVal;}else if((vR=="")&&(!document.all))vR=pDefVal;return vR;}else return pDefVal;}function DES_SetAtt(pE,pN,pV){if(gDES_BI.Opera7){eval("pE."+pN+"=pV");}else if(pE.setAttribute)pE.setAttribute(pN,pV,0);else{var vN=pE.name+"_"+pN;eval("vN = pV.toString();");}}function DES_Target(pE){if(!pE){pE=window.event;if(!pE)return null;}var vT=pE.target?pE.target:pE.srcElement;if(vT.nodeType==3)vT=vT.parentNode;return vT;}function DES_ParentNode(pE){if(pE.parentElement!=null)return pE.parentElement;else if(pE.parentNode!=null)return pE.parentNode;else return null;}function DES_GetChildNodes(pParent,pNodeName,pIndex){var vFoundCount=0;var vChildren=null;if(pParent.childNodes){vChildren=pParent.childNodes;}else if(pParent.children){vChildren=pParent.children;}else if(pParent.getElementsByTagName){vChildren=pParent.getElementsByTagName(pNodeName);}else{return null;}var vLength=vChildren.length;for(var vCount=0;vCount<vLength;vCount++)if(vChildren[vCount].nodeName==pNodeName){vFoundCount++;if(vFoundCount==pIndex)return vChildren[vCount];}return null;}function DES_SetInnerHTML(pFld,pV){if(gDES_BI.IEMac51||gDES_BI.IEMacOSX){pFld.innerHTML="";var vNE=document.createElement("span");vNE.innerHTML=pV;pFld.appendChild(vNE);}else pFld.innerHTML=pV;}function DES_SetFocus(pFldId){var vF=DES_GetById(pFldId);if(!vF)return;if(window.gDES_VG&&gDES_VG.FocF&&!eval(gDES_VG.FocF+'(vF)'))return;if(vF.gocDE)vF=vF.gocDE[0];if((vF.focus!=null)&&((vF.type==null)||(vF.type!="hidden"))&&((vF.disabled==null)||!vF.disabled)&&((vF.style==null)||DES_IsVisible(vF))){try{vF.focus();if(vF.select)vF.select();}catch(e){}}}function DES_HideFocus(pID,pV){var vF=DES_GetById(pID);if(vF.hideFocus!=null)vF.hideFocus=pV;}function DES_SetBkColor(pE,pC){if(gDES_BI.Opera1){if(pC=="")pC="white";pE.style.background=pC;}else{pE.style.backgroundColor=pC;if(!pC&&pE.background)pE.background="";}}function DES_IsVisible(pFld){var vV=true;while(vV&&(pFld!=null)&&(pFld!=document.body)){vV=!((pFld.style.visibility=="hidden")||(pFld.style.display=="none"));pFld=pFld.parentNode;}return vV;}function DES_UnselectPage(){if(gDES_BI.IEWin55&&document.execCommand)document.execCommand("Unselect",false,null);}function DES_Alert(pMsg,pDelay){if(!window.gDES_Alert){if(pDelay){var vCode="DES_AlertBody('"+pMsg+"');";setTimeout(vCode,10);}else DES_AlertBody(pMsg);}}var gDES_Alert=0;function DES_AlertBody(pMsg){if(window.gDES_Alert)return;window.gDES_Alert=1;try{alert(pMsg);}catch(e){}window.gDES_Alert=0;}function DES_LoadStyleSheet(pURL){vPH=document.createElement("link");vPH.href=pURL;vPH.rel="stylesheet";vPH.type='text/css';var vB=document.body;vB.insertBefore(vPH,vB.childNodes[0]);}function DES_RegisterOnSubmit(pKey,pCode,pFst){var vO=window.DES_RegOnSub;if(!vO){vO={};window.DES_RegOnSub=vO;}if(vO[pKey]==null){DES_AttachEvent(document.forms[0],"onsubmit",pCode,pFst);vO[pKey]=1;if(window.Sys.WebForms.PageRequestManager){var vPRM=Sys.WebForms.PageRequestManager.getInstance();if(!vPRM._onSubmitStatements)vPRM._onSubmitStatements=new Array();vPRM._onSubmitStatements[vPRM._onSubmitStatements.length]=new Function(pCode+"\r\nreturn true;\r\n");}}}function DES_AddHiddenField(pName,pValue){var vHF=document.getElementById(pName);if(vHF==null){vHF=document.createElement("input");vHF.type="hidden";vHF.id=pName;vHF.name=pName;vHF.className="DESNOCLASS";var vForm=document.forms[0];vForm.insertBefore(vHF,vForm.childNodes[0]);}vHF.value=pValue;return vHF;}function DES_ParseInt(pVal){var vR=0;var vNeg=false;for(var vI=0;vI<pVal.length;vI++){var vC=pVal.charAt(vI);if((vC>='0')&&(vC<='9'))vR=(vR*10)+parseInt(vC);else if(((vC=="-")||(vC=="("))&&(vI==0))vNeg=true;else if(vC!=")")return NaN;}if(vNeg)vR=-vR;return vR;}function DES_Round(pVal,pMd,pDP){if(pDP==-1)return pVal;var vTxt=pVal.toString();var vP=vTxt.indexOf(".");if(vP<0)return pVal;if(vTxt.length-(vP+1)<=pDP)return pVal;var vSF=Math.pow(10.0,pDP);var vSV=pVal*vSF;switch(pMd){case 0:vSV=Math.floor(Math.abs(vSV));if(pVal<0)vSV=-vSV;return vSV/vSF;case 1:var vNV=Math.floor(vSV);if((vSV!=vNV)&&(vNV%2==1)){vNV=Math.round(vSV);}return vNV/vSF;case 2:vSV=Math.abs(vSV);vSV=vSV.toFixed(1);vSV=parseFloat(vSV).toFixed(0);vSV=parseFloat(vSV);if(pVal<0)vSV=-vSV;return vSV/vSF;case 3:vSV=Math.ceil(vSV);return vSV/vSF;case 4:vSV=Math.ceil(Math.abs(vSV));if(pVal<0)vSV=-vSV;return vSV/vSF;}return 0;}function DES_Trunc(pDecimal){var vStr=pDecimal.toString();var vPos=vStr.indexOf(".");if(vPos==-1)return parseInt(vStr);else return parseInt(vStr.substr(0,vPos));}function DES_DecToStr(pV){var vR=pV.toString();if((vR.indexOf('e-')>-1)&&pV.toFixed){var vM=vR.match(/^.e(\d*)$/);var vSz=parseInt(vM[1]);vR=pV.toFixed(vSz);}return vR;}function DES_ToPrimitive(pV){if(pV==0)return 0;if(typeof(pV)=="string")return pV;if(pV.valueOf)return pV.valueOf();return pV;}function DES_StripTags(pHTML){return gDES_BI.IEMac||(gDES_BI.IEWin&&!gDES_BI.IEWin55)?pHTML:DES_RERpl(pHTML,"<(.|\n)+?>","");}function DES_RERpl(pText,pFind,pReplace){var vRx=new RegExp(pFind,"ig");return pText.replace(vRx,pReplace);}var gDES_NLTkn=new Array("","<br />","\n","\r"," ");function DES_NLTkn(pText,pUse,pType){if(pType&&pUse){if((pType==3)&&!gDES_BI.MultilineTT)pType=4;return DES_RERpl(pText,"{NEWLINE}",gDES_NLTkn[pType]);}else return pText;}function DES_Trim(s){var m=s.match(/^\s*(\S+(\s+\S+)*)\s*$/);return(m==null)?"":m[1];}function DES_SPReplToken(pText,pCnt,pTName){var vRE=new RegExp("\\{"+pTName+":([^:}]*):([^:}]*)\\}");var vMatch=vRE.exec(pText);if((vMatch!=null)&&(vMatch.length==3)){var vOrig=new RegExp("{"+pTName+":"+vMatch[1]+":"+vMatch[2]+"}","gi");if(pCnt==1)return pText.replace(vOrig,vMatch[1]);else return pText.replace(vOrig,vMatch[2]);}else return pText;}function DES_AttachEvent(pFld,pEvtName,pCode,pFst){if(typeof(pFld)=="string")pFld=DES_GetById(pFld);var vEv=eval("pFld."+pEvtName+";");if(typeof(vEv)=="function"){vEv=vEv.toString();vEv=vEv.substring(vEv.indexOf("{")+1,vEv.lastIndexOf("}"));if(vEv.charAt(vEv.length-1)!=";")vEv=vEv+";";if(vEv.indexOf(pCode)>-1)return;}else vEv="";if(pFst)vEv=pCode+vEv;else vEv=vEv+pCode;eval("pFld."+pEvtName+"= function("+(window.attachEvent==null?"event){":"){")+vEv+"}");DES_TrackEvent(pFld,pEvtName);}if(window.ValidatorHookupEvent)window.ValidatorHookupEvent=DES_ValidatorHookupEvent;function DES_ValidatorHookupEvent(pFld,pEvtName,pCode){if(gDES_BI.IEWin)pCode="var e = window.event;"+DES_RERpl(pCode,"event","e");DES_AttachEvent(pFld,pEvtName,pCode,0);}function DES_TrackEvent(pFld,pEvtName){if(window.attachEvent){if(!gDES_Events){gDES_Events=new Array;window.attachEvent("onunload",DES_DetachEvents);}gDES_Events[gDES_Events.length]={fld:pFld,evt:pEvtName};}}var gDES_Events=null;function DES_DetachEvents(){if(gDES_Events){for(var vI=0;vI<gDES_Events.length;vI++){var vO=gDES_Events[vI];eval("vO.fld."+vO.evt+" = null;vO.fld=null;");}}gDES_Events=null;}function DES_FireEvent(pFld,pEN,pDOMET){if(typeof(pFld)=="string")pFld=DES_GetById(pFld);if(pFld.fireEvent!=null)pFld.fireEvent('on'+pEN);else if((document.createEvent!=null)&&!gDES_BI.Opera7&&(!gDES_BI.Safari||gDES_BI.Safari3)){var vEv=document.createEvent(pDOMET);switch(pDOMET){case"UIEvents":vEv.initUIEvent(pEN,true,true,window,0);break;case"MouseEvents":vEv.initMouseEvent(pEN,true,true,window,0,0,0,0,0,false,false,false,false,0,null);break;default:vEv.initEvent(pEN,true,false);break;}pFld.dispatchEvent(vEv);}else{var vEv="";if(gDES_BI.Opera7||gDES_BI.Safari)vEv=eval("pFld.on"+pEN);else vEv=pFld.getAttribute('on'+pEN);vEv=vEv.toString();if(vEv.indexOf("javascript:")==0)vEv=vEv.slice(11);vEv=vEv.substring(vEv.indexOf("{")+1,vEv.lastIndexOf("}"));eval(vEv+';');}}function DES_StopEvent(pE){if(!pE)if(window.event)pE=window.event;else return;if(pE.cancelBubble!=null)pE.cancelBubble=true;if(pE.stopPropagation)pE.stopPropagation();if(pE.preventDefault)pE.preventDefault();pE.returnValue=false;if(pE.cancel!=null)pE.cancel=true;}function DES_EventStopped(pE){if(!pE)if(window.event)pE=window.event;else return false;if(gDES_BI.Opera7)return false;return pE.returnValue==false;}function DES_GetKeyCode(pE){var vKC=null;if(pE.keyCode)vKC=pE.keyCode;else if(pE.which)vKC=pE.which;return vKC;}function DES_IsCtrl(pE){var vCK=false;if(pE.ctrlKey!=null)vCK=pE.ctrlKey;else if(pE.modifiers!=null)vCK=(pE.modifiers|2)!=0;return vCK;}function DES_IsShift(pE){var vSK=false;if(pE.shiftKey!=null)vSK=pE.shiftKey;else if(pE.modifiers!=null)vSK=(pE.modifiers|4)!=0;return vSK;}function DES_ApplyCssPlus(pFld,pCss){pFld.className=DES_MergeCss(pFld.className,pCss);}function DES_MergeCss(pOCss,pPCss){if(!pPCss||(pOCss.indexOf(pPCss)>-1))return pOCss;if(pOCss=="")return pPCss;if(pPCss.charAt(0)==" ")return pOCss+pPCss;if(pPCss.charAt(pPCss.length-1)==" ")return pPCss+pOCss;return pPCss;}function DES_UpdateClassNames(pL){if(!pL)return;for(var vI=0;vI<pL.length;vI++){var vO=pL[vI];if(!vO.ids)continue;for(var vJ=0;vJ<vO.ids.length;vJ++){var vF=DES_GetById(vO.ids[vJ]);if(vF){if(vF.OrigCss==null)vF.OrigCss=vF.className;DES_ApplyCssPlus(vF,vO.css);}}}}function DES_Reanimate(){if(gDES_BI.IEWin)window.setTimeout("DES_ReanBody();",50);}function DES_ReanBody(){for(var vI=0;vI<document.images.length;vI++){var vImg=document.images[vI];var vName=vImg.src.toUpperCase();if(vName.substring(vName.length-3,vName.length)=="GIF")vImg.src=vImg.src;}}function DES_WaitMsg(){var vMsg=window.gDES_PgLd?gDES_PgLd:"Page is loading. Please wait.";alert(vMsg);}function DES_OnReset(pIsPostBack){if(this.DES_VALReset)DES_VALReset(pIsPostBack);if(this.DES_RunAllFSC){gDES_Init=true;try{DES_RunAllFSC();}finally{gDES_Init=false;}}if(window.DES_CalcAll)DES_CalcAll();if(this.DES_CMonReset)DES_CMonReset();if(this.DES_VWBRefresh)DES_VWBRefresh();DES_RefreshPage(true);var vF=DES_GetById("DES_JSE");if(vF)vF.value=1;}function DES_EvtType(pF){var vEvt=0;switch(pF.tagName){case"SELECT":case"TEXTAREA":vEvt=1;break;case"INPUT":if(gInputTypesRE.test(pF.type))vEvt=1;break;}return vEvt;}var gInputTypesRE=new RegExp("(text)|(password)|(file)|(email)|(url)|(number)|(date)|(month)|(week)|(time)|(datetime)|(datetime\-local)|(search)|(color)|(range)");var gDES_Refresh=null;function DES_RefreshPage(pVal){if(window.gDES_VG&&pVal&&gDES_VG.VUpdF)eval(gDES_VG.VUpdF);DES_Refresh();if(this.TMTB_Resize)TMTB_Resize();if(this.gDES_PV)DES_PVRefresh();if(this.DES_UpdateRFM&&window.gDES_VG&&window.gDES_VG.AHRFM)DES_UpdateRFM();}function DES_AddRefresh(pFld,pFnc){if(!gDES_Refresh)gDES_Refresh=new Array();gDES_Refresh[gDES_Refresh.length]={fld:pFld,fnc:pFnc};}function DES_Refresh(pFld){if(gDES_Refresh)for(var vI=0;vI<gDES_Refresh.length;vI++){var vR=gDES_Refresh[vI];if(!pFld||(pFld==vR.fld))vR.fnc(vR.fld);}}function DES_FixRefresh(){if(gDES_Refresh){var vT=new Array;for(var vI=0;vI<gDES_Refresh.length;vI++){var vF=gDES_Refresh[vI].fld;var vFld=DES_GetById(vF.id);if(vFld)vT[vT.length]=gDES_Refresh[vI];else{vF.style.display="none";vF.style.visibility="hidden";vF.disabled=false;gDES_Refresh[vI].fnc(vF);}}gDES_Refresh=vT.length>0?vT:null;}}function DES_RefreshOne(pSrc,pDst,pDsp){if(pDst){pDst.style.visibility=pSrc.style.visibility=="hidden"?"hidden":"";if(!pDsp){pDsp="inline";if(pDst.tagName=="TABLE"){if(gDES_BI.Opera9)pDsp="inline-table";else if(gDES_BI.Safari3||gDES_BI.FireFox3)pDsp="inline-block";}}pDst.style.display=pSrc.style.display=="none"?"none":pDsp;if(pSrc.disabled!=null){pDst.disabled=pSrc.disabled;DES_DisableImg(pDst);}}}var gDES_DisableFilter="progid:DXImageTransform.Microsoft.BasicImage(opacity = 0.50)";function DES_DisableImg(pImg,pAny){function DsbCss(){if(pImg.DsbCss!=null){if(pImg.SvDsbCss==null)pImg.SvDsbCss=pImg.className;pImg.className=pImg.disabled?pImg.DsbCss:pImg.SvDsbCss;return true;}return false;}if((pImg.disabled!=null)&&(pAny||(pImg.tagName=="IMG")||((pImg.tagName=="INPUT")&&(pImg.type=="image")))){if(pImg.DsbImg!=null){if(pImg.SvDsbImg==null)pImg.SvDsbImg=pImg.src;pImg.src=pImg.disabled?pImg.DsbImg:pImg.SvDsbImg;}if(DsbCss())return;if(gDES_BI.IEWin55)pImg.style.filter=pImg.disabled?gDES_DisableFilter:"";else if(pImg.style.opacity!=null){pImg.style.opacity=pImg.disabled?0.5:1.0;}}else if(pImg.disabled!=null)if(pImg.tagName!="SELECT")if(!DsbCss())for(var vI=0;vI<pImg.childNodes.length;vI++){var vC=pImg.childNodes[vI];if(vC.nodeType==1){vC.DsbCss=pImg.DsbCss;var vSv=vC.disabled;vC.disabled=pImg.disabled;DES_DisableImg(vC,pAny);vC.disabled=vSv;}}}function DES_WindowStatus(pMsg){if(window.status)window.status=pMsg;}function DES_CanEditParent(pFId){var vPos=pFId.lastIndexOf("_");if(vPos>-1){var vEF=DES_GetById(pFId.substr(0,vPos));if(vEF&&(vEF.readonly||vEF.disabled))return false;}return true;}function DES_FixCI(pCI){return pCI?pCI:gDES_CultureInfo;}function DES_GetCulture(pAO){return gDES_CultureInfo;}function DES_GetCmdId(pKMap,pKC,pCK,pSK,pOKD){function GetIt(pPos,pTkn){var vEP=pKMap.indexOf("}",pPos+pTkn.length+1);return(vEP>-1)?parseInt(pKMap.substring(pPos+pTkn.length+1,vEP)):0;}if(gDES_BI.IEWin&&(pKC==17))return 0;var vMK=(pCK?"C":"")+(pSK?"S":"");var vTkn="{#"+pKC+vMK;var vPos=pKMap.indexOf(vTkn);if(vPos>-1){return GetIt(vPos,vTkn);}else if(!pOKD||(pKC<33)||(pKC>47)){var vKCS=String.fromCharCode(pKC);var vU=vKCS.toUpperCase();if((pKC<65)||(pKC>90))if(vU==vKCS)vMK=(pCK?"C":"");vKCS=vU;vTkn="{"+vKCS+vMK;vPos=pKMap.indexOf(vTkn+"|");if(vPos>-1){return GetIt(vPos,vTkn);}}return 0;}function DES_Debug(pMsg){var vF=DES_GetById("DES_Debug");if(!vF){var vF=document.createElement("span");document.body.appendChild(vF);}vF.innerHTML=vF.innerHTML+pMsg+"<br />";}function DES_Preload(pUrl){if(pUrl&&document.images){var vImg=new Image();vImg.src=pUrl;}}function DES_MatchGroup(pGRq,pGSp){if((pGRq=="*")||(pGSp=="*"))return true;if(pGSp=="")return pGRq=="";var vRp=/\$/g;pGSp=pGSp.replace(vRp,"\\$$");var vRx=new RegExp("(^|\|)("+pGSp+")($|\|)","i");return vRx.test(pGRq);}function DES_DisplayStyle(pF){var vT=gDES_BI.IEWin8||gDES_BI.FireFox3||gDES_BI.Safari3||gDES_BI.Opera10;switch(pF.tagName){case"TR":if(vT)return"table-row";break;case"TD":if(vT)return"table-cell";break;case"TABLE":if(vT)return"table";break;}if(gDES_DStlRE.test(pF.tagName))return"block";else return"inline";}var gDES_DStlRE=/^((P)|(DIV)|(TABLE)|(TD)|(TH)|(TR)|(BLOCKQUOTE)|(PRE)|(HR)|(CENTER))$/;function DES_TxtLen(pFld){var vIsS=typeof(pFld)=="string";var vTxt=vIsS?pFld:pFld.value;var vL=vTxt.length;if(!vIsS&&(pFld.tagName!="TEXTAREA"))return vL;var vM;var vRE=/([^\r](?=\n))|(\r$)/g;while((vM=vRE.exec(vTxt))!=null){vL++;}return vL;}//!dc-end 4.0.4
function DES_DoAction(pAO){pAO.CondResult=-1;if(pAO.Enabled&&pAO.Run&&DES_DoEnabler(pAO)){pAO.CondResult=DES_EvalCondition(pAO.Cond);pAO.Run(pAO,pAO.CondResult);pAO.HasEval=1;}}function DES_DoEnabler(pAO){function VisEnb(){if((pAO.VT=="VAL")&&gDES_VG.ADVal&&pAO.Ctl){for(var vI=0;vI<pAO.Ctl.length;vI++){var vF=pAO.Ctl[vI];if(vF.AO&&(vF.AO.VT=="VT"))continue;if((vF.style.visibility=="hidden")||(vF.style.display=="none")||(vF.disabled))return false;}}return true;}if(!VisEnb()||(pAO.CanRun&&!pAO.CanRun(pAO))){if(pAO.VT=="VAL")if((pAO.EvtToVal!=1)||gDES_SubmitEvent)pAO.Run(pAO,1);return false;}return true;}var gDES_MAId=null;var gDES_Init=true;var gDES_SubmitEvent=false;var gDES_NoFC=false;function DES_CanRunActn(pAO){if(pAO.Enabler){var vR=DES_EvalCondition(pAO.Enabler);return vR!=0;}else return true;}function DES_InitActions(){if(window.PDP_InitObjects)PDP_InitObjects(false);if(window.attachEvent)window.attachEvent("onunload",DES_UnloadActions);if(window.DES_InitValA)DES_InitValA();var vAutoRun=new Array();for(var vActnID=0;vActnID<gDES_Actions.length;vActnID++){DES_InitOneAction(vActnID);var vAO=gDES_Actions[vActnID];if(vAO.AutoRun)vAutoRun[vAutoRun.length]=vAO;}for(var vI=0;vI<vAutoRun.length;vI++)DES_DoAction(vAutoRun[vI]);if(window.gDES_Vals&&window.DES_SetHiliteFields)for(var vI=0;vI<gDES_Vals.length;vI++){var vVO=gDES_Vals[vI];if(vVO&&!vVO.IsValid)DES_SetHiliteFields(vVO,0);}if(window.DES_CEMDoAction)DES_CEMDoAction();if(window.DES_AddVal)DES_ValUpdateCssOnPostBack();if(vAutoRun.length>0){if(window.DES_CalcAll)DES_CalcAll();DES_RefreshPage(true);}else if(window.gDES_ValRFM&&gDES_VG.AHRFM)DES_UpdateRFM();gDES_Init=false;}function DES_InitOneAction(pActnID){var vAO=gDES_Actions[pActnID];if(vAO.AOInited)return;vAO.AOInited=1;vAO.id=pActnID;if(vAO.Cond){var vCO=vAO.Cond;vCO.Action=vAO;if(vCO.Init)vCO.Init(vCO,vAO);}else vAO.Enabled=false;var vEn=vAO.Enabler;if((vEn!=null)&&(vEn.Init!=null)){vEn.Action=vAO;vEn.Init(vEn,vAO);}if(vAO.ExHU!=null)for(var vI=0;vI<vAO.ExHU.length;vI++)DES_HookupControl(DES_GetById(vAO.ExHU[vI]),vAO,null,cDES_HUCFlagECRA,null);if(vAO.Init)vAO.Init(vAO);}function DES_FieldChanged(pFldId,pHasEval){if(gDES_NoFC)return;gDES_SubmitEvent=false;var vFld=DES_GetById(pFldId);if(!vFld.ActionIDs)return;var vPV=0;for(var vI=0;vI<vFld.ActionIDs.length;vI++){var vAO=gDES_Actions[vFld.ActionIDs[vI]];if(!vAO)continue;if(pHasEval&&(vAO.VT=="VAL")&&!vAO.HasEval)continue;DES_DoAction(vAO);if(vAO.VT=="VAL")vPV=1;}if(vPV&&window.DES_PostValidateFld)DES_PostValidateFld(vFld);}function DES_UnloadActions(){for(var vI=0;vI<gDES_Actions.length;vI++){var vAO=gDES_Actions[vI];if(!vAO)continue;if(vAO.Ctl){for(var vJ=0;vJ<vAO.Ctl.length;vJ++){var vFld=vAO.Ctl[vJ];vFld.ActionIDs=null;}vAO.Ctl=null;}vAO.Ctl2=null;vAO.ErrFld=null;vAO.ImgErrFld=null;vAO.TxtErrFld=null;vAO.LnkErrFld=null;}window.gDES_Vals=null;window.gDES_SSMsgs=null;window.gDES_ValFlds=null;window.gDES_AONoIDs=null;window.gDES_ValErrMsgs=null;}function DES_FindAOById(pID){var vFld=DES_GetById(pID);if(vFld&&vFld.AO)return vFld.AO;pID=pID.toUpperCase();for(var vActnID=0;vActnID<gDES_Actions.length;vActnID++){var vAO=gDES_Actions[vActnID];if(!vAO)continue;if((vAO.CID!=null)&&(vAO.CID==pID))return vAO;}return null;}function DES_SetEnabled(pAO,pEnabled){if((pAO!=null)&&(pEnabled!=pAO.Enabled)){pAO.Enabled=pEnabled;if(pEnabled)DES_DoAction(pAO);else{if(pAO.VT=="VAL")pAO.Run(pAO,1);}if(pAO.CID!=null){var vRFM=DES_GetByIdEx(pAO.CID,"_RFM");if(vRFM!=null)vRFM.style.visibility=pEnabled?"inherit":"hidden";}}}
var gDES_CBCount=0;var gDES_CBLast=0;function DES_StartCallback(pVCnt,pFinishDelay,pReattachAll){function CleanupArray(pL,pUseEmpty,pSetup){if(pL){var vT=new Array;for(var vI=0;vI<pL.length;vI++){var vFld=DES_GetById(pL[vI].id);if(vFld){if(!pSetup||eval("vFld."+pSetup))vT[vT.length]=vFld;}pL[vI]=null;}if(!pUseEmpty&&(vT.length==0))return null;pL=vT;}return pL;}if(window.gDESDebugAJAX==true){alert("Begin DES Callback response.");window.gDESDebugAJAX2=true;}gDES_InCallback=true;gDES_DelayAOs=null;gDES_DelayedInit=null;gDES_ReattachAll=pReattachAll;gDES_CBCount++;window.gDES_ReVal=null;if(window.gDES_VG){gDES_VG.VCnt=pVCnt;if(window.DES_InitValA)DES_InitValA();}if(window.gDES_Actions)for(var vI=0;vI<gDES_Actions.length;vI++){var vAO=gDES_Actions[vI];if(!vAO)continue;if(vAO.CBDisabled)vAO.Enabled=true;if(vAO.ToDel&&vAO.ToDel(vAO)){vAO.Enabled=false;vAO.CBDisabled=true;}else if(window.DES_AddVal)DES_AddVal(vAO);}if(window.gDES_ValFlds){var vT=new Array;for(var vI=0;vI<gDES_ValFlds.length;vI++){var vFld=DES_GetById(gDES_ValFlds[vI].id);if(vFld&&vFld.ActionIDs)vT[vT.length]=vFld;gDES_ValFlds[vI]=null;}gDES_ValFlds=vT.length>0?vT:null;}if(window.gDES_ValSummary){var vT=new Array;for(var vI=0;vI<gDES_ValSummary.length;vI++){var vVSO=gDES_ValSummary[vI];var vFld=DES_GetById(vVSO.ValSumID);if(vFld)vT[vT.length]=vVSO;}gDES_ValSummary=vT.length>0?vT:null;}if(window.gDES_MOs){var vT=new Array;for(var vI=0;vI<gDES_MOs.length;vI++){var vMO=gDES_MOs[vI];var vFld=DES_GetById(vMO.id);if(vFld)vT[vT.length]=vMO;else if(vMO.Dispose)vMO.Dispose(vMO);}gDES_MOs=vT.length>0?vT:null;}window.gDES_SSMsgs=null;gDES_SIOs=CleanupArray(window.gDES_SIOs,true,"SIO");gDES_SOC=CleanupArray(window.gDES_SOC,true,"DESSOC");gDES_GOC=CleanupArray(window.gDES_GOC,true,"gocDE");gDES_Hints=CleanupArray(window.gDES_Hints,true,"DESHint");gDES_MSDE=CleanupArray(window.gDES_MSDE,true,"MSDE");gDES_VWBFlds=CleanupArray(window.gDES_VWBFlds,true,"VWBInit");DES_FixRefresh();if(pFinishDelay)window.setTimeout('DES_FinishCallback('+pVCnt+','+pReattachAll+');',pFinishDelay);}function DES_CallbackInit(pData,pInitFnc){if(window.gDESDebugAJAX==true){alert('Callback receiving control data');window.setTimeout("window.gDESDebugAJAX = true;",1000);window.gDESDebugAJAX=false;window.gDESDebugAJAX2=true;}switch(pInitFnc){case 0:DES_InitActionCB(pData);break;case 1:DES_InitVSOs(pData);break;case 5:DES_AddCVOs(pData,true);break;case 6:DES_AddControls(pData,true);break;case 10:if(window.DES_InitSIOs)DES_InitSIOs(pData);break;case 12:if(window.DES_InitMenuControl)DES_InitMenuControl(pData[0],pData[1],pData[2],pData[3]);break;case 13:if(window.DES_InitLinkMenuControl)DES_InitLinkMenuControl(pData[0],pData[1],pData[2]);break;case 20:DES_InitKOs(pData);break;case 21:DES_InitSOCs(pData);break;case 22:DES_VWBInit(pData);break;case 25:DES_InitMSDEs(pData);break;case 26:DES_InitSpinners(pData);break;case 27:DES_InitSpinner(pData);break;case 28:DES_NoPaste(pData);break;case 30:DES_InitHints(pData);break;case 32:DES_TTInitTROs(pData);break;case 34:DES_InitPVs(pData,1);break;case 35:DES_InitPVGbls(pData);break;case 40:var vFnc=new Function(pData[1]);DES_GOCInitCstmOC(pData[0],vFnc);break;case 42:DES_InitPUMOs(pData);break;case 45:DES_InitCMons(pData);break;case 46:DES_CMonCallback(pData);break;case 50:DES_InitMOs(pData,0);break;case 51:DES_InitPopups(pData);break;case 55:DES_InitCMs(pData);break;case 56:DES_InitSDOs(pData);break;case 70:DES_InitAPBs(pData);break;case 75:DES_InitTCOs(pData);break;case 85:DES_BLDEVInit(pData);break;case 86:DES_BLDEVUIInit(pData);break;case 100:eval(pData);break;}}function DES_CallbackPreInit(pData,pInitFnc){if(!gDES_DelayedInit)gDES_DelayedInit=new Array;gDES_DelayedInit[gDES_DelayedInit.length]={Data:pData,Fnc:pInitFnc};}var gDES_DelayedInit=null;function DES_FinishCallback(pVCnt,pReattachAll,pReVal){if(pVCnt==null)pVCnt=200;if(gDES_CBCount==gDES_CBLast)DES_StartCallback(pVCnt,0,pReattachAll);gDES_CBLast=gDES_CBCount;if(gDES_DelayedInit){if(window.PDP_InitObjects)PDP_InitObjects(false);var vRest=new Array;for(var vI=0;vI<gDES_DelayedInit.length;vI++){var vObj=gDES_DelayedInit[vI];if((vObj.Fnc==0)&&(vObj.Data.VT=="VAL"))DES_CallbackInit(vObj.Data,vObj.Fnc);else vRest[vRest.length]=vObj;}var vAutoRun=new Array;var vCalc=false;for(var vI=0;vI<vRest.length;vI++){var vObj=vRest[vI];DES_CallbackInit(vObj.Data,vObj.Fnc);if(vObj.Fnc==0){var vAO=vObj.Data;if(vAO.AutoRun)vAutoRun[vAutoRun.length]=vAO;if(vAO.VT=="CALC")vCalc=true;}}if((vAutoRun.length>0)&&window.DES_DoAction)for(var vI=0;vI<vAutoRun.length;vI++){DES_DoAction(vAutoRun[vI]);}if(pReattachAll&&window.gDES_Actions&&window.DES_DoAction){for(var vActnID=0;vActnID<gDES_Actions.length;vActnID++){DES_InitOneAction(vActnID);}}if(vCalc)DES_CalcAll();}else{if(window.DES_CalcAll)DES_CalcAll();if(window.DES_RunAllFSC)DES_RunAllFSC(false);}if(pReVal&&window.DES_ReVal)DES_ReVal();if(window.DES_FinishInitCM)DES_FinishInitCM();if(window.DES_FixHint)DES_FixHint();if(window.DES_PEFUnQueue)DES_PEFUnQueue();DES_RefreshPage(true);if(window.DES_DSBody&&window.gDES_SIOs)DES_DSBody(false);gDES_DelayedInit=null;gDES_Init=false;if(window.gDESDebugAJAX2){alert("End DES Callback response.");window.gDESDebugAJAX=true;window.gDESDebugAJAX2=null;}}function DES_InitActionCB(pAO){if(!window.gDES_Actions)gDES_Actions=new Array();var vFnd=false;var vActnID=0;for(vActnID=0;vActnID<gDES_Actions.length;vActnID++){if(pAO.CID&&(pAO.CID==gDES_Actions[vActnID].CID)){vFnd=true;gDES_Actions[vActnID]=pAO;break;}}if(!vFnd){vActnID=gDES_Actions.length;gDES_Actions[gDES_Actions.length]=pAO;}DES_InitOneAction(vActnID);if(pAO.AutoRun||(pAO.VT=="CALC")){if(!window.gDES_DelayAOs)gDES_DelayAOs=new Array;gDES_DelayAOs[gDES_DelayAOs.length]=pAO;}}var gDES_DelayAOs=null;function DES_ToDel(pAO){if(pAO.ErrFldID&&!DES_GetById(pAO.ErrFldID))return true;if(pAO.Cond&&pAO.Cond.ToDel&&pAO.Cond.ToDel(pAO.Cond))return true;if(pAO.Enabler&&pAO.Enabler.ToDel&&pAO.Enabler.ToDel(pAO.Enabler))return true;return false;}function DES_ToDelVal(pAO){if(pAO.ErrFldID!=null){pAO.ErrFld=DES_GetById(pAO.ErrFldID);pAO.ImgErrFld=DES_GetByIdEx(pAO.ErrFldID,"_Img");pAO.TxtErrFld=null;pAO.LnkErrFld=null;}if(DES_ToDel(pAO))return true;return false;}function DES_ToDelCalc(pAO){function ToDelExp(pExp){for(var vI=0;vI<pExp.length;vI++){var vIC=pExp[vI];var vCd=vIC.Cond;if(vCd&&vCd.ToDel&&vCd.ToDel(vCd))return true;if(vIC.LID&&!DES_GetById(vIC.LID))return true;if(vIC.CID&&!DES_GetById(vIC.CID))return true;if(vIC.CalcID&&!DES_GetById(vIC.CalcID))return true;if(vIC.Exp!=null)if(ToDelExp(vIC.Exp))return true;if(vIC.ExpT!=null)if(ToDelExp(vIC.ExpT))return true;if(vIC.ExpF!=null)if(ToDelExp(vIC.ExpF))return true;}return false;}if(pAO.CID2&&!DES_GetById(pAO.CID2))return true;if(pAO.SVID&&!DES_GetById(pAO.SVID))return true;if(pAO.Exp&&ToDelExp(pAO.Exp))return true;if(DES_ToDel(pAO))return true;return false;}function DES_ToDelFSC(pAO){pAO.ChgFld=DES_GetById(pAO.IDToChg);if(!pAO.ChgFld)return true;if(DES_ToDel(pAO))return true;return false;}function DES_ToDelMultiA(pAO){var vR=false;if(pAO.Actions)for(var vI=0;vI<pAO.Actions.length;vI++){var vAO=pAO.Actions[vI];if(vAO.ToDel&&vAO.ToDel(pAO))vR=true;}if(vR)return true;if(DES_ToDel(pAO))return true;return false;}function DES_ToDelCond(pCO){if(pCO.IDToEval&&!DES_GetById(pCO.IDToEval))return true;if(pCO.IDToEval2&&!DES_GetById(pCO.IDToEval2))return true;return false;}function DES_ToDelMultiCond(pCO){var vR=false;if(pCO.Conds)for(var vI=0;vI<pCO.Conds.length;vI++){var vCO=pCO.Conds[vI];if(vCO.ToDel&&vCO.ToDel(vCO))vR=true;}if(vR)return true;return false;}
var gDES_APB={RAId:null};function DES_InitAPBs(pL){for(var vI=0;vI<pL.length;vI++)DES_InitAPB(pL[vI]);}function DES_InitAPB(pPBO){function Attach(pF){pF.APBO=pPBO;var vEvt=DES_EvtType(pF)?"onchange":"onclick";var vCode="DES_AutoPostBack('"+pF.id+"');";DES_AttachEvent(pF.id,vEvt,"setTimeout(\""+vCode+"\",0);",0);}var vF=DES_GetById(pPBO.CID);if(!vF||vF.APBO)return;var vCVO=DES_GetCVO(vF);if(vF.gocDE)vF.APBO=pPBO;else if(vCVO.GetChild){for(var vI=0;true;vI++){vCF=vCVO.GetChild(pPBO.CID,vI,1);if(vCF)Attach(vCF);else break;}}else Attach(vF);}function DES_AutoPostBack(pFID){var vF=DES_GetById(pFID);if(vF&&vF.APBO)return DES_PostBack(vF.APBO)
return null;}function DES_PostBack(pPBO){var vF=DES_GetById(pPBO.CID);if(pPBO.Msg)if(!confirm(pPBO.Msg))return false;if(pPBO.Grp!=null)if(!DES_ValidateGroup(pPBO.Grp,true))return false;if(pPBO.One){if(DES_IsValid(vF)==false)return false;}gDES_CauseVal=false;var vUID=pPBO.UID;if(!vUID)vUID=vF.name?vF.name:vF.id;if(pPBO.TF){var vLF=DES_GetById("__DESLF");if(!vLF){vLF=document.createElement("input");vLF.id="__DESLF";vLF.name="__DESLF";vLF.type="hidden";var vET=DES_GetById("__EVENTTARGET");if(vET)vET.parentNode.appendChild(vLF);}if(vLF){var vAE=document.activeElement;if(vAE&&(vAE.id||vAE.name))vLF.value=vAE.name?vAE.name:vAE.id;else vLF.value=vUID;}}var vArg=pPBO.Arg?pPBO.Arg:"";if(pPBO.AJ){eval(gDES_APB.RAId+".AjaxRequestWithTarget('"+vUID+"','"+vArg+"')");}else{if(pPBO.AMS&&window.Sys.WebForms.PageRequestManager){var vPRM=Sys.WebForms.PageRequestManager._instance;if(!vPRM._postBackSettings||!vPRM._postBackSettings.async){__doPostBack(vUID,vArg);return true;}vPRM._form.__EVENTTARGET.value=vUID;vPRM._form.__EVENTARGUMENT.value=vArg;vPRM._onFormSubmit(null);}else __doPostBack(vUID,vArg);}return true;}
var gDES_BlinkObjCnt=0;var gDES_BlinkState=false;var gDES_BlinkTimerID=0;function DES_StartBlink(pAO){if(gDES_BI.setInterval&&(pAO.Blnk)&&(pAO.BlinkCnt==0)&&(pAO.BlinkFnc!=null)){pAO.BlinkCnt=gDES_SubmitEvent?gDES_VG.BlkOS:gDES_VG.BlkOC;if(pAO.BlinkCnt==0)return;gDES_BlinkObjCnt++;if(gDES_BlinkObjCnt==1){gDES_BlinkState=false;gDES_BlinkTimerID=window.setInterval("javascript: DES_DoBlink();",gDES_VG.BlkT);}else if(gDES_BlinkState)pAO.BlinkFnc(pAO,true);}}function DES_StopBlink(pAO){if(pAO.BlinkCnt!=0){pAO.BlinkFnc(pAO,false);gDES_BlinkObjCnt--;pAO.BlinkCnt=0;if(gDES_BlinkObjCnt==0){window.clearInterval(gDES_BlinkTimerID);gDES_BlinkTimerID=0;}}}function DES_DoBlink(){gDES_BlinkState=!gDES_BlinkState;for(var vActnID=0;vActnID<gDES_Actions.length;vActnID++){vAO=gDES_Actions[vActnID];if(!vAO)continue;if((vAO.BlinkCnt!=null)&&(vAO.BlinkCnt!=0)){if((vAO.BlinkCnt>0)&&!gDES_BlinkState){if(vAO.BlinkCnt==1){DES_StopBlink(vAO);continue;}else vAO.BlinkCnt--;}vAO.BlinkFnc(vAO,gDES_BlinkState);}}}function DES_Blink(pAO,pBlink){if(!pAO.ErrFld)return;if((pAO.BlnkCss!="")&&(pAO.ErrFld.className!=null))pAO.ErrFld.className=pBlink?pAO.BlnkCss:pAO.OrigCss;else if(pAO.ErrFld.style!=null)pAO.ErrFld.style.color=pBlink?'':pAO.OrigColor;if((pAO.ImgErrFld!=null)&&(pAO.ImgErrFld.style!=null))pAO.ImgErrFld.style.visibility=pBlink?"hidden":"inherit";}
function DES_EvalCallBackCond(pCO){if(!gDES_SubmitEvent){__theFormPostData='';WebForm_InitCallback();eval(pCO.Callback);}if(pCO.Action.LastResult!=null)return pCO.Action.LastResult;else return-1;}function DES_CBResp(pR,pVID){var vParts=pR.split(String.fromCharCode(20));DES_UpdVal(pVID,parseInt(vParts[0]),vParts[1],vParts[2]);}
function DES_COInit(pTC,pPC){function Add(pName){var vImg=document.createElement("img");vImg.id=pPC.id+"_CO_"+pName;vImg.border=0;vImg.src=vPO.COUrl+pName+".gif";vImg.style.visibility="hidden";vImg.style.position="absolute";document.body.appendChild(vImg);return vImg;}var vPO=pPC.PO;if(!vPO||!vPO.COUrl||vPO.COImgs)return;vPO.COImgs=new Array(Add("Left"),Add("Right"),Add("Top"),Add("Bottom"));DES_COPreload(vPO);}function DES_COPreload(pPO){if(pPO.COUrlPL)return;pPO.COUrlPL=1;if(pPO.COUrl){DES_Preload(pPO.COUrl+"Left.gif");DES_Preload(pPO.COUrl+"Right.gif");DES_Preload(pPO.COUrl+"Top.gif");DES_Preload(pPO.COUrl+"Bottom.gif");}}function DES_COShow(pTC,pPC,pTLP,pTTP,pPLP,pPTP,pZ){function Fit(pT1,pT2,pP1,pP2,pCOW){if((pT1<pP1)&&(pT2<pP1))return-1;else if((pT2>pP2)&&(pT1>pP2))return-1;if((pP2-pP1)<(pCOW+vPO.COfs))return-1;if(pT1<pP1)return vPO.COfs;var vF=(pT1-pP1);vF=vF+Math.round((pT2-pT1)*(vPO.COPct/100));if(vF<vPO.COfs)vF=vPO.COfs;return vF;}function Show(pIdx,pX,pY,pMX,pMY){for(var vI=0;vI<=3;vI++)if(pIdx==vI){var vImg=vPO.COImgs[vI];DES_SetLeftPos(vImg,pX);DES_SetTopPos(vImg,pY);vImg.style.zIndex=pZ+1;if(pMX!=0)DES_SetLeftPos(pPC,pPLP+pMX);if(pMY!=0)DES_SetTopPos(pPC,pPTP+pMY);vPO.COImgs[vI].style.visibility="inherit";}else{vPO.COImgs[vI].style.visibility="hidden";}}var vPO=pPC.PO;if(!vPO||!vPO.COImgs)return;var vOfs=Fit(pTLP,pTLP+pTC.offsetWidth,pPLP,pPLP+pPC.offsetWidth,vPO.COLRW);if(vOfs>-1){if(pTTP>pPTP+pPC.offsetHeight)Show(3,pPLP+vOfs,pPTP+pPC.offsetHeight-vPO.COTBH-1,0,-vPO.COTBH);else if(pTTP+pTC.offsetHeight<pPTP)Show(2,pPLP+vOfs,pPTP,0,vPO.COTBH);else Show(-1);}else{vOfs=Fit(pTTP,pTTP+pTC.offsetHeight,pPTP,pPTP+pPC.offsetHeight,vPO.COTBH);if(vOfs>-1){if(pTLP>pPLP+pPC.offsetWidth)Show(1,pPLP+pPC.offsetWidth-vPO.COLRW-1,pPTP+vOfs,-vPO.COLRW,0);else if(pTLP+pTC.offsetWidth<pPLP)Show(0,pPLP,pPTP+vOfs,vPO.COLRW,0);else Show(-1);}}}function DES_COHide(pPC){var vPO=pPC.PO;if(!vPO||!vPO.COImgs)return;for(var vI=0;vI<=3;vI++)vPO.COImgs[vI].style.visibility="hidden";}//DES_COHide
var gDES_ValOnBlur=0;function DES_EvalCondition(pCO){if(pCO.Enabled&&pCO.Eval){var vR=pCO.Eval(pCO);if((vR!=-1)&&pCO.Not)vR=(vR==1)?0:1;return vR;}else return-1;}function DES_InitCond(pCO,pAO){if(pCO.Trim==null)pCO.Trim=true;}function DES_InitOneFldCond(pCO,pAO){DES_InitCond(pCO,pAO);if(pCO.IDToEval!="")DES_HookupControl(DES_GetById(pCO.IDToEval),pAO,pCO,false);}function DES_InitTwoFldCond(pCO,pAO){DES_InitOneFldCond(pCO,pAO);if(pCO.IDToEval2!="")DES_HookupControl(DES_GetById(pCO.IDToEval2),pAO,pCO,false);}function DES_InitMultiCond(pCO,pAO){DES_InitCond(pCO,pAO);for(var vI=0;vI<pCO.Conds.length;vI++){var vChild=pCO.Conds[vI];if(pAO.VT)vChild.Action=pAO;if(vChild.Init)vChild.Init(vChild,pAO);}}function DES_InitRangeCond(pCO,pAO){DES_InitOneFldCond(pCO,pAO);if(pCO.MinTxt!=null)pCO.Min=pCO.Parse(pCO,pCO.MinTxt);else pCO.Min=null;if(pCO.MaxTxt!=null)pCO.Max=pCO.Parse(pCO,pCO.MaxTxt);else pCO.Max=null;pCO.IsRng=1;}function DES_InitCompValCond(pCO,pAO){DES_InitOneFldCond(pCO,pAO);pCO.Val=pCO.Parse(pCO,pCO.ValTxt);}function DES_EvalMultiCond(pCO){if(pCO.Conds.length==0)return-1;var vResult=true;var vCanEval=false;if(pCO.ANDOp){for(var vI=0;vResult&&(vI<pCO.Conds.length);vI++){var vR=DES_EvalCondition(pCO.Conds[vI]);if(vR==0)vResult=false;if(vR!=-1)vCanEval=true;}}else{vResult=false;for(var vI=0;!vResult&&(vI<pCO.Conds.length);vI++){var vR=DES_EvalCondition(pCO.Conds[vI]);if(vR==1)vResult=true;if(vR!=-1)vCanEval=true;}}if(!vCanEval)return-1;if(pCO.NOTOp)vResult=!vResult;return vResult?1:0;}function DES_EvalReqTextCond(pCO){var vR=1;var vV=DES_GetTextValue(pCO.IDToEval,pCO.Trim);if(!pCO.Unassnd||(pCO.Unassnd.length==0))return(vV!="")?1:0;if(pCO.CaseIns)vV=vV.toUpperCase();for(var vI=0;vR&&(vI<pCO.Unassnd.length);vI++)if(pCO.Unassnd[vI]==vV)vR=0;return vR;}function DES_EvalReqListCond(pCO){var vIdx=DES_GetSelIdx(pCO.IDToEval);if(vIdx==null)return-1;if(pCO.UnassgnIdx==null)pCO.UnassgnIdx=-1;return(vIdx!=pCO.UnassgnIdx)?1:0;}function DES_EvalRangeCond(pCO){var vVal=DES_GetNativeValue(pCO.IDToEval,pCO);if(!DES_GoodNativeVal(vVal))return-1;return(((pCO.Min==null)||(DES_Comparer(pCO,pCO.Min,vVal,5)))&&((pCO.Max==null)||(DES_Comparer(pCO,pCO.Max,vVal,3))))?1:0;}function DES_EvalComp2FldsCond(pCO){var vVal1=DES_GetNativeValue(pCO.IDToEval,pCO);var vVal2=DES_GetNativeValue(pCO.IDToEval2,pCO);if(!DES_GoodNativeVal(vVal1)||!DES_GoodNativeVal(vVal2))return-1;return DES_Comparer(pCO,vVal1,vVal2,pCO.Op)?1:0;}function DES_EvalCompValCond(pCO){var vVal=DES_GetNativeValue(pCO.IDToEval,pCO);if(!DES_GoodNativeVal(vVal))return-1;return DES_Comparer(pCO,vVal,pCO.Val,pCO.Op)?1:0;}function DES_EvalDTCheckCond(pCO){pCO.Val=DES_GetNativeValue(pCO.IDToEval,pCO);if(pCO.Val==gDES_GetNativeInvalid){pCO.Val=null;return 0;}if((pCO.Val!=null)&&(pCO.Val!=gDES_GetNativeUnassigned)){return(((pCO.Min==null)||(DES_Comparer(pCO,pCO.Min,pCO.Val,5)))&&((pCO.Max==null)||(DES_Comparer(pCO,pCO.Max,pCO.Val,3))))?1:0;}else return-1;}function DES_EvalRegexCond(pCO){if(pCO.Expr=="")return-1;var vV=DES_GetTextValue(pCO.IDToEval,pCO.Trim);if(vV=="")return pCO.IBT;var vRx=new RegExp(pCO.Expr,pCO.Flags);return vRx.test(vV)?1:0;}function DES_EvalCheckStateCond(pCO){var vChk=DES_GetBoolValue(pCO.IDToEval);if(vChk==null)return-1;return(vChk==pCO.Chk)?1:0;}function DES_EvalSelIdxListCond(pCO){var vSel=DES_IsSelIdx(pCO.IDToEval,pCO.Idx);if(vSel==null)return-1;return(vSel==pCO.Sel)?1:0;}function DES_EvalAltCS(pCO){if((pCO.OCSMode==0)&&gDES_SubmitEvent){pCO.OCSMode=1;return 1;}else if(pCO.OCSMode==0)return 0;else return 1;}function DES_EvalFixed(pCO){return gDES_SubmitEvent?1:pCO.Res;}var cDES_HUCFlagAltEvent=1;var cDES_HUCFlagECRA=2;function DES_HookupControl(pFld,pAO,pCO,pFlags,pHookup){if(!pFld)return false;var vCVO=null;if(window.DES_GetCVO){vCVO=DES_GetCVO(pFld);if(!pHookup&&vCVO.Hookup)pHookup=vCVO.Hookup;}if((pFlags==null)||(pFlags==false))pFlags=0;else if(pFlags==true)pFlags=cDES_HUCFlagAltEvent;if(pCO&&!pCO.HUEvts){if(window.DES_HookupRFM)DES_HookupRFM(pAO,pCO,pFld);return false;}if(!pCO||!pHookup){var vOF=pFld;var vOFC=0;if(pAO.Ctl==null)pAO.Ctl=new Array;pAO.Ctl[pAO.Ctl.length]=pFld;if(pAO.REA&&pAO.ErrFldID&&window.DES_GOCInit){var vCFld=DES_GetById(pAO.ErrFldID);if(vCFld){DES_GOCInit(vCFld,pFld,1);if(gDES_ValOnBlur&&pAO.Cond.Req&&!pFld.InitVOB)pFld.InitVOB=pAO;pFld=vCFld;vOFC=1;}}var vFT=false;var vAOID=gDES_MAId!=null?gDES_MAId:pAO.id;if(pFld.ActionIDs==null){vFT=true;pFld.ActionIDs=new Array;if(((pFlags&cDES_HUCFlagAltEvent)==0)&&!pFld.gocDE){var vUseOnChange=DES_EvtType(pFld)==1;var vEv=vUseOnChange?pFld.onchange:pFld.onclick;if(typeof(vEv)=="function"){vEv=vEv.toString();vEv=vEv.substring(vEv.indexOf("{")+1,vEv.lastIndexOf("}"));}else vEv="";var vFunc=new Function("DES_FieldChanged('"+pFld.id+"'); "+vEv);if(vUseOnChange){pFld.onchange=vFunc;DES_TrackEvent(pFld,"onchange");}else{pFld.onclick=vFunc;DES_TrackEvent(pFld,"onclick");}}if(gDES_ValOnBlur&&pAO.Cond.Req&&!vOF.InitVOB){DES_AttachEvent(pFld,"onblur","DES_FieldOnBlur('"+vOF.id+"');",false);vOF.InitVOB=pAO;}}else if(gDES_InCallback){for(var vI=0;vI<pFld.ActionIDs.length;vI++)if(vAOID==pFld.ActionIDs[vI])return false;}if(!pAO.RegID){pFld.ActionIDs[pFld.ActionIDs.length]=vAOID;if(pAO.REA)pAO.RegID=1;}if(vOFC)DES_GOCAddAO(vOF,vAOID);if(window.DES_VALRegCTV)DES_VALRegCTV(pFld,pAO,(pFlags&cDES_HUCFlagECRA)!=0);if(window.gDES_CMon&&(pAO.VT=="VAL")&&gEditTagsRE.test(pFld.tagName))DES_InitCMon({id:pFld.id,Grp:pAO.Group});if(window.DES_FSCInitKP)DES_FSCInitKP(pFld,pAO);return vFT;}else{pHookup(pCO,pAO,pFld.id,vCVO?vCVO.GetChild:null);return false;}}var gEditTagsRE=new RegExp("(INPUT)|(SELECT)|(TEXTAREA)");function DES_FieldOnBlur(pFId){var vF=DES_GetById(pFId);if((gDES_ValOnBlur==1)||(vF.InitVOB&&!vF.InitVOB.HasEval))DES_FieldChanged(pFId);}//!NOTE:Moved many functions to Controls.js
var gDES_Controls=new Array();var gDES_CVOs=new Array();function DES_AddControls(pList,pRefresh){for(var vI=0;vI<pList.length;vI++){var vItem=pList[vI];if(pRefresh){var vDup=0;for(var vJ=0;vJ<gDES_Controls.length;vJ++)if(gDES_Controls[vJ].id==vItem.id){vDup=1;break;}if(vDup)continue;}gDES_Controls[gDES_Controls.length]=vItem;}}function DES_GetCVO(pFId){var vF=DES_GetById(pFId);if(!vF.CVO){var vCVO=DES_FindCVOByControl(vF.id);if(vCVO.Init)if(vCVO.Init(vF.id)==false){window.setTimeout("DES_GetCVO('"+vF.id+"')",50);return vCVO;}vF.CVO=vCVO;}return vF.CVO;}function DES_FindCVOByControl(pID){for(var vI=0;vI<gDES_Controls.length;vI++)if(gDES_Controls[vI].id==pID){return DES_FindCVO(gDES_Controls[vI].CVO);}return{id:"Stnd"};}function DES_AddCVOs(pCVOs,pRefresh){for(var vI=0;vI<pCVOs.length;vI++){var vCVO=pCVOs[vI];if(pRefresh){var vDup=0;for(var vJ=0;vJ<gDES_CVOs.length;vJ++)if(gDES_CVOs[vJ].id==vCVO.id){vDup=1;break;}if(vDup)continue;}gDES_CVOs[gDES_CVOs.length]=vCVO;}}function DES_FindCVO(pID){for(var vI=0;vI<gDES_CVOs.length;vI++)if(gDES_CVOs[vI].id==pID){return gDES_CVOs[vI];}return{id:pID};}function DES_GetTextValue(pId,pTrim,pFnc){function Prep(pS){if(pTrim)pS=DES_Trim(pS);if((vC.VWB!=null)&&(vC.value.toUpperCase()==vC.VWBUC))pS="";return pS;}var vC=DES_GetById(pId);var vCVO=DES_GetCVO(vC);if(!pFnc&&vCVO.GetText)pFnc=vCVO.GetText;if(pFnc!=null)return Prep(pFnc(pId));if((vC.tagName=="INPUT")&&((vC.type=="checkbox")||(vC.type=="radio")))return vC.checked?"1":"";if(typeof(vC.value)=="string")return Prep(vC.value);if(vC.options&&vC.selectedIndex)if(vC.selectedIndex==-1)return"";else{var vVal=vC.options[vC.selectedIndex].value;if(pTrim)vVal=DES_Trim(vVal);return vVal;}if(vC.Btns)for(var vI=0;vI<vC.Btns.length;vI++){if(vC.Btns[vI].checked)return vC.Btns[vI].value;}return"";}function DES_GetSelIdx(pId,pFnc){var vF=DES_GetById(pId);var vCVO=DES_GetCVO(vF);if(!pFnc&&vCVO.GetSelIdx)pFnc=vCVO.GetSelIdx;if(pFnc!=null)return pFnc(pId);if(vF.selectedIndex!=null)return vF.selectedIndex;else if(vF.Btns){for(var vI=0;vI<vF.Btns.length;vI++){if(vF.Btns[vI].checked)return vI;}return-1;}else return null;}function DES_IsSelIdx(pFId,pIdx,pFnc){var vF=DES_GetById(pFId);var vCVO=DES_GetCVO(vF);if(!pFnc&&vCVO.IsSelIdx)pFnc=vCVO.IsSelIdx;if(pFnc!=null)return pFnc(pFId,pIdx);if(vF.multiple&&vF.options&&(pIdx>-1))return vF.options[pIdx].selected;if(vF.selectedIndex!=null)return vF.selectedIndex==pIdx;else if(vF.Btns){if(pIdx==-1)return DES_GetSelIdx(vF)==-1;if(pIdx<vF.Btns.length)return vF.Btns[pIdx].checked;return false;}return null;}function DES_GetBoolValue(pFId,pFnc){var vF=DES_GetById(pFId);var vCVO=DES_GetCVO(vF);if(!pFnc&&vCVO.GetBool)pFnc=vCVO.GetBool;if(pFnc!=null)return pFnc(pFId);if(vF.checked==null)return null;return vF.checked;}function DES_IsValueNull(pFId,pFnc){var vF=DES_GetById(pFId);var vCVO=DES_GetCVO(vF);if(!pFnc&&vCVO.IsValNull)pFnc=vCVO.IsValNull;if(pFnc!=null)return pFnc(pFId);return vF.value=="";}function DES_GetMultiSelIdx(pFId,pFnc){var vF=DES_GetById(pFId);var vCVO=DES_GetCVO(vF);if(!pFnc&&vCVO.MultiSelIdx)pFnc=vCVO.MultiSelIdx;if(pFnc!=null)return pFnc(pFId);var vL=new Array();if(vF.Btns){for(var vI=0;vI<vF.Btns.length;vI++)if(vF.Btns[vI].checked)vL[vL.length]=vI;}else if(vF.options){for(var vI=0;vI<vF.options.length;vI++)if(vF.options[vI].selected)vL[vL.length]=vI;}else vL=null;return vL;}function DES_GetListCount(pFId,pFnc){var vF=DES_GetById(pFId);var vCVO=DES_GetCVO(vF);if(!pFnc&&vCVO.LstCnt)pFnc=vCVO.LstCnt;if(pFnc!=null)return pFnc(pFId);if(vF.Btns)return vF.Btns.length;else if(vF.options)return vF.options.length;else return null;}function DES_SetTextValue(pId,pValue,pFnc){var vF=DES_GetById(pId);var vCVO=DES_GetCVO(vF);if(!pFnc&&vCVO.SetText)pFnc=vCVO.SetText;if(pFnc!=null)return pFnc(pId,pValue);vF.value=pValue;}function DES_InitBtnList(pFld){function FindChildren(array,parent){for(var vI=0;vI<parent.childNodes.length;vI++){var vC=parent.childNodes[vI];if(vC.tagName=="INPUT")array[array.length]=vC;else FindChildren(array,vC);}}pFld=DES_GetById(pFld);var VL=pFld.Btns;if(!VL){VL=new Array();FindChildren(VL,pFld);pFld.Btns=VL;}}function DES_HUGetChildCtrls(pCO,pAO,pFId,pFnc){if(pFnc==null)pFnc=pCO.GetChild;for(var vI=0;true;vI++){var vF=pFnc(pFId,vI,1);if(vF!=null)DES_HookupControl(vF,pAO,null,0,null);else return;}}function DES_GCCheckRadioList(pFId,pIdx,pMd){var vF=DES_GetById(pFId);if(pMd==0){if(pIdx==0)return vF;pIdx=pIdx-1;}return(pIdx<vF.Btns.length)?vF.Btns[pIdx]:null;}function DES_CNTNRParentNoID(pFId){pFId=DES_GetById(pFId);var vPFld=pFId.parentElement!=null?pFId.parentElement:pFId.parentNode;if((vPFld.id=="")&&(vPFld.tagName=="SPAN"))return vPFld;return null;}function DES_SetErrStyle(pFId,pEvtFnc){var vFld=DES_GetById(pFId);if(vFld){vFld.SetErrStyle=pEvtFnc;DES_TrackEvent(vFld,"SetErrStyle");}}
var cMSInDay=86400000;function DES_FmtDate(pY,pM,pD,pPtn,pFmt,pCI){if(pD==0)return"";pCI=DES_FixCI(pCI);var vR=pPtn;var vM=DES_DPLit(vR);var vLit=null;if(vM)for(var vI=1;vI<vM.length;vI++)if(vM[vI]!=null)if((vM[vI].charAt(0)!="'")&&(vM[vI].charAt(0)!='"')){if(!vLit)vLit=new Array;var vPos=vLit.length;vLit[vPos]=vM[vI];vR=vR.replace(vM[vI-1],"{"+vPos+"}");}vR=vR.replace("yyyy",pY.toString());if(vR.indexOf("yy")!=-1){var vSY=pY%100;if(vSY>9)vR=vR.replace("yy",vSY.toString());else vR=vR.replace("yy","0"+vSY.toString());}if(vR.indexOf("dd")!=-1){if(pD>9)vR=vR.replace("dd",pD.toString());else vR=vR.replace("dd","0"+pD.toString());}else vR=vR.replace("d",pD.toString());if(pFmt==0){var vAdj=pM+1;if(vR.indexOf("MM")!=-1){if(vAdj>9)vR=vR.replace("MM",vAdj.toString());else vR=vR.replace("MM","0"+vAdj.toString());}else vR=vR.replace("M",vAdj.toString());}else if(pFmt==1){var vDate=new Date(pY,pM,pD);var vDOW=vDate.getDay();if(pCI.AMN)vR=vR.replace("MMMM",pCI.AMN[pM]);if(pCI.ADN)vR=vR.replace("ww",pCI.ADN[vDOW]);}else{var vDate=new Date(pY,pM,pD);var vDOW=vDate.getDay();if(pCI.MN)vR=vR.replace("MMMM",pCI.MN[pM]);if(pCI.DN)vR=vR.replace("ww",pCI.DN[vDOW]);}if(vLit)for(var vI=0;vI<vLit.length;vI++)vR=vR.replace("{"+vI+"}",vLit[vI]);return vR;}function DES_DPLit(pPtn){if(!window.gDES_REPtnLit)window.gDES_REPtnLit=/(['"]([^'"]+)['"])(?:[^'"]+(['"]([^'"]+)['"])?)?/;return window.gDES_REPtnLit.exec(pPtn);}function DES_FmtDate2(pDate,pPtn,pFmt,pCI){if(pDate){return DES_FmtDate(pDate.getUTCFullYear(),pDate.getUTCMonth(),pDate.getUTCDate(),pPtn,pFmt,pCI);}else return"";}function DES_FmtTime(pSec,pPat,pHS,pCI){function SetOne(pPtn,pChar,pNew){var pNew=pNew.toString();var vTwoChar=pChar+pChar;if(pPtn.indexOf(vTwoChar)>-1){if(pNew<10)pPtn=pPtn.replace(vTwoChar,"0"+pNew);else pPtn=pPtn.replace(vTwoChar,pNew);}else if(pPtn.indexOf(pChar)>-1){pPtn=pPtn.replace(pChar,pNew);}return pPtn;}if(pSec==null)return"";pCI=DES_FixCI(pCI);var vR='';if(pHS&&(pSec%60==0))pPat--;switch(pPat){case 0:vR=pCI.STP;break;case 1:vR=pCI.LTP;break;case 2:vR=pCI.SDurP;break;case 3:vR=pCI.LDurP;break;case 4:vR=pCI.STPD;break;case 5:vR=pCI.LTPD;break;case 6:vR=pCI.STPN;break;case 7:vR=pCI.LTPN;break;case 10:vR=DES_Round(pSec/60,2,2);return vR;}var vHrs=DES_Round(pSec/3600,0,0);var vVal=vHrs;if(vR.indexOf("H")>-1)vR=SetOne(vR,"H",vVal);else{if(vVal==0)vVal=12;else if((vVal>12)&&(vVal<24))vVal=vVal-12;vR=SetOne(vR,"h",vVal);}vVal=DES_Round((pSec/60)%60,0,0);vR=SetOne(vR,"m",vVal);vVal=pSec%60;vR=SetOne(vR,"s",vVal);if(vR.indexOf("t")>-1){var vDes=(vHrs>=12)?pCI.PMD:pCI.AMD;if(vR.indexOf("tt")>-1)vR=vR.replace("tt",vDes);else vR=vR.replace("t",vDes.length?vDes.charAt(0):"");}return vR;}function DES_MakeUTCDate(pY,pM,pD){if((pY==null)||(pM==null)||(pD==null))return null;var vDate=new Date(0);vDate.setUTCFullYear(pY,pM,pD);vDate.setUTCHours(0,0,0,0);return vDate;}function DES_AddMonths(pDate,pAdd){if(!pAdd)return pDate;var vM=pDate.getUTCMonth();var vY=pDate.getUTCFullYear();var vD=pDate.getUTCDate();var vR=null;if(pAdd>0){vM=vM+pAdd;vY=vY+Math.round((vM/12)-0.5);vM=vM%12;}else{vM=11-vM;vM=vM-pAdd;vY=vY-Math.round((vM/12)-0.5);vM=11-(vM%12);}do{vR=DES_MakeUTCDate(vY,vM,vD);vD--;}while(vR.getUTCMonth()!=vM);return vR;}function DES_GetWeekNum(pDate,pCI){pCI=DES_FixCI(pCI);var vY=pDate.getUTCFullYear();var vD1=DES_GetFirstWeekNumDate(vY,pCI);var vWN=Math.round(1+((pDate-vD1)/(86400000*7)));if(vWN>52){var vD2=DES_GetFirstWeekNumDate(vY+1,pCI);if(vD2<=pDate)vWN=1;}return vWN;}function DES_GetFirstWeekNumDate(pY,pCI){pCI=DES_FixCI(pCI);var vDate=DES_MakeUTCDate(pY,0,1);var vDOW=vDate.getUTCDay();switch(pCI.CWR){case 0:if(vDOW==pCI.FDOW)return vDate;else{var vUTC=vDate.valueOf();if(pCI.FDOW>vDOW)vUTC=vUTC-((vDOW-pCI.FDOW+7)*cMSInDay);else vUTC=vUTC-((vDOW-pCI.FDOW)*cMSInDay);return new Date(vUTC);}break;case 1:if(vDOW==pCI.FDOW)return vDate;else return DES_MakeUTCDate(pY,0,1+(pCI.FDOW+7-vDOW));break;default:if(pCI.FDOW>3)pCI.FDOW=pCI.FDOW+4;if(vDOW<=pCI.FDOW+3){if(vDOW==pCI.FDOW)return vDate;else return DES_MakeUTCDate(pY,0,1+(pCI.FDOW-vDOW));}else return DES_MakeUTCDate(pY,0,1+(pCI.FDOW+7-vDOW));break;}}
var gDES_GetNativeUnassigned={Unassigned:1};var gDES_GetNativeInvalid={Invalid:1};function DES_GetNativeValue(pFId,pCO,pFnc){var vF=DES_GetById(pFId);if(!pFnc&&pCO.GetNative)pFnc=pCO.GetNative;if(pFnc!=null)return pFnc(pFId);var vT=DES_GetTextValue(pFId,pCO.Trim!=null?pCO.Trim:true);if(vT=="")return null;else{if(!pCO.Parse)return vT;var vR=pCO.Parse(pCO,vT);if(vR==null)return gDES_GetNativeInvalid;return vR;}}function DES_GoodNativeVal(pVal){return(pVal!=gDES_GetNativeInvalid)&&(pVal!=gDES_GetNativeUnassigned)&&(pVal!=null);}function DES_Comparer(pCO,pLVal,pRVal,pOp,pFnc){if(pCO){if(!pFnc&&pCO.Compare)pFnc=pCO.Compare;}if(pFnc!=null)return pFnc(pLVal,pRVal,pOp);pLVal=DES_ToPrimitive(pLVal);pRVal=DES_ToPrimitive(pRVal);switch(pOp){case 0:return pLVal==pRVal;case 1:return pLVal!=pRVal;case 2:return pLVal>pRVal;case 3:return pLVal>=pRVal;case 4:return pLVal<pRVal;case 5:return pLVal<=pRVal;}return true;}function DES_StripGrpSep(pGSep,pTxt){var vT='\\{0}';vT=vT.replace('{0}',pGSep);if(pGSep.charCodeAt(0)==160)vT='[ \\xA0]';return DES_RERpl(pTxt,vT,'');}function DES_RplDecSep(pDSep,pTSep,pTxt){if((pDSep!=".")&&(pTxt.indexOf(".")>-1)){var vR=false;if(pTxt.indexOf(pDSep)==-1){if(pTSep!=".")vR=true;else{var vPos1=pTxt.indexOf(pTSep);var vPos2=pTxt.lastIndexOf(pTSep);if((vPos1==-1)||(vPos1==vPos2))vR=true;}if(vR)pTxt=pTxt.replace(".",pDSep);}}return pTxt;}function DES_AddGrpSep(pText,pDSep,pGSep,pTS,pGpSz){if(!pTS)return pText;var vDecPos=pText.indexOf(pDSep);var vR="";var vEndPos=pText.length;if(vDecPos>-1){vR=pText.substring(vDecPos,vEndPos);vEndPos=vDecPos;}if(pGpSz!=null){var vSzIdx=0;var vNxtP=pGpSz[0];var vPos=0;for(var vI=vEndPos-1;vI>=0;vI--){vR=pText.charAt(vI)+vR;if(vI==0)break;vPos++;if(vPos==vNxtP){vR=pGSep+vR;if(vSzIdx<pGpSz.length-1)vSzIdx++;if(pGpSz[vSzIdx]==0)vNxtP=999;else vNxtP=vNxtP+pGpSz[vSzIdx];}}}else{vDecPos=vEndPos-3;while(vEndPos>3){if(vDecPos<0)vDecPos=0;vR=pGSep+pText.substring(vDecPos,vEndPos)+vR;vDecPos=vDecPos-3;vEndPos=vEndPos-3;}if(vEndPos>0)vR=pText.substring(0,vEndPos)+vR;}return vR;}
function DES_DTCParseStr(pCO,pTxt){return pTxt;}function DES_DTCParseCIStr(pCO,pTxt){return pTxt.toUpperCase();}function DES_DTCParseInt(pCO,pTxt){if(window.DES_DTTBFixCO)pCO=DES_DTTBFixCO(pCO);var vCI=DES_GetCulture(pCO.AO);if(pCO.NoTS&&vCI.NGSep&&(pTxt.indexOf(vCI.NGSep)>-1))return null;pTxt=DES_StripGrpSep(vCI.NGSep,pTxt);var vVal=DES_ParseInt(pTxt);vVal=isNaN(vVal)?null:vVal;if(!pCO.Neg&&(vVal!=null)&&(vVal<0))vVal=null;if((vVal!=null)&&((vVal>2147483647)||(vVal<-2147483648)))vVal=null;return vVal;}function DES_DTCParseDec(pCO,pTxt){if(window.DES_DTTBFixCO)pCO=DES_DTTBFixCO(pCO);var vCI=DES_GetCulture(pCO.AO);if(pCO.Per)pTxt=DES_RplDecSep(vCI.NDSep,vCI.NGSep,pTxt);if(pCO.NoTS&&vCI.NGSep&&(pTxt.indexOf(vCI.NGSep)>-1))return null;pTxt=DES_StripGrpSep(vCI.NGSep,pTxt);if(!vCI.DecRE){var vPtrn="^\\s*([-\\+])?(\\d+)?(\\{0})?(\\d+)?\\s*$";vPtrn=vPtrn.replace("{0}",vCI.NDSep);vCI.DecRE=new RegExp(vPtrn);}var m=pTxt.match(vCI.DecRE);if(m==null)return null;var vPrepVal=(m[1]!=null?m[1]:"")+((m[2]!=null)&&(m[2].length>0)?m[2]:"0")+"."+(m[4]!=null?m[4]:"");var vVal=parseFloat(vPrepVal);vVal=isNaN(vVal)?null:vVal;if(!pCO.Neg&&(vVal!=null)&&(vVal<0.0))vVal=null;if(pCO.mxdec&&(vVal!=null)){var vT2=DES_DecToStr(vVal);var vDP=vT2.indexOf('.');if((vDP>-1)&&(vDP+pCO.mxdec+1<vT2.length))vVal=null;}return vVal;}
function DES_DTCParseDate(pCO,pTxt){if(window.DES_DTTBFixCO)pCO=DES_DTTBFixCO(pCO);var vCI=DES_GetCulture(pCO.AO);pTxt=DES_Trim(pTxt);if(pTxt.length==0)return null;var vD=-1;var vM=-1;var vY=-1;var vSDO=vCI.SDO.split('|');var vDSep=vCI.DSep;if(pTxt.indexOf(vDSep)==-1)if(pTxt.indexOf('-')==4){vDSep='-';vSDO=new Array("Y","M","D");}else return null;var vParts=pTxt.split(vDSep);var vPL=vParts.length;if(vPL!=3)if((vPL==4)&&(vParts[3]==""))vPL--;else return null;var vDateCount=0;for(var vI=0;vI<vPL;vI++){var vPV=DES_ParseInt(vParts[vI]);if(isNaN(vPV))return null;switch(vSDO[vI].charAt(0)){case'D':if((vPV<=0)||(vPV>31))return null;vD=vPV;break;case'M':if((vPV>12)||(vPV<=0))return null;vM=vPV;break;case'Y':if(vPV<1)return null;if(vPV<100){if((vCI.CBrk==0)||(vPV<=vCI.CBrk))vPV=vPV+2000;else vPV=vPV+1900;}vY=vPV;if(vY>9999)return null;break;}}vM-=1;var vR=new Date(vY,vM,vD);if(vR==null)return null;else return(vY==vR.getFullYear()&&vM==vR.getMonth()&&vD==vR.getDate())?vR:null;}function DES_DTCFmtDate(pAO,pVal){var vCI=DES_GetCulture(pAO);return DES_FmtDate(pVal,0,vCI.SDP,vCI);}function DES_DTCParseDur(pCO,pTxt){if(window.DES_DTTBFixCO)pCO=DES_DTTBFixCO(pCO);var vCI=DES_GetCulture(pCO.AO);pTxt=DES_Trim(pTxt);if(pTxt.length==0)return null;var vTSep=vCI.TSep;var vT=[0,0,0];pTxt=pTxt.toLowerCase();var vIsPM=pTxt.indexOf(vCI.PMD.toLowerCase())>-1;var vAPD=vIsPM?vCI.PMD:vCI.AMD;pTxt=pTxt.replace(vAPD.toLowerCase(),"");pTxt=DES_Trim(pTxt);var vSeg=0;var vCC=0;for(var vPos=0;vPos<pTxt.length;vPos++){var vChar=pTxt.charAt(vPos);if(vChar==vTSep){vSeg++;if(vSeg>2)return null;if((vPos==0)||(vPos==pTxt.length-1))return null;if((vSeg>0)&&(vCC>2))return null;vCC=0;}else if((vChar>='0')&&(vChar<='9')){vT[vSeg]=vT[vSeg]*10+parseInt(vChar);vCC++;}else return null;}if(vT[0]<12&&vIsPM)vT[0]=vT[0]+12;if((pCO.MaxHrs!=null)&(vT[0]>pCO.MaxHrs))return null;if(vT[1]>59)return null;if(vT[2]>59)return null;return vT[0]*3600+vT[1]*60+vT[2];}function DES_DTCParseTOD(pCO,pTxt){pCO.MaxHrs=23;return DES_DTCParseDur(pCO,pTxt);}function DES_DTCParseCurr(pCO,pTxt){if(window.DES_DTTBFixCO)pCO=DES_DTTBFixCO(pCO);var vCI=DES_GetCulture(pCO.AO);if(pCO.Sym){if(!vCI.CurrRE){var vSym=(vCI.CSym=='$')?"\\$":vCI.CSym;vCI.CurrRE=new RegExp("\\s*("+vSym+")\\s*","gi");}var m=pTxt.match(vCI.CurrRE);if(m!=null){if(m.length>1)return null;if((m.length==1)&&(m[0]!=""))pTxt=pTxt.replace(vCI.CurrRE,"");}}pTxt=DES_Trim(pTxt);var vTxtLen=pTxt.length;if(vTxtLen==0)return null;if(pCO.Per)pTxt=DES_RplDecSep(vCI.CDSep,vCI.CGSep,pTxt);if(pCO.NoTS&&vCI.CGSep&&(pTxt.indexOf(vCI.CGSep)>-1))return null;var vPos=0;var vChar=pTxt.charAt(0);var vLParen=vChar=="(";var vNeg=vLParen||(vChar=="-");if((vChar=="+")||vNeg){vPos++;vChar=pTxt.charAt(vPos);}var vDecStr="";var vDone=false;var vCvGS=(vCI.CGSep=="\xA0");do{if(vCvGS&&(vChar==" "))vChar="\xA0";if((vChar>="0")&&(vChar<="9"))vDecStr+=vChar;else if(vChar!=vCI.CGSep)vDone=true;if(!vDone)if(++vPos<vTxtLen)vChar=pTxt.charAt(vPos);else vDone=true;}while(!vDone);if(vChar==vCI.CDSep){vDecStr+=".";var vDigCnt=0;vDone=false;if(++vPos<vTxtLen){vChar=pTxt.charAt(vPos);do{if((vChar>="0")&&(vChar<="9")){vDecStr+=vChar;vDigCnt++;}else vDone=true;if(!vDone)if(++vPos<vTxtLen)vChar=pTxt.charAt(vPos);else vDone=true;}while(!vDone);}var vCDDig=(pCO.CDDig!=null)?pCO.CDDig:vCI.CDDig;if(vDigCnt>vCDDig)return null;}if(vChar==" "){vPos++;if(vPos<vTxtLen)vChar=pTxt.charAt(vPos);}var vRParen=vChar==")";if(vRParen)vPos++;else if(vChar=="-"){vNeg=true;vPos++;}if((vPos<vTxtLen)||(vLParen!=vRParen))return null;var vR=parseFloat(vDecStr);if(isNaN(vR))return null;if(vNeg)if(!pCO.Neg)vR=null;else vR=-vR;return vR;}function DES_DTCFmtCurr(pAO,pVal){var vCI=DES_GetCulture(pAO);var vR=DES_DecToStr(Math.abs(pVal));var vMinDig=pAO.wno?0:vCI.CDDig;if(vMinDig>0){var vPos=vR.indexOf(".");if((vPos>-1)||!pAO.hidezero){var vNeeded=(vPos==-1)?vMinDig:(vMinDig-(vR.length-vPos-1));if(vPos==-1)vR=vR+".";if(vNeeded>0)vR=vR+String("00000000").substr(0,vNeeded);}}if(vCI.CDSep!=".")vR=vR.replace(".",vCI.CDSep);vR=DES_AddGrpSep(vR,vCI.CDSep,vCI.CGSep,pAO.Cond.ShowTS,vCI.GpSz);var vT="{0}";if(pVal>=0){if(pAO.Sym)vT=vCI.PosC;}else if(pAO.Sym)vT=vCI.NegC;else vT=vCI.NegN;return vT.replace("{0}",vR);}function DES_DTCParsePct(pCO,pTxt){if(window.DES_DTTBFixCO)pCO=DES_DTTBFixCO(pCO);var vCI=DES_GetCulture(pCO.AO);if(pCO.Sym)while(pTxt.indexOf(vCI.PSym)>-1)pTxt=pTxt.replace(vCI.PSym,"");pTxt=DES_Trim(pTxt);if(pTxt=="")return null;if(pCO.NoTS&&vCI.NGSep&&(pTxt.indexOf(vCI.NGSep)>-1))return null;if(vCI.NDSep!=" ")while(pTxt.indexOf(" ")>-1)pTxt=pTxt.replace(" ","");var vIsNeg=false;while(pTxt.indexOf("-")>-1){pTxt=pTxt.replace("-","");vIsNeg=true;}var vVal=DES_DTCParseDec(pCO,pTxt);if(vVal!=null){if(pCO.WNO){vVal=DES_Round(vVal,0,0);}if(vIsNeg)if(pCO.Neg)vVal=-vVal;else vVal=null;}return vVal;}function DES_DTCFmtPct(pAO,pVal){var vPosV=Math.abs(pVal);var vTxt=DES_DTCFmtDec(pAO,vPosV);var vCI=DES_GetCulture(pAO);var vT="{0}";if(pVal>=0){if(pAO.Sym)vT=vCI.PosP;}else if(pAO.Sym)vT=vCI.NegP;else vT=vCI.NegN;return vT.replace("{0}",vTxt);}//DES_DTCFmtPct
function DES_DTCFmtInt(pAO,pVal){var vCI=DES_GetCulture(pAO);var vR=Math.abs(pVal).toString();vR=DES_AddGrpSep(vR,vCI.NDSep,vCI.NGSep,pAO.Cond.ShowTS);if(vR.length<pAO.FLZ){vT="0000000000";vR=vT.substr(0,pAO.FLZ-vR.length)+vR;}if(pVal<0)vR=vCI.NegN.replace("{0}",vR);return vR;}function DES_DTCFmtDec(pAO,pVal){var vCI=DES_GetCulture(pAO);var vR=DES_DecToStr(Math.abs(pVal));if((pAO.trzero!=0)&&(vR.indexOf(".")==-1))vR=vR+".0";if(pAO.trzero>0){var vN=pAO.trzero-(vR.length-vR.indexOf(".")-1);if(vN>0)vR=vR+String("000000000000000000").substr(0,vN);}if(vCI.NDSep!=".")vR=vR.replace(".",vCI.NDSep);vR=DES_AddGrpSep(vR,vCI.NDSep,vCI.NGSep,pAO.Cond.ShowTS);if(pVal<0)vR=vCI.NegN.replace("{0}",vR);return vR;}
function DES_InitBEOs(pBEOs,pBtns){for(var vI=0;vI<pBtns.length;vI++){var vBEO=pBEOs[pBtns[vI].p];DES_BEOAttach(pBtns[vI].i,vBEO);}}var gDES_BEORegex=null;function DES_BEOAttach(pId,pBEO){var vBtn=DES_GetById(pId);if(vBtn&&!vBtn.BEO){vBtn.BEO=pBEO;vBtn.NoDrag=1;if(pBEO.None)return;DES_BEOPrepUrls(pBEO);vBtn.onmousedown=new Function("DES_BEOShow('"+vBtn.id+"', 1);");vBtn.onmouseup=new Function("DES_BEOShow('"+vBtn.id+"', 0);");vBtn.onmouseout=new Function("DES_BEOShow('"+vBtn.id+"', 0);");vBtn.onmouseover=new Function("DES_BEOShow('"+vBtn.id+"', 2);");}}function DES_BEOPrepUrls(pBEO){if(pBEO.UrlInited)return;pBEO.UrlInited=1;if(pBEO.Url){if(!gDES_BEORegex)gDES_BEORegex=new RegExp('(\.[A-Za-z\d]+)$');var vR=gDES_BEORegex.exec(pBEO.Url);if(vR){if(pBEO.PU)pBEO.PUrl=pBEO.Url.replace(vR[1],"Pressed"+vR[1]);if(pBEO.MU)pBEO.MUrl=pBEO.Url.replace(vR[1],"MouseOver"+vR[1]);}DES_Preload(pBEO.Url);DES_Preload(pBEO.PUrl);DES_Preload(pBEO.MUrl);}}var gDES_BEODelay=null;function DES_BEOPrep(pId,pBEO){if(!gDES_BEODelay)gDES_BEODelay=new Array();gDES_BEODelay[gDES_BEODelay.length]={id:pId,BEO:pBEO}}function DES_BEODone(){if(gDES_BEODelay){for(var vI=0;vI<gDES_BEODelay.length;vI++){var vO=gDES_BEODelay[vI];DES_BEOAttach(vO.id,vO.BEO);}gDES_BEODelay=null;}}function DES_BEOShow(pId,pAct){var vBtn=DES_GetById(pId);var vBEO=vBtn.BEO;if(vBEO&&(vBtn.disabled!=true)){var vCtl=vBEO.Par?vBtn.parentNode:vBtn;switch(pAct){case 0:if(vBEO.Css)vCtl.className=vBEO.Css;if(vBEO.Url)vBtn.src=vBEO.Url;break;case 1:if(vBEO.Css)vCtl.className=vBEO.Css+" "+vBEO.Css+"Pressed";if(vBEO.PUrl)vBtn.src=vBEO.PUrl;break;case 2:if(vBEO.Css)vCtl.className=vBEO.Css+" "+vBEO.Css+"MouseOver";if(vBEO.MUrl)vBtn.src=vBEO.MUrl;break;}}}function DES_BtnHTML(pID,pTxt,pBEO,pTT,pOnC){if(!pTxt)pTxt="";var vBH=pBEO.Url?"<img border='0' ":"<span ";vBH+="id='"+pID+"' ";if(pBEO.Css)vBH+="class='"+pBEO.Css+"' ";if(pBEO.Url){vBH+="src='"+pBEO.Url+"' ";vBH+="alt='"+pTxt+"' ";}vBH+="title='"+(pTT?pTT:pTxt)+"' ";if(pOnC)vBH+="onclick=\""+pOnC+"\" ";if(pBEO.Url)vBH+=" />";else{vBH+=">"+pTxt+"</span>";}DES_BEOPrep(pID,pBEO);return vBH;}function DES_MouseOver(pFID,pCss){var vF=DES_GetById(pFID);if(vF.className.indexOf(pCss)>-1)return;vF.OldMOCss=vF.className;DES_ApplyCssPlus(vF,pCss);vF.MOCss=vF.className;}function DES_MouseOut(pFID){var vF=DES_GetById(pFID);if((vF.OldMOCss!=null)&&(vF.MOCss==vF.className))vF.className=vF.OldMOCss;}function DES_AddMouseOverHtml(pID,pMO,pAltFnc){var vH="";if(pMO.MOCss){if(!pAltFnc)pAltFnc="DES_MouseOver";vH="onmouseover=\"if (window."+pAltFnc+"){"+pAltFnc+"('"+pID+"','"+pMO.MOCss+"');}\" ";vH+="onmouseout=\"DES_MouseOut('"+pID+"');\" ";}return vH;}function DES_AddMouseOverEvents(pFld,pMO,pAltFnc){if(pMO.MOCss){if(!pAltFnc)pAltFnc="DES_MouseOver";pFld.onmouseover=new Function(pAltFnc+"('"+pFld.id+"','"+pMO.MOCss+"');");pFld.onmouseout=new Function("DES_MouseOut('"+pFld.id+"');");}}var gDES_DragG={IsD:0,X:0,Y:0,Fld:null,Dn:0};function DES_DragInit(pFld,pDrgFld){if(!(gDES_BI.IEWin55||gDES_BI.Gecko||gDES_BI.Safari||gDES_BI.Opera7))return;if(!pDrgFld)return;pDrgFld.DragOwner=pFld;if(pFld.addEventListener){pDrgFld.addEventListener("mousedown",DES_DragMS,true);pDrgFld.addEventListener("mousemove",DES_DragMM,true);pDrgFld.addEventListener("mouseup",DES_DragME,true);if(!gDES_DragG.DocInit){document.addEventListener("mouseup",DES_DragME,false);gDES_DragG.DocInit=1;}}else{pDrgFld.attachEvent("onmousedown",new Function("DES_DragMS(window.event);"));pDrgFld.attachEvent("onmousemove",new Function("DES_DragMM(window.event);"));var vME=new Function("DES_DragME();");pDrgFld.attachEvent("onmouseup",vME);pDrgFld.attachEvent("ondragstart",new Function("DES_StopEvent(window.event);return false;"));}}function DES_DragMS(pE){if(gDES_DragG.Fld)DES_DragME();gDES_DragG.X=pE.clientX;gDES_DragG.Y=pE.clientY;var vF=DES_Target(pE);for(var vSE=vF;(vSE!=document)&&(vSE!=null);vSE=vSE.parentNode){if(vSE.NoDrag)return;if(vSE.DragOwner){vF=vSE;break;}}gDES_DragG.Fld=vF;if(vF.setCapture)vF.setCapture(true);gDES_DragG.Dn=1;}function DES_DragMM(pE){var vF=gDES_DragG.Fld;if(!vF||!gDES_DragG.Dn)return;vF=vF.DragOwner;var vLP=DES_GetLeftPos(vF);var vTP=DES_GetTopPos(vF);var vIX=pE.clientX-gDES_DragG.X;var vIY=pE.clientY-gDES_DragG.Y;if(gDES_DragG.IsD){if(vIX!=0)DES_SetLeftPos(vF,vLP+vIX);if(vIY!=0)DES_SetTopPos(vF,vTP+vIY);gDES_DragG.X=pE.clientX;gDES_DragG.Y=pE.clientY;if(vF.IEFix){vF.IEFix.pixelTop=vF.style.pixelTop;vF.IEFix.pixelLeft=vF.style.pixelLeft;}}else{if((Math.abs(vIX)>=4)||(Math.abs(vIY)>=4)){if(window.DES_COHide)DES_COHide(vF);if(window.gDES_PV){gDES_PV.IncOpq=-gDES_PV.BIncOpq;gDES_PV.PV.Solid=0;DES_PVOpqChg(0);}gDES_DragG.IsD=1;DES_DragMM(pE);}}}function DES_DragME(){var vF=gDES_DragG.Fld;if(vF){if(vF.releaseCapture)vF.releaseCapture();gDES_DragG.IsD=0;gDES_DragG.Fld=null;gDES_DragG.Dn=0;if(window.gDES_PV&&gDES_PV.PV){gDES_PV.IncOpq=gDES_PV.BIncOpq;gDES_PV.PV.Solid=1;DES_PVOpqChg(0);}}}
var gDES_PUMOG={Cur:null,Tmr:null};function DES_InitPUMOs(pL){for(var vI=0;vI<pL.length;vI++)DES_InitPUMO(pL[vI]);}function DES_InitPUMO(pPUMO){var vF=DES_GetById(pPUMO.TId);if(!vF)return;vF.PUMO=pPUMO;var vF1=new Function("DES_PUMOMouseIn(this);");var vF2=new Function("DES_PUMOStopTimer(this);");if(gDES_BI.IEWin55){vF.onmouseenter=vF1;vF.onmouseleave=vF2;}else{vF.onmouseover=vF1;vF.onmouseout=vF2;}DES_AttachEvent(vF,"onmousedown","DES_PUMOStopTimer(this);",true);}function DES_PUMOMouseIn(pFId){DES_PUMOStopTimer(pFId);var vF=DES_GetById(pFId);if(!vF)return;if(vF.PUMO.Del==0)DES_PUMOPopup(pFId);else gDES_PUMOG.Tmr=window.setTimeout("DES_PUMOPopup(DES_GetById('"+vF.PUMO.TId+"'));",vF.PUMO.Del);}function DES_PUMOPopup(pFId){var vF=DES_GetById(pFId);if(!vF)return;var vP=DES_GetById(vF.PUMO.PId);var vCurTId=null;if(gDES_PUMOG.Cur!=null)vCurTId=gDES_PUMOG.Cur.TId;if(!vP||!vP.Poppedup||(vF.id!=vCurTId)){gDES_PUMOG.Cur=vF.PUMO;if(vF.CM)DES_ForcePopupMenu(vF.CM);else{window.gDES_NoFC=true;DES_FireEvent(vF,"click","MouseEvents");window.gDES_NoFC=false;}}gDES_PUMOG.Tmr=null;}function DES_PUMOStopTimer(pFId){var vF=DES_GetById(pFId);if(!vF)return;if(gDES_PUMOG.Cur&&vF.PUMO.Exit)DES_PVPopDown();if(gDES_PUMOG.Tmr){window.clearTimeout(gDES_PUMOG.Tmr);gDES_PUMOG.Tmr=null;gDES_PUMOG.Cur=null;}}//DES_PUMOStopTimer
function CSC_GetDate(pCalCId){return DES_CALGetDate(pCalCId);}function CSC_GetDateString(pCalCId,pPattern,pFormat){return DES_CALGetDateString(pCalCId,pPattern,pFormat);}function CSC_GetYear(pCalCId){return DES_CALGetYear(pCalCId);}function CSC_GetMonth(pCalCId){return DES_CALGetMonth(pCalCId);}function CSC_GetDay(pCalCId){return DES_CALGetDay(pCalCId);}function CSC_SetDate(pCalCId,pY,pM,pDay,pChangeMonth,pFB){return DES_CALSetDate(pCalCId,pY,pM,pDay,pChangeMonth,pFB);}function CSC_SetNoSelection(pCalCId,pShowTodayMonth,pFB){DES_CALSetNoSelection(pCalCId,pShowTodayMonth,pFB);}function CSC_ViewDate(pCalCId,pYear,pMonth){DES_CALViewDate(pCalCId,pYear,pMonth);}function CSC_ViewMonth(pCalCId,pMonth){DES_CALViewMonth(pCalCId,pMonth);}function CSC_ViewYear(pCalCId,pYear){DES_CALViewYear(pCalCId,pYear);}function CSC_GetViewedMonth(pCalCId){return DES_CALGetViewedMonth(pCalCId);}function CSC_GetViewedYear(pCalCId){return DES_CALGetViewedYear(pCalCId);}function CSC_JumpMonths(pCalId,pFwd){DES_CALJumpMonths(pCalId,pFwd);}function CSC_ViewMonthByCount(pCalCId,pJumpMonths){DES_CALViewMonthByCount(pCalCId,pJumpMonths);}function CSC_ShowSelection(pCalCId){DES_CALShowSelection(pCalCId);}function CSC_ShowToday(pCalCId,pFB){DES_CALShowToday(pCalCId,pFB);}function CSC_ShowSpecial(pCalCId,pFB){DES_CALShowSpecial(pCalCId,pFB);}function CSC_Apply(pCalCId){DES_CALApply(pCalCId);}function CSC_ClearCmd(pCalCId){DES_CALClearCmd(pCalCId);}function CSC_Show(pCalCId){DES_CALShow(pCalCId);}function DTB_GetTodayDate(pTBId){return DES_DTBTodayDate(pTBId);}function DTB_GetSpecialDate(pTBId){return DES_DTBSpecialDate(pTBId);}function DTB_AssignToday(pTBId){DES_DTBTodayCmd(pTBId);}function DTB_AssignSpecialDate(pTBId){DES_DTBSpecialCmd(pTBId);}function DTB_IncDate(pTBId,pDays){return DES_DTBAddDays(pTBId,pDays);}function DTB_AddMonth(pTBId,pAdd){return DES_DTBAddMonths(pTBId,pAdd);}function DTB_IsEmpty(pTBId){return DES_TBIsBlank(DES_GetById(pTBId));}function DTB_GetDateValue(pTBId){return DES_GetDTTBValue(pTBId);}function DTB_ParseDate(pTBId,pText){return DES_DTBParseDate(pTBId,pText);}function DTB_SetDateValue(pTBId,pDate,pAfter){DES_SetDTTBValue(pTBId,pDate,4);}function DTB_GetMinDate(pTBFld){return DES_DTBMinDate(pTBFld);}function DTB_GetMaxDate(pTBFld){return DES_DTBMaxDate(pTBFld);}function DTB_SetMinDate(pTBFld,pDate){DES_DTBSetMinDate(pTBFld,pDate);}function DTB_SetMaxDate(pTBFld,pDate){DES_DTBSetMaxDate(pTBFld,pDate);}function DTB_SetDateYMD(pTBId,pYear,pMonth,pDay,pAfter){DES_DTBSetDate(pTBId,pYear,pMonth,pDay,4);}function PDP_FmtDate(pYear,pMonth,pDay,pPattern,pFormat){return DES_FmtDate(pYear,pMonth,pDay,pPattern,pFormat,gDES_CultureInfo);}function PDP_FmtDate2(pDate,pPattern,pFormat){return DES_FmtDate2(pDate,pPattern,pFormat,gDES_CultureInfo);}function PDP_MakeUTCDate(pY,pM,pD){return DES_MakeUTCDate(pY,pM,pD);}function PDP_ParseInt(pValue){return DES_ParseInt(pValue);}function PDP_Trunc(pDecimal){return DES_Trunc(pDecimal);}function PDP_SetInnerHTML(pFld,pValue){DES_SetInnerHTML(pFld,pValue);}function PDP_GetById(pId){return DES_GetById(pId);}function PDP_AttachEvent(pFld,pEvtName,pCode,pFst){DES_AttachEvent(pFld,pEvtName,pCode,pFst);}function FMP_SelectMonthYear(pFMPId,pMonth,pYear){DES_FYPSelectMonthYear(pFMPId,pMonth,pYear);}function FMP_GetMonth(pFMPId){return DES_FYPGetMonth(pFMPId);}function FMP_GetYear(pFMPId){return DES_FYPGetYear(pFMPId);}function MYP_SelectMonthYear(pMYPId,pMonth,pYear){DES_MYPSelectMonthYear(pMYPId,pMonth,pYear);}function MYP_GetMonth(pMYPId){return DES_MYPGetMonth(pMYPId);}function MYP_GetYear(pMYPId){return DES_MYPGetYear(pMYPId);}function MSC_SetRange(pCalCId,pStart,pEnd,pAction){DES_MSCSetRange(pCalCId,pStart,pEnd,pAction);}function MSC_GetLastClickedDate(pCalCId,pSel){return DES_MSCGetLastClickedDate(pCalCId,pSel);}function MSC_GetRange(pCalCId,pLow){return DES_MSCGetRange(pCalCId,pLow);}function MSC_GetSelectedCount(pCalCId){return DES_MSCGetSelectedCount(pCalCId);}function TP_GetValue(pTPId){return DES_TPGetValue(pTPId);}function TP_SetValue(pTPId,pSeconds){DES_TPSetValue(pTPId,pSeconds);}function TP_IsTimeInPicker(pTPId,pSeconds){return DES_TPIsTimeInPicker(pTPId,pSeconds);}function TP_ScrollIntoView(pTPId){DES_TPScrollIntoView(pTPId);}function TMTB_AssignNow(pTBId,pDTBId){DES_TMTBNowCmd(pTBId);}function TMTB_AddSeconds(pTBId,pDTBId,pSeconds){return DES_TMTBAddSeconds(pTBId,pSeconds);}function TMTB_IsEmpty(pTBId){return DES_TBIsBlank(DES_GetById(pTBId));}function TMTB_GetTimeValue(pTBId){return DES_GetDTTBValue(pTBId);}function TMTB_SetTimeValue(pTBId,pTime,pAfter){DES_SetDTTBValue(pTBId,pTime,4);}function TMTB_GetMinTime(pTBFld){return DES_TMTBMinTime(pTBFld);}function TMTB_GetMaxTime(pTBFld){return DES_TMTBMaxTime(pTBFld);}
var gDES_PopupCId=new Array("","","","","");var gDES_ToggleCId=new Array("","","","","");var gDES_PUNPos=-1;function DES_InitPopups(pL){for(var vI=0;vI<pL.length;vI++)DES_InitPopup(pL[vI]);}function DES_InitPopup(pPO){var vOF;if(pPO.OwnID)vOF=DES_GetById(pPO.OwnID);DES_FixPO(pPO);DES_RelocatePopup(DES_GetById(pPO.id));if(vOF){vOF.PO=pPO;vOF.onfocus=new Function("DES_HideFocus('"+vOF.id+"', true);");}else DES_GetById(pPO.id).PO=pPO;}function DES_FixPO(pPO){if(pPO.HPos==null)pPO.HPos=2;if(pPO.VPos==null)pPO.VPos=0;if(pPO.HPosOf==null)pPO.HPosOf=0;if(pPO.VPosOf==null)pPO.VPosOf=0;}function DES_TogglePopup(pTId,pPId,pOnPopup){var vPC=DES_GetById(pPId);if(vPC.style.visibility=="inherit"){DES_ClosePopup();}else{DES_OpenPopup(pTId,pPId,true,pOnPopup);}}function DES_OpenPopup(pTId,pPId,pClick,pOnPopup,pCstZO,pNoCls){var vTC=null;if(pTId!="")vTC=DES_GetById(pTId);if(vTC!=null)if(vTC.disabled)return;if(!pNoCls){if(pClick&&window.event)DES_TestClickDOM(window.event);if(gDES_PUNPos>=gDES_PopupCId.length)return;}var vPC=DES_GetById(pPId);var vPO=(vTC&&vTC.PO)?vTC.PO:vPC.PO;if(!vPO){vPO={id:pPId};DES_FixPO(vPO);if(vTC)vTC.PO=vPO;else vPC.PC=vPO;}vPC.PO=vPO;if(vTC&&window.DES_COInit)DES_COInit(vTC,vPC);if(vPO.PUS&&window.DES_AddShadow)DES_AddShadow(vPC);var vFlt=(vPO.PUT&&window.DES_PopupTransform)?DES_PopupTransform(vPC,1):null;var vOPUFnc="";if(pOnPopup!=null)vOPUFnc=pOnPopup;else vOPUFnc=vPO.onpopup;if((vOPUFnc!=null)&&(vOPUFnc!="")){if(vOPUFnc.indexOf("{")>-1){vOPUFnc=vOPUFnc.replace("{TID}",pTId);vOPUFnc=vOPUFnc.replace("{PID}",pPId);}var vResult=true;eval(vOPUFnc);if(vResult==false){if(vFlt)vFlt.play();return;}}if(!pNoCls){gDES_PUNPos++;gDES_PopupCId[gDES_PUNPos]=pPId;gDES_ToggleCId[gDES_PUNPos]=pTId;}vPC.style.zIndex=pCstZO?pCstZO:(30000+gDES_PUNPos);if(vTC!=null)DES_PositionPopupToToggle(vTC,vPC);DES_MSIEFixPopupOpen(vPC,pCstZO?pCstZO-10:gDES_PUNPos);vPC.style.visibility="inherit";vPC.Poppedup=true;if(vPC.focus&&!vPC.NoFocus)setTimeout("javascript:var vPC2 = DES_GetById('"+pPId+"'); if (vPC2.Poppedup && (vPC2.style.visibility = 'inherit')) vPC2.focus();",50);if(!pNoCls){if(document.attachEvent){if(gDES_PUNPos==0)document.attachEvent("onmousedown",DES_TestClickIE);}else if(document.addEventListener){if(gDES_PUNPos==0)document.addEventListener("mousedown",DES_TestClickDOM,false);}else document.onmousedown=DES_TestClickIE;}vPO.NoCls=pNoCls;if(vFlt)vFlt.play();}function DES_OpenPopupAtMousePoint(pPId,pE){if((document.body.scrollTop==null)&&(window.pageXOffset))return;DES_TestClickDOM(pE);if(gDES_PUNPos>=gDES_PopupCId.length)return;var vPC=DES_GetById(pPId);vPC.style.position="absolute";var vCX=DES_GetScrolledX(vPC,pE.clientX,true);var vCY=DES_GetScrolledY(vPC,pE.clientY,true);vCX=DES_GetOffsetX(vPC,vCX,-1);vCY=DES_GetOffsetY(vPC,vCY,-1);if(gDES_BI.IEMac){vCX=vCX+10;vCY=vCY+15;}if(gDES_BI.Safari){vCX=vCX+document.body.offsetLeft;vCY=vCY+document.body.offsetTop;}DES_SetLeftPos(vPC,vCX);DES_SetTopPos(vPC,vCY);vPC.style.zIndex=30000+gDES_PUNPos+1;if((gDES_PUNPos==-1)||(gDES_PopupCId[gDES_PUNPos]!=pPId))DES_OpenPopup("",pPId,true);}function DES_ClosePopup(pPId){if(!pPId&&(gDES_PUNPos==-1))return;var vPC=DES_GetById(pPId?pPId:gDES_PopupCId[gDES_PUNPos]);var vPO=vPC.PO;var vNC=vPO.NoCls;var vFlt=(vPO.PUT&&window.DES_PopupTransform)?DES_PopupTransform(vPC,0):null;if(vPO.onpopdown)eval(vPO.onpopdown);vPC.style.visibility="hidden";if(window.DES_COHide)DES_COHide(vPC);vPC.Poppedup=false;if(!vNC){if(document.detachEvent){if(gDES_PUNPos==0)document.detachEvent("onmousedown",DES_TestClickIE);}else if(document.removeEventListener){if(gDES_PUNPos==0)document.removeEventListener("mousedown",DES_TestClickDOM,false);}}DES_MSIEFixPopupClose(vPC);if(!vNC){gDES_PopupCId[gDES_PUNPos]="";gDES_ToggleCId[gDES_PUNPos]="";gDES_PUNPos--;}if(vFlt)vFlt.play();if(!vNC&&(gDES_PUNPos>-1)){DES_SetFocus(gDES_PopupCId[gDES_PUNPos]);}}function DES_CloseAllPopups(){while(gDES_PUNPos>-1)DES_ClosePopup();}function DES_DelayedClosePopup(){window.setTimeout("DES_ClosePopup();",100);}function DES_PositionPopupToToggle(pTC,pPC){function Shift(pHP,pHO,pVP,pVO){if((pHO>=0)&&pPC.clientWidth&&(pPC.clientWidth<pPC.offsetWidth)){pHO+=(pPC.offsetWidth-pPC.clientWidth)/2;}switch(pHP){case 0:vLP=vLP;break;case 1:vLP=vLP+(vTW-vPW)/2;break;case 2:vLP=vLP+vTW-vPW;break;case 3:vLP=vLP+vTW;break;case 4:vLP=vLP-vPW-vBW;break;}vLP=vLP+pHO;if((pVO>=0)&&pPC.clientHeight&&(pPC.clientHeight<pPC.offsetHeight)){pVO+=(pPC.offsetHeight-pPC.clientHeight)/2;}switch(pVP){case 0:vTP=vTP+vTH;break;case 1:vTP=vTP+(vTH-vPH)/2;break;case 2:vTP=vTP-vPH-vPB;break;case 3:vTP=vTP;break;}vTP=vTP+pVO;}var vTW=pTC.offsetWidth;var vPW=pPC.offsetWidth;var vBW=DES_GetLeftBorder(pPC)*2;var vTH=pTC.offsetHeight;var vPH=pPC.offsetHeight;var vPB=DES_GetTopBorder(pPC)*2;var vPO=pPC.PO;gDES_FixedPos=0;var vLP=DES_GetOffsetX(pTC,pTC.offsetLeft,1);var vTP=DES_GetOffsetY(pTC,pTC.offsetTop,1);if(gDES_BI.IEMac){vLP=vLP+10;vTP=vTP+15;}if(gDES_BI.Safari){vLP=vLP+document.body.offsetLeft;vTP=vTP+document.body.offsetTop;}vLP=DES_GetOffsetX(pPC,vLP,-1,true);vTP=DES_GetOffsetY(pPC,vTP,-1,true);var vSX=DES_GetScrolledX(pTC,0,false);var vSY=DES_GetScrolledY(pTC,0,false);var vPSX=DES_GetScrolledX(pPC,0,false);var vPSY=DES_GetScrolledY(pPC,0,false);if(gDES_BI.Opera7&&!gDES_BI.Opera10&&!gDES_FixedPos)vPSX=vPSY=0;vLP=vLP+vPSX-vSX;vTP=vTP+vPSY-vSY;var vLPS=vLP;var vTPS=vTP;var vHP=vPO?vPO.HPos:2;var vVP=vPO?vPO.VPos:0;var vHO=vPO?vPO.HPosOf:0;if(vHP==4)vHO=-vHO;var vVO=vPO?vPO.VPosOf:0;if(vVP==2)vVO=-vVO;Shift(vHP,vHO,vVP,vVO);var vMvX=0;var vMvY=0;var vDE=document.documentElement;var vDB=document.body;if(!vDE)vDE=vDB;if(gDES_BI.IEWin55||(gDES_BI.Gecko)||gDES_BI.Safari3||gDES_BI.Opera9)if(vDE&&(vDE.offsetWidth!=null)){var vScW=vDE.clientWidth;if(gDES_BI.FireFox15&&!gDES_BI.FireFox3){if(vScW<vDB.clientWidth)vScW=vDB.clientWidth;}else if(!vScW){vScW=vDE.offsetWidth;}var vRP=vLP+pPC.offsetWidth;if(gDES_FixedPos)vSX=DES_GetScrolledX(document.body,0,false);var vRDE=vScW+vSX;if(vRP>vRDE){vLP=vLP-(vRP-vRDE);vMvX=1;}var vScH=vDE.clientHeight;if(gDES_BI.FireFox15&&!gDES_BI.FireFox3){if(vScH<vDB.clientHeight)vScH=vDB.clientHeight;}else if(!vScH){vScH=vDE.offsetHeight;}var vBP=vTP+pPC.offsetHeight;if(gDES_FixedPos)vSY=DES_GetScrolledY(document.body,0,false);var vBDE=vScH+vSY;if(vBP>vBDE){vTP=vTP-(vBP-vBDE);vMvY=1;}}if((window.__smartNav==null)||(!DES_AbsParent(pPC))){if(vLP<0){vLP=0;vMvX=1;}if(vTP<0){vTP=0;vMvY=1;}}if(vPO&&vPO.NoOL){var vXO=0;var vYO=0;if((vHP==1)&&vMvY){if(vLP<vLPS){if(vLP+vPW>vLPS)vXO=1;}else if(vLP<vLPS+vPW)vXO=1;if(vXO&&(vVP>0))vMvX=1;}if((vVP==1)&&vMvX){if(vTP<vTPS){if(vTP+vPH>vTPS)vYO=1;}else if(vTP<vTPS+vPH)vYO=1;if(vYO&&(vHP<3))vMvY=1;}if(vXO&&vYO){if(vHP==1)vMvX=1;if(vVP==1)vMvY=1;}if(vMvY){var vOld=vVP;switch(vVP){case 0:case 3:vVP=2;break;case 2:vVP=0;break;case 1:vVP=vTP>vPH?2:0;break;}vVO=Math.abs(vVO);if(vVP==2)vVO=-vVO;if(((vOld==3)||(vOld==1))&&!vMvX)if(vHP==3)vHP=0;else if(vHP==4)vHP=2;}if(vMvX){var vFV=(vVP==1)||(vVP==3);switch(vHP){case 3:case 0:vHP=2;break;case 4:case 2:vHP=0;break;case 1:vHP=vLP>vPW?2:0;vFV=false;break;}if(vFV){vVP=vTP>vPH?2:0;vVO=Math.abs(vVO);if(vVP==2)vVO=-vVO;}vHO=Math.abs(vHO);if(vHP==4)vHO=-vHO;}if(vMvX||vMvY){vLP=vLPS;vTP=vTPS;Shift(vHP,vHO,vVP,vVO);}}pPC.style.position="absolute";DES_SetLeftPos(pPC,vLP);DES_SetTopPos(pPC,vTP);if(gDES_BI.IEMac){if(pPC.style.pixelWidth=="")pPC.style.pixelWidth=pPC.offsetWidth;if(pPC.style.pixelHeight=="")pPC.style.pixelHeight=pPC.offsetHeight;}if(window.DES_COShow)DES_COShow(pTC,pPC,vLPS,vTPS,vLP,vTP,pPC.style.zIndex);}function DES_TestClickIE(){DES_TestClickDOM(window.event);}function DES_TestClickDOM(pE){if(gDES_PUNPos==-1)return;var vC=0;var vPC=DES_GetById(gDES_PopupCId[gDES_PUNPos]);var vSOld=gDES_BI.Safari&&(gDES_BI.Ver<525.0);var vX=vSOld?pE.clientX:DES_GetScrolledX(vPC,pE.clientX,false);var vY=vSOld?pE.clientY:DES_GetScrolledY(vPC,pE.clientY,false);if(gDES_BI.IEMac&&!gDES_BI.IEMacOSX){vX=vX-10;vY=vY-15;}if(gDES_BI.Safari){vX=vX+document.body.offsetLeft;vY=vY+document.body.offsetTop;}var vLP=DES_GetOffsetX(vPC,vPC.offsetLeft,1);var vTP=DES_GetOffsetY(vPC,vPC.offsetTop,1);if(gDES_BI.Opera7){vLP=vLP-DES_GetLeftBorder(document.body);vTP=vTP-DES_GetTopBorder(document.body);}if(vX<vLP){vC=1;}else if(vX>vLP+vPC.offsetWidth){vC=1;}else if(vY<vTP){vC=1;}else if(vY>vTP+vPC.offsetHeight){vC=1;}if(vC&&(gDES_ToggleCId[gDES_PUNPos]!="")){var vTC=DES_GetById(gDES_ToggleCId[gDES_PUNPos]);var vTL=DES_GetOffsetX(vTC,vTC.offsetLeft,1)-DES_GetLeftBorder(vTC);var vTT=DES_GetOffsetY(vTC,vTC.offsetTop,1)-DES_GetTopBorder(vTC);if((vX>=vTL)&&(vX<=vTL+vTC.offsetWidth)&&(vY>=vTT)&&(vY<=vTT+vTC.offsetHeight))vC=0;}if(vC){DES_ClosePopup();if(gDES_PUNPos>-1)DES_TestClickDOM(pE);}}function DES_MSIEFixPopupOpen(pPC,pOfs){if(gDES_BI.IEWin55&&pPC.PO.IEFix){var vIFrNm="DES_ZIndexFix_"+pPC.id;if(!document.all[vIFrNm]){var vIFrame="<iframe src='javascript:false;' id='"+vIFrNm+"' scrolling='no' frameborder='0'  "+"style='position:absolute;top:0x;left:0px;"+"display:none'></iframe>";var vEl=pPC.parentElement;vEl.insertAdjacentHTML('beforeEnd',vIFrame);}if(document.all[vIFrNm]){var vS=document.all[vIFrNm].style;vS.pixelTop=pPC.style.pixelTop;vS.pixelLeft=pPC.style.pixelLeft;vS.pixelWidth=pPC.offsetWidth+6;vS.pixelHeight=pPC.offsetHeight+6;vS.zIndex=29990-pOfs;vS.filter='progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)';vS.display='block';pPC.IEFix=vS;}}}function DES_MSIEFixPopupClose(pPC){if(gDES_BI.IEWin55&&pPC.PO.IEFix){var vIFrNm="DES_ZIndexFix_"+pPC.id;if(document.all[vIFrNm]){document.all[vIFrNm].style.display='none';}}pPC.IEFix=null;}function DES_RelocatePopup(pPC){var vPN=pPC.parentNode;if((vPN!=null)&&(vPN!=document.body)&&(vPN.tagName!="FORM")&&(window.__smartNav==null)){if((document.body.removeChild!=null)&&((document.body.appendChild!=null)||(document.body.outerHTML!=null))){var vMoving=vPN.removeChild(pPC);var vPH=gDES_Popups;if(vPH==null){vPH=document.createElement("div");vPH.id="DES_Popups";vPH.className="DESNOCLASS";var vForm=document.forms[0];vForm.insertBefore(vPH,vForm.childNodes[0]);gDES_Popups=vPH;}if(vPH.insertAdjacentElement)vPH.insertAdjacentElement("afterEnd",vMoving);else vPH.parentNode.insertBefore(vMoving,vPH.nextSibling);pPC=DES_GetById(pPC.id);}}return pPC;}var gDES_Popups=null;
var gDES_PopupViews=new Array;var gDES_PV={MinO:90,MaxO:100,DlyO:2000,FcsFld:null,HFcsFld:null,TgtID:null,PV:null};function DES_InitPVGbls(pG){if(pG){if(pG.Min)gDES_PV.MinO=pG.Min;if(pG.Max)gDES_PV.MaxO=pG.Max;if(pG.Dly)gDES_PV.DlyO=pG.Dly;}if(gDES_PV.MinO!=100){var vB=Math.round((100-gDES_PV.MinO)/5);if(vB==0)vB=1;gDES_PV.BIncOpq=vB;}}function DES_InitPVs(pL,pRpl){for(var vI=0;vI<pL.length;vI++){var vPV=pL[vI];if(pRpl){for(var vJ=0;vJ<gDES_PopupViews;vJ++)if(gDES_PopupViews[vJ].id==vPV.id){gDES_PopupViews[vJ]=vPV;DES_InitPV(vPV);break;}}if(!pRpl||!vPV.Inited){gDES_PopupViews[gDES_PopupViews.length]=vPV;DES_InitPV(vPV);}}}function DES_InitPV(pPV){if(!pPV.Inited){if(window.DES_BEOPrepUrls){if(pPV.CBBEO)DES_BEOPrepUrls(pPV.CBBEO);if(pPV.HBBEO)DES_BEOPrepUrls(pPV.HBBEO);}DES_Preload(pPV.BImg);if(pPV.PO&&window.DES_COPreload)DES_COPreload(pPV.PO);pPV.Inited=1;}}function DES_PVPopup(pPV,pTgtID,pMsg,pHlp){if(!gDES_PV.Inited){if(window.addEventListener){window.addEventListener("resize",DES_PVRefresh,false);}else if(window.attachEvent)window.attachEvent("onresize",DES_PVRefresh);gDES_PV.Inited=1;}if(gDES_PV.PV){if((pTgtID==gDES_PV.TgtID)&&(gDES_PV.PV==pPV))if((pPV.LastMsg==pMsg)&&(pPV.LastHlp==pHlp)){DES_PVSolid(1);return;}var vPO=pPV.PO;var vSv=vPO.PUT;vPO.PUT=0;DES_PVPopDown();vPO.PUT=vSv;}var vPID=pPV.id;if(!pPV.View){var vPO=pPV.PO;vPO.NoOL=1;DES_FixPO(vPO);vPO.id=vPID;vPO.onpopdown="DES_PVOnPopDown();";pPV.View=DES_GetById(vPID);if(!pPV.View)DES_PVCreate(pPV);pPV.View=DES_GetById(vPID);pPV.View.PO=pPV.PO;pPV.MFld=DES_GetById(vPID+"_Msg");if(pPV.HBBEO)pPV.HFld=DES_GetById(vPID+"_Help");if(pPV.HBA==7)pPV.TFld=DES_GetById(vPID+"_Title");pPV.FtrFld=DES_GetById(vPID+"_Ftr");}var vFull=pMsg;if(pPV.HMTLB)vFull=pPV.HMTLB+pMsg;if(pPV.HMTLA)vFull+=pPV.HMTLA;DES_SetInnerHTML(pPV.MFld,vFull);if(pPV.HFld){if(pPV.FtrFld){pPV.FtrFld.style.visibility=pHlp?"":"hidden";}if(pHlp){if(pPV.HBA==1)pPV.ForHelp=pMsg+pPV.HBSep+pHlp;else if(pPV.HBA==2)pPV.ForHelp=pHlp;else if(pPV.HBA>=10){if(pPV.HFld.tagName=="A")pPV.HFld.href=pPV.href.replace(gDES_PVRE,pHlp);else pPV.HFld.onclick=new Function(pPV.script.replace(gDES_PVRE,pHlp));}}}else if(pPV.HBA==7)DES_SetInnerHTML(pPV.TFld,pHlp?pHlp:pPV.HT);var vTgtF=DES_GetById(pTgtID);var vSPO=vTgtF.PO;vTgtF.PO=pPV.View.PO;var vZI=vTgtF.TT?null:29000;DES_OpenPopup(pTgtID,vPID,0,null,vZI,1);vTgtF.PO=vSPO;gDES_PV.PV=pPV;gDES_PV.TgtID=pTgtID;DES_PVSolid(null);pPV.LastMsg=pMsg;pPV.LastHlp=pHlp;}var gDES_PVRE=/\{0\}/gi;function DES_PVPopDown(){if(gDES_PV.PV){DES_ClosePopup(gDES_PV.PV.id);gDES_PV.PV=null;gDES_PV.TgtID=null;if(window.gDES_HG){gDES_HG.CurFId=null;gDES_HG.CurHO=null;}}}function DES_PVRefresh(){if(gDES_PV.PV){var vTgl=DES_GetById(gDES_PV.TgtID);if(!vTgl||(gDES_PV.PV.HCB&&gDES_InCallback)){DES_PVPopDown();return;}DES_PositionPopupToToggle(vTgl,DES_GetById(gDES_PV.PV.id));}}function DES_PVCreate(pPV){if(pPV.View)return;var vDiv=document.createElement("div");vDiv.id=pPV.id;vDiv.className=pPV.Css;vDiv.style.visibility="hidden";vDiv.style.position="absolute";vDiv.style.left="0px";vDiv.style.top="0px";vDiv.style.width=pPV.Wd;vDiv.NoFocus=1;document.body.appendChild(vDiv);pPV.View=vDiv;var vHdr="";if((pPV.HBA==7)&&!pPV.HT)pPV.HT="&nbsp;";if(pPV.HT||pPV.CBBEO){vHdr="<table id='"+pPV.id+"_TB' style='width:100%;' class='"+pPV.HCss+"' ><tr>";if(pPV.HT){if(!pPV.HHA)pPV.HHA="";vHdr+="<td align='"+pPV.HHA+"' id='"+pPV.id+"_Title'>"+pPV.HT+"</td>";}if(pPV.CBBEO){var vBtn=DES_BtnHTML(pPV.id+"_Close",pPV.CBT,pPV.CBBEO,pPV.CBTT,"DES_PVPopDown();");vHdr+="<td align='right'>"+vBtn+"</td>";}vHdr+="</tr></table>";}var vBody="";if(pPV.bfnc)vBody=pPV.bfnc(pPV);if(!vBody)vBody+="<div id='"+pPV.id+"_Msg' class='"+pPV.BCss+"' ></div>";var vFtr="";if(pPV.HBBEO){if(!pPV.FHA)pPV.FHA="";vFtr="<table id='"+pPV.id+"_Ftr' style='width:100%;' ><tr class='"+pPV.FCss+"'><td align='"+pPV.FHA+"' >";var vHBtn=DES_BtnHTML(pPV.id+"_HB",pPV.HBT,pPV.HBBEO,null,null);switch(pPV.HBA){case 1:case 5:vFtr+="<a  id='"+pPV.id+"_Help' onclick='DES_PVShowHelpText();'>"+vHBtn+"</span>";break;case 10:vFtr+="<a id='"+pPV.id+"_Help' href='"+pPV.href+"'  >"+vHBtn+"</a>";break;case 11:vFtr+="<a id='"+pPV.id+"_Help' href='"+pPV.href+"' target='blank' >"+vHBtn+"</a>";break;case 20:vFtr+="<span id='"+pPV.id+"_Help' >"+vHBtn+"</span>";break;}vFtr+="</td></tr></table>";}DES_SetInnerHTML(vDiv,vHdr+vBody+vFtr);if(pPV.CBBEO)DES_BEOAttach(pPV.id+"_Close",pPV.CBBEO);if(pPV.HBBEO)DES_BEOAttach(pPV.id+"_HB",pPV.HBBEO);if(pPV.Opq){if(gDES_BI.IEWin55){vDiv.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity=100)";}gDES_PV.Solid=0;gDES_PV.CurOpq=gDES_PV.MaxO;if(vDiv.addEventListener){vDiv.addEventListener("mouseover",DES_PVSolid,false);document.addEventListener("mousemove",DES_PVOpaque,false);}else if(vDiv.attachEvent){vDiv.attachEvent("onmouseenter",DES_PVSolid);document.attachEvent("onmousemove",DES_PVOpaque);}}if(pPV.Drg)DES_DragInit(vDiv,DES_GetById(pPV.id+(pPV.Drg==1?"_TB":"")));vDiv.onmousedown=new Function("gDES_PV.FcsFld = null;gDES_PV.HFcsFld = null;");}function DES_PVBodyImg(pPV){if(pPV.BImg){var vBody="<table style='width:100%;margin-right:0px;margin-left:0px;' class='"+pPV.BCss+"' ><tr><td valign='"+pPV.BVA+"' style='width:10px;padding-right:5px;' ><img src='"+pPV.BImg+"' alt='' ></img></td>";vBody+="<td id='"+pPV.id+"_Msg'></td></tr></table>";return vBody;}else return"";}function DES_PVOnPopDown(){gDES_PV.PV=null;gDES_PV.TgtID=null;if(window.DES_DragME)DES_DragME();if(window.gDES_TTG){gDES_TTG.IsPU=0;gDES_TTG.Fld=null;}}function DES_PVShowHelpText(){if(!gDES_PV.PV)return;var vPV=gDES_PV.PV;if(!vPV.ForHelp)return;var vTgtID=gDES_PV.TgtID;gDES_PV.TgtID=null;DES_PVPopup(vPV,vTgtID,vPV.ForHelp,"");}function DES_PVUpdateText(pPV,pFFcs,pMsg){if(pFFcs.id==gDES_PV.TgtID){var vFull=pMsg;if(pPV.HMTLB)vFull=pPV.HMTLB+pMsg;if(pPV.HMTLA)vFull+=pPV.HMTLA;DES_SetInnerHTML(pPV.MFld,vFull);}}function DES_PVSolid(pE){if(!gDES_PV.PV||!gDES_PV.PV.Opq||gDES_PV.PV.Solid||!gDES_PV.PV.View.style||gDES_DragG.Fld)return;var vF=gDES_PV.PV.View;gDES_PV.IncOpq=gDES_PV.BIncOpq;if(!pE)gDES_PV.CurOpq=gDES_PV.MaxO-1;gDES_PV.PV.Solid=1;DES_PVOpqChg(0);}function DES_PVOpaque(pE){if(!gDES_PV.PV||!gDES_PV.PV.Opq||(gDES_PV.PV.Solid==0)||gDES_PV.HFcsFld||gDES_PV.FcsFld||!gDES_PV.PV.View.style)return;if(!gDES_PV.IncOpq&&(pE.clientX!=null))if(gDES_PV.CX==null){gDES_PV.CX=pE.clientX;gDES_PV.CY=pE.clientY;return;}else if((Math.abs(pE.clientX-gDES_PV.CX)<4)&&(Math.abs(pE.clientY-gDES_PV.CY)<4))return;gDES_PV.CX=null;var vT=DES_Target(pE);var vF=gDES_PV.PV.View;var vI=0;for(var vSE=vT;(vSE!=document.body)&&(vSE!=null)&&(vI<8);vSE=vSE.parentNode){if(vSE==vF)return;vI++;}gDES_PV.IncOpq=-gDES_PV.BIncOpq;gDES_PV.PV.Solid=0;DES_PVOpqChg(1);}function DES_PVOpqChg(pLD){if(!gDES_PV.PV||!gDES_PV.PV.Opq)return;if(gDES_PV.TmrID){window.clearTimeout(gDES_PV.TmrID);gDES_PV.TmrID=null;}var vMx=gDES_PV.MaxO;var vMn=gDES_PV.MinO;var vDly=pLD&&(gDES_PV.CurOpq==vMx)?gDES_PV.DlyO:100;if(!pLD){gDES_PV.CurOpq+=gDES_PV.IncOpq;if(gDES_PV.CurOpq>vMx)gDES_PV.CurOpq=vMx;else if(gDES_PV.CurOpq<vMn)gDES_PV.CurOpq=vMn;var vF=gDES_PV.PV.View;if(gDES_BI.IEWin55&&vF.filters)vF.filters.item("DXImageTransform.Microsoft.Alpha").opacity=gDES_PV.CurOpq;else if(vF.style.opacity!=null){var vVal=gDES_PV.CurOpq/100;vF.style.opacity=vVal.toString();}}if(!pLD&&((gDES_PV.CurOpq>=vMx)||(gDES_PV.CurOpq<vMn))){gDES_PV.IncOpq=null;gDES_PV.CX=null;gDES_PV.TmrID=null;}else gDES_PV.TmrID=window.setTimeout("DES_PVOpqChg(0);",vDly);}function DES_PEFInit(pAO){if(pAO.PEFInited)return;if(!pAO.EMPV)pAO.EMPV=gDES_PopupViews[pAO.PIdx];pAO.ErrFld.onclick=new Function("DES_PEFPopup('"+pAO.id+"');");if(pAO.PUMO)DES_InitPUMO({TId:pAO.ErrFldID,PId:pAO.EMPV.id,Del:pAO.Dly,Exit:pAO.PUME});if(pAO.PUOF&&pAO.Ctl){for(var vI=0;vI<pAO.Ctl.length;vI++)DES_PEFHookupFB(pAO.Ctl[vI],pAO);}else if(pAO.PUOF&&pAO.Val){for(var vV=0;vV<pAO.Val.length;vV++){var vVO=pAO.Val[vV].AO;if(!vVO)vVO=DES_FindAOById(pAO.Val[vV].FID);if(!vVO)continue;if(vVO.Ctl)for(var vI=0;vI<vVO.Ctl.length;vI++)DES_PEFHookupFB(vVO.Ctl[vI],pAO);}}pAO.PEFInited=1;}function DES_PEFPopup(pAOID){var vAO=gDES_Actions[pAOID];var vTgtID=vAO.Tgt;if(!vTgtID)if(vAO.Ctl)vTgtID=vAO.Ctl[vAO.Ctl.length-1].id;else if(vAO.Val){for(var vI=vAO.Val.length-1;(vI>=0)&&!vTgtID;vI--){var vCtl=vAO.Val[vI].AO.Ctl;if(vCtl)vTgtID=vCtl[vCtl.length-1].id;}}DES_PVPopup(vAO.EMPV,vTgtID,DES_NLTkn(DES_GetErrMsg(vAO),vAO.Tkns,1),vAO.Hlp);}function DES_PEFHookupFB(pFld,pAO){if(!pFld.PEFONFB){DES_AttachEvent(pFld,"onfocus","DES_PEFOnFocus(this);",false);DES_AttachEvent(pFld,"onblur","DES_PEFOnBlur(this);",false);pFld.PEFONFB=1;}}function DES_PEFOnFocus(pFld){var vIDs=pFld.ActionIDs;if(!vIDs)vIDs=pFld.GOCActionIDs;if(vIDs){for(var vI=0;vI<vIDs.length;vI++){var vAO=gDES_Actions[vIDs[vI]];if(vAO.CEMAO)vAO=vAO.CEMAO;if(vAO.EMPV&&(vAO.IsValid==false)){gDES_PV.FcsFld=pFld;if(!vAO.PUOFDly)DES_PEFPopup(vAO.id);else window.setTimeout("DES_PEFPopup('"+vAO.id+"');",vAO.PUOFDly);return;}}}}function DES_PEFOnBlur(pFld){if((pFld==gDES_PV.FcsFld)&&(pFld.id==gDES_PV.TgtID)){window.setTimeout("DES_PEFOBBody('"+pFld.id+"');",500);}}function DES_PEFOBBody(pFID){if((DES_GetById(pFID)==gDES_PV.FcsFld)&&(pFID==gDES_PV.TgtID)){DES_PVPopDown();gDES_PV.FcsFld=null;}}function DES_PEFFmtter(pAO,pShow){if(DES_PEFQueue(pAO,pShow))return;if(pShow){DES_PEFInit(pAO);if((pAO.VT=="CEM")&&gDES_PV.PV&&(pAO.EMPV==gDES_PV.PV))DES_PEFPopup(pAO.id);}else if(gDES_PV.PV&&(pAO.EMPV==gDES_PV.PV))DES_PVPopDown();}var gDES_PEFQ=null;function DES_PEFQueue(pAO,pShow){if(gDES_Init&&pShow){if(gDES_PEFQ==null){gDES_PEFQ=new Array();}gDES_PEFQ[gDES_PEFQ.length]=pAO;return true;}else return false;}function DES_PEFUnQueue(){if(gDES_PEFQ){for(var vI=0;vI<gDES_PEFQ.length;vI++)DES_PEFInit(gDES_PEFQ[vI]);}gDES_PEFQ=null;}//!dc-end
var gDES_FixedPos=0;function DES_GetOffsetX(pF,pIP,pDir,pBrd){var vLP=pIP;if(pBrd)vLP=vLP+pDir*DES_GetLeftBorder(pF);if(pF.offsetParent)for(var vP=pF.offsetParent;vP;vP=vP.offsetParent){if(!gDES_BI.Opera7||(vP.style.display!="inline-block"))vLP=vLP+pDir*vP.offsetLeft;if((pDir<0)||gDES_BI.Safari)if(!gDES_BI.Safari||(vP!=document.body))vLP=vLP+pDir*DES_GetLeftBorder(vP);if(gDES_BI.Safari&&(vP.style.position=="absolute"))break;}else for(var vP=pF.parentNode;vP&&(vP!=document.body);vP=vP.parentNode){if(vP.style.position=="absolute"){vLP=vLP+pDir*vP.offsetLeft;break;}}return vLP;}function DES_GetOffsetY(pF,pIP,pDir,pBrd){var vTP=pIP;if(pBrd)vTP=vTP+pDir*DES_GetTopBorder(pF);if(pF.offsetParent)for(var vP=pF.offsetParent;vP;vP=vP.offsetParent){if(!gDES_BI.Opera7||(vP.style.display!="inline-block"))vTP=vTP+pDir*vP.offsetTop;if((pDir<0)||gDES_BI.Safari)if(!gDES_BI.Safari||(vP!=document.body))vTP=vTP+pDir*DES_GetTopBorder(vP);if(gDES_BI.Safari&&(vP.style.position=="absolute"))break;}else for(var vP=pF.parentNode;vP&&(vP!=document.body);vP=vP.parentNode){if(vP.style.position=="absolute"){vTP=vTP+pDir*vP.offsetTop;break;}}return vTP;}function DES_GetScrolledX(pF,pX,pL){if(document.body.scrollLeft!=null){var vDE=document.documentElement;if(pL){var vOW=(vDE&&vDE.offsetWidth)?vDE.offsetWidth:document.body.offsetWidth;if(pX+pF.offsetWidth>vOW)pX=pX-pF.offsetWidth;if(pX<0)pX=0;}if(pF!=document.body)for(var vP=DES_ParentNode(pF);(vP!=document.body)&&(vP!=null);vP=DES_ParentNode(vP)){var vV=DES_GetPosStyle(vP);if(vV=="fixed"){gDES_FixedPos=1;return 0;}if(vP.scrollLeft!=null)pX=pX+vP.scrollLeft;}if(vDE&&vDE.scrollLeft)pX=pX+vDE.scrollLeft;else pX=pX+document.body.scrollLeft;}else if(window.pageXOffset!=null){pX=pX+window.pageXOffset;}return pX;}function DES_GetScrolledY(pF,pY,pL){if(document.body.scrollTop!=null){var vDE=document.documentElement;if(pL){var vOH=(vDE&&vDE.offsetHeight)?vDE.offsetHeight:document.body.offsetHeight;if(pY+pF.offsetHeight>vOH)pY=pY-pF.offsetHeight;if(pY<0)pY=0;}if(pF!=document.body)for(var vP=DES_ParentNode(pF);(vP!=document.body)&&(vP!=null);vP=DES_ParentNode(vP)){var vV=DES_GetPosStyle(vP);if(vV=="fixed"){gDES_FixedPos=1;return 0;}if(vP.scrollTop!=null)pY=pY+vP.scrollTop;}if(vDE&&vDE.scrollTop)pY=pY+vDE.scrollTop;else pY=pY+document.body.scrollTop;}else if(window.pageXOffset!=null){pY=pY+window.pageYOffset;}return pY;}function DES_GetLeftPos(pF){if(pF.style.pixelLeft!=null)return parseInt(pF.style.pixelLeft);else if(pF.style.posLeft!=null)return parseInt(pF.style.posLeft);else return parseInt(pF.style.left);}function DES_GetTopPos(pF){if(pF.style.pixelTop!=null)return parseInt(pF.style.pixelTop);else if(pF.style.posTop!=null)return parseInt(pF.style.posTop);else return parseInt(pF.style.top);}function DES_SetLeftPos(pF,pL){if(pF.style.pixelLeft)pF.style.pixelLeft=pL;else if(pF.style.posLeft)pF.style.posLeft=pL.toString()+"px";else pF.style.left=pL.toString()+"px";}function DES_SetTopPos(pF,pT){if(pF.style.pixelTop)pF.style.pixelTop=pT;else if(pF.style.posTop)pF.style.posTop=pT.toString()+"px";else pF.style.top=pT.toString()+"px";}function DES_AbsParent(pF){if(pF.offsetParent)for(var vP=pF.offsetParent;vP&&(vP!=document.body);vP=vP.offsetParent){if(DES_GetPosStyle(vP)=="absolute"){return true;}}else for(var vP=pF.parentNode;vP&&(vP!=document.body);vP=vP.parentNode){if(DES_GetPosStyle(vP)=="absolute"){return true;}}return false;}function DES_GetPosStyle(pF){if(pF.style.position!="")return pF.style.position;if(pF.currentStyle)return pF.currentStyle.position;if(window.getComputedStyle)return document.defaultView.getComputedStyle(pF,null).getPropertyValue("position");}function DES_ConvBorderWidth(pW,pS){if(pS=="none")return 0;switch(pW){case'thin':return 2;case'medium':return 4;case'thick':return 6;default:var vR=parseInt(pW);if(isNaN(vR))return 0;return vR;}}function DES_GetLeftBorder(pC){var vB=0;if(pC.currentStyle){vB=DES_ConvBorderWidth(pC.currentStyle.borderLeftWidth,pC.currentStyle.borderLeftStyle);}else if(window.getComputedStyle){vB=parseInt(document.defaultView.getComputedStyle(pC,null).getPropertyValue("border-left-width"));}else if(gDES_BI.Safari||gDES_BI.Opera7){vB=(pC.offsetWidth-pC.clientWidth)/2;}return isNaN(vB)?0:vB;}function DES_GetTopBorder(pC){var vB=0;if(pC.currentStyle){vB=DES_ConvBorderWidth(pC.currentStyle.borderTopWidth,pC.currentStyle.borderTopStyle);}else if(window.getComputedStyle){vB=parseInt(document.defaultView.getComputedStyle(pC,null).getPropertyValue("border-top-width"));}else if(gDES_BI.Safari){vB=(pC.offsetHeight-pC.clientHeight)/2;}return isNaN(vB)?0:vB;}
var gDES_DTTBIds=null;var gDES_SG={AR1:500,AR2:250,Up:null,Dn:null,Trk:0,Spd:500,IC:0,Tmr:0};function DES_InitSpinners(pList){for(var vI=0;vI<pList.length;vI++)DES_InitSpinner(pList[vI]);}function DES_InitSpinner(pSO){function Attach(pCol,pDir){var vImg=DES_GetById(pSO.SID+"_"+pCol+(pDir?"U":"D"));if(vImg){DES_BEOAttach(vImg.id,pDir?gDES_SG.Up:gDES_SG.Dn);var vInc=pSO.Inc[pCol];if(!pDir)vInc=-vInc;var vCode="DES_SpinClickDown('"+pSO.CID+"',"+vInc+");";DES_AttachEvent(vImg,"onmousedown",vCode,false);if(gDES_BI.IEWin&&(gDES_BI.Ver<=8))vImg.ondblclick=new Function("DES_SpinInc('"+pSO.CID+"',"+vInc+");");var vCode="DES_SpinClickUp('"+pSO.CID+"');";DES_AttachEvent(vImg,"onmouseup",vCode,false);DES_AttachEvent(vImg,"onmouseout",vCode,false);}}var vTBFld=DES_GetById(pSO.CID);if(!vTBFld||vTBFld.Spin)return;vTBFld.Spin=pSO;if(!pSO.SFnc)switch(pSO.SFN){case 1:pSO.SFnc=DES_DTTBAdd;break;case 2:pSO.SFnc=DES_TMTBAddSeconds;break;}var vBtnFld=DES_GetById(pSO.SID);if(gDES_BI.OperaPresto)vBtnFld.style.width="10px";Attach(0,1);Attach(0,0);Attach(1,1);Attach(1,0);Attach(2,1);Attach(2,0);DES_AddRefresh(vTBFld,DES_SpinRefresh);DES_SpinRefresh(vTBFld);}function DES_SpinRefresh(pFld){function GetVAlign(pF){if(pF.style.verticalAlign!="")return pF.style.verticalAlign;if(pF.currentStyle)return pF.currentStyle.verticalAlign;if(window.getComputedStyle)return document.defaultView.getComputedStyle(pF,null).getPropertyValue("vertical-align");}var vSO=pFld.Spin;var vB=DES_GetById(vSO.SID);if(!vB)return;DES_RefreshOne(pFld,vB);var vBP=vB.parentNode;if(vBP&&vBP.style&&(GetVAlign(vBP)!="middle")&&(GetVAlign(vB)!="middle")){var vY=(pFld.offsetHeight-vB.offsetHeight)/2;if(vY>0){if(gDES_BI.FireFox2&&(gDES_BI.Ver<4)){if(vY>0)vB.style.verticalAlign=(-vY).toString()+"px";}else vB.style.marginTop=vY.toString()+"px";}}DES_DisableImg(vB,true);}function DES_SpinClickDown(pTBId,pInc){if(!DES_CmdCanEdit(pTBId))return;DES_SpinClear();gDES_SG.Spd=gDES_SG.AR1;gDES_SG.IC=0;DES_SpinInc(pTBId,pInc);var vCode="javascript:DES_SpinRepeat('"+pTBId+"',"+pInc+")";gDES_SG.Tmr=setTimeout(vCode,gDES_SG.Spd);gDES_SG.Trk=1;}function DES_SpinRepeat(pTBId,pInc){if(gDES_SG.Trk){DES_SpinInc(pTBId,pInc);var vCode="javascript:DES_SpinRepeat('"+pTBId+"',"+pInc+")";gDES_SG.Tmr=setTimeout(vCode,gDES_SG.Spd);gDES_SG.IC++;if(gDES_SG.IC==4)gDES_SG.Spd=gDES_SG.AR2;}}function DES_SpinClickUp(pTBId){if(gDES_SG.Trk){var vF=DES_GetById(pTBId);if(vF.focus)try{vF.focus();if(vF.select)vF.select();}catch(e){}}DES_SpinClear();}function DES_SpinClear(){gDES_SG.Trk=0;if(gDES_SG.Tmr!=0)clearTimeout(gDES_SG.Tmr);gDES_SG.Tmr=0;}function DES_SpinInc(pTBId,pInc){if(!DES_CmdCanEdit(pTBId))return;var vSO=DES_GetById(pTBId).Spin;if(!vSO.SFnc(pTBId,pInc))DES_SpinClickUp(pTBId);else DES_FieldChanged(pTBId);}
var gDES_SIOs=null;var gDES_SIORE=/(__doPostBack)|(WebForm_DoPostBackWithOptions)/;function DES_InitSIOs(pL){for(var vI=0;vI<pL.length;vI++)DES_InitSIO(pL[vI]);}function DES_InitSIO(pSIO){var vF=DES_GetById(pSIO.id);if(!vF||vF.SIO)return;vF.SIO=pSIO;if(!gDES_SIOs)gDES_SIOs=new Array();gDES_SIOs[gDES_SIOs.length]=vF;pSIO.Msg=pSIO.Msg?DES_NLTkn(pSIO.Msg,true,2):"";if(!pSIO.NoOC)DES_InitSIOOnClick(pSIO,vF);DES_InitSIOStatusBar(vF);if(pSIO.MMv){var vP=pSIO.Grp!=null?"'"+pSIO.Grp+"'":"null";DES_AttachEvent(vF,"onmousedown","DES_BtnMouseDown('"+vF.id+"', "+vP+");",false);}if(pSIO.DsbImg){vF.DsbImg=pSIO.DsbImg;DES_Preload(vF.DsbImg);}if(pSIO.DsbCss)vF.DsbCss=pSIO.DsbCss;if(pSIO.CMD&&window.DES_CMonUpdateBtn)DES_CMonUpdateBtn(vF);else if(vF.disabled==true)DES_DisableImg(vF,false);}function DES_InitSIOOnClick(pSIO,pF){var vOC="";if(pF.tagName=="A"){var vHR=pF.href.replace('javascript:','');if(vHR){vHR="try{"+vHR+"}catch(e){if (window.DES_DSBody)DES_DSBody(false);}";pF.href="javascript: if (DES_BtnClick('"+pF.id+"')){"+vHR+"}";pSIO.ValOnPB=1;}vOC="if (this.disabled) return false;";}else{vOC="if (!DES_BtnClick('"+pSIO.id+"')) return false;";if(pF.onclick&&!gDES_SIORE.test(pF.onclick.toString()))pSIO.ValOnPB=1;}DES_AttachEvent(pF,"onclick",vOC,true);}function DES_InitSIOStatusBar(pF){if(pF.tagName=="A"){var vT=pF.title?pF.title:(pF.HO&&(pF.HO.H!=null)?DES_StripTags(DES_NLTkn(pF.HO.H,1,4)):'');vT=DES_RERpl(vT,"\r","");vT=DES_RERpl(vT,"\n","");vT="window.status='"+DES_RERpl(vT,"'","\\'")+"';return true;";DES_AttachEvent(pF,"onmouseover",vT,false);DES_AttachEvent(pF,"onmouseout","window.status='';",false);}}function DES_BtnClick(pFID){var vF=DES_GetById(pFID);if(!vF||!vF.SIO)return true;var vSIO=vF.SIO;var vSkp=null;if(vSIO.CMM){var vChg=window.DES_CMonIsChanged&&DES_CMonIsChanged(DES_CMonBtnGrp(vF));vSkp=((vSIO.CMM==1)&&!vChg)||((vSIO.CMM==2)&&vChg);}if((vSIO.Grp!=null)&&window.DES_ValOnClick){DES_ValOnClick(vSIO.Grp,vSIO.Msg);if(vSkp)gDES_AltCfmMsg=null;if(vSIO.ValOnPB){if(!DES_ValOnSubmit())return false;if(this.Page_ClientValidate!=null)if(!Page_ClientValidate())return false;gDES_CauseVal=false;}}else{gDES_CauseVal=false;DES_Reanimate();if(vSIO.Msg){if(vSkp)return true;if(!confirm(vSIO.Msg))return false;}}if(window.DES_DPNCB&&(vSIO.Grp!=null)&&vSIO.Tgt)if(!DES_DPNCB(vSIO.Grp,vSIO.Tgt,""))return false;return true;}
var gDES_ISDV=false;function DES_GetDTTBValue(pTBId){var vR=null;var vAO=DES_DTTBGetAO(DES_GetById(pTBId));if(vAO){if(DES_EvalCondition(vAO.Cond)==1)vR=vAO.Cond.Val;}return vR;}function DES_SetDTTBValue(pTBId,pValue,pAfter){var vFld=DES_GetById(pTBId);var vAO=DES_DTTBGetAO(vFld);if(!vAO)return false;if(pAfter==null)pAfter=4;var vOnCE=pAfter>1;var vOnCF=(pAfter==1)||(pAfter==4)||(pAfter==10&&vAO.CmdOC);gDES_ISDV=true;if(pValue==null){vFld.value="";if(vFld.VWB!=null)DES_VWBSet(vFld);if(vOnCE)DES_SOCCheck(pTBId);DES_CallOnCF(vFld,pValue,false,vOnCF);gDES_ISDV=false;return false;}var vR=false;var vText=DES_FormatDTTBValue(pTBId,pValue);if(vText!=null){vFld.value=vText;if(vFld.orval==null)vFld.orval="";if(vOnCE)DES_SOCCheck(pTBId);vR=true;}if(pAfter!=0)DES_CallOnCF(vFld,pValue,vText==null,vOnCF);gDES_ISDV=false;return vR;}function DES_FormatDTTBValue(pTBId,pValue){var vR=null;var vAO=DES_DTTBGetAO(DES_GetById(pTBId));if(vAO!=null){vR=vAO.Format(vAO,pValue);}return vR;}function DES_DTTBInit(pAO){pAO.CID=pAO.Cond.IDToEval;var vFld=DES_GetById(pAO.CID);vFld.DTTB=1;if(vFld==null){pAO.Enabled=false;return;}else{vFld.AO=pAO;if(pAO.CPFN)pAO.Cond.CstParse=eval("new Function('pFld','pVal','pLastVal','return "+pAO.CPFN+"(pFld,pVal,pLastVal)');");if(pAO.OCFN)pAO.CstOnChg=eval("new Function('pFldID','pVal','pErr','return "+pAO.OCFN+"(pFldID, pVal, pErr)');");}}function DES_DTTBAction(pAO,pEvalRes){var vFld=DES_GetById(pAO.Cond.IDToEval);if(pEvalRes==1){var vText=pAO.Format(pAO,pAO.Cond.Val);if(vText!=null){vFld.value=vText;}}if(!gDES_ISDV)DES_CallOnCF(vFld,pAO.Cond.Val,pEvalRes==0,true);}function DES_CallOnCF(pFld,pVal,pErr,pUOC){var vAO=pFld.AO;if(vAO.OnChg){var vR=vAO.OnChg(pFld,pVal,pErr);if(vR==false)return;if(vR==null)pErr=true;}if(vAO.CstOnChg&&pUOC){if((pVal==null)||pErr)if(vAO.OCFA!=1)return;vAO.CstOnChg(pFld.id,pVal,pErr);}}function DES_DTTBFixCO(pCO){if(pCO.Action&&(pCO.Action.VT=="DTTB"))return pCO;var vAO=DES_DTTBGetAO(DES_GetById(pCO.IDToEval));return vAO?vAO.Cond:pCO;}function DES_DTTBGetAO(pFld){if(!pFld.DTTB&&!window.gDES_Init)return null;if(pFld.AO)return pFld.AO;for(var vI=0;vI<gDES_Actions.length;vI++){var vAO=gDES_Actions[vI];if((vAO.VT=="DTTB")&&(vAO.Cond.IDToEval==pFld.id)){DES_InitOneAction(vI);return vAO;}}return null;}var gDES_PassThruKey=false;var gDES_KFVal=null;function DES_InitKOs(pKOs){for(var vI=0;vI<pKOs.length;vI++)DES_InitKO(pKOs[vI]);}function DES_InitKO(pKO){var vF=DES_GetById(pKO.CID);if(!vF)return;vF.KO=pKO;DES_AttachEvent(vF,"onkeydown","if (!DES_OnKeyDown(this, event)) return false;",true);DES_AttachEvent(vF,"onkeypress","if (!DES_KeyPress(this, event)) return false;",true);if(pKO.MxTab){DES_AttachEvent(vF,"onkeyup","if (!DES_TabAtMax(this)) return false;",true);DES_AttachEvent(vF,"onfocus","gDES_KFVal = null;",true);}if(pKO.Cse&&!gDES_BI.IEWin&&vF.addEventListener)vF.addEventListener("change",DES_FixCase,false);if(!pKO.Exc)pKO.Exc=0;if(!pKO.Fltr)pKO.Fltr="";if(pKO.Pst){vF.onpaste=new Function("if (window.event)event.returnValue=false;return false;");}if(pKO.DAC){vF.autocomplete="off";vF.setAttribute("autocomplete","off",0);}}function DES_KeyPress(pFld,pE){if(gDES_PassThruKey){gDES_KFVal=null;return true;}if(DES_EventStopped(pE))return false;var vR=false;var vRO=pFld.readOnly;if(pFld.disabled||(vRO&&(!pFld.AO||!pFld.AO.ROED)))return false;if(DES_IsCtrl(pE))return true;var vKO=pFld.KO;if(!vKO){return false;}if(gDES_KFVal&&vKO.MxTab){DES_TabAtMax(pFld);if(!gDES_KFVal){DES_StopEvent(pE);return false;}}var vKC=DES_GetKeyCode(pE);if((vKC==null)||(vKC==0)||(vKC==57401)||(gDES_BI.Safari&&(vKC>=63232)&&(vKC<=63276)))return true;if(vKO.CstmKP&&!vKO.CstmKP(pFld,pE,vKC)){DES_StopEvent(pE);return false;}if(!DES_KeyCmd(pFld,pE,vKC,0)){DES_StopEvent(pE);return false;}var vKCS=String.fromCharCode(vKC);if(vKC==13){if(vKO.EBtn){DES_ClickBtn(vKO.EBtn,true);}else if(vKO.ETab)DES_SetFocus(vKO.NxtId);else{if(vRO)return false;if((vKO.Fltr=="")&&(vKO.Ent==null)&&(vKO.Exc==0))vR=true;else vR=vKO.Ent?!vKO.Exc:false;if(vR&&(pFld.tagName=="TEXTAREA")){if(pE.cancelBubble!=null)pE.cancelBubble=true;if(pE.stopPropagation)pE.stopPropagation();}}}else{if(vRO)return false;if(vKC<30)vR=true;else{if(vKO.CTab&&(vKO.CTab.indexOf(vKCS)>-1)&&(pFld.value!=""))DES_SetFocus(vKO.NxtId);else{if(vKO.Cse&&gDES_BI.IEWin){vKCS=(vKO.Cse==1)?vKCS.toUpperCase():vKCS.toLowerCase();var vNew=vKCS.charCodeAt(0);if(vNew!=pE.keyCode)try{pE.keyCode=vNew;}catch(pV){}}if(vKO.Fltr=="")vR=true;else if(vKO.Fltr.indexOf(vKCS)>-1)vR=!vKO.Exc;else vR=vKO.Exc;}}}if(vR){if((vKC>=30)&&(pFld.maxLength))gDES_KFVal=pFld.value;}else DES_StopEvent(pE);return vR;}function DES_OnKeyDown(pFld,pE){function ChgFcs(pNewId,pMd){gDES_KFVal=null;var vF=DES_GetById(pNewId);if(vF.focus){try{vF.focus();if((vF.tagName=="INPUT")&&((vF.type=="text")||(vF.type=="password"))){DES_Select(vF,pMd);}}catch(e){}DES_StopEvent(pE);return true;}return false;}var vKO=pFld.KO;if(!vKO){DES_WaitMsg();DES_StopEvent(pE);return false;}gDES_PassThruKey=false;if(DES_EventStopped(pE))return false;var vKC=DES_GetKeyCode(pE);if(vKO.CstmKD&&!vKO.CstmKD(pFld,pE,vKC)){DES_StopEvent(pE);return false;}if(gDES_BI.Safari&&!gDES_BI.Safari41)return true;if(((vKC>=33)&&(vKC<=47))||DES_IsCtrl(pE))if(!DES_KeyCmd(pFld,pE,vKC,1)){DES_StopEvent(pE);gDES_PassThruKey=true;return false;}if(vKC==8){if(vKO.BTab&&vKO.PrvId&&(pFld.value=="")){if(ChgFcs(vKO.PrvId,2))return false;}}if(vKO.ATab){if((vKC==37)&&vKO.PrvId&&DES_IsSelMd(pFld,1)){if(ChgFcs(vKO.PrvId,2))return false;}if((vKC==39)&&vKO.NxtId&&DES_IsSelMd(pFld,2)){if(ChgFcs(vKO.NxtId,1))return false;}}if((vKC>=33)&&(vKC<=47)&&!pE.altKey)gDES_PassThruKey=true;return true;}function DES_KeyCmd(pFld,pE,pKC,pOKD){var vKO=pFld.KO;if(vKO.KMap&&vKO.KCmd){var vCId=DES_GetCmdId(vKO.KMap,pKC,DES_IsCtrl(pE),DES_IsShift(pE),pOKD);return vCId?vKO.KCmd(pFld,vCId):true;}else return true;}function DES_TabAtMax(pFld){if(gDES_KFVal!=null){if((pFld.value.length==pFld.maxLength)&&(pFld.value.length>gDES_KFVal.length)&&(pFld.value.substr(0,gDES_KFVal.length)==gDES_KFVal)){DES_SetFocus(pFld.KO.NxtId);gDES_KFVal=null;}}return true;}function DES_ClickBtn(pBId,pFcs){var vB=DES_GetById(pBId);if(vB)if((vB.disabled==null)||!vB.disabled)if(vB.href){if(pFcs&&vB.focus)vB.focus();window.location.href=vB.href;return true;}else if(vB.click){if(pFcs&&vB.focus)vB.focus();vB.click();return true;}return false;}function DES_KeyToBtn(pE,pKC,pBId,pFcs){var vKC=DES_GetKeyCode(pE);if(vKC==pKC){if(DES_ClickBtn(pBId,pFcs)){DES_StopEvent(pE);return false;}}return true;}function DES_InitKTB(pCId,pKC,pBId,pFcs){var vFld=DES_GetById(pCId);if(!vFld)vFld=document;var vKP=1;if((pKC>=33)&&(pKC<=47))vKP=0;else if((pKC>=112)&&(pKC<=123))vKP=0;else if(gDES_BI.Safari&&(pKC>=63232)&&(pKC<=63276))vKP=0;var vCd="if (!DES_KeyToBtn(event,"+pKC+",'"+pBId+"',"+pFcs.toString()+")) return false;";DES_AttachEvent(vFld,vKP?"onkeypress":"onkeydown",vCd,true);}function DES_DTTBKCmd(pFld,pCId){var vR=false;var vAO=DES_DTTBGetAO(pFld);if(!vAO)return false;var vID=pFld.id;switch(pCId){case 60:DES_DTTBAdd(vID,-vAO.Inc);break;case 61:DES_DTTBAdd(vID,vAO.Inc);break;default:vR=true;break;}return vR;}function DES_FixCase(pE){var vF=DES_Target(pE);if(!vF||!vF.KO)return;var vNV=(vF.KO.Cse==1)?vF.value.toUpperCase():vF.value.toLowerCase();if(vNV!=vF.value)vF.value=vNV;}function DES_Select(pF,pMd){var vX=0;var vY=pF.value.length;if(pMd==1)vY=vX;else if(pMd==2)vX=vY;if(pF.setSelectionRange)pF.setSelectionRange(vX,vY);else if(pF.createTextRange){var vR=pF.createTextRange();vR.collapse(true);vR.moveEnd('character',vX);vR.moveStart('character',vY);vR.select();}}function DES_IsSelMd(pF,pMd){if((pMd!=0)&&(pF.value.length==0))return true;if(pF.setSelectionRange){var vX=pF.selectionStart;var vY=pF.selectionEnd;if(vY==0)return pMd==1;if(vX==pF.value.length)return pMd==2;return pMd==0;}else if(pF.createTextRange){var vR=document.selection.createRange();var vD=pF.createTextRange().duplicate();vD.collapse();vD.moveStart('character',0);vD.moveEnd('character',0);if(vR.isEqual(vD))return pMd==1;var vL=pF.value.length;vD.moveStart('character',vL);vD.moveEnd('character',vL);if(vR.isEqual(vD))return pMd==2;return pMd==0;}else return false;}function DES_CanEdit(pFId){var vF=DES_GetById(pFId);return!(vF.disabled||vF.readOnly);}function DES_CmdCanEdit(pFId){var vFld=DES_GetById(pFId);if(vFld.disabled)return true;if(vFld.readOnly)if(vFld.AO&&vFld.AO.ROED)return true;else return false;return true;}var gDES_SOC=null;function DES_InitSOCs(pL){for(var vI=0;vI<pL.length;vI++)DES_InitSOC(pL[vI]);}function DES_InitSOC(pSOC){var vF=DES_GetById(pSOC.id);if(!vF)return;if(vF.DESSOC)return;vF.DESSOC=1;if(vF.value!=null){if(vF.disabled||(vF.readOnly&&(!vF.AO||!vF.AO.ROED)))return;if(!gDES_SOC){gDES_SOC=new Array;if(window.attachEvent)window.attachEvent("onunload",DES_DisposeSOC);}gDES_SOC[gDES_SOC.length]=vF;var vId=pSOC.id;DES_AttachEvent(vF,"onblur","DES_SOCCheck('"+vId+"');");DES_AttachEvent(vF,"onchange","DES_SOCSet('"+vId+"','C');");DES_AttachEvent(vF,"onfocus","DES_SOCSet('"+vId+"','F');");}}function DES_DisposeSOC(){gDES_SOC=null;}function DES_SOCCheck(pTBId){var vFld=DES_GetById(pTBId);var vChg=null;var vVal=DES_TBIsBlank(vFld)?"":vFld.value;if((vFld.orval!=null)&&(vFld.orval!=vVal)){vFld.orval=vVal;DES_FireEvent(vFld,"change","HTMLEvents");vChg=true;}if(window.DES_GOCSet)DES_GOCSet(vFld,false,vChg);}function DES_SOCSet(pTBId,pEvt){var vFld=DES_GetById(pTBId);if(DES_TBIsBlank(vFld))vFld.orval="";else vFld.orval=vFld.value;if(window.DES_GOCSet)if(pEvt=='F')DES_GOCSet(vFld,true,null);else if(pEvt=='C')DES_GOCSet(vFld,false,true);}function DES_TBIsBlank(pF,pTxt){if(pTxt==null)pTxt=pF.value;if(pTxt=="")return true;else if(pF.VWB==null)return false;return pTxt.toUpperCase()==pF.VWBUC;}function DES_RangeError(pFld){if(pFld.ActionIDs)for(var vI=0;vI<pFld.ActionIDs.length;vI++){var vAO=gDES_Actions[pFld.ActionIDs[vI]];if(!vAO)continue;if((vAO.VT=="VAL")&&(vAO.Cond.Eval.toString()=="DES_EvalRangeCond")){DES_DoAction(vAO);if(window.DES_PostValidateFld&&window.gDES_VG){var vSF=gDES_VG.FOC;gDES_VG.FOC=0;var vSA=gDES_VG.AOC;gDES_VG.AOC=0;DES_PostValidateFld(pFld);gDES_VG.FOC=vSF;;gDES_VG.AOC=vSA;}}}}function DES_DTTBAdd(pTBId,pAdd){if(!DES_CmdCanEdit(pTBId))return false;var vTBFld=DES_GetById(pTBId);var vAO=DES_DTTBGetAO(vTBFld);if(!vAO)return false;var vVal=DES_GetDTTBValue(pTBId);var vOrig=vVal;if((vVal==null)&&DES_TBIsBlank(vTBFld)){var vN=0;if((vAO.Max!=null)&&(pAdd<0))vN=vAO.Max;else if((vAO.Min!=null)&&(pAdd>0))vN=vAO.Min;DES_SetDTTBValue(pTBId,vN);DES_SetFocus(vTBFld);return true;}if(vVal!=null){vVal=vVal+pAdd;if(vAO.Digs==null){vAO.Round=0;var vDigs=null;if(vAO.Cond.mxdec!=null)vDigs=vAO.Cond.mxdec;else if(vAO.FLZ==null)vDigs=vAO.Cond.CDDig?vAO.Cond.CDDig:gDES_CultureInfo.CDDig;if(vDigs!=null){vAO.Round=1;if((vDigs<0)||(vDigs>5))vDigs=5;vAO.Digs=vDigs;}else vAO.Digs=0;}if(vAO.Round)if(vAO.Digs==0)vVal=Math.round(vVal);else{var vSF=Math.pow(10.0,vAO.Digs);var vSV=vVal*vSF;vSV=Math.round(vSV);vVal=vSV/vSF;}if((vAO.Max!=null)&&(pAdd>0)&&(vAO.Max<vVal))vVal=vAO.Max;else if((vAO.Min!=null)&&(pAdd<0)&&(vAO.Min>vVal))vVal=vAO.Min;if(vVal!=vOrig){DES_SetDTTBValue(pTBId,vVal,0);DES_SetFocus(vTBFld);}return vVal!=vOrig;}return false;}function DES_DTTBSetMinMax(pTBId,pMin,pMax){var vAO=DES_DTTBGetAO(DES_GetById(pTBId));if(vAO){if(pMin!=null)vAO.Min=pMin;if(pMax!=null)vAO.Max=pMax;}}function DES_BDATInit(pAO){DES_DTTBInit(pAO);var vID=pAO.CID;if(pAO.PUID){switch(pAO.TBType){case 1:case 2:pAO.ToPU=DES_DTBToCal;pAO.FromPU=DES_DTBFromCal;break;case 5:pAO.ToPU=DES_DTBToMYP;pAO.FromPU=DES_DTBFromMYP;break;case 10:case 20:pAO.ToPU=DES_TMTBToTP;pAO.FromPU=DES_TMTBFromTP;break;}if(pAO.APUF)DES_APUInit(pAO);}if(DES_GetById(vID+"_PU")||DES_GetByIdEx(vID,"_Help"))DES_AddRefresh(DES_GetById(vID),DES_BDATRefresh);}function DES_BDATRefresh(pFld){DES_RefreshOne(pFld,DES_GetById(pFld.id+"_CONT"));DES_RefreshOne(pFld,DES_GetByIdEx(pFld.id,"_Help"));DES_RefreshOne(pFld,DES_GetByIdEx(pFld.id,"_PU"));if(pFld.disabled!=null){var vT=DES_GetByIdEx(pFld.id,"_PU_TG");if(vT){vT.disabled=pFld.disabled;DES_DisableImg(vT);}}}var gDES_DTBRE=0;function DES_BDATPopup(pTBId){if(gDES_DTBRE||!DES_CmdCanEdit(pTBId))return false;var vTBFld=DES_GetById(pTBId);var vAO=vTBFld.AO;vAO.APUOn=0;var vPUID=vAO.PUID;var vPUF=DES_GetById(vPUID);if(!DES_CtlInited(vPUF))return false;if(vPUF.style){if(vPUF.style.visibility=='hidden'){vPUF.MO.TBId=pTBId;if(vAO.ToPU(pTBId,vPUID)){DES_OpenPopup(DES_PrepIdEx(pTBId,"_PU_TG"),vPUID,false,"");return true;}}else DES_ClosePopup();}return false;}function DES_BDATFromPopup(pTBId,pVal,pAfter){gDES_DTBRE=1;DES_SetDTTBValue(pTBId,pVal,pAfter);gDES_DTBRE=0;var vF=DES_GetById(pTBId);if(vF.KO&&vF.KO.NxtId)DES_SetFocus(vF.KO.NxtId);else if(vF.focus&&vF.select&&DES_IsVisible(vF)){if(vF.AO.APUF)vF.AO.APUOn=1;try{vF.focus();if(vF.select)vF.select();}catch(e){}}}
var gDES_PageIsValid=true;var gDES_Vals=null;var gDES_AONoIDs=new Array;var gDES_CauseVal=false;var gDES_AltCfmMsg="";var gDES_ValPassCnt=0;var gDES_ValErrMsgs=null;var gDES_ValRFM=0;function DES_InitValAction(pAO){DES_AddVal(pAO);if(pAO.SumMsg==null)pAO.SumMsg="";if(pAO.SelErrMsg==null)pAO.SelErrMsg=DES_SelErrMsg;if(pAO.SelSumMsg==null)pAO.SelSumMsg=DES_SelSumMsg;if(pAO.UseFocus==null)pAO.UseFocus=false;if(pAO.ShowAlert==null)pAO.ShowAlert=false;if(pAO.CtlErrCss==null)pAO.CtlErrCss="";if(pAO.Group==null)pAO.Group="";if(pAO.EvtToVal==null)pAO.EvtToVal=0;if(pAO.Blnk==null)pAO.Blnk=false;if(pAO.BlnkCss==null)pAO.BlnkCss='';if(window.DES_Blink&&!pAO.BlinkFnc)pAO.BlinkFnc=DES_Blink;if(pAO.IsValid==null)pAO.IsValid=true;if(pAO.HasEval)pAO.CondResult=pAO.IsValid?1:0;pAO.BlinkCnt=0;var vHasHF=pAO.HltFlds!=null;if(vHasHF)for(var vI=0;vI<pAO.HltFlds.length;vI++){var vHF=pAO.HltFlds[vI];var vF=DES_GetById(vHF.FID);if(!vF)continue;vHF.OCss=vF.className;if(vF.HFPassCnt==null)vF.HFPassCnt=-1;}if(window.DES_CEMAddAction)DES_CEMAddAction(pAO);if(pAO.ErrFldID!=null){pAO.ErrFld=DES_GetById(pAO.ErrFldID);if(pAO.ErrFld==null){pAO.Enabled=false;return;}pAO.ErrFld.AO=pAO;pAO.OrigCss=pAO.ErrFld.className;pAO.OrigColor=(pAO.ErrFld.style!=null)?pAO.ErrFld.style.color:null;pAO.ImgErrFld=DES_GetByIdEx(pAO.ErrFldID,"_Img");if((pAO.ErrFld.style!=null)&&(pAO.ErrFld.style.visibility!="hidden")&&pAO.Format){if(pAO.VT!="CEM"){if(pAO.TokenRepl)DES_EvalCondition(pAO.Cond);pAO.Format(pAO,true);if(window.DES_StartBlink){gDES_SubmitEvent=true;DES_StartBlink(pAO);gDES_SubmitEvent=false;}}else if(gDES_InCallback)DES_CEMDoOneAction(pAO);}pAO.RFMFld=DES_GetByIdEx(pAO.ErrFldID,"_RFM");if(pAO.RFMFld)gDES_ValRFM=1;}if(!pAO.Ctl&&(pAO.VT=="VAL")){var vFnd=false;if(gDES_InCallback)for(var vI=0;vI<gDES_AONoIDs.length;vI++){if(pAO.CID==gDES_AONoIDs[vI].CID){vFnd=true;gDES_AONoIDs[vI]=pAO;break;}}if(!vFnd)gDES_AONoIDs[gDES_AONoIDs.length]=pAO;}}function DES_AddVal(pAO){if(pAO.VIdx!=null){if(!gDES_Vals){if(!gDES_VG.VCnt||(gDES_VG.VCnt<pAO.VIdx))gDES_VG.VCnt=pAO.VIdx+1;DES_InitValA();}else for(var vI=gDES_Vals.length;vI<pAO.VIdx;vI++)gDES_Vals[vI]=null;var vOld=gDES_Vals[pAO.VIdx];if(vOld){if(!vOld.CEMAO)if(vOld.HasEval){var vL=window.gDES_ReVal;if(!vL)vL=new Array();vL[vL.length]=pAO;window.gDES_ReVal=vL;}else if(pAO.IsValid==null){pAO.IsValid=vOld.IsValid;pAO.CondResult=vOld.CondResult;}}gDES_Vals[pAO.VIdx]=pAO;}}function DES_VALRegCTV(pFld,pAO,pECRA){if(!pFld.AVF){var vAVF=pAO.VT=="VAL";if(vAVF&&pECRA)if(window.gDES_VG&&!window.gDES_VG.EXHF)vAVF=false;if(vAVF){pFld.AVF=1;if(!window.gDES_ValFlds)gDES_ValFlds=new Array;gDES_ValFlds[gDES_ValFlds.length]=pFld;}}}function DES_ReVal(){var vL=window.gDES_ReVal;if(vL){var vGF=DES_GetById("DES_Group");var vGrp=vGF?vGF.value:"*";for(var vI=0;vI<vL.length;vI++){var vAO=vL[vI];if(!gDES_VG.SKVG&&!DES_MatchGroup(vGrp,vAO.Group))continue;if(vAO.Cond.OCSMode!=null)DES_DoValidate(vAO,vAO.IsValid!=false?1:0);else DES_DoAction(vAO);}DES_PostValidate("*",false,true);}}function DES_HookupRFM(pAO,pCO,pFld){if(gDES_VG.AHRFM){if(!pAO.RFMFld&&pAO.ErrFldID)pAO.RFMFld=DES_GetByIdEx(pAO.ErrFldID,"_RFM");if(pAO.RFMFld&&!pFld.ChkRFM){pFld.ChkRFM=1;DES_AttachEvent(pFld,DES_EvtType(pFld)?"onchange":"onclick","DES_UpdateRFM();",false);}}}function DES_DoValidate(pAO,pEvalRes){pAO.IsValid=pEvalRes!=0;if(pAO.Format&&pAO.ErrFld){if(pEvalRes!=-1){if(pAO.BeforeFmt)pAO.BeforeFmt(pAO,pEvalRes);pAO.Format(pAO,!pAO.IsValid);}if(pAO.Dspl==2)pAO.ErrFld.style.display=pAO.IsValid?"none":"inline";pAO.ErrFld.style.visibility=pAO.IsValid?"hidden":"inherit";pAO.HasEval=1;if(pAO.NEFMd)DES_NoErrFmt(pAO);if(window.DES_StartBlink)if(!pAO.IsValid)DES_StartBlink(pAO);else DES_StopBlink(pAO);}}function DES_CanRunVal(pAO){if((pAO.EvtToVal==1)&&!gDES_SubmitEvent)return false;if((pAO.EvtToVal==2)&&gDES_SubmitEvent)return false;return DES_CanRunActn(pAO);}function DES_ValidateGroup(pGrp,pReal,pHasEval){gDES_PageIsValid=true;var vIsValid=true;gDES_SubmitEvent=pReal!=false;if(this.gDES_Vals==null)return true;for(var vI=0;vI<gDES_Vals.length;vI++){var vAO=gDES_Vals[vI];if(!vAO)continue;if(pHasEval&&!vAO.HasEval)continue;if(DES_MatchGroup(pGrp,vAO.Group)){vAO.IsValid=true;DES_DoAction(vAO);if(!vAO.IsValid&&(vAO.EvtToVal!=3))vIsValid=false;}else if(!gDES_VG.SKVG)DES_HideVal(vAO);}var vT=window.gDES_SSMsgs;if(vIsValid)gDES_SSMsgs=null;DES_PostValidate(pGrp,true,false);gDES_SSMsgs=vT;gDES_PageIsValid=vIsValid;if(gDES_VG.PPVFN)eval(gDES_VG.PPVFN+"('"+pGrp+"',"+(vIsValid?"true":"false")+");");return vIsValid;}function DES_ValOnSubWGrp(pGrp){gDES_CauseVal=false;if(window.gDES_VG)for(var vI=0;vI<3;vI++){switch(gDES_VG.SOrd[vI]){case 0:if(!DES_ValidateGroup(pGrp,true))return false;break;case 1:if(this.confirm){if(gDES_AltCfmMsg==null)break;if(gDES_AltCfmMsg!=""){if(!confirm(DES_NLTkn(gDES_AltCfmMsg,true,2)))return false;}else if((gDES_VG.CnfM!=null)&&((this.gDES_VG.CnfG=="*")||(this.gDES_VG.CnfG==pGrp)))if(!confirm(DES_NLTkn(gDES_VG.CnfM,true,2)))return false;}if(window.DES_ConfirmWarnings)if(!DES_ConfirmWarnings(pGrp))return false;break;case 2:if(gDES_VG.CSFN!=null)if(!eval(gDES_VG.CSFN+"('"+pGrp+"');"))return false;break;}}if(this.DES_DisableSubmit)DES_DisableSubmit();return true;}function DES_ValOnSubmit(){if(!gDES_CauseVal){gDES_AltCfmMsg="";if(this.DES_DisableSubmit)DES_DisableSubmit();return true;}gDES_CauseVal=true;var vGrpFld=DES_GetById("DES_Group");if(vGrpFld==null){var vFlds=document.getElementsByName("DES_Group");if((vFlds==null)||(vFlds.length==0)){gDES_AltCfmMsg="";return true;}vGrpFld=vFlds[0];}var vR=DES_ValOnSubWGrp(vGrpFld.value);if(!vR&&(window.event!=null)){window.event.cancelBubble=true;window.event.returnValue=false;}if(!vR&&(window.__defaultFired!=null))window.__defaultFired=false;if(window.DES_Reanimate)DES_Reanimate();return vR;}function DES_ValOnClick(pGrp,pAltMsg){var vGrpFld=DES_GetById("DES_Group");if(vGrpFld==null){var vFlds=document.getElementsByName("DES_Group");if((vFlds==null)||(vFlds.length==0))return;vGrpFld=vFlds[0];}vGrpFld.value=pGrp;gDES_CauseVal=true;gDES_AltCfmMsg=pAltMsg?pAltMsg:"";}function DES_PostValidate(pGrp,pAll,pAUVS){if(!window.gDES_VG)return;if(gDES_VG.POS){var vIsV=true;gDES_ValPassCnt++;gDES_ValErrMsgs=new Array;var vFstInv=null;if(window.gDES_ValFlds)for(var vI=0;vI<gDES_ValFlds.length;vI++){var vF=gDES_ValFlds[vI];if(!vF)continue;if(!DES_PostValidateBody(vF,pGrp,true)){vIsV=false;if(vFstInv==null)vFstInv=vF;}}for(var vI=0;vI<gDES_AONoIDs.length;vI++){var vAO=gDES_AONoIDs[vI];if(vAO.Enabled&&!vAO.IsValid&&DES_MatchGroup(pGrp,vAO.Group)){DES_UpdateValErrMsgs(vAO,true,null);vIsV=false;}}if(this.gDES_SSMsgs)for(var vI=0;vI<gDES_SSMsgs.length;vI++)if(gDES_SSMsgs[vI].FldId==null)gDES_ValErrMsgs[gDES_ValErrMsgs.length]=gDES_SSMsgs[vI];if((!vIsV||(gDES_ValErrMsgs.length>0))&&pAll){var vA=gDES_VG.AOS&&((this.gDES_SSMsgs==null)||(this.gDES_SSMsgs.length<gDES_ValErrMsgs.length));DES_PostValidateAction(vFstInv,gDES_VG.FOS,vA);}if(window.DES_UpdateSummaries)DES_UpdateSummaries(pGrp,pAUVS);}if(window.DES_CEMDoAction)DES_CEMDoAction();DES_RefreshPage(true);}function DES_PostValidateFld(pFld){if(!window.gDES_VG)return;if(gDES_VG.POC){gDES_ValPassCnt++;gDES_ValErrMsgs=new Array;if(!DES_PostValidateBody(pFld,"*",false))DES_PostValidateAction(pFld,gDES_VG.FOC,gDES_VG.AOC);}var vAO=gDES_Actions[pFld.ActionIDs[0]];if(!vAO)return;if(window.DES_UpdateSummaries)DES_AutoUpdateSummaries(vAO.Group);if(this.DES_CEMDoAction)DES_CEMDoAction();DES_RefreshPage(true);}function DES_PostValidateBody(pFld,pGrp,pS){pFld.IsV=null;if(pFld.ValPassCnt==null)pFld.ValPassCnt=0;if(pFld.ValPassCnt<gDES_ValPassCnt){var vOFA=new Array;if(!pFld.gocDE&&(pFld.OFPassCnt!=gDES_ValPassCnt))vOFA[0]=pFld;pFld.ValPassCnt=gDES_ValPassCnt;pFld.OFPassCnt=gDES_ValPassCnt;for(var vI=0;vI<pFld.ActionIDs.length;vI++){vAO=gDES_Actions[pFld.ActionIDs[vI]];if(!vAO)continue;if(vAO.VT!="VAL")continue;if(vAO.ValPassCnt==null)vAO.ValPassCnt=0;if((vAO.IsValid!=null)&&(vAO.CondResult!=-1)&&DES_MatchGroup(pGrp,vAO.Group)){if(!vAO.IsValid){if(vAO.ValPassCnt<gDES_ValPassCnt)DES_UpdateValErrMsgs(vAO,pS,pFld.id);pFld.IsV=false;}else if(pFld.IsV==null)pFld.IsV=true;DES_GetOtherErrCtl(vOFA,pFld,vAO,pS);}else if((vAO.CondResult==-1)&&DES_MatchGroup(pGrp,vAO.Group)){if(pFld.IsV==null)pFld.IsV=true;DES_GetOtherErrCtl(vOFA,pFld,vAO,pS);}vAO.ValPassCnt=gDES_ValPassCnt;DES_SetHiliteFields(vAO,vAO.CondResult);}if((pFld.IsV!=null)&&(gDES_VG.ErrCtlCss!=null)){for(var vI=0;vI<vOFA.length;vI++)DES_PostValidateErrCtl(vOFA[vI],vOFA[vI].IsV);}}return pFld.IsV!=false;}function DES_GetOtherErrCtl(pOFA,pFld,pAO,pS){if(!pFld.gocDE&&(pS||(pAO.EvtToVal==1)))return;var vMS=pFld.gocDE!=null;var vFA=vMS?pFld.gocDE:pAO.Ctl;for(var vJ=0;vJ<vFA.length;vJ++){var vO=vFA[vJ];if(vO.gocDE){DES_GetOtherErrCtl(pOFA,vO,pAO,pS);continue;}if(vO!=pFld){var vUPC=(vO.OFPassCnt==null)||(vO.OFPassCnt<gDES_ValPassCnt);if(vUPC)pOFA[pOFA.length]=vO;if(vUPC||!pAO.IsValid)vO.IsV=pAO.IsValid;if(DES_IsValid(vO)==false)vO.IsV=false;vO.OFPassCnt=gDES_ValPassCnt;}}if(pFld.gocfld){for(var vI=0;vI<pFld.gocfld.length;vI++){if(DES_IsValid(pFld.gocfld[vI])==false){pFld.IsV=false;break;}}}}function DES_UpdateValErrMsgs(pAO,pS,pFldId){if(!pS||(pAO.EvtToVal!=2)){if(!gDES_VG.ASEM)pS=true;var vMsg=pS?DES_GetSumMsg(pAO):DES_GetErrMsg(pAO);if(vMsg!=""){var vId=pAO.Ctl?pAO.Ctl[0].id:pFldId;gDES_ValErrMsgs[gDES_ValErrMsgs.length]={Msg:vMsg,Grp:pAO.Group,FldId:vId,OStl:pAO.OStl};}}}function DES_PostValidateErrCtl(pF,pIsV){var vOStl=0;if(pF.ActionIDs)for(var vI=0;vI<pF.ActionIDs.length;vI++){var vAO=gDES_Actions[pF.ActionIDs[vI]];if(vAO&&vAO.OStl&&vAO.IsValid==false){vOStl=1;break;}}if(pF.SetErrStyle){pF.SetErrStyle(pF.id,pIsV,vOStl);return;}var vCss="";var vCB=false;var vAltF=null;if((pF.tagName=="INPUT")&&((pF.type=="checkbox")||(pF.type=="radio"))){vCss=!vOStl?gDES_VG.ErrChkCss:gDES_VG.ErrChkCss2;vCB=true;}else if(pF.tagName=="SELECT")vCss=!vOStl?gDES_VG.ErrLstCss:gDES_VG.ErrLstCss2;if(vCss=="")vCss=!vOStl?gDES_VG.ErrCtlCss:gDES_VG.ErrCtlCss2;if((vCss!="")&&(pF.className!=null)){if(!vCB||(gDES_VG.CBECCMd<2)){DES_SetErrCtlCss(vAltF?vAltF:pF,pIsV,vCss);}if(vCB&&(gDES_VG.CBECCMd!=1)){vL=pF.nextSibling;if(vL&&(vL.tagName=="LABEL"))DES_SetErrCtlCss(vL,pIsV,vCss);}}}function DES_FlashErrCtl(pF){if(window.gDES_VG&&(DES_IsValid(pF)==true)){DES_PostValidateErrCtl(pF,false);window.setTimeout("DES_PostValidateErrCtl(DES_GetById('"+pF.id+"'), true);",500);}}function DES_SetErrCtlCss(pF,pIsV,pCss){pF=DES_GetById(pF);if(pF.OrigCss==null){pF.OrigCss=pF.className;}else if(pF.OrigCss!=null){pF.className=pF.OrigCss;if(pIsV&&window.DES_VWBInit)DES_VWBApplyCss(pF,true);}if(!pIsV){if(typeof(pCss)=="number")switch(pCss){case 0:pCss=gDES_VG.ErrCtlCss;break;case 1:pCss=gDES_VG.ErrLstCss;break;case 2:pCss=gDES_VG.ErrChkCss;break;case 10:pCss=gDES_VG.ErrCtlCss2;break;case 11:pCss=gDES_VG.ErrLstCss2;break;case 12:pCss=gDES_VG.ErrChkCss2;break;default:pCss="";break;}if(pCss!="")DES_ApplyCssPlus(pF,pCss);}}function DES_PostValidateAction(pFld,pFocus,pAlert){if(!window.gDES_VG)return;if(pAlert){var vMsg=gDES_VG.AltTmpt;var vNB=(vMsg=="")||(vMsg.indexOf("{0}")>-1);var vHB=false;if(vNB){var vBody="";for(var vI=0;vI<gDES_ValErrMsgs.length;vI++){var vCnt=vI+1;var vLine="";if(gDES_VG.AltLstStl)vLine=gDES_VG.AltLdTxt.replace("#",vCnt)+gDES_ValErrMsgs[vI].Msg+"\n";else vLine=gDES_ValErrMsgs[vI].Msg+" ";vBody=vBody+vLine;}vHB=vBody!="";if(vMsg=="")vMsg=vBody;else vMsg=vMsg.replace("{0}",vBody);}if((vMsg!="")&&(vHB||(!vNB&&(gDES_VG.AltTmpt!="")))){if(vMsg.indexOf("{COUNT")>-1){var vEC=gDES_ValErrMsgs.length;vMsg=DES_SPReplToken(vMsg,vEC,"COUNT");vMsg=DES_RERpl(vMsg,"{COUNT}",vEC);}if(gDES_VG.DAOS)gDES_VG.DAOS--;if(!gDES_VG.DAOS)alert(DES_StripTags(DES_NLTkn(vMsg,true,2)));}}if(pFocus&&(pFld!=null)){var vCode="javascript:DES_SetFocus('"+pFld.id+"');";setTimeout(vCode,10);}}function DES_SetHiliteFields(pAO,pEvalRes){if(pAO.HltFlds!=null)for(var vI=0;vI<pAO.HltFlds.length;vI++){var vHF=pAO.HltFlds[vI];var vF=DES_GetById(vHF.FID);if(!vF)continue;if(pEvalRes!=0){if(vF.HFPassCnt<gDES_ValPassCnt)vF.className=vHF.OCss;}else{if(vF.HFPassCnt<gDES_ValPassCnt){var vCN=(vHF.Txt==1)?gDES_VG.THltCss:gDES_VG.NTHltCss;if(vCN!="")DES_ApplyCssPlus(vF,vCN);vF.HFPassCnt=gDES_ValPassCnt;}}}}function DES_ValUpdateCssOnPostBack(){if(!window.gDES_ValFlds)return;gDES_ValPassCnt++;gDES_ValErrMsgs=new Array;for(var vI=0;vI<gDES_ValFlds.length;vI++){var vF=gDES_ValFlds[vI];if(!vF||DES_IsValid(vF,true,true))continue;DES_PostValidateBody(vF,"*",true);}}function DES_TextFmttr(pAO,pShow){if(pShow){if(pAO.TxtErrFld==null)pAO.TxtErrFld=DES_GetById(pAO.ErrFldID+"_Txt");DES_SetInnerHTML(pAO.TxtErrFld,DES_NLTkn(DES_GetErrMsg(pAO),pAO.Tkns,1));}}function DES_TTFmttr(pAO,pShow){if(pShow&&pAO.ImgErrFld)pAO.ImgErrFld.title=DES_NLTkn(DES_GetErrMsg(pAO),pAO.Tkns,3);}function DES_AlertFmttr(pAO,pShow){if(pShow&&pAO.ImgErrFld&&(pAO.ImgErrFld.onclick==null))pAO.ImgErrFld.onclick=new Function(DES_GetErrFmtAlert(pAO));}function DES_HyperLinkFmttr(pAO,pShow){if(pShow){if(pAO.LnkErrFld==null){pAO.LnkErrFld=DES_GetByIdEx(pAO.ErrFldID,"_Link");pAO.LnkErrFld.href="javascript: "+DES_GetErrFmtAlert(pAO)+"DES_Reanimate();";}}}function DES_GetErrFmtAlert(pAO){var vR="";if(pAO.VIdx!=null)vR="var vAO=gDES_Vals["+pAO.VIdx+"];";else vR="var vAO=gDES_Actions["+pAO.id+"];";vR+="alert(DES_NLTkn(DES_GetErrMsg(vAO), vAO.Tkns, 2));";if(gDES_VG.FAA){var vId=null;if((pAO.Ctl!=null)&&(pAO.Ctl.length>0))vId=pAO.Ctl[0].id;else if((pAO.Cond.IDToEval!=null)&&(pAO.Cond.IDToEval!=""))vId=pAO.Cond.IDToEval;if(vId)vR=vR+"DES_SetFocus('"+vId+"');";}return vR;}function DES_GetErrMsg(pAO){var vMsg=pAO.SelErrMsg(pAO);if(vMsg==null)return"";if(pAO.TokenRepl&&(vMsg.indexOf("{")!=-1))vMsg=pAO.TokenRepl(pAO,vMsg);return vMsg;}function DES_GetSumMsg(pAO){var vMsg=pAO.SelSumMsg(pAO);if(vMsg==null)return"";if(pAO.TokenRepl&&(vMsg.indexOf("{")!=-1))vMsg=pAO.TokenRepl(pAO,vMsg);if(vMsg=="")vMsg=DES_GetErrMsg(pAO);return vMsg;}function DES_SelErrMsg(pAO){return pAO.ErrMsg;}function DES_SelSumMsg(pAO){return pAO.SumMsg;}function DES_OneFldReplToken(pAO,pText){var vCO=pAO.Cond;if(vCO.IDToEval!="")return DES_RERpl(pText,"{TEXTVALUE}",DES_GetTextValue(vCO.IDToEval,vCO.Trim));else return pText;}function DES_TwoFldReplToken(pAO,pText){pText=DES_OneFldReplToken(pAO,pText);var vCO=pAO.Cond;if(vCO.IDToEval2!="")return DES_RERpl(pText,"{TEXTVALUE2}",DES_GetTextValue(vCO.IDToEval2,vCO.Trim));else return pText;}function DES_InitValA(){if(window.gDES_VG&&(gDES_VG.VCnt>0)){gDES_Vals=new Array(gDES_VG.VCnt);for(var vI=0;vI<gDES_VG.VCnt;vI++)gDES_Vals[vI]=null;}else gDES_Vals=null;}function DES_VALReset(pIsPostBack){if(this.gDES_Vals&&this.gDES_VG){var vT=(gDES_VG.AOS!=null)?gDES_VG.AOS:false;gDES_VG.AOS=false;if(pIsPostBack)DES_ValidateGroup("*",false);else{for(var vI=0;vI<gDES_Vals.length;vI++){var vAO=gDES_Vals[vI];if(!vAO)continue;DES_HideVal(vAO);}DES_PostValidate("*",true,false);}gDES_VG.AOS=vT;}}function DES_HideVal(pVO){pVO.IsValid=true;pVO.CondResult=1;if(pVO.Enabled&&pVO.Run)pVO.Run(pVO,1);}function DES_UpdVal(pVID,pCR,pEMsg,pSMsg){var vAO=DES_FindAOById(pVID);if(pCR!=null){vAO.CondResult=parseInt(pCR);vAO.LastResult=vAO.CondResult;}if(pEMsg!=null)vAO.ErrMsg=pEMsg;if(pSMsg!=null)vAO.SumMsg=pSMsg;DES_DoValidate(vAO,vAO.CondResult);if(vAO.Ctl!=null){var vF=DES_GetById(vAO.Ctl[0].id);if(vF.gocfld)vF=vF.gocfld[0];DES_PostValidateFld(vF);}}function DES_IsValid(pFld,pShowing,pNoVal){function Test(pActIDS){if(pActIDS)for(var vI=0;vI<pActIDS.length;vI++){var vAO=gDES_Actions[pActIDS[vI]];if(!vAO)continue;if(vAO.VT!="VAL")continue;if(!vAO.HasEval){if(pNoVal)return true;else DES_DoAction(vAO);}if(pShowing){if((!vAO.IsValid&&vAO.Dspl)||vAO.NEFVis)return false;}else if(!vAO.IsValid)return false;}return true;}pFld=DES_GetById(pFld);var vA=pFld.ActionIDs;if(vA)return Test(vA);else if(pFld.gocfld){for(var vJ=0;vJ<pFld.gocfld.length;vJ++)if(!Test(pFld.gocfld[vJ].ActionIDs))return false;return true;}return null;}function DES_PageIsValid(pGrp){if(!window.gDES_Vals)return true;for(var vI=0;vI<gDES_Vals.length;vI++){var vAO=gDES_Vals[vI];if(!vAO)continue;if(DES_MatchGroup(pGrp,vAO.Group)){if(!vAO.IsValid)return false;}}return true;}function DES_CountErrors(pGrp){var vC=0;for(var vI=0;vI<gDES_Vals.length;vI++){var vAO=gDES_Vals[vI];if(!vAO)continue;if(DES_MatchGroup(pGrp,vAO.Group)){if(vAO.IsValid==false)vC++;}}return vC;}function DES_UpdateRFM(){if(gDES_ValRFM&&gDES_Vals)for(var vI=0;vI<gDES_Vals.length;vI++){var vAO=gDES_Vals[vI];if(!vAO)continue;var vF=vAO.RFMFld;if(!vF&&vAO.CEMAO){if(!vAO.Cond.Req)continue;vF=vAO.CEMAO.RFMFld;}if(vF){var vS=DES_DoEnabler(vAO);vAO.HasEval=0;vF.style.visibility=vS?"inherit":"hidden";var vCur=vAO.CEMAO||vAO;if(vCur.Dspl==2)vF.style.display=vS?"inline":"none";}}}//DES_UpdateRFM
function DES_ParallelMSValCustomCond(pCO){var vSrc={clientvalidationfunction:pCO.CVFnc};var vArgs={Value:"",IsValid:true};eval(pCO.CVFnc+"(vSrc, vArgs);");return vArgs.IsValid?1:0;}function DES_ParallelMSValOneFldCustomCond(pCO){var vSrc={controltovalidate:pCO.IDToEval,clientvalidationfunction:pCO.CVFnc};var vVal=DES_GetTextValue(pCO.IDToEval,pCO.Trim);if(vVal.length==0)return 1;var vArgs={Value:vVal,IsValid:true};eval(pCO.CVFnc+"(vSrc, vArgs);");return vArgs.IsValid?1:0;}function DES_EvalBTxtLenCond(pCO){var vVal=DES_GetTextValue(pCO.IDToEval,pCO.Trim);if(pCO.IBT&&(vVal.length==0))return 1;pCO.Count=pCO.CntElFnc(pCO,vVal);if(pCO.IDToEval2!=""){vVal=DES_GetTextValue(pCO.IDToEval2,pCO.Trim);pCO.Count=pCO.Count+pCO.CntElFnc(pCO,vVal);}if(pCO.Min!=0)if(pCO.Min>pCO.Count){pCO.Diff=pCO.Min-pCO.Count;return 0;}if(pCO.Max!=0)if(pCO.Max<pCO.Count){pCO.Diff=pCO.Count-pCO.Max;return 0;}return 1;}function DES_TxtLenReplToken(pAO,pText){pText=DES_TwoFldReplToken(pAO,pText);pText=DES_SPReplToken(pText,pAO.Cond.Count,"COUNT");pText=DES_SPReplToken(pText,pAO.Cond.Diff,"EXCEEDS");pText=DES_RERpl(pText,"{COUNT}",pAO.Cond.Count);return DES_RERpl(pText,"{EXCEEDS}",pAO.Cond.Diff);}function DES_CntChars(pCO,pText){if(pCO.IsTA==null)pCO.IsTA=DES_GetById(pCO.IDToEval).tagName=="TEXTAREA";return pCO.IsTA?DES_TxtLen(pText):pText.length;}function DES_NoErrFmt(pAO){if(!pAO.NEFInit){pAO.NEFInit=true;pAO.NEFFld=DES_GetById(pAO.ErrFldID+"_NEF");}if(!pAO.NEFFld)return;var vVis=false;if(pAO.CondResult!=-1){if((pAO.NEFMd==1)||((pAO.NEFMd==3)&&pAO.HasEval))vVis=pAO.IsValid;else if(pAO.NEFMd==2){vVis=false;if(pAO.LastCR!=null)vVis=(pAO.CondResult==1)&&((pAO.LastCR==0)||((pAO.LastCR==1)&&(pAO.LastCR2==0)));pAO.LastCR2=pAO.LastCR;pAO.LastCR=pAO.CondResult;}else vVis=false;}pAO.NEFFld.style.display=vVis?"inline":"none";pAO.NEFFld.style.visibility=vVis?"inherit":"hidden";pAO.NEFVis=vVis;}function DES_ConfirmWarnings(pGrp){if(!gDES_Vals||!gDES_VG.WCMsg)return true;var vErr="";var vCnt=1;var vSv=gDES_SubmitEvent;gDES_SubmitEvent=false;for(var vI=0;vI<gDES_Vals.length;vI++){var vAO=gDES_Vals[vI];if(vAO&&(vAO.EvtToVal>=2)&&DES_MatchGroup(pGrp,vAO.Group)){DES_DoAction(vAO);if(vAO.CondResult!=0)continue;var vMsg=DES_GetSumMsg(vAO);if(vMsg!=""){if(vErr!="")vErr+="\n";vErr+=gDES_VG.WCLdTxt.replace("#",vCnt)+vMsg;vCnt++;}}}gDES_SubmitEvent=vSv;if(vErr=="")return true;return confirm(DES_StripTags(DES_NLTkn(gDES_VG.WCMsg.replace("{0}",vErr),true,2)));}//DES_ConfirmWarnings
function DES_EvalDiffCond(pCO){if(pCO.OneMult==null)pCO.OneMult=1;else if(pCO.OneMult==0)return-1;var vVal1=DES_GetNativeValue(pCO.IDToEval,pCO);var vVal2=DES_GetNativeValue(pCO.IDToEval2,pCO);;if(!DES_GoodNativeVal(vVal1)||!DES_GoodNativeVal(vVal2))return-1;var vDiff=Math.abs(DES_ToPrimitive(vVal1)-DES_ToPrimitive(vVal2));if(pCO.OneMult!=1){vDiff=vDiff/pCO.OneMult;if(pCO.RdIvl)vDiff=Math.round(vDiff);}pCO.DiffRes=DES_Round(vDiff,2,2);return DES_Comparer(pCO,vDiff,pCO.Diff,pCO.Op)?1:0;}function DES_EvalCountSelsCond(pCO){var vCnt=0;for(var vJ=0;vJ<2;vJ++){var vID=vJ==0?pCO.IDToEval:pCO.IDToEval2;if(vID!=""){var vIdxs=DES_GetMultiSelIdx(vID);if(!vIdxs)return-1;vCnt+=vIdxs.length;}}pCO.Count=vCnt;var vMax=(pCO.Max>0)?pCO.Max:99999;return((pCO.Min<=vCnt)&&(vMax>=vCnt))?1:0;}function DES_EvalCountTrueCond(pCO){if(pCO.Conds.length==0)return-1;var vCnt=0;var vCanEval=false;for(var vI=0;vI<pCO.Conds.length;vI++){var vR=DES_EvalCondition(pCO.Conds[vI]);if(vR==1)vCnt++;if(vR!=-1)vCanEval=true;}pCO.Count=vCnt;if(!vCanEval)return-1;return((pCO.Min<=vCnt)&&(pCO.Max>=vCnt))?1:0;}function DES_EvalCCNCond(pCO){var vVal=DES_GetTextValue(pCO.IDToEval,pCO.Trim);if(vVal=="")return pCO.IBT;if(pCO.ASp)vVal=DES_RERpl(vVal," ","");var vLen=vVal.length;if(vLen<10)return 0;var vRx=new RegExp("^(\\d+)$","i");if(!vRx.test(vVal))return 0;if(pCO.PfxByLen!=null){var vFd=false;for(var vI=0;(vI<pCO.PfxByLen.length)&&!vFd;vI++){if(pCO.PfxByLen[vI].Len==vLen){vFd=true;var vRx=new RegExp(pCO.PfxByLen[vI].Pref,"i");if(!vRx.test(vVal))return 0;}}if(!vFd)return 0;}var vT=0;var vAN=true;for(var vI=vLen-1;vI>=0;vI--){var vD=parseInt(vVal.charAt(vI));if(vAN)vT+=vD;else{vD=vD*2;if(vD>9)vT+=1+(vD%10);else vT+=vD;}vAN=!vAN;}return vT%10==0?1:0;}function DES_EvalABARtNumCond(pCO){var vVal=DES_GetTextValue(pCO.IDToEval,pCO.Trim);if(vVal=="")return pCO.IBT;var vLen=vVal.length;if(vLen!=9)return 0;var vRx=new RegExp("^(\\d+)$","i");if(!vRx.test(vVal))return 0;var vT=0;var vM=[3,7,1];for(var vI=0;vI<9;vI++){vT+=parseInt(vVal.charAt(vI))*vM[vI%3];}if(vT==0)return 0;return vT%10==0?1:0;}function DES_InitDupEntryCond(pCO,pAO){DES_InitCond(pCO,pAO);for(var vI=0;vI<pCO.Ctls.length;vI++){DES_HookupControl(DES_GetById(pCO.Ctls[vI].ID),pAO,pCO,0,null);}}function DES_EvalDupEntryCond(pCO){pCO.TxtVal="";pCO.Lbl1="";pCO.Lbl2="";var vTM=pCO.Md!=2;var vVals=new Array;for(var vI=0;vI<pCO.Ctls.length;vI++){var vV;var vV2;var vC=pCO.Ctls[vI];if(!vTM)vV=DES_GetSelIdx(vC.ID);else{vV=DES_GetTextValue(vC.ID,pCO.Trim);vV2=vV;if(pCO.Md==1)vV=vV.toUpperCase();}for(var vJ=0;vJ<vVals.length;vJ++){if((vTM&&(!pCO.IU||(vV!=pCO.UTxt)))||(!vTM&&(!pCO.IU||(vV!=pCO.UIdx))))if(vVals[vJ]==vV){if(vTM)pCO.TxtVal=vV2;pCO.Lbl1=pCO.Ctls[vJ].Lbl;pCO.Lbl2=vC.Lbl;return 0;}}vVals[vVals.length]=vV;}return 1;}function DES_EvalSelIdxRngCond(pCO){var vMax=DES_GetListCount(pCO.IDToEval)-1;for(var vR=0;vR<pCO.Rngs.length;vR++){var vEIdx=pCO.Rngs[vR].EIdx;if(vEIdx>vMax)vEIdx=vMax;for(var vI=pCO.Rngs[vR].SIdx;vI<=vEIdx;vI++)if(DES_IsSelIdx(pCO.IDToEval,vI))return 1;}return 0;}function DES_EvalBadWordsCond(pCO){pCO.TxtVal="";if(pCO.Expr=="")return-1;var vV=DES_GetTextValue(pCO.IDToEval,pCO.Trim);if(vV=="")return pCO.IBT;var vRx=new RegExp(pCO.Expr,pCO.Flags);var vMatch=vRx.exec(vV);if((vMatch!=null)&&(vMatch.length>0)){pCO.TxtVal=vMatch[vMatch.length-1];return 0;}else return 1;}function DES_EvalReqSelCond(pCO){var vV=DES_IsValueNull(pCO.IDToEval);if(vV==null)return-1;return vV?0:1;}function DES_UDSelErrMsg(pAO){if((pAO.Cond.DateLbl=="")&&(pAO.NoLblErrMsg!=""))return pAO.NoLblErrMsg;else return pAO.ErrMsg;}function DES_UDSelSumMsg(pAO){if((pAO.Cond.DateLbl=="")&&(pAO.NoLblSumMsg!=""))return pAO.NoLblSumMsg;else return pAO.SumMsg;}function DES_EvalListSzCond(pCO){var vC=DES_GetListCount(pCO.IDToEval)
if(vC==null)return-1;if(vC<pCO.Min)return 0;if((pCO.Max>0)&&(pCO.Max<vC))return 0;return 1;}function DES_InitMReqCond(pCO,pAO){DES_InitTwoFldCond(pCO,pAO);if(pCO.Ctls)for(var vI=0;vI<pCO.Ctls.length;vI++){DES_HookupControl(DES_GetById(pCO.Ctls[vI].id),pAO,pCO,0,null);}}function DES_EvalMReqCond(pCO){function EvalText(pID,pUV,pCS){var vVal=DES_GetTextValue(pID,pCO.Trim);if(!pUV)return(vVal!="")?1:0;if(!pCS){vVal=vVal.toUpperCase();pUV=pUV.toUpperCase();}var vUVA=pUV.split("|");for(var vI=0;vI<vUVA.length;vI++)if(vUVA[vI]==vVal)return 0;return 1;}var vCount=0;var vHasData=0;if(pCO.IDToEval){vCount++;if(EvalText(pCO.IDToEval,null,true))vHasData++;}if(pCO.IDToEval2){vCount++;if(EvalText(pCO.IDToEval2,null,true))vHasData++;}if(pCO.Ctls)for(var vI=0;vI<pCO.Ctls.length;vI++){var vBRC=pCO.Ctls[vI];vCount++;if(vBRC.UI==null){if(EvalText(vBRC.id,vBRC.UV,vBRC.CS))vHasData++;}else{if(!DES_IsSelIdx(vBRC.id,vBRC.UI))vHasData++;}}if(vCount==0)return-1;switch(pCO.Md){case 0:return vCount==vHasData?1:0;case 1:return(vCount==vHasData)||(vHasData==0)?1:0;case 2:return vHasData>0?1:0;case 3:return vHasData==1?1:0;case 10:if((pCO.Max>0)&&(pCO.Max<vHasData))return 0;if((pCO.Min>0)&&(vHasData<pCO.Min))return 0;return 1;}return-1;}function DES_DiffReplToken(pAO,pText){pText=DES_TwoFldReplToken(pAO,pText);return DES_RERpl(pText,"{DIFFRESULT}",pAO.Cond.DiffRes)}function DES_CntSelReplToken(pAO,pText){pText=DES_OneFldReplToken(pAO,pText);pText=DES_SPReplToken(pText,pAO.Cond.Count,"COUNT");return DES_RERpl(pText,"{COUNT}",pAO.Cond.Count)}function DES_CntTrueReplToken(pAO,pText){pText=DES_SPReplToken(pText,pAO.Cond.Count,"COUNT");return DES_RERpl(pText,"{COUNT}",pAO.Cond.Count)}function DES_DupEntryReplToken(pAO,pText){pText=DES_RERpl(pText,"{TEXTVALUE}",pAO.Cond.TxtVal);pText=DES_RERpl(pText,"{LABEL1}",pAO.Cond.Lbl1);pText=DES_RERpl(pText,"{LABEL2}",pAO.Cond.Lbl2);return pText;}function DES_BadWordsReplToken(pAO,pText){pText=DES_RERpl(pText,"{UNWANTED}",pAO.Cond.TxtVal);return pText;}function DES_UnselDateReplToken(pAO,pText){pText=DES_OneFldReplToken(pAO,pText);pText=DES_RERpl(pText,"{DATELABEL}",pAO.Cond.DateLbl);return pText;}function DES_ListSzReplToken(pAO,pText){pText=DES_OneFldReplToken(pAO,pText);var vF=DES_GetById(pAO.Cond.IDToEval);if(!vF||!vF.options)return pText;pText=DES_SPReplToken(pText,vF.options.length,"COUNT");return DES_RERpl(pText,"{COUNT}",vF.options.length)}function DES_CntWords(pCO,pText){if(pText.length==0)return 0;pText=pText.replace(new RegExp("'","gi"),"");var vRegEx=new RegExp("(\\b|^)(\\w+?)(\\b|$)","ig");var vCnt=0;while(vRegEx.exec(pText)!=null)vCnt++;return vCnt;}
var gDES_ValSummary;function DES_InitVSOs(pL){for(var vI=0;vI<pL.length;vI++)DES_InitVSO(pL[vI]);}function DES_InitVSO(pVSO){if(!window.gDES_ValSummary)gDES_ValSummary=new Array;var vFnd=false;var vVSID=0;for(vVSID=0;vVSID<gDES_ValSummary.length;vVSID++){var vOld=gDES_ValSummary[vVSID];if(pVSO.ValSumID&&(pVSO.ValSumID==vOld.ValSumID)){vFnd=true;pVSO.Showing=vOld.Showing;gDES_ValSummary[vVSID]=pVSO;break;}}if(!vFnd){vVSID=gDES_ValSummary.length;gDES_ValSummary[gDES_ValSummary.length]=pVSO;}}function DES_UpdateSummaries(pGrp,pAutoUpd){if(this.gDES_ValSummary!=null){for(var vI=0;vI<this.gDES_ValSummary.length;vI++){var vVSO=this.gDES_ValSummary[vI];if(!pAutoUpd||(vVSO.Showing&&vVSO.AutoUpd))DES_UpdateValSum(vVSO,pGrp);}}}function DES_AutoUpdateSummaries(pGrp){if(this.gDES_ValSummary!=null){for(var vI=0;vI<this.gDES_ValSummary.length;vI++){var vVSO=this.gDES_ValSummary[vI];if(vVSO.Showing&&vVSO.AutoUpd){DES_PostValidate(pGrp,false,true);return;}else if((vVSO.RCDM==11)||vVSO.AUFS){var vEC=DES_CountErrors(pGrp);if((vEC>0)&&vVSO.AUFS&&(vVSO.AUFS<=vEC)){vVSO.Showing=1;DES_PostValidate(pGrp,false,true);}else if((vVSO.RCDM==11)&&vVSO.RelCtl&&(vEC>0)){var vRC=DES_GetById(vVSO.RelCtl);if((vRC.style.visibility!="hidden")){vRC.style.visibility="hidden";if(!vVSO.RCIS)vRC.style.display="none";}}}}}}function DES_UpdateValSum(pVSO,pGrp){if(pVSO.fAllGrps==null){pVSO.fAllGrps=pVSO.Grp=="*";if(!pVSO.fAllGrps){pVSO.fGroups=pVSO.Grp.split('|');for(var vI=0;vI<pVSO.fGroups.length;vI++)pVSO.fGroups[vI]=DES_Trim(pVSO.fGroups[vI]);}}var vList="";if(pVSO.fAllGrps||DES_MatchGroup(pGrp,pVSO.Grp)){var vPosNum=0;for(var vI=0;vI<gDES_ValErrMsgs.length;vI++){var vMsgGrp=gDES_ValErrMsgs[vI].Grp;var vMatch=pVSO.fAllGrps;if(!vMatch)for(var vJ=0;!vMatch&&(vJ<pVSO.fGroups.length);vJ++)vMatch=DES_MatchGroup(pVSO.fGroups[vJ],vMsgGrp);if(vMatch){if(pVSO.FmtListFnc!=null){vMsg=gDES_ValErrMsgs[vI].Msg;if(pVSO.Links&&(gDES_ValErrMsgs[vI].FldId!=null))vMsg="<a href=\"javascript:DES_SetFocus('"+gDES_ValErrMsgs[vI].FldId+"');\">"+vMsg+"</a>";if(gDES_ValErrMsgs[vI].OStl&&pVSO.ErrMsgCss2)vMsg="<span class='"+pVSO.ErrMsgCss2+"'>"+vMsg+"</span>";vList=vList+pVSO.FmtListFnc(pVSO,vMsg,vPosNum);vPosNum++;}else vList="!";}}}else return;pVSO.Showing=(vList!="");var vFld=DES_GetById(pVSO.ValSumID);var vHEFld=DES_GetById(pVSO.ValSumID+"_HadErrs");if(pVSO.Showing){DES_SetInnerHTML(vFld,DES_NLTkn(pVSO.GetInner(pVSO,vList),true,1));vFld.style.visibility="inherit";if(!pVSO.InvSpc)vFld.style.display=pVSO.Inl?pVSO.Inl:"block";if(gDES_SubmitEvent&&(pVSO.Scroll!=null)&&vFld.scrollIntoView)vFld.scrollIntoView(pVSO.Scroll==1);if(vHEFld)vHEFld.value="1";}else{if(!pVSO.InvSpc)vFld.style.display="none";vFld.style.visibility="hidden";DES_SetInnerHTML(vFld,"");}if(pVSO.RelCtl!=null){var vSRC=pVSO.Showing;switch(pVSO.RCDM){case 10:vSRC=!vSRC;break;case 11:vSRC=!vSRC&&(vHEFld.value!="");break;}var vRC=DES_GetById(pVSO.RelCtl);vRC.style.visibility=vSRC?"inherit":"hidden";if(!pVSO.RCIS)vRC.style.display=vSRC?DES_DisplayStyle(vRC):"none";}}function DES_ValSumInnerHTML(pVSO,pList){var vIH="";if(pVSO.Hdr!="")vIH=pVSO.Hdr+pVSO.HdrSep;if(pVSO.PreListFnc!=null)vIH+=pVSO.PreListFnc(pVSO)+pList+pVSO.PostListFnc(pVSO);if(pVSO.Ftr!="")vIH+=pVSO.Ftr;if(pVSO.CntTkn==null)pVSO.CntTkn=vIH.indexOf("{COUNT")>0;if(pVSO.CntTkn){var vEC=DES_CountErrors(pVSO.Grp);vIH=DES_SPReplToken(vIH,vEC,"COUNT");vIH=DES_RERpl(vIH,"{COUNT}",vEC);}return vIH;}function DES_ValSumPreDefault(pVSO){return"<p"+DES_ValSumPreAttributes(pVSO)+">";}function DES_ValSumPreBullet(pVSO){return pVSO.BulletTL+"' "+DES_ValSumPreAttributes(pVSO)+">";}function DES_ValSumPreDiv(pVSO){return"<div style='width:100%'"+DES_ValSumPreAttributes(pVSO)+">";}function DES_ValSumPreAttributes(pVSO){var vAttr="";if(pVSO.ErrMsgCss!="")vAttr=vAttr+" class='"+pVSO.ErrMsgCss+"'";if(pVSO.LinkTT!="")vAttr=vAttr+" title='"+pVSO.LinkTT+"'";return vAttr;}function DES_ValSumPostDefault(pVSO){return"</p>";}function DES_ValSumPostBullet(pVSO){if(pVSO.BulletTL.charAt(1)=='o')return"</ol>";else return"</ul>";}function DES_ValSumPostDiv(pVSO){return"</div>";}function DES_ValSumFmtItemList(pVSO,pMsg,pRowNum){var vR=pVSO.ListLdTxt+pMsg+"<br />";if(pRowNum>0)vR=pVSO.ListRSep+vR;return vR;}function DES_ValSumFmtBullet(pVSO,pMsg,pRowNum){return"<li>"+pMsg+"</li>";}
function DES_ValSumPreTbl(pVSO){return"<table width='100%' border='0' cellspacing='0' "+DES_ValSumPreAttributes(pVSO)+">";}function DES_ValSumPostTbl(pVSO){return"</table>";}function DES_ValSumFmtTbl(pVSO,pMsg,pRowNum){var vCss=(pRowNum%2==0)?pVSO.EvenRowCss:pVSO.OddRowCss;return"<tr><td class='"+vCss+"'>"+pMsg+"</td></tr>";}function DES_ValSumPreSglPara(pVSO){return"<span"+DES_ValSumPreAttributes(pVSO)+">";}function DES_ValSumPostSglPara(pVSO){return"</span>";}function DES_ValSumFmtSglPara(pVSO,pMsg,pRowNum){if(pRowNum==0)return pMsg;else return pVSO.SglParSep+pMsg;}
var gDES_VWBFlds=new Array();function DES_VWBInit(pList){for(var vI=0;vI<pList.length;vI++){var vO=pList[vI];var vF=DES_GetById(vO.CID);if(vF.VWBInit!=null)continue;gDES_VWBFlds[gDES_VWBFlds.length]=vF;vF.VWBInit=1;vF.VWB=vO.VWB;vF.VWBUC=vF.VWB.toUpperCase();vF.VWBCss=vO.Css;if(gDES_VWBMd!=0)DES_AttachEvent(vF,"onfocus","DES_VWBClear('"+vO.CID+"');");DES_AttachEvent(vF,"onblur","DES_VWBSet('"+vO.CID+"');");if(vF.OrigCss==null){if(vF.style.OrigCss!=null)vF.OrigCss=vF.style.OrigCss;else vF.OrigCss=vF.className;}var vSv=gDES_VWBMd;gDES_VWBMd=2;DES_VWBSet(vO.CID);gDES_VWBMd=vSv;}}function DES_VWBClear(pFId){var vF=DES_GetById(pFId);if(vF.value.toUpperCase()==vF.VWBUC){vF.value="";if(gDES_VWBMd==2)DES_VWBFixCss(vF);vF.select();}}function DES_VWBSet(pFId){var vF=DES_GetById(pFId);var vVal=vF.value.toUpperCase();var vCss=false;if(vVal!=vF.VWBUC){if(vVal==""){vF.value=vF.VWB;vCss=true;}else DES_VWBFixCss(vF);}else if((vF.VWB=="")&&(vVal==""))vCss=true;else if((vVal==vF.VWBUC)&&(gDES_VWBMd==2))vCss=true;if(vCss)DES_VWBApplyCss(vF,true);}function DES_VWBFixCss(pF){DES_VWBApplyCss(pF,false);}function DES_VWBApplyCss(pF,pAdd){if(pF.VWBCss){if(window.gDES_VG){if(gDES_VG.ErrCtlCss&&(pF.className.indexOf(gDES_VG.ErrCtlCss)>-1))return;if(gDES_VG.ErrCtlCss2&&(pF.className.indexOf(gDES_VG.ErrCtlCss2)>-1))return;}pF.className=pAdd?DES_MergeCss(pF.className,pF.VWBCss):pF.OrigCss;}}function DES_VWBRefresh(){for(var vI=0;vI<gDES_VWBFlds.length;vI++)DES_VWBSet(gDES_VWBFlds[vI]);}
function VAM_FieldChanged(pFldId){DES_FieldChanged(pFldId);}function VAM_FindAOById(pID){return DES_FindAOById(pID);}function VAM_SetEnabled(pAO,pEnabled){DES_SetEnabled(pAO,pEnabled);}function VAM_CalcOne(pID){DES_CalcOne(pID);}function VAM_CalcAll(){DES_CalcAll();}function VAM_GetById(pId){return DES_GetById(pId);}function VAM_SetInnerHTML(pFld,pValue){DES_SetInnerHTML(pFld,pValue);}function VAM_ParseInt(pVal){return DES_ParseInt(pVal);}function VAM_AttachEvent(pFld,pEvtName,pCode,pFst){DES_AttachEvent(pFld,pEvtName,pCode,pFst);}function VAM_FireEvent(pFld,pEN,pDOMET){DES_FireEvent(pFld,pEN,pDOMET);}function VAM_IsVisible(pFld){return DES_IsVisible(pFld);}function VAM_SetFocus(pFldId){DES_SetFocus(pFldId);}function VAM_Trim(pS){return DES_Trim(pS);}function VAM_RefreshPage(pVal){DES_RefreshPage(pVal);}function VAM_InitCond(pCO,pAO){DES_InitCond(pCO,pAO);}function VAM_InitOneFldCond(pCO,pAO){DES_InitOneFldCond(pCO,pAO);}function VAM_InitTwoFldCond(pCO,pAO){}function VAM_EvalRegexCond(pCO){return DES_EvalRegexCond(pCO);}function VAM_HookupControl(pFld,pAO,pCO,pAltEvent,pHookup){return DES_HookupControl(pFld,pAO,pCO,pAltEvent,pHookup);}function VAM_GetTextValue(pId,pTrim,pGetTextFnc){return DES_GetTextValue(pId,pTrim,pGetTextFnc);}function VAM_GetSelIdx(pId,pGetFnc){return DES_GetSelIdx(pId,pGetFnc);}function VAM_RunAllFSC(pAll){DES_RunAllFSC(pAll);}function VAM_ChgHint(pFId,pHint){DES_ChgHint(pFId,pHint);}function VAM_GetTextMSDE(pId){return DES_GetTextMSDE(pId);}function VAM_ClearMSDE(pId){DES_ClearMSDE(pId);}function VAM_SaveMSDE(pId){DES_SaveMSDE(pId);}function VAM_RestoreMSDE(pId){DES_RestoreMSDE(pId);}function VAM_UpdateSpinners(){DES_RefreshPage(false);}function VAM_DisableSubmit(){DES_DisableSubmit();}function VAM_GetDTTBValue(pTBId){return DES_GetDTTBValue(pTBId);}function VAM_SetDTTBValue(pTBId,pValue){return DES_SetDTTBValue(pTBId,pValue);}function VAM_FormatDTTBValue(pTBId,pValue){return DES_FormatDTTBValue(pTBId,pValue);}function VAM_ClickBtn(pBId,pFcs){DES_ClickBtn(pBId,pFcs);}function VAM_GetKeyCode(pE){return DES_GetKeyCode(pE);}function VAM_StopEvent(pE){DES_StopEvent(pE);}function VAM_CanEdit(pFId){return DES_CanEdit(pFId);}function VAM_TBIsBlank(pF){return DES_TBIsBlank(pF);}function VAM_ValidateGroup(pGrp,pReal){return DES_ValidateGroup(pGrp,pReal);}function VAM_ValOnSubWGrp(pGrp){return DES_ValOnSubWGrp(pGrp);}function VAM_ValOnSubmit(){return DES_ValOnSubmit();}function VAM_PostValidate(pGrp,pAll){DES_PostValidate(pGrp,pAll);}function VAM_OnReset(pIsPostBack){DES_VALReset(pIsPostBack);}function VAM_IsValid(pFld){return DES_IsValid(pFld);}function VAM_OneFldReplToken(pAO,pText){return DES_OneFldReplToken(pAO,pText);}function VAM_TwoFldReplToken(pAO,pText){return DES_TwoFldReplToken(pAO,pText);}function VAM_SPReplToken(pText,pCnt,pTName){return DES_SPReplToken(pText,pCnt,pTName);}function VAM_GetAttrCondVal(pCO){return DES_GetAttrCondVal(pCO);}function VAM_UpdateSummaries(pGrp,pAutoUpd){DES_UpdateSummaries(pGrp,pAutoUpd);}//---ValidationSummary2.js:NO MAPPED FUNCTIONS
